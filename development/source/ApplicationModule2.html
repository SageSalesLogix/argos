<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Integrations/BOE/ApplicationModule', ['exports', 'module', 'dojo/_base/declare', 'dojo/_base/lang', 'argos/I18n', 'argos/ApplicationModule', './Modules/AccountAssociationModule', './Modules/AccountModule', './Modules/BillToAccountModule', './Modules/BillToModule', './Modules/ContactModule', './Modules/ContactAssociationModule', './Modules/HelpModule', './Modules/InvoiceLineModule', './Modules/InvoiceModule', './Modules/OpportunityModule', './Modules/PayFromModule', './PicklistService', './Modules/ProductModule', './Modules/QuoteModule', './Modules/QuotePersonModule', './Modules/QuoteLineModule', './Modules/ReceivableLineModule', './Modules/ReceivableModule', './Modules/ReturnLineModule', './Modules/ReturnModule', './Modules/SalesOrderItemModule', './Modules/SalesOrderModule', './Modules/ShipmentLineModule', './Modules/ShipmentModule', './Modules/ShipToAccountModule', './Modules/ShipToModule', './Models/SyncResult/SData', './Models/BackOffice/SData', './Models/BackOfficeAccountingEntity/SData', './Models/Location/SData', './Models/OperatingCompany/SData', './Models/UnitOfMeasure/SData', 'argos/TabWidget'], function (exports, module, _dojo_baseDeclare, _dojo_baseLang, _argosI18n, _argosApplicationModule, _ModulesAccountAssociationModule, _ModulesAccountModule, _ModulesBillToAccountModule, _ModulesBillToModule, _ModulesContactModule, _ModulesContactAssociationModule, _ModulesHelpModule, _ModulesInvoiceLineModule, _ModulesInvoiceModule, _ModulesOpportunityModule, _ModulesPayFromModule, _PicklistService, _ModulesProductModule, _ModulesQuoteModule, _ModulesQuotePersonModule, _ModulesQuoteLineModule, _ModulesReceivableLineModule, _ModulesReceivableModule, _ModulesReturnLineModule, _ModulesReturnModule, _ModulesSalesOrderItemModule, _ModulesSalesOrderModule, _ModulesShipmentLineModule, _ModulesShipmentModule, _ModulesShipToAccountModule, _ModulesShipToModule, _ModelsSyncResultSData, _ModelsBackOfficeSData, _ModelsBackOfficeAccountingEntitySData, _ModelsLocationSData, _ModelsOperatingCompanySData, _ModelsUnitOfMeasureSData, _argosTabWidget) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _lang = _interopRequireDefault(_dojo_baseLang);

  var _getResource = _interopRequireDefault(_argosI18n);

  var _ApplicationModule = _interopRequireDefault(_argosApplicationModule);

  var _AccountAssociationModule = _interopRequireDefault(_ModulesAccountAssociationModule);

  var _AccountModule = _interopRequireDefault(_ModulesAccountModule);

  var _BillToAccountModule = _interopRequireDefault(_ModulesBillToAccountModule);

  var _BillToModule = _interopRequireDefault(_ModulesBillToModule);

  var _ContactModule = _interopRequireDefault(_ModulesContactModule);

  var _ContactAssociationModule = _interopRequireDefault(_ModulesContactAssociationModule);

  var _HelpModule = _interopRequireDefault(_ModulesHelpModule);

  var _InvoiceLineModule = _interopRequireDefault(_ModulesInvoiceLineModule);

  var _InvoiceModule = _interopRequireDefault(_ModulesInvoiceModule);

  var _OpportunityModule = _interopRequireDefault(_ModulesOpportunityModule);

  var _PayFromModule = _interopRequireDefault(_ModulesPayFromModule);

  var _PicklistService2 = _interopRequireDefault(_PicklistService);

  var _ProductModule = _interopRequireDefault(_ModulesProductModule);

  var _QuoteModule = _interopRequireDefault(_ModulesQuoteModule);

  var _QuotePersonModule = _interopRequireDefault(_ModulesQuotePersonModule);

  var _QuoteLineModule = _interopRequireDefault(_ModulesQuoteLineModule);

  var _ReceivableLineModule = _interopRequireDefault(_ModulesReceivableLineModule);

  var _ReceivableModule = _interopRequireDefault(_ModulesReceivableModule);

  var _ReturnLineModule = _interopRequireDefault(_ModulesReturnLineModule);

  var _ReturnModule = _interopRequireDefault(_ModulesReturnModule);

  var _SalesOrderItemModule = _interopRequireDefault(_ModulesSalesOrderItemModule);

  var _SalesOrderModule = _interopRequireDefault(_ModulesSalesOrderModule);

  var _ShipmentLineModule = _interopRequireDefault(_ModulesShipmentLineModule);

  var _ShipmentModule = _interopRequireDefault(_ModulesShipmentModule);

  var _ShipToAccountModule = _interopRequireDefault(_ModulesShipToAccountModule);

  var _ShipToModule = _interopRequireDefault(_ModulesShipToModule);

  var resource = (0, _getResource['default'])('icboeApplicationModule');

  var __class = (0, _declare['default'])('crm.Integrations.BOE.ApplicationModule', [_ApplicationModule['default']], {
    modules: null,
    init: function init() {
      this.inherited(arguments);
    },
    initDynamic: function init() {
      if (!this.isIntegrationEnabled()) {
        return;
      }

      console.log('Loading dynamic modules for BOE');
      App.picklistService = _PicklistService2['default'];
      App.enableDashboards = this.enableDashboards;
      this.modules = [new _AccountAssociationModule['default'](this), new _AccountModule['default'](this), new _BillToAccountModule['default'](this), new _BillToModule['default'](this), new _ContactModule['default'](this), new _ContactAssociationModule['default'](this), new _HelpModule['default'](this), new _InvoiceLineModule['default'](this), new _InvoiceModule['default'](this), new _OpportunityModule['default'](this), new _PayFromModule['default'](this), new _ProductModule['default'](this), new _QuoteModule['default'](this), new _QuotePersonModule['default'](this), new _QuoteLineModule['default'](this), new _ReceivableLineModule['default'](this), new _ReceivableModule['default'](this), new _ReturnLineModule['default'](this), new _ReturnModule['default'](this), new _SalesOrderItemModule['default'](this), new _SalesOrderModule['default'](this), new _ShipmentLineModule['default'](this), new _ShipmentModule['default'](this), new _ShipToAccountModule['default'](this), new _ShipToModule['default'](this)];

      this.modules.forEach(function initModules(mod) {
        mod.init();
      });

      this.inherited(arguments);
    },
    isIntegrationEnabled: function isIntegrationEnabled() {
      var results = this.application.context.integrations.filter(function (integration) {
        return integration.Name === &quot;Back Office Extension&quot;;
      })[0];
      return results &amp;&amp; results.Enabled;
    },
    loadViewsDynamic: function loadViewsDynamic() {
      if (!this.isIntegrationEnabled()) {
        return;
      }

      console.log('loading dynamic views for BOE');
      this.modules.forEach(function loadModuleViews(module) {
        module.loadViews();
      });
    },
    loadCustomizationsDynamic: function loadCustomizations() {
      if (!this.isIntegrationEnabled()) {
        return;
      }

      console.log('loading dynamic customizations for BOE');
      this.modules.forEach(function loadModuleCustomizations(module) {
        module.loadCustomizations();
      });
      this.registerDefaultViews();

      _lang['default'].extend(argos._ListBase, {
        navigateToInsertView: function navigateToInsertView(el, additionalOptions) {
          var view = this.app.getView(this.insertView || this.editView);
          var options = {
            detailView: this.detailView,
            returnTo: this.id,
            insert: true
          };

          // Pass along the selected entry (related list could get it from a quick action)
          if (this.options.selectedEntry) {
            options.selectedEntry = this.options.selectedEntry;
          }

          if (additionalOptions) {
            options = _lang['default'].mixin(options, additionalOptions);
          }

          if (view) {
            view.show(options);
          }
        }
      });

      _lang['default'].extend(argos._EditBase, {
        onInsertCompleted: function onInsertCompleted(entry) {
          if (this.options &amp;&amp; this.options.detailView) {
            var view = App.getView(this.options.detailView);
            if (view) {
              view.show({
                key: entry.$key,
                title: entry.$descriptor,
                description: entry.$descriptor
              }, {
                returnTo: -1
              });
            }
          }
          if (this.options &amp;&amp; this.options.returnTo) {
            var returnTo = this.options.returnTo;
            var view = App.getView(returnTo);
            if (view) {
              view.show();
            } else {
              window.location.hash = returnTo;
            }
          } else {
            ReUI.back();
          }
        }
      });

      _lang['default'].extend(crm.Views.MetricWidget, {
        itemTemplate: new Simplate(['&lt;h1 class=&quot;metric-value&quot; {%: $$.getValueStyle() %} &gt;{%: $$.formatter($.value) %}&lt;/h1&gt;', '&lt;span class=&quot;metric-title&quot;&gt;{%: $$.title %}&lt;/span&gt;']),
        setValueColor: function setValueColor(color) {
          this.valueColor = color;
        },
        getValueStyle: function getValueStyle() {
          if (this.valueColor) {
            return 'style=color:' + this.valueColor;
          }
          return '';
        }
      });

      _lang['default'].extend(argos.TabWidget, {
        tabListItemTemplate: new Simplate(['&lt;li data-key=&quot;{%: $.name %}&quot; class=&quot;tab&quot; data-action=&quot;selectedTab&quot;&gt;', '{%: ($.title || $.options.title) %}', '&lt;/li&gt;'])
      });
    },
    loadToolbarsDynamic: function loadToolbars() {
      if (!this.isIntegrationEnabled()) {
        return;
      }

      console.log('Loading dynamic toolbars for BOE');
      this.modules.forEach(function loadModuleToolbars(module) {
        module.loadToolbars();
      });
    },
    loadAppStatePromises: function loadAppStatePromises() {
      this.inherited(arguments);
      this.registerAppStatePromise({
        seq: 2,
        description: resource.picklistsText,
        items: [{
          name: 'picklist-requests',
          description: resource.retrievingPicklistsText,
          fn: function fn() {
            _PicklistService2['default'].requestPicklists();
          }
        }]
      });
    },
    registerDefaultViews: function registerDefaultViews() {
      var self = this;
      var originalGetDefaultViews = crm.Application.prototype.getDefaultViews;
      _lang['default'].extend(crm.Application, {
        getDefaultViews: function getDefaultViews() {
          var views = originalGetDefaultViews.apply(this, arguments) || [];
          self.modules.forEach(function (module) {
            module.registerDefaultViews(views);
          });
          return views;
        }
      });
    }
  });

  _lang['default'].setObject('icboe.ApplicationModule', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9JbnRlZ3JhdGlvbnMvQk9FL0FwcGxpY2F0aW9uTW9kdWxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNDQSxNQUFNLFFBQVEsR0FBRyw2QkFBWSx3QkFBd0IsQ0FBQyxDQUFDOztBQUV2RCxNQUFNLE9BQU8sR0FBRyx5QkFBUSx3Q0FBd0MsRUFBRSwrQkFBbUIsRUFBRTtBQUNyRixXQUFPLEVBQUUsSUFBSTtBQUNiLFFBQUksRUFBRSxTQUFTLElBQUksR0FBRztBQUNwQixVQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0tBQzNCO0FBQ0QsZUFBVyxFQUFFLFNBQVMsSUFBSSxHQUFHO0FBQzNCLFVBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsRUFBRTtBQUNoQyxlQUFPO09BQ1I7O0FBRUQsYUFBTyxDQUFDLEdBQUcsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO0FBQy9DLFNBQUcsQ0FBQyxlQUFlLCtCQUFrQixDQUFDO0FBQ3RDLFNBQUcsQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7QUFDN0MsVUFBSSxDQUFDLE9BQU8sR0FBRyxDQUNiLHlDQUE2QixJQUFJLENBQUMsRUFDbEMsOEJBQWtCLElBQUksQ0FBQyxFQUN2QixvQ0FBd0IsSUFBSSxDQUFDLEVBQzdCLDZCQUFpQixJQUFJLENBQUMsRUFDdEIsOEJBQWtCLElBQUksQ0FBQyxFQUN2Qix5Q0FBNkIsSUFBSSxDQUFDLEVBQ2xDLDJCQUFlLElBQUksQ0FBQyxFQUNwQixrQ0FBc0IsSUFBSSxDQUFDLEVBQzNCLDhCQUFrQixJQUFJLENBQUMsRUFDdkIsa0NBQXNCLElBQUksQ0FBQyxFQUMzQiw4QkFBa0IsSUFBSSxDQUFDLEVBQ3ZCLDhCQUFrQixJQUFJLENBQUMsRUFDdkIsNEJBQWdCLElBQUksQ0FBQyxFQUNyQixrQ0FBc0Is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Q0gsQ0FBQyxDQUFDO0tBQ0o7QUFDRCx3QkFBb0IsRUFBRSxTQUFTLG9CQUFvQixHQUFHO0FBQ3BELFVBQU0sSUFBSSxHQUFHLElBQUksQ0FBQztBQUNsQixVQUFNLHVCQUF1QixHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQztBQUMxRSx1QkFBSyxNQUFNLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRTtBQUMzQix1QkFBZSxFQUFFLFNBQVMsZUFBZSxHQUFHO0FBQzFDLGNBQU0sS0FBSyxHQUFHLHVCQUF1QixDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ25FLGNBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQUMsTUFBTSxFQUFLO0FBQy9CLGtCQUFNLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUM7V0FDcEMsQ0FBQyxDQUFDO0FBQ0gsaUJBQU8sS0FBSyxDQUFDO1NBQ2Q7T0FDRixDQUFDLENBQUM7S0FDSjtHQUNGLENBQUMsQ0FBQzs7QUFFSCxtQkFBSyxTQUFTLENBQUMseUJBQXlCLEVBQUUsT0FBTyxDQUFDLENBQUM7bUJBQ3BDLE9BQU8iLCJmaWxlIjoic3JjL0ludGVncmF0aW9ucy9CT0UvQXBwbGljYXRpb25Nb2R1bGUuanMiLCJzb3VyY2VSb290Ijoic3JjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRlY2xhcmUgZnJvbSAnZG9qby9fYmFzZS9kZWNsYXJlJztcclxuaW1wb3J0IGxhbmcgZnJvbSAnZG9qby9fYmFzZS9sYW5nJztcclxuaW1wb3J0IGdldFJlc291cmNlIGZyb20gJ2FyZ29zL0kxOG4nO1xyXG5pbXBvcnQgQXBwbGljYXRpb25Nb2R1bGUgZnJvbSAnYXJnb3MvQXBwbGljYXRpb25Nb2R1bGUnO1xyXG5pbXBvcnQgQWNjb3VudEFzc29jaWF0aW9uTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9BY2NvdW50QXNzb2NpYXRpb25Nb2R1bGUnO1xyXG5pbXBvcnQgQWNjb3VudE1vZHVsZSBmcm9tICcuL01vZHVsZXMvQWNjb3VudE1vZHVsZSc7XHJcbmltcG9ydCBCaWxsVG9BY2NvdW50TW9kdWxlIGZyb20gJy4vTW9kdWxlcy9CaWxsVG9BY2NvdW50TW9kdWxlJztcclxuaW1wb3J0IEJpbGxUb01vZHVsZSBmcm9tICcuL01vZHVsZXMvQmlsbFRvTW9kdWxlJztcclxuaW1wb3J0IENvbnRhY3RNb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL0NvbnRhY3RNb2R1bGUnO1xyXG5pbXBvcnQgQ29udGFjdEFzc29jaWF0aW9uTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9Db250YWN0QXNzb2NpYXRpb25Nb2R1bGUnO1xyXG5pbXBvcnQgSGVscE1vZHVsZSBmcm9tICcuL01vZHVsZXMvSGVscE1vZHVsZSc7XHJcbmltcG9ydCBJbnZvaWNlTGluZU1vZHVsZSBmcm9tICcuL01vZHVsZXMvSW52b2ljZUxpbmVNb2R1bGUnO1xyXG5pbXBvcnQgSW52b2ljZU1vZHVsZSBmcm9tICcuL01vZHVsZXMvSW52b2ljZU1vZHVsZSc7XHJcbmltcG9ydCBPcHBvcnR1bml0eU1vZHVsZSBmcm9tICcuL01vZHVsZXMvT3Bwb3J0dW5pdHlNb2R1bGUnO1xyXG5pbXBvcnQgUGF5RnJvbU1vZHVsZSBmcm9tICcuL01vZHVsZXMvUGF5RnJvbU1vZHVsZSc7XHJcbmltcG9ydCBQaWNrbGlzdFNlcnZpY2UgZnJvbSAnLi9QaWNrbGlzdFNlcnZpY2UnO1xyXG5pbXBvcnQgUHJvZHVjdE1vZHVsZSBmcm9tICcuL01vZHVsZXMvUHJvZHVjdE1vZHVsZSc7XHJcbmltcG9ydCBRdW90ZU1vZHVsZSBmcm9tICcuL01vZHVsZXMvUXVvdGVNb2R1bGUnO1xyXG5pbXBvcnQgUXVvdGVQZXJzb25Nb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1F1b3RlUGVyc29uTW9kdWxlJztcclxuaW1wb3J0IFF1b3RlTGluZU1vZHVsZSBmcm9tICcuL01vZHVsZXMvUXVvdGVMaW5lTW9kdWxlJztcclxuaW1wb3J0IFJlY2VpdmFibGVMaW5lTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9SZWNlaXZhYmxlTGluZU1vZHVsZSc7XHJcbmltcG9ydCBSZWNlaXZhYmxlTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9SZWNlaXZhYmxlTW9kdWxlJztcclxuaW1wb3J0IFJldHVybkxpbmVNb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1JldHVybkxpbmVNb2R1bGUnO1xyXG5pbXBvcnQgUmV0dXJuTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9SZXR1cm5Nb2R1bGUnO1xyXG5pbXBvcnQgU2FsZXNPcmRlckl0ZW1Nb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1NhbGVzT3JkZXJJdGVtTW9kdWxlJztcclxuaW1wb3J0IFNhbGVzT3JkZXJNb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1NhbGVzT3JkZXJNb2R1bGUnO1xyXG5pbXBvcnQgU2hpcG1lbnRMaW5lTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9TaGlwbWVudExpbmVNb2R1bGUnO1xyXG5pbXBvcnQgU2hpcG1lbnRNb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1NoaXBtZW50TW9kdWxlJztcclxuaW1wb3J0IFNoaXBUb0FjY291bnRNb2R1bGUgZnJvbSAnLi9Nb2R1bGVzL1NoaXBUb0FjY291bnRNb2R1bGUnO1xyXG5pbXBvcnQgU2hpcFRvTW9kdWxlIGZyb20gJy4vTW9kdWxlcy9TaGlwVG9Nb2R1bGUnO1xyXG5pbXBvcnQgJy4vTW9kZWxzL1N5bmNSZXN1bHQvU0RhdGEnO1xyXG5pbXBvcnQgJy4vTW9kZWxzL0JhY2tPZmZpY2UvU0RhdGEnO1xyXG5pbXBvcnQgJy4vTW9kZWxzL0JhY2tPZmZpY2VBY2NvdW50aW5nRW50aXR5L1NEYXRhJztcclxuaW1wb3J0ICcuL01vZGVscy9Mb2NhdGlvbi9TRGF0YSc7XHJcbmltcG9ydCAnLi9Nb2RlbHMvT3BlcmF0aW5nQ29tcGFueS9TRGF0YSc7XHJcbmltcG9ydCAnLi9Nb2RlbHMvVW5pdE9mTWVhc3VyZS9TRGF0YSc7XHJcbmltcG9ydCAnYXJnb3MvVGFiV2lkZ2V0JztcclxuXHJcbmNvbnN0IHJlc291cmNlID0gZ2V0UmVzb3VyY2UoJ2ljYm9lQXBwbGljYXRpb25Nb2R1bGUnKTtcclxuXHJcbmNvbnN0IF9fY2xhc3MgPSBkZWNsYXJlKCdjcm0uSW50ZWdyYXRpb25zLkJPRS5BcHBsaWNhdGlvbk1vZHVsZScsIFtBcHBsaWNhdGlvbk1vZHVsZV0sIHtcclxuICBtb2R1bGVzOiBudWxsLFxyXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICB0aGlzLmluaGVyaXRlZChhcmd1bWVudHMpO1xyXG4gIH0sXHJcbiAgaW5pdER5bmFtaWM6IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICBpZiAoIXRoaXMuaXNJbnRlZ3JhdGlvbkVuYWJsZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0xvYWRpbmcgZHluYW1pYyBtb2R1bGVzIGZvciBCT0UnKTtcclxuICAgIEFwcC5waWNrbGlzdFNlcnZpY2UgPSBQaWNrbGlzdFNlcnZpY2U7XHJcbiAgICBBcHAuZW5hYmxlRGFzaGJvYXJkcyA9IHRoaXMuZW5hYmxlRGFzaGJvYXJkcztcclxuICAgIHRoaXMubW9kdWxlcyA9IFtcclxuICAgICAgbmV3IEFjY291bnRBc3NvY2lhdGlvbk1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IEFjY291bnRNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBCaWxsVG9BY2NvdW50TW9kdWxlKHRoaXMpLFxyXG4gICAgICBuZXcgQmlsbFRvTW9kdWxlKHRoaXMpLFxyXG4gICAgICBuZXcgQ29udGFjdE1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IENvbnRhY3RBc3NvY2lhdGlvbk1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IEhlbHBNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBJbnZvaWNlTGluZU1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IEludm9pY2VNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBPcHBvcnR1bml0eU1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFBheUZyb21Nb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBQcm9kdWN0TW9kdWxlKHRoaXMpLFxyXG4gICAgICBuZXcgUXVvdGVNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBRdW90ZVBlcnNvbk1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFF1b3RlTGluZU1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFJlY2VpdmFibGVMaW5lTW9kdWxlKHRoaXMpLFxyXG4gICAgICBuZXcgUmVjZWl2YWJsZU1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFJldHVybkxpbmVNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBSZXR1cm5Nb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBTYWxlc09yZGVySXRlbU1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFNhbGVzT3JkZXJNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBTaGlwbWVudExpbmVNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBTaGlwbWVudE1vZHVsZSh0aGlzKSxcclxuICAgICAgbmV3IFNoaXBUb0FjY291bnRNb2R1bGUodGhpcyksXHJcbiAgICAgIG5ldyBTaGlwVG9Nb2R1bGUodGhpcyksXHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMubW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIGluaXRNb2R1bGVzKG1vZCkge1xyXG4gICAgICBtb2QuaW5pdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICB9LFxyXG4gIGlzSW50ZWdyYXRpb25FbmFibGVkOiBmdW5jdGlvbiBpc0ludGVncmF0aW9uRW5hYmxlZCgpIHtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLmFwcGxpY2F0aW9uLmNvbnRleHQuaW50ZWdyYXRpb25zLmZpbHRlcigoaW50ZWdyYXRpb24pID0+IGludGVncmF0aW9uLk5hbWUgPT09IFwiQmFjayBPZmZpY2UgRXh0ZW5zaW9uXCIpWzBdO1xyXG4gICAgcmV0dXJuIHJlc3VsdHMgJiYgcmVzdWx0cy5FbmFibGVkO1xyXG4gIH0sXHJcbiAgbG9hZFZpZXdzRHluYW1pYzogZnVuY3Rpb24gbG9hZFZpZXdzRHluYW1pYygpIHtcclxuICAgIGlmICghdGhpcy5pc0ludGVncmF0aW9uRW5hYmxlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZygnbG9hZGluZyBkeW5hbWljIHZpZXdzIGZvciBCT0UnKTtcclxuICAgIHRoaXMubW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIGxvYWRNb2R1bGVWaWV3cyhtb2R1bGUpIHtcclxuICAgICAgbW9kdWxlLmxvYWRWaWV3cygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuICBsb2FkQ3VzdG9taXphdGlvbnNEeW5hbWljOiBmdW5jdGlvbiBsb2FkQ3VzdG9taXphdGlvbnMoKSB7XHJcbiAgICBpZiAoIXRoaXMuaXNJbnRlZ3JhdGlvbkVuYWJsZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ2xvYWRpbmcgZHluYW1pYyBjdXN0b21pemF0aW9ucyBmb3IgQk9FJyk7XHJcbiAgICB0aGlzLm1vZHVsZXMuZm9yRWFjaChmdW5jdGlvbiBsb2FkTW9kdWxlQ3VzdG9taXphdGlvbnMobW9kdWxlKSB7XHJcbiAgICAgIG1vZHVsZS5sb2FkQ3VzdG9taXphdGlvbnMoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5yZWdpc3RlckRlZmF1bHRWaWV3cygpO1xyXG5cclxuICAgIGxhbmcuZXh0ZW5kKGFyZ29zLl9MaXN0QmFzZSwge1xyXG4gICAgICBuYXZpZ2F0ZVRvSW5zZXJ0VmlldzogZnVuY3Rpb24gbmF2aWdhdGVUb0luc2VydFZpZXcoZWwsIGFkZGl0aW9uYWxPcHRpb25zKSB7XHJcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLmdldFZpZXcodGhpcy5pbnNlcnRWaWV3IHx8IHRoaXMuZWRpdFZpZXcpO1xyXG4gICAgICAgIGxldCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgZGV0YWlsVmlldzogdGhpcy5kZXRhaWxWaWV3LFxyXG4gICAgICAgICAgcmV0dXJuVG86IHRoaXMuaWQsXHJcbiAgICAgICAgICBpbnNlcnQ6IHRydWUsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gUGFzcyBhbG9uZyB0aGUgc2VsZWN0ZWQgZW50cnkgKHJlbGF0ZWQgbGlzdCBjb3VsZCBnZXQgaXQgZnJvbSBhIHF1aWNrIGFjdGlvbilcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNlbGVjdGVkRW50cnkpIHtcclxuICAgICAgICAgIG9wdGlvbnMuc2VsZWN0ZWRFbnRyeSA9IHRoaXMub3B0aW9ucy5zZWxlY3RlZEVudHJ5O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGFkZGl0aW9uYWxPcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gbGFuZy5taXhpbihvcHRpb25zLCBhZGRpdGlvbmFsT3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgdmlldy5zaG93KG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxhbmcuZXh0ZW5kKGFyZ29zLl9FZGl0QmFzZSwge1xyXG4gICAgICBvbkluc2VydENvbXBsZXRlZDogZnVuY3Rpb24gb25JbnNlcnRDb21wbGV0ZWQoZW50cnkpIHtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy5kZXRhaWxWaWV3KSB7XHJcbiAgICAgICAgICBjb25zdCB2aWV3ID0gQXBwLmdldFZpZXcodGhpcy5vcHRpb25zLmRldGFpbFZpZXcpO1xyXG4gICAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgdmlldy5zaG93KHtcclxuICAgICAgICAgICAgICBrZXk6IGVudHJ5LiRrZXksXHJcbiAgICAgICAgICAgICAgdGl0bGU6IGVudHJ5LiRkZXNjcmlwdG9yLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlbnRyeS4kZGVzY3JpcHRvcixcclxuICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgIHJldHVyblRvOiAtMSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnJldHVyblRvKSB7XHJcbiAgICAgICAgICBjb25zdCByZXR1cm5UbyA9IHRoaXMub3B0aW9ucy5yZXR1cm5UbztcclxuICAgICAgICAgIGNvbnN0IHZpZXcgPSBBcHAuZ2V0VmlldyhyZXR1cm5Ubyk7XHJcbiAgICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICB2aWV3LnNob3coKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gcmV0dXJuVG87XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIFJlVUkuYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxhbmcuZXh0ZW5kKGNybS5WaWV3cy5NZXRyaWNXaWRnZXQsIHtcclxuICAgICAgaXRlbVRlbXBsYXRlOiBuZXcgU2ltcGxhdGUoW1xyXG4gICAgICAgJzxoMSBjbGFzcz1cIm1ldHJpYy12YWx1ZVwiIHslOiAkJC5nZXRWYWx1ZVN0eWxlKCkgJX0gPnslOiAkJC5mb3JtYXR0ZXIoJC52YWx1ZSkgJX08L2gxPicsXHJcbiAgICAgICAnPHNwYW4gY2xhc3M9XCJtZXRyaWMtdGl0bGVcIj57JTogJCQudGl0bGUgJX08L3NwYW4+JyxcclxuICAgICAgXSksXHJcbiAgICAgIHNldFZhbHVlQ29sb3I6IGZ1bmN0aW9uIHNldFZhbHVlQ29sb3IoY29sb3IpIHtcclxuICAgICAgICB0aGlzLnZhbHVlQ29sb3IgPSBjb2xvcjtcclxuICAgICAgfSxcclxuICAgICAgZ2V0VmFsdWVTdHlsZTogZnVuY3Rpb24gZ2V0VmFsdWVTdHlsZSgpIHtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZUNvbG9yKSB7XHJcbiAgICAgICAgICByZXR1cm4gJ3N0eWxlPWNvbG9yOicgKyB0aGlzLnZhbHVlQ29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxhbmcuZXh0ZW5kKGFyZ29zLlRhYldpZGdldCwge1xyXG4gICAgICB0YWJMaXN0SXRlbVRlbXBsYXRlOiBuZXcgU2ltcGxhdGUoW1xyXG4gICAgICAgJzxsaSBkYXRhLWtleT1cInslOiAkLm5hbWUgJX1cIiBjbGFzcz1cInRhYlwiIGRhdGEtYWN0aW9uPVwic2VsZWN0ZWRUYWJcIj4nLFxyXG4gICAgICAgICAgJ3slOiAoJC50aXRsZSB8fCAkLm9wdGlvbnMudGl0bGUpICV9JyxcclxuICAgICAgICc8L2xpPicsXHJcbiAgICAgIF0pLFxyXG4gICAgfSk7XHJcbiAgfSxcclxuICBsb2FkVG9vbGJhcnNEeW5hbWljOiBmdW5jdGlvbiBsb2FkVG9vbGJhcnMoKSB7XHJcbiAgICBpZiAoIXRoaXMuaXNJbnRlZ3JhdGlvbkVuYWJsZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0xvYWRpbmcgZHluYW1pYyB0b29sYmFycyBmb3IgQk9FJyk7XHJcbiAgICB0aGlzLm1vZHVsZXMuZm9yRWFjaChmdW5jdGlvbiBsb2FkTW9kdWxlVG9vbGJhcnMobW9kdWxlKSB7XHJcbiAgICAgIG1vZHVsZS5sb2FkVG9vbGJhcnMoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgbG9hZEFwcFN0YXRlUHJvbWlzZXM6IGZ1bmN0aW9uIGxvYWRBcHBTdGF0ZVByb21pc2VzKCkge1xyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICAgIHRoaXMucmVnaXN0ZXJBcHBTdGF0ZVByb21pc2Uoe1xyXG4gICAgICBzZXE6IDIsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiByZXNvdXJjZS5waWNrbGlzdHNUZXh0LFxyXG4gICAgICBpdGVtczogW3tcclxuICAgICAgICBuYW1lOiAncGlja2xpc3QtcmVxdWVzdHMnLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiByZXNvdXJjZS5yZXRyaWV2aW5nUGlja2xpc3RzVGV4dCxcclxuICAgICAgICBmbjogKCkgPT4ge1xyXG4gICAgICAgICAgUGlja2xpc3RTZXJ2aWNlLnJlcXVlc3RQaWNrbGlzdHMoKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9XSxcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgcmVnaXN0ZXJEZWZhdWx0Vmlld3M6IGZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdFZpZXdzKCkge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBjb25zdCBvcmlnaW5hbEdldERlZmF1bHRWaWV3cyA9IGNybS5BcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0RGVmYXVsdFZpZXdzO1xyXG4gICAgbGFuZy5leHRlbmQoY3JtLkFwcGxpY2F0aW9uLCB7XHJcbiAgICAgIGdldERlZmF1bHRWaWV3czogZnVuY3Rpb24gZ2V0RGVmYXVsdFZpZXdzKCkge1xyXG4gICAgICAgIGNvbnN0IHZpZXdzID0gb3JpZ2luYWxHZXREZWZhdWx0Vmlld3MuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCBbXTtcclxuICAgICAgICBzZWxmLm1vZHVsZXMuZm9yRWFjaCgobW9kdWxlKSA9PiB7XHJcbiAgICAgICAgICBtb2R1bGUucmVnaXN0ZXJEZWZhdWx0Vmlld3Modmlld3MpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB2aWV3cztcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxubGFuZy5zZXRPYmplY3QoJ2ljYm9lLkFwcGxpY2F0aW9uTW9kdWxlJywgX19jbGFzcyk7XHJcbmV4cG9ydCBkZWZhdWx0IF9fY2xhc3M7XHJcbiJdfQ==
</pre>
</body>
</html>
