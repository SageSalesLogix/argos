<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Application', ['exports', 'module', 'dojo/_base/declare', 'dojo/_base/array', 'dojo/_base/connect', 'dojo/json', 'dojo/_base/lang', 'dojo/has', 'dojo/string', 'dojo/Deferred', './DefaultMetrics', 'argos/ErrorManager', './Environment', 'argos/Application', 'argos/Offline/Manager', 'argos/Models/Types', './Models/Names', 'argos/Dialogs/BusyIndicator', 'argos/I18n', 'dojo/sniff'], function (exports, module, _dojo_baseDeclare, _dojo_baseArray, _dojo_baseConnect, _dojoJson, _dojo_baseLang, _dojoHas, _dojoString, _dojoDeferred, _DefaultMetrics, _argosErrorManager, _Environment, _argosApplication, _argosOfflineManager, _argosModelsTypes, _ModelsNames, _argosDialogsBusyIndicator, _argosI18n, _dojoSniff) {
  var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i &amp;&amp; _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n &amp;&amp; _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _array = _interopRequireDefault(_dojo_baseArray);

  var _connect = _interopRequireDefault(_dojo_baseConnect);

  var _json = _interopRequireDefault(_dojoJson);

  var _lang = _interopRequireDefault(_dojo_baseLang);

  var _has = _interopRequireDefault(_dojoHas);

  var _string = _interopRequireDefault(_dojoString);

  var _Deferred = _interopRequireDefault(_dojoDeferred);

  var _DefaultMetrics2 = _interopRequireDefault(_DefaultMetrics);

  var _ErrorManager = _interopRequireDefault(_argosErrorManager);

  var _environment = _interopRequireDefault(_Environment);

  var _Application = _interopRequireDefault(_argosApplication);

  var _offlineManager = _interopRequireDefault(_argosOfflineManager);

  var _MODEL_TYPES = _interopRequireDefault(_argosModelsTypes);

  var _MODEL_NAMES = _interopRequireDefault(_ModelsNames);

  var _BusyIndicator = _interopRequireDefault(_argosDialogsBusyIndicator);

  var _getResource = _interopRequireDefault(_argosI18n);

  var resource = (0, _getResource['default'])('application');

<span id='crm-Application'>  /**
</span>   * @class crm.Application
   *
   * @extends argos.Application
   * @requires argos.ErrorManager
   * @requires crm.Environment
   * @requires moment
   *
   */
  var __class = (0, _declare['default'])('crm.Application', [_Application['default']], {
    navigationState: null,
    rememberNavigationState: true,
    enableUpdateNotification: false,
    multiCurrency: false,
    enableGroups: true,
    enableHashTags: true,
    enableOfflineSupport: false,
    speedSearch: {
      includeStemming: true,
      includePhonic: true,
      includeThesaurus: false,
      useFrequentFilter: false,
      searchType: 1
    },
    enableCaching: true,
    userDetailsQuerySelect: ['UserName', 'UserInfo/UserName', 'UserInfo/FirstName', 'UserInfo/LastName', 'DefaultOwner/OwnerDescription'],
    userOptionsToRequest: ['DefaultGroup;ACCOUNT', 'DefaultGroup;CONTACT', 'DefaultGroup;OPPORTUNITY', 'DefaultGroup;LEAD', 'DefaultGroup;TICKET', 'DefaultGroup;SALESORDER', 'DefaultGroup;QUOTE', 'General;InsertSecCodeID', 'General;Currency', 'Calendar;DayStartTime', 'Calendar;WeekStart', 'ActivityMeetingOptions;AlarmEnabled', 'ActivityMeetingOptions;AlarmLead', 'ActivityMeetingOptions;Duration', 'ActivityPhoneOptions;AlarmEnabled', 'ActivityPhoneOptions;AlarmLead', 'ActivityPhoneOptions;Duration', 'ActivityToDoOptions;AlarmEnabled', 'ActivityToDoOptions;AlarmLead', 'ActivityToDoOptions;Duration', 'ActivityPersonalOptions;AlarmEnabled', 'ActivityPersonalOptions;AlarmLead', 'ActivityPersonalOptions;Duration'],
    systemOptionsToRequest: ['BaseCurrency', 'MultiCurrency', 'ChangeOpportunityRate', 'LockOpportunityRate'],
    appName: 'argos-saleslogix',
    serverVersion: {
      'major': 8,
      'minor': 0,
      'revision': 0
    },
    mobileVersion: {
      'major': 3,
      'minor': 5,
      'revision': 0
    },
    versionInfoText: resource.versionInfoText,
    loadingText: resource.loadingText,
    authText: resource.authText,
    connectionToastTitleText: resource.connectionToastTitleText,
    offlineText: resource.offlineText,
    onlineText: resource.onlineText,
    homeViewId: 'myactivity_list',
    offlineHomeViewId: 'recently_viewed_list',
    loginViewId: 'login',
    logOffViewId: 'logoff',

    UID: null,
    init: function init() {
      if ((0, _has['default'])('ie') &amp;&amp; (0, _has['default'])('ie') &lt; 9) {
        window.location.href = 'unsupported.html';
      }

      this.inherited(arguments);
      this._loadNavigationState();

      this.UID = new Date().getTime();
      var original = Sage.SData.Client.SDataService.prototype.executeRequest;
      var self = this;
      Sage.SData.Client.SDataService.prototype.executeRequest = function executeRequest(request) {
        request.setRequestHeader('X-Application-Name', self.appName);
        request.setRequestHeader('X-Application-Version', _string['default'].substitute('${version.major}.${version.minor}.${version.revision};${id}', {
          version: self.mobileVersion,
          id: self.UID
        }));
        return original.apply(this, arguments);
      };
    },
    initConnects: function initConnects() {
      this.inherited(arguments);

      if (window.applicationCache) {
        this._connects.push(_connect['default'].connect(window.applicationCache, 'updateready', this, this._checkForUpdate));
      }
    },
    isOnFirstView: function isOnFirstView() {
      var history = ReUI.context.history;
      var length = history.length;
      var current = history[length - 1];
      var previous = history[length - 2];
      var isFirstView = false;

      if (current &amp;&amp; current.page === this.loginViewId || current &amp;&amp; current.page === this.logOffViewId) {
        isFirstView = true;
      } else if (previous &amp;&amp; previous.page === this.loginViewId) {
        isFirstView = true;
      } else if (length === 1) {
        isFirstView = true;
      }

      return isFirstView;
    },
    onSetOrientation: function onSetOrientation() {
      if (this.snapper) {
        this.snapper.close();
      }
    },
    _viewTransitionTo: function _viewTransitionTo() {
      this.inherited(arguments);
      this._checkSaveNavigationState();
      if (this.snapper) {
        this.snapper.close();
      }
    },
    _checkSaveNavigationState: function _checkSaveNavigationState() {
      if (this.rememberNavigationState !== false) {
        this._saveNavigationState();
      }
    },
    _checkForUpdate: function _checkForUpdate() {
      var applicationCache = window.applicationCache;
      if (applicationCache &amp;&amp; this.enableUpdateNotification) {
        if (applicationCache.status === applicationCache.UPDATEREADY) {
          this._notifyUpdateAvailable();
        }
      }
    },
    _notifyUpdateAvailable: function _notifyUpdateAvailable() {
      if (this.bars.updatebar) {
        this.bars.updatebar.show();
      }
    },
    _saveNavigationState: function _saveNavigationState() {
      try {
        if (window.localStorage) {
          window.localStorage.setItem('navigationState', _json['default'].stringify(ReUI.context.history));
        }
      } catch (e) {} // eslint-disable-line
    },
    hasMultiCurrency: function hasMultiCurrency() {
      // Check if the configuration specified multiCurrency, this will override the dynamic check.
      // A configuration is not ideal, and we should refactor the edit view to process the layout when it first recieves its data,
      // instead of on startup. We cannot check App.context data that was loaded after login when the startup method is used.
      if (this.multiCurrency) {
        return true;
      }

      return false;
    },
    canLockOpportunityRate: function canLockOpportunityRate() {
      if (this.context &amp;&amp; this.context.systemOptions &amp;&amp; this.context.systemOptions.LockOpportunityRate === 'True') {
        return true;
      }

      return false;
    },
    canChangeOpportunityRate: function canChangeOpportunityRate() {
      if (this.context &amp;&amp; this.context.systemOptions &amp;&amp; this.context.systemOptions.ChangeOpportunityRate === 'True') {
        return true;
      }

      return false;
    },
    getMyExchangeRate: function getMyExchangeRate() {
      var results = {
        code: '',
        rate: 1
      };

      if (this.hasMultiCurrency() &amp;&amp; this.context &amp;&amp; this.context.exchangeRates &amp;&amp; this.context.userOptions &amp;&amp; this.context.userOptions['General:Currency']) {
        var myCode = this.context.userOptions['General:Currency'];
        var myRate = this.context.exchangeRates[myCode];
        _lang['default'].mixin(results, {
          code: myCode,
          rate: myRate
        });
      }

      return results;
    },
    getBaseExchangeRate: function getBaseExchangeRate() {
      var results = {
        code: '',
        rate: 1
      };

      if (this.hasMultiCurrency() &amp;&amp; this.context &amp;&amp; this.context.exchangeRates &amp;&amp; this.context.systemOptions &amp;&amp; this.context.systemOptions.BaseCurrency) {
        var baseCode = this.context.systemOptions.BaseCurrency;
        var baseRate = this.context.exchangeRates[baseCode];
        _lang['default'].mixin(results, {
          code: baseCode,
          rate: baseRate
        });
      }

      return results;
    },
    getCurrentOpportunityExchangeRate: function getCurrentOpportunityExchangeRate() {
      var results = {
        code: '',
        rate: 1
      };

      var found = this.queryNavigationContext(function (o) {
        return (/^(opportunities)$/.test(o.resourceKind) &amp;&amp; o.key
        );
      });

      found = found &amp;&amp; found.options;

      if (found) {
        var rate = found.ExchangeRate;
        var code = found.ExchangeRateCode;
        _lang['default'].mixin(results, {
          code: code,
          rate: rate
        });
      }

      return results;
    },
    run: function run() {
      this.inherited(arguments);

      if (this.isOnline() || !this.enableCaching) {
        this.handleAuthentication();
      } else {
        // todo: always navigate to home when offline? data may not be available for restored state.
        this.navigateToHomeView();
      }

      if (this.enableUpdateNotification) {
        this._checkForUpdate();
      }
    },
    onAuthenticateUserSuccess: function onAuthenticateUserSuccess(credentials, callback, scope, result) {
      var _this = this;

      var user = {
        '$key': _lang['default'].trim(result.response.userId),
        '$descriptor': result.response.prettyName,
        'UserName': result.response.userName
      };

      this.context.user = user;
      this.context.roles = result.response.roles;
      this.context.securedActions = result.response.securedActions;

      if (this.context.securedActions) {
        this.context.userSecurity = {};
        _array['default'].forEach(this.context.securedActions, function (item) {
          _this.context.userSecurity[item] = true;
        });
      } else {
        // downgrade server version as only 8.0 has `securedActions` as part of the
        // `getCurrentUser` response.
        this.serverVersion = {
          'major': 7,
          'minor': 5,
          'revision': 4
        };
      }

      if (credentials.remember) {
        try {
          if (window.localStorage) {
            window.localStorage.setItem('credentials', Base64.encode(_json['default'].stringify({
              username: credentials.username,
              password: credentials.password || ''
            })));
          }
        } catch (e) {} //eslint-disable-line
      }

      if (callback) {
        callback.call(scope || this, {
          user: user
        });
      }
    },
    onAuthenticateUserFailure: function onAuthenticateUserFailure(callback, scope, response) {
      var service = this.getService();
      if (service) {
        service.setUserName(false).setPassword(false);
      }

      if (callback) {
        callback.call(scope || this, {
          response: response
        });
      }
    },
    authenticateUser: function authenticateUser(credentials, options) {
      var service = this.getService().setUserName(credentials.username).setPassword(credentials.password || '');

      var request = new Sage.SData.Client.SDataServiceOperationRequest(service).setContractName('system').setOperationName('getCurrentUser');

      request.execute({}, {
        success: _lang['default'].hitch(this, this.onAuthenticateUserSuccess, credentials, options.success, options.scope), // this.onAuthenticateUserSuccess.createDelegate(this, [credentials, options.success, options.scope], true),
        failure: _lang['default'].hitch(this, this.onAuthenticateUserFailure, options.failure, options.scope), // this.onAuthenticateUserFailure.createDelegate(this, [options.failure, options.scope], true),
        aborted: _lang['default'].hitch(this, this.onAuthenticateUserFailure, options.failure, options.scope) });
    },
    // this.onAuthenticateUserFailure.createDelegate(this, [options.aborted, options.scope], true)
    hasAccessTo: function hasAccessTo(security) {
      if (!security) {
        return true;
      }

      var user = this.context.user;
      var userId = user &amp;&amp; user.$key;
      var userSecurity = this.context.userSecurity;

      if (/^ADMIN\s*/i.test(userId)) {
        return true;
      }

      if (typeof userSecurity === 'undefined') {
        return true; // running against a pre 8.0 SalesLogix environment
      }

      return !!userSecurity[security];
    },
    reload: function reload() {
      this.ReUI.disableLocationCheck();
      this.hash('');
      window.location.reload();
    },
    logOut: function logOut() {
      this.removeCredentials();
      this._clearNavigationState();

      var service = this.getService();
      this.isAuthenticated = false;
      this.context = {};

      if (service) {
        service.setUserName(false).setPassword(false);
      }

      var view = this.getView(this.logOffViewId);

      if (view) {
        view.show();
      }
    },
    getCredentials: function getCredentials() {
      var credentials = null;
      try {
        if (window.localStorage) {
          var stored = window.localStorage.getItem('credentials');
          var encoded = stored &amp;&amp; Base64.decode(stored);
          credentials = encoded &amp;&amp; _json['default'].parse(encoded);
        }
      } catch (e) {} //eslint-disable-line

      return credentials;
    },
    removeCredentials: function removeCredentials() {
      try {
        if (window.localStorage) {
          window.localStorage.removeItem('credentials');
        }
      } catch (e) {} //eslint-disable-line
    },
    isAuthenticated: false,
    hasState: false,
    handleAuthentication: function handleAuthentication() {
      var credentials = this.getCredentials();

      if (credentials) {
        this.setPrimaryTitle(this.authText);
        this.authenticateUser(credentials, {
          success: this.onHandleAuthenticationSuccess,
          failure: this.onHandleAuthenticationFailed,
          aborted: this.onHandleAuthenticationAborted,
          scope: this
        });
      } else {
        this.navigateToLoginView();
      }
    },
    onHandleAuthenticationSuccess: function onHandleAuthenticationSuccess() {
      var _this2 = this;

      this.isAuthenticated = true;
      this.setPrimaryTitle(this.loadingText);
      this.initAppState().then(function () {
        _this2.onInitAppStateSuccess();
      }, function (err) {
        _this2.onInitAppStateFailed(err);
      });
    },
    onHandleAuthenticationFailed: function onHandleAuthenticationFailed() {
      this.removeCredentials();
      this.navigateToLoginView();
    },
    onHandleAuthenticationAborted: function onHandleAuthenticationAborted() {
      this.navigateToLoginView();
    },
    onInitAppStateSuccess: function onInitAppStateSuccess() {
      var _this3 = this;

      this._saveDefaultPreferences();
      this.setDefaultMetricPreferences();
      if (this.enableOfflineSupport) {
        this.initOfflineData().then(function () {
          _this3.hasState = true;
          _this3.navigateToInitialView();
        }, function (error) {
          _this3.hasState = true;
          _this3.enableOfflineSupport = false;
          var message = resource.offlineInitErrorText;
          _ErrorManager['default'].addSimpleError(message, error);
          _ErrorManager['default'].showErrorDialog(null, message, function () {
            _this3.navigateToInitialView();
          });
        });
      } else {
        this.hasState = true;
        this.navigateToInitialView();
      }
    },
    onInitAppStateFailed: function onInitAppStateFailed(error) {
      var _this4 = this;

      var message = resource.appStateInitErrorText;
      _ErrorManager['default'].addSimpleError(message, error);
      _ErrorManager['default'].showErrorDialog(null, message, function () {
        _this4._clearNavigationState();
        _this4.removeCredentials();
        _this4.navigateToLoginView();
      });
    },
    _clearNavigationState: function _clearNavigationState() {
      try {
        this.initialNavigationState = null;

        if (window.localStorage) {
          window.localStorage.removeItem('navigationState');
        }
      } catch (e) {} //eslint-disable-line
    },
    _loadNavigationState: function _loadNavigationState() {
      try {
        if (window.localStorage) {
          this.navigationState = window.localStorage.getItem('navigationState');
        }
      } catch (e) {} // eslint-disable-line
    },
    _saveDefaultPreferences: function _saveDefaultPreferences() {
      if (this.preferences) {
        return;
      }

      var views = this.getDefaultViews();

      this.preferences = {
        home: {
          visible: views
        },
        configure: {
          order: views.slice(0)
        }
      };
    },
    getMetricsByResourceKind: function getMetricsByResourceKind(resourceKind) {
      var results = [];
      var prefs = this.preferences &amp;&amp; this.preferences.metrics &amp;&amp; this.preferences.metrics;

      if (prefs) {
        prefs = _array['default'].filter(prefs, function (item) {
          return item.resourceKind === resourceKind;
        });

        if (prefs.length === 1) {
          results = prefs[0].children;
        }
      }

      return results;
    },
    setDefaultMetricPreferences: function setDefaultMetricPreferences() {
      if (!this.preferences.metrics) {
        var defaults = new _DefaultMetrics2['default']();
        this.preferences.metrics = defaults.getDefinitions();
        this.persistPreferences();
      }
    },
    requestUserDetails: function requestUserDetails() {
      var request = new Sage.SData.Client.SDataSingleResourceRequest(this.getService()).setResourceKind('users').setResourceSelector(_string['default'].substitute('&quot;${0}&quot;', [this.context.user.$key])).setQueryArg('select', this.userDetailsQuerySelect.join(','));

      var def = new _Deferred['default']();

      request.read({
        success: function success(entry) {
          this.context.user = entry;
          this.context.defaultOwner = entry &amp;&amp; entry.DefaultOwner;
          def.resolve(entry);
        },
        failure: function failure() {
          def.reject();
        },
        scope: this
      });

      return def.promise;
    },
    requestUserOptions: function requestUserOptions() {
      var batch = new Sage.SData.Client.SDataBatchRequest(this.getService()).setContractName('system').setResourceKind('useroptions').setQueryArg('select', 'name,value').using(function using() {
        var service = this.getService();
        _array['default'].forEach(this.userOptionsToRequest, function forEach(item) {
          new Sage.SData.Client.SDataSingleResourceRequest(this).setContractName('system').setResourceKind('useroptions').setResourceSelector(_string['default'].substitute('&quot;${0}&quot;', [item])).read();
        }, service);
      }, this);

      var def = new _Deferred['default']();
      batch.commit({
        success: function success(feed) {
          var userOptions = this.context.userOptions = this.context.userOptions || {};

          _array['default'].forEach(feed &amp;&amp; feed.$resources, function (item) {
            var key = item &amp;&amp; item.$descriptor;
            var value = item &amp;&amp; item.value;

            if (value &amp;&amp; key) {
              userOptions[key] = value;
            }
          });

          var insertSecCode = userOptions['General:InsertSecCodeID'];
          var currentDefaultOwner = this.context.defaultOwner &amp;&amp; this.context.defaultOwner.$key;

          if (insertSecCode &amp;&amp; (!currentDefaultOwner || currentDefaultOwner !== insertSecCode)) {
            this.requestOwnerDescription(insertSecCode);
          }

          this.loadCustomizedMoment();
          def.resolve(feed);
        },
        failure: function failure(response, o) {
          def.reject();
          _ErrorManager['default'].addError(response, o, {}, 'failure');
        },
        scope: this
      });

      return def.promise;
    },
    /*
     * Loads a custom object to pass into the current moment language. The object for the language gets built in buildCustomizedMoment.
     */
    loadCustomizedMoment: function loadCustomizedMoment() {
      var custom = this.buildCustomizedMoment();
      var currentLang = moment.locale();

      moment.locale(currentLang, custom);
      this.moment = moment().locale(currentLang, custom);
    },
    /*
     * Builds an object that will get passed into moment.locale()
     */
    buildCustomizedMoment: function buildCustomizedMoment() {
      if (!this.context.userOptions) {
        return null;
      }

      var userWeekStartDay = parseInt(this.context.userOptions['Calendar:WeekStart'], 10);
      var results = {}; // 0-6, Sun-Sat

      if (!isNaN(userWeekStartDay)) {
        results = {
          week: {
            dow: userWeekStartDay
          }
        };
      }

      return results;
    },
    requestSystemOptions: function requestSystemOptions() {
      var request = new Sage.SData.Client.SDataResourceCollectionRequest(this.getService()).setContractName('system').setResourceKind('systemoptions').setQueryArg('select', 'name,value');

      var def = new _Deferred['default']();
      request.read({
        success: function succes(feed) {
          var _this5 = this;

          var systemOptions = this.context.systemOptions = this.context.systemOptions || {};

          _array['default'].forEach(feed &amp;&amp; feed.$resources, function (item) {
            var name = item.name;
            var value = item.value;

            if (value &amp;&amp; name &amp;&amp; _array['default'].indexOf(_this5.systemOptionsToRequest, name) &gt; -1) {
              systemOptions[name] = value;
            }
          }, this);

          var multiCurrency = systemOptions.MultiCurrency;

          if (multiCurrency &amp;&amp; multiCurrency === 'True') {
            this.requestExchangeRates().then(function () {
              def.resolve(feed);
            }, function () {
              def.reject();
            });
          } else {
            def.resolve(feed);
          }
        },
        failure: function failure(response, o) {
          _ErrorManager['default'].addError(response, o, {}, 'failure');
          def.reject();
        },
        scope: this
      });

      return def.promise;
    },
    requestExchangeRates: function requestExchangeRates() {
      var request = new Sage.SData.Client.SDataResourceCollectionRequest(this.getService()).setContractName('dynamic').setResourceKind('exchangeRates').setQueryArg('select', 'Rate');

      var def = new _Deferred['default']();
      request.read({
        success: function success(feed) {
          var exchangeRates = this.context.exchangeRates = this.context.exchangeRates || {};

          _array['default'].forEach(feed &amp;&amp; feed.$resources, function (item) {
            var key = item &amp;&amp; item.$descriptor;
            var value = item &amp;&amp; item.Rate;

            if (value &amp;&amp; key) {
              exchangeRates[key] = value;
            }
          });

          def.resolve(feed);
        },
        failure: function failure(response, o) {
          def.reject();
          _ErrorManager['default'].addError(response, o, {}, 'failure');
        },
        scope: this
      });

      return def.promise;
    },
    requestOwnerDescription: function requestOwnerDescription(key) {
      var request = new Sage.SData.Client.SDataSingleResourceRequest(this.getService()).setResourceKind('owners').setResourceSelector(_string['default'].substitute('&quot;${0}&quot;', [key])).setQueryArg('select', 'OwnerDescription');

      request.read({
        success: this.onRequestOwnerDescriptionSuccess,
        failure: this.onRequestOwnerDescriptionFailure,
        scope: this
      });
    },
    onRequestOwnerDescriptionSuccess: function onRequestOwnerDescriptionSuccess(entry) {
      if (entry) {
        this.context.defaultOwner = entry;
      }
    },
    onRequestOwnerDescriptionFailure: function onRequestOwnerDescriptionFailure(response, o) {
      _ErrorManager['default'].addError(response, o, {}, 'failure');
    },
    defaultViews: ['myday_list', 'calendar_view', 'history_list', 'account_list', 'contact_list', 'lead_list', 'opportunity_list', 'ticket_list', 'myattachment_list', 'recently_viewed_list', 'briefcase_list'],
    getDefaultViews: function getDefaultViews() {
      return this.defaultViews;
    },
    getExposedViews: function getExposedViews() {
      var _this6 = this;

      return Object.keys(this.views).filter(function (id) {
        var view = _this6.getView(id);
        return view &amp;&amp; view.id !== 'home' &amp;&amp; view.expose;
      });
    },
    cleanRestoredHistory: function cleanRestoredHistory(restoredHistory) {
      var result = [];
      var hasRoot = false;

      for (var i = restoredHistory.length - 1; i &gt;= 0 &amp;&amp; !hasRoot; i--) {
        if (restoredHistory[i].data.options &amp;&amp; restoredHistory[i].data.options.negateHistory) {
          result = [];
          continue;
        }

        if (this.hasView(restoredHistory[i].page)) {
          result.unshift(restoredHistory[i]);
        }

        hasRoot = restoredHistory[i].page === 'home';
      }

      return hasRoot &amp;&amp; result;
    },
    navigateToInitialView: function navigateToInitialView() {
      this.loadSnapper();

      try {
        var restoredState = this.navigationState;
        var restoredHistory = restoredState &amp;&amp; _json['default'].parse(restoredState);
        var cleanedHistory = this.cleanRestoredHistory(restoredHistory);

        this._clearNavigationState();

        if (cleanedHistory) {
          ReUI.context.transitioning = true;
          ReUI.context.history = ReUI.context.history.concat(cleanedHistory.slice(0, cleanedHistory.length - 1));

          for (var i = 0; i &lt; cleanedHistory.length - 1; i++) {
            window.location.hash = cleanedHistory[i].hash;
          }

          ReUI.context.transitioning = false;

          var last = cleanedHistory[cleanedHistory.length - 1];
          var view = this.getView(last.page);
          var options = last.data &amp;&amp; last.data.options;

          view.show(options);
        } else {
          this.navigateToHomeView();
        }
      } catch (e) {
        this._clearNavigationState();
        this.navigateToHomeView();
      }
    },
    setupRedirectHash: function setupRedirectHash() {
      if (this._hasValidRedirect()) {
        // Split by &quot;/redirectTo/&quot;
        var split = this.redirectHash.split(/\/redirectTo\//gi);
        if (split.length === 2) {
          this.redirectHash = split[1];
        }
      } else {
        this.redirectHash = '';
      }
    },
    onConnectionChange: function onConnectionChange(online) {
      var view = this.getView('left_drawer');
      if (!this.enableOfflineSupport) {
        return;
      }

      if (view) {
        view.refresh();
      }

      this.ReUI.resetHistory();
      if (online) {
        this.toast.add({ message: this.onlineText, title: this.connectionToastTitleText });
        if (this.context &amp;&amp; this.context.user) {
          this.navigateToInitialView();
        } else {
          this.navigateToLoginView();
        }
      } else {
        this.toast.add({ message: this.offlineText, title: this.connectionToastTitleText });
        this.navigateToInitialView();
      }

      this.setToolBarMode(online);
    },
    navigateToLoginView: function navigateToLoginView() {
      this.setupRedirectHash();

      var view = this.getView(this.loginViewId);
      if (view) {
        view.show();
      }
    },
    _hasValidRedirect: function _hasValidRedirect() {
      return this.redirectHash !== '' &amp;&amp; this.redirectHash.indexOf('/redirectTo/') &gt; 0;
    },
    showLeftDrawer: function showLeftDrawer() {
      var view = this.getView('left_drawer');
      if (view) {
        view.show();
      }
    },
    showRightDrawer: function showRightDrawer() {
      var view = this.getView('right_drawer');
      if (view) {
        view.show();
      }
    },
    navigateToHomeView: function navigateToHomeView() {
      this.setupRedirectHash();
      this.loadSnapper();

      var visible = this.preferences &amp;&amp; this.preferences.home &amp;&amp; this.preferences.home.visible;
      if (visible &amp;&amp; visible.length &gt; 0) {
        this.homeViewId = visible[0];
      }

      // Default view will be the home view, overwritten below if a redirect hash is supplied
      var view = this.getView(this.homeViewId);

      if (this.redirectHash) {
        var split = this.redirectHash.split(';');
        if (split.length &gt; 0) {
          var _split = _slicedToArray(split, 2);

          var viewId = _split[0];
          var key = _split[1];

          var redirectView = this.getView(viewId);
          if (redirectView) {
            view = redirectView;
            if (key) {
              redirectView.show({
                key: key
              });
            }
          }
        }
      }

      if (!this.isOnline()) {
        view = this.getView(this.offlineHomeViewId);
      }

      if (view) {
        view.show();
      }
    },
    navigateToActivityInsertView: function navigateToActivityInsertView() {
      var view = this.getView('activity_types_list');
      if (view) {
        view.show();
      }
    },
    initiateCall: function initiateCall() {
      // shortcut for environment call
      _environment['default'].initiateCall.apply(this, arguments);
    },
    initiateEmail: function initiateEmail() {
      // shortcut for environment call
      _environment['default'].initiateEmail.apply(this, arguments);
    },
    showMapForAddress: function showMapForAddress() {
      // shortcut for environment call
      _environment['default'].showMapForAddress.apply(this, arguments);
    },
    getVersionInfo: function getVersionInfo() {
      var info = _string['default'].substitute(this.versionInfoText, [this.mobileVersion.major, this.mobileVersion.minor, this.mobileVersion.revision, this.serverVersion.major]);
      return info;
    },
    initOfflineData: function initOfflineData() {
      var _this7 = this;

      var def = new _Deferred['default']();
      var model = this.ModelManager.getModel(_MODEL_NAMES['default'].AUTHENTICATION, _MODEL_TYPES['default'].OFFLINE);
      if (model) {
        (function () {
          var indicator = new _BusyIndicator['default']({
            id: 'busyIndicator__offlineData',
            label: resource.offlineInitDataText
          });
          _this7.modal.disableClose = true;
          _this7.modal.showToolbar = false;
          _this7.modal.add(indicator);
          indicator.start();

          model.initAuthentication(_this7.context.user.$key).then(function (result) {
            var options = _offlineManager['default'].getOptions();
            if (result.hasUserChanged) {
              options = {
                clearAll: true
              };
            }
            if (result.hasUserChanged || !result.hasAuthenticatedToday) {
              _offlineManager['default'].clearData(options).then(function () {
                model.updateEntry(result.entry);
                indicator.complete(true);
                _this7.modal.disableClose = false;
                _this7.modal.hide();
                def.resolve();
              }, function (err) {
                indicator.complete(true);
                _this7.modal.disableClose = false;
                _this7.modal.hide();
                def.reject(err);
              });
            } else {
              result.entry.ModifyDate = moment().toDate();
              model.updateEntry(result.entry);
              indicator.complete(true);
              _this7.modal.disableClose = false;
              _this7.modal.hide();
              def.resolve(); // Do nothing since this not the first time athuenticating.
            }
          }, function (err) {
            def.reject(err);
          });
        })();
      } else {
        def.resolve();
      }
      return def.promise;
    }
  });

  _lang['default'].setObject('Mobile.SalesLogix.Application', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,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QUNoQyxxQkFBSyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDbEIsaUJBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQzthQUNmO1dBQ0YsRUFBRSxVQUFDLEdBQUcsRUFBSztBQUNWLGVBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7V0FDakIsQ0FBQyxDQUFDOztPQUNKLE1BQU07QUFDTCxXQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7T0FDZjtBQUNELGFBQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQztLQUNwQjtHQUNGLENBQUMsQ0FBQzs7QUFFSCxtQkFBSyxTQUFTLENBQUMsK0JBQStCLEVBQUUsT0FBTyxDQUFDLENBQUM7bUJBQzFDLE9BQU8iLCJmaWxlIjoic3JjL0FwcGxpY2F0aW9uLmpzIiwic291cmNlUm9vdCI6InNyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWNsYXJlIGZyb20gJ2Rvam8vX2Jhc2UvZGVjbGFyZSc7XHJcbmltcG9ydCBhcnJheSBmcm9tICdkb2pvL19iYXNlL2FycmF5JztcclxuaW1wb3J0IGNvbm5lY3QgZnJvbSAnZG9qby9fYmFzZS9jb25uZWN0JztcclxuaW1wb3J0IGpzb24gZnJvbSAnZG9qby9qc29uJztcclxuaW1wb3J0IGxhbmcgZnJvbSAnZG9qby9fYmFzZS9sYW5nJztcclxuaW1wb3J0IGhhcyBmcm9tICdkb2pvL2hhcyc7XHJcbmltcG9ydCBzdHJpbmcgZnJvbSAnZG9qby9zdHJpbmcnO1xyXG5pbXBvcnQgRGVmZXJyZWQgZnJvbSAnZG9qby9EZWZlcnJlZCc7XHJcbmltcG9ydCBEZWZhdWx0TWV0cmljcyBmcm9tICcuL0RlZmF1bHRNZXRyaWNzJztcclxuaW1wb3J0IEVycm9yTWFuYWdlciBmcm9tICdhcmdvcy9FcnJvck1hbmFnZXInO1xyXG5pbXBvcnQgZW52aXJvbm1lbnQgZnJvbSAnLi9FbnZpcm9ubWVudCc7XHJcbmltcG9ydCBBcHBsaWNhdGlvbiBmcm9tICdhcmdvcy9BcHBsaWNhdGlvbic7XHJcbmltcG9ydCBvZmZsaW5lTWFuYWdlciBmcm9tICdhcmdvcy9PZmZsaW5lL01hbmFnZXInO1xyXG5pbXBvcnQgTU9ERUxfVFlQRVMgZnJvbSAnYXJnb3MvTW9kZWxzL1R5cGVzJztcclxuaW1wb3J0IE1PREVMX05BTUVTIGZyb20gJy4vTW9kZWxzL05hbWVzJztcclxuaW1wb3J0IEJ1c3lJbmRpY2F0b3IgZnJvbSAnYXJnb3MvRGlhbG9ncy9CdXN5SW5kaWNhdG9yJztcclxuaW1wb3J0IGdldFJlc291cmNlIGZyb20gJ2FyZ29zL0kxOG4nO1xyXG5pbXBvcnQgJ2Rvam8vc25pZmYnO1xyXG5cclxuXHJcbmNvbnN0IHJlc291cmNlID0gZ2V0UmVzb3VyY2UoJ2FwcGxpY2F0aW9uJyk7XHJcblxyXG4vKipcclxuICogQGNsYXNzIGNybS5BcHBsaWNhdGlvblxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBhcmdvcy5BcHBsaWNhdGlvblxyXG4gKiBAcmVxdWlyZXMgYXJnb3MuRXJyb3JNYW5hZ2VyXHJcbiAqIEByZXF1aXJlcyBjcm0uRW52aXJvbm1lbnRcclxuICogQHJlcXVpcmVzIG1vbWVudFxyXG4gKlxyXG4gKi9cclxuY29uc3QgX19jbGFzcyA9IGRlY2xhcmUoJ2NybS5BcHBsaWNhdGlvbicsIFtBcHBsaWNhdGlvbl0sIHtcclxuICBuYXZpZ2F0aW9uU3RhdGU6IG51bGwsXHJcbiAgcmVtZW1iZXJOYXZpZ2F0aW9uU3RhdGU6IHRydWUsXHJcbiAgZW5hYmxlVXBkYXRlTm90aWZpY2F0aW9uOiBmYWxzZSxcclxuICBtdWx0aUN1cnJlbmN5OiBmYWxzZSxcclxuICBlbmFibGVHcm91cHM6IHRydWUsXHJcbiAgZW5hYmxlSGFzaFRhZ3M6IHRydWUsXHJcbiAgZW5hYmxlT2ZmbGluZVN1cHBvcnQ6IGZhbHNlLFxyXG4gIHNwZWVkU2VhcmNoOiB7XHJcbiAgICBpbmNsdWRlU3RlbW1pbmc6IHRydWUsXHJcbiAgICBpbmNsdWRlUGhvbmljOiB0cnVlLFxyXG4gICAgaW5jbHVkZVRoZXNhdXJ1czogZmFsc2UsXHJcbiAgICB1c2VGcmVxdWVudEZpbHRlcjogZmFsc2UsXHJcbiAgICBzZWFyY2hUeXBlOiAxLFxyXG4gIH0sXHJcbiAgZW5hYmxlQ2FjaGluZzogdHJ1ZSxcclxuICB1c2VyRGV0YWlsc1F1ZXJ5U2VsZWN0OiBbJ1VzZXJOYW1lJywgJ1VzZXJJbmZvL1VzZXJOYW1lJywgJ1VzZXJJbmZvL0ZpcnN0TmFtZScsICdVc2VySW5mby9MYXN0TmFtZScsICdEZWZhdWx0T3duZXIvT3duZXJEZXNjcmlwdGlvbiddLFxyXG4gIHVzZXJPcHRpb25zVG9SZXF1ZXN0OiBbXHJcbiAgICAnRGVmYXVsdEdyb3VwO0FDQ09VTlQnLFxyXG4gICAgJ0RlZmF1bHRHcm91cDtDT05UQUNUJyxcclxuICAgICdEZWZhdWx0R3JvdXA7T1BQT1JUVU5JVFknLFxyXG4gICAgJ0RlZmF1bHRHcm91cDtMRUFEJyxcclxuICAgICdEZWZhdWx0R3JvdXA7VElDS0VUJyxcclxuICAgICdEZWZhdWx0R3JvdXA7U0FMRVNPUkRFUicsXHJcbiAgICAnRGVmYXVsdEdyb3VwO1FVT1RFJyxcclxuICAgICdHZW5lcmFsO0luc2VydFNlY0NvZGVJRCcsXHJcbiAgICAnR2VuZXJhbDtDdXJyZW5jeScsXHJcbiAgICAnQ2FsZW5kYXI7RGF5U3RhcnRUaW1lJyxcclxuICAgICdDYWxlbmRhcjtXZWVrU3RhcnQnLFxyXG4gICAgJ0FjdGl2aXR5TWVldGluZ09wdGlvbnM7QWxhcm1FbmFibGVkJyxcclxuICAgICdBY3Rpdml0eU1lZXRpbmdPcHRpb25zO0FsYXJtTGVhZCcsXHJcbiAgICAnQWN0aXZpdHlNZWV0aW5nT3B0aW9ucztEdXJhdGlvbicsXHJcbiAgICAnQWN0aXZpdHlQaG9uZU9wdGlvbnM7QWxhcm1FbmFibGVkJyxcclxuICAgICdBY3Rpdml0eVBob25lT3B0aW9ucztBbGFybUxlYWQnLFxyXG4gICAgJ0FjdGl2aXR5UGhvbmVPcHRpb25zO0R1cmF0aW9uJyxcclxuICAgICdBY3Rpdml0eVRvRG9PcHRpb25zO0FsYXJtRW5hYmxlZCcsXHJcbiAgICAnQWN0aXZpdHlUb0RvT3B0aW9ucztBbGFybUxlYWQnLFxyXG4gICAgJ0FjdGl2aXR5VG9Eb09wdGlvbnM7RHVyYXRpb24nLFxyXG4gICAgJ0FjdGl2aXR5UGVyc29uYWxPcHRpb25zO0FsYXJtRW5hYmxlZCcsXHJcbiAgICAnQWN0aXZpdHlQZXJzb25hbE9wdGlvbnM7QWxhcm1MZWFkJyxcclxuICAgICdBY3Rpdml0eVBlcnNvbmFsT3B0aW9ucztEdXJhdGlvbicsXHJcbiAgXSxcclxuICBzeXN0ZW1PcHRpb25zVG9SZXF1ZXN0OiBbXHJcbiAgICAnQmFzZUN1cnJlbmN5JyxcclxuICAgICdNdWx0aUN1cnJlbmN5JyxcclxuICAgICdDaGFuZ2VPcHBvcnR1bml0eVJhdGUnLFxyXG4gICAgJ0xvY2tPcHBvcnR1bml0eVJhdGUnLFxyXG4gIF0sXHJcbiAgYXBwTmFtZTogJ2FyZ29zLXNhbGVzbG9naXgnLFxyXG4gIHNlcnZlclZlcnNpb246IHtcclxuICAgICdtYWpvcic6IDgsXHJcbiAgICAnbWlub3InOiAwLFxyXG4gICAgJ3JldmlzaW9uJzogMCxcclxuICB9LFxyXG4gIG1vYmlsZVZlcnNpb246IHtcclxuICAgICdtYWpvcic6IDMsXHJcbiAgICAnbWlub3InOiA1LFxyXG4gICAgJ3JldmlzaW9uJzogMCxcclxuICB9LFxyXG4gIHZlcnNpb25JbmZvVGV4dDogcmVzb3VyY2UudmVyc2lvbkluZm9UZXh0LFxyXG4gIGxvYWRpbmdUZXh0OiByZXNvdXJjZS5sb2FkaW5nVGV4dCxcclxuICBhdXRoVGV4dDogcmVzb3VyY2UuYXV0aFRleHQsXHJcbiAgY29ubmVjdGlvblRvYXN0VGl0bGVUZXh0OiByZXNvdXJjZS5jb25uZWN0aW9uVG9hc3RUaXRsZVRleHQsXHJcbiAgb2ZmbGluZVRleHQ6IHJlc291cmNlLm9mZmxpbmVUZXh0LFxyXG4gIG9ubGluZVRleHQ6IHJlc291cmNlLm9ubGluZVRleHQsXHJcbiAgaG9tZVZpZXdJZDogJ215YWN0aXZpdHlfbGlzdCcsXHJcbiAgb2ZmbGluZUhvbWVWaWV3SWQ6ICdyZWNlbnRseV92aWV3ZWRfbGlzdCcsXHJcbiAgbG9naW5WaWV3SWQ6ICdsb2dpbicsXHJcbiAgbG9nT2ZmVmlld0lkOiAnbG9nb2ZmJyxcclxuXHJcbiAgVUlEOiBudWxsLFxyXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICBpZiAoaGFzKCdpZScpICYmIGhhcygnaWUnKSA8IDkpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAndW5zdXBwb3J0ZWQuaHRtbCc7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICAgIHRoaXMuX2xvYWROYXZpZ2F0aW9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLlVJRCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XHJcbiAgICBjb25zdCBvcmlnaW5hbCA9IFNhZ2UuU0RhdGEuQ2xpZW50LlNEYXRhU2VydmljZS5wcm90b3R5cGUuZXhlY3V0ZVJlcXVlc3Q7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIFNhZ2UuU0RhdGEuQ2xpZW50LlNEYXRhU2VydmljZS5wcm90b3R5cGUuZXhlY3V0ZVJlcXVlc3QgPSBmdW5jdGlvbiBleGVjdXRlUmVxdWVzdChyZXF1ZXN0KSB7XHJcbiAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignWC1BcHBsaWNhdGlvbi1OYW1lJywgc2VsZi5hcHBOYW1lKTtcclxuICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdYLUFwcGxpY2F0aW9uLVZlcnNpb24nLCBzdHJpbmcuc3Vic3RpdHV0ZSgnJHt2ZXJzaW9uLm1ham9yfS4ke3ZlcnNpb24ubWlub3J9LiR7dmVyc2lvbi5yZXZpc2lvbn07JHtpZH0nLCB7XHJcbiAgICAgICAgdmVyc2lvbjogc2VsZi5tb2JpbGVWZXJzaW9uLFxyXG4gICAgICAgIGlkOiBzZWxmLlVJRCxcclxuICAgICAgfSkpO1xyXG4gICAgICByZXR1cm4gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIH07XHJcbiAgfSxcclxuICBpbml0Q29ubmVjdHM6IGZ1bmN0aW9uIGluaXRDb25uZWN0cygpIHtcclxuICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcblxyXG4gICAgaWYgKHdpbmRvdy5hcHBsaWNhdGlvbkNhY2hlKSB7XHJcbiAgICAgIHRoaXMuX2Nvbm5lY3RzLnB1c2goY29ubmVjdC5jb25uZWN0KHdpbmRvdy5hcHBsaWNhdGlvbkNhY2hlLCAndXBkYXRlcmVhZHknLCB0aGlzLCB0aGlzLl9jaGVja0ZvclVwZGF0ZSkpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgaXNPbkZpcnN0VmlldzogZnVuY3Rpb24gaXNPbkZpcnN0VmlldygpIHtcclxuICAgIGNvbnN0IGhpc3RvcnkgPSBSZVVJLmNvbnRleHQuaGlzdG9yeTtcclxuICAgIGNvbnN0IGxlbmd0aCA9IGhpc3RvcnkubGVuZ3RoO1xyXG4gICAgY29uc3QgY3VycmVudCA9IGhpc3RvcnlbbGVuZ3RoIC0gMV07XHJcbiAgICBjb25zdCBwcmV2aW91cyA9IGhpc3RvcnlbbGVuZ3RoIC0gMl07XHJcbiAgICBsZXQgaXNGaXJzdFZpZXcgPSBmYWxzZTtcclxuXHJcbiAgICBpZiAoKGN1cnJlbnQgJiYgY3VycmVudC5wYWdlID09PSB0aGlzLmxvZ2luVmlld0lkKSB8fCAoY3VycmVudCAmJiBjdXJyZW50LnBhZ2UgPT09IHRoaXMubG9nT2ZmVmlld0lkKSkge1xyXG4gICAgICBpc0ZpcnN0VmlldyA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKHByZXZpb3VzICYmIHByZXZpb3VzLnBhZ2UgPT09IHRoaXMubG9naW5WaWV3SWQpIHtcclxuICAgICAgaXNGaXJzdFZpZXcgPSB0cnVlO1xyXG4gICAgfSBlbHNlIGlmIChsZW5ndGggPT09IDEpIHtcclxuICAgICAgaXNGaXJzdFZpZXcgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBpc0ZpcnN0VmlldztcclxuICB9LFxyXG4gIG9uU2V0T3JpZW50YXRpb246IGZ1bmN0aW9uIG9uU2V0T3JpZW50YXRpb24oKSB7XHJcbiAgICBpZiAodGhpcy5zbmFwcGVyKSB7XHJcbiAgICAgIHRoaXMuc25hcHBlci5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgX3ZpZXdUcmFuc2l0aW9uVG86IGZ1bmN0aW9uIF92aWV3VHJhbnNpdGlvblRvKCkge1xyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICAgIHRoaXMuX2NoZWNrU2F2ZU5hdmlnYXRpb25TdGF0ZSgpO1xyXG4gICAgaWYgKHRoaXMuc25hcHBlcikge1xyXG4gICAgICB0aGlzLnNuYXBwZXIuY2xvc2UoKTtcclxuICAgIH1cclxuICB9LFxyXG4gIF9jaGVja1NhdmVOYXZpZ2F0aW9uU3RhdGU6IGZ1bmN0aW9uIF9jaGVja1NhdmVOYXZpZ2F0aW9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5yZW1lbWJlck5hdmlnYXRpb25TdGF0ZSAhPT0gZmFsc2UpIHtcclxuICAgICAgdGhpcy5fc2F2ZU5hdmlnYXRpb25TdGF0ZSgpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgX2NoZWNrRm9yVXBkYXRlOiBmdW5jdGlvbiBfY2hlY2tGb3JVcGRhdGUoKSB7XHJcbiAgICBjb25zdCBhcHBsaWNhdGlvbkNhY2hlID0gd2luZG93LmFwcGxpY2F0aW9uQ2FjaGU7XHJcbiAgICBpZiAoYXBwbGljYXRpb25DYWNoZSAmJiB0aGlzLmVuYWJsZVVwZGF0ZU5vdGlmaWNhdGlvbikge1xyXG4gICAgICBpZiAoYXBwbGljYXRpb25DYWNoZS5zdGF0dXMgPT09IGFwcGxpY2F0aW9uQ2FjaGUuVVBEQVRFUkVBRFkpIHtcclxuICAgICAgICB0aGlzLl9ub3RpZnlVcGRhdGVBdmFpbGFibGUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgX25vdGlmeVVwZGF0ZUF2YWlsYWJsZTogZnVuY3Rpb24gX25vdGlmeVVwZGF0ZUF2YWlsYWJsZSgpIHtcclxuICAgIGlmICh0aGlzLmJhcnMudXBkYXRlYmFyKSB7XHJcbiAgICAgIHRoaXMuYmFycy51cGRhdGViYXIuc2hvdygpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgX3NhdmVOYXZpZ2F0aW9uU3RhdGU6IGZ1bmN0aW9uIF9zYXZlTmF2aWdhdGlvblN0YXRlKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ25hdmlnYXRpb25TdGF0ZScsIGpzb24uc3RyaW5naWZ5KFJlVUkuY29udGV4dC5oaXN0b3J5KSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcclxuICB9LFxyXG4gIGhhc011bHRpQ3VycmVuY3k6IGZ1bmN0aW9uIGhhc011bHRpQ3VycmVuY3koKSB7XHJcbiAgICAvLyBDaGVjayBpZiB0aGUgY29uZmlndXJhdGlvbiBzcGVjaWZpZWQgbXVsdGlDdXJyZW5jeSwgdGhpcyB3aWxsIG92ZXJyaWRlIHRoZSBkeW5hbWljIGNoZWNrLlxyXG4gICAgLy8gQSBjb25maWd1cmF0aW9uIGlzIG5vdCBpZGVhbCwgYW5kIHdlIHNob3VsZCByZWZhY3RvciB0aGUgZWRpdCB2aWV3IHRvIHByb2Nlc3MgdGhlIGxheW91dCB3aGVuIGl0IGZpcnN0IHJlY2lldmVzIGl0cyBkYXRhLFxyXG4gICAgLy8gaW5zdGVhZCBvZiBvbiBzdGFydHVwLiBXZSBjYW5ub3QgY2hlY2sgQXBwLmNvbnRleHQgZGF0YSB0aGF0IHdhcyBsb2FkZWQgYWZ0ZXIgbG9naW4gd2hlbiB0aGUgc3RhcnR1cCBtZXRob2QgaXMgdXNlZC5cclxuICAgIGlmICh0aGlzLm11bHRpQ3VycmVuY3kpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcbiAgY2FuTG9ja09wcG9ydHVuaXR5UmF0ZTogZnVuY3Rpb24gY2FuTG9ja09wcG9ydHVuaXR5UmF0ZSgpIHtcclxuICAgIGlmICh0aGlzLmNvbnRleHQgJiZcclxuICAgICAgdGhpcy5jb250ZXh0LnN5c3RlbU9wdGlvbnMgJiZcclxuICAgICAgdGhpcy5jb250ZXh0LnN5c3RlbU9wdGlvbnMuTG9ja09wcG9ydHVuaXR5UmF0ZSA9PT0gJ1RydWUnKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9LFxyXG4gIGNhbkNoYW5nZU9wcG9ydHVuaXR5UmF0ZTogZnVuY3Rpb24gY2FuQ2hhbmdlT3Bwb3J0dW5pdHlSYXRlKCkge1xyXG4gICAgaWYgKHRoaXMuY29udGV4dCAmJlxyXG4gICAgICB0aGlzLmNvbnRleHQuc3lzdGVtT3B0aW9ucyAmJlxyXG4gICAgICB0aGlzLmNvbnRleHQuc3lzdGVtT3B0aW9ucy5DaGFuZ2VPcHBvcnR1bml0eVJhdGUgPT09ICdUcnVlJykge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSxcclxuICBnZXRNeUV4Y2hhbmdlUmF0ZTogZnVuY3Rpb24gZ2V0TXlFeGNoYW5nZVJhdGUoKSB7XHJcbiAgICBjb25zdCByZXN1bHRzID0ge1xyXG4gICAgICBjb2RlOiAnJyxcclxuICAgICAgcmF0ZTogMSxcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHRoaXMuaGFzTXVsdGlDdXJyZW5jeSgpICYmXHJcbiAgICAgIHRoaXMuY29udGV4dCAmJlxyXG4gICAgICB0aGlzLmNvbnRleHQuZXhjaGFuZ2VSYXRlcyAmJlxyXG4gICAgICB0aGlzLmNvbnRleHQudXNlck9wdGlvbnMgJiZcclxuICAgICAgdGhpcy5jb250ZXh0LnVzZXJPcHRpb25zWydHZW5lcmFsOkN1cnJlbmN5J10pIHtcclxuICAgICAgY29uc3QgbXlDb2RlID0gdGhpcy5jb250ZXh0LnVzZXJPcHRpb25zWydHZW5lcmFsOkN1cnJlbmN5J107XHJcbiAgICAgIGNvbnN0IG15UmF0ZSA9IHRoaXMuY29udGV4dC5leGNoYW5nZVJhdGVzW215Q29kZV07XHJcbiAgICAgIGxhbmcubWl4aW4ocmVzdWx0cywge1xyXG4gICAgICAgIGNvZGU6IG15Q29kZSxcclxuICAgICAgICByYXRlOiBteVJhdGUsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG4gIH0sXHJcbiAgZ2V0QmFzZUV4Y2hhbmdlUmF0ZTogZnVuY3Rpb24gZ2V0QmFzZUV4Y2hhbmdlUmF0ZSgpIHtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSB7XHJcbiAgICAgIGNvZGU6ICcnLFxyXG4gICAgICByYXRlOiAxLFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAodGhpcy5oYXNNdWx0aUN1cnJlbmN5KCkgJiZcclxuICAgICAgdGhpcy5jb250ZXh0ICYmXHJcbiAgICAgIHRoaXMuY29udGV4dC5leGNoYW5nZVJhdGVzICYmXHJcbiAgICAgIHRoaXMuY29udGV4dC5zeXN0ZW1PcHRpb25zICYmXHJcbiAgICAgIHRoaXMuY29udGV4dC5zeXN0ZW1PcHRpb25zLkJhc2VDdXJyZW5jeSkge1xyXG4gICAgICBjb25zdCBiYXNlQ29kZSA9IHRoaXMuY29udGV4dC5zeXN0ZW1PcHRpb25zLkJhc2VDdXJyZW5jeTtcclxuICAgICAgY29uc3QgYmFzZVJhdGUgPSB0aGlzLmNvbnRleHQuZXhjaGFuZ2VSYXRlc1tiYXNlQ29kZV07XHJcbiAgICAgIGxhbmcubWl4aW4ocmVzdWx0cywge1xyXG4gICAgICAgIGNvZGU6IGJhc2VDb2RlLFxyXG4gICAgICAgIHJhdGU6IGJhc2VSYXRlLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0cztcclxuICB9LFxyXG4gIGdldEN1cnJlbnRPcHBvcnR1bml0eUV4Y2hhbmdlUmF0ZTogZnVuY3Rpb24gZ2V0Q3VycmVudE9wcG9ydHVuaXR5RXhjaGFuZ2VSYXRlKCkge1xyXG4gICAgY29uc3QgcmVzdWx0cyA9IHtcclxuICAgICAgY29kZTogJycsXHJcbiAgICAgIHJhdGU6IDEsXHJcbiAgICB9O1xyXG5cclxuICAgIGxldCBmb3VuZCA9IHRoaXMucXVlcnlOYXZpZ2F0aW9uQ29udGV4dCgobykgPT4ge1xyXG4gICAgICByZXR1cm4gKC9eKG9wcG9ydHVuaXRpZXMpJC8pLnRlc3Qoby5yZXNvdXJjZUtpbmQpICYmIG8ua2V5O1xyXG4gICAgfSk7XHJcblxyXG4gICAgZm91bmQgPSBmb3VuZCAmJiBmb3VuZC5vcHRpb25zO1xyXG5cclxuICAgIGlmIChmb3VuZCkge1xyXG4gICAgICBjb25zdCByYXRlID0gZm91bmQuRXhjaGFuZ2VSYXRlO1xyXG4gICAgICBjb25zdCBjb2RlID0gZm91bmQuRXhjaGFuZ2VSYXRlQ29kZTtcclxuICAgICAgbGFuZy5taXhpbihyZXN1bHRzLCB7XHJcbiAgICAgICAgY29kZTogY29kZSxcclxuICAgICAgICByYXRlOiByYXRlLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0cztcclxuICB9LFxyXG4gIHJ1bjogZnVuY3Rpb24gcnVuKCkge1xyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuXHJcbiAgICBpZiAodGhpcy5pc09ubGluZSgpIHx8ICF0aGlzLmVuYWJsZUNhY2hpbmcpIHtcclxuICAgICAgdGhpcy5oYW5kbGVBdXRoZW50aWNhdGlvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gdG9kbzogYWx3YXlzIG5hdmlnYXRlIHRvIGhvbWUgd2hlbiBvZmZsaW5lPyBkYXRhIG1heSBub3QgYmUgYXZhaWxhYmxlIGZvciByZXN0b3JlZCBzdGF0ZS5cclxuICAgICAgdGhpcy5uYXZpZ2F0ZVRvSG9tZVZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5lbmFibGVVcGRhdGVOb3RpZmljYXRpb24pIHtcclxuICAgICAgdGhpcy5fY2hlY2tGb3JVcGRhdGUoKTtcclxuICAgIH1cclxuICB9LFxyXG4gIG9uQXV0aGVudGljYXRlVXNlclN1Y2Nlc3M6IGZ1bmN0aW9uIG9uQXV0aGVudGljYXRlVXNlclN1Y2Nlc3MoY3JlZGVudGlhbHMsIGNhbGxiYWNrLCBzY29wZSwgcmVzdWx0KSB7XHJcbiAgICBjb25zdCB1c2VyID0ge1xyXG4gICAgICAnJGtleSc6IGxhbmcudHJpbShyZXN1bHQucmVzcG9uc2UudXNlcklkKSxcclxuICAgICAgJyRkZXNjcmlwdG9yJzogcmVzdWx0LnJlc3BvbnNlLnByZXR0eU5hbWUsXHJcbiAgICAgICdVc2VyTmFtZSc6IHJlc3VsdC5yZXNwb25zZS51c2VyTmFtZSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5jb250ZXh0LnVzZXIgPSB1c2VyO1xyXG4gICAgdGhpcy5jb250ZXh0LnJvbGVzID0gcmVzdWx0LnJlc3BvbnNlLnJvbGVzO1xyXG4gICAgdGhpcy5jb250ZXh0LnNlY3VyZWRBY3Rpb25zID0gcmVzdWx0LnJlc3BvbnNlLnNlY3VyZWRBY3Rpb25zO1xyXG5cclxuICAgIGlmICh0aGlzLmNvbnRleHQuc2VjdXJlZEFjdGlvbnMpIHtcclxuICAgICAgdGhpcy5jb250ZXh0LnVzZXJTZWN1cml0eSA9IHt9O1xyXG4gICAgICBhcnJheS5mb3JFYWNoKHRoaXMuY29udGV4dC5zZWN1cmVkQWN0aW9ucywgKGl0ZW0pID0+IHtcclxuICAgICAgICB0aGlzLmNvbnRleHQudXNlclNlY3VyaXR5W2l0ZW1dID0gdHJ1ZTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBkb3duZ3JhZGUgc2VydmVyIHZlcnNpb24gYXMgb25seSA4LjAgaGFzIGBzZWN1cmVkQWN0aW9uc2AgYXMgcGFydCBvZiB0aGVcclxuICAgICAgLy8gYGdldEN1cnJlbnRVc2VyYCByZXNwb25zZS5cclxuICAgICAgdGhpcy5zZXJ2ZXJWZXJzaW9uID0ge1xyXG4gICAgICAgICdtYWpvcic6IDcsXHJcbiAgICAgICAgJ21pbm9yJzogNSxcclxuICAgICAgICAncmV2aXNpb24nOiA0LFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjcmVkZW50aWFscy5yZW1lbWJlcikge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NyZWRlbnRpYWxzJywgQmFzZTY0LmVuY29kZShqc29uLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIHVzZXJuYW1lOiBjcmVkZW50aWFscy51c2VybmFtZSxcclxuICAgICAgICAgICAgcGFzc3dvcmQ6IGNyZWRlbnRpYWxzLnBhc3N3b3JkIHx8ICcnLFxyXG4gICAgICAgICAgfSkpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHt9IC8vZXNsaW50LWRpc2FibGUtbGluZVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICBjYWxsYmFjay5jYWxsKHNjb3BlIHx8IHRoaXMsIHtcclxuICAgICAgICB1c2VyOiB1c2VyLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LFxyXG4gIG9uQXV0aGVudGljYXRlVXNlckZhaWx1cmU6IGZ1bmN0aW9uIG9uQXV0aGVudGljYXRlVXNlckZhaWx1cmUoY2FsbGJhY2ssIHNjb3BlLCByZXNwb25zZSkge1xyXG4gICAgY29uc3Qgc2VydmljZSA9IHRoaXMuZ2V0U2VydmljZSgpO1xyXG4gICAgaWYgKHNlcnZpY2UpIHtcclxuICAgICAgc2VydmljZVxyXG4gICAgICAgIC5zZXRVc2VyTmFtZShmYWxzZSlcclxuICAgICAgICAuc2V0UGFzc3dvcmQoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICBjYWxsYmFjay5jYWxsKHNjb3BlIHx8IHRoaXMsIHtcclxuICAgICAgICByZXNwb25zZTogcmVzcG9uc2UsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgYXV0aGVudGljYXRlVXNlcjogZnVuY3Rpb24gYXV0aGVudGljYXRlVXNlcihjcmVkZW50aWFscywgb3B0aW9ucykge1xyXG4gICAgY29uc3Qgc2VydmljZSA9IHRoaXMuZ2V0U2VydmljZSgpXHJcbiAgICAgIC5zZXRVc2VyTmFtZShjcmVkZW50aWFscy51c2VybmFtZSlcclxuICAgICAgLnNldFBhc3N3b3JkKGNyZWRlbnRpYWxzLnBhc3N3b3JkIHx8ICcnKTtcclxuXHJcbiAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFNhZ2UuU0RhdGEuQ2xpZW50LlNEYXRhU2VydmljZU9wZXJhdGlvblJlcXVlc3Qoc2VydmljZSlcclxuICAgICAgLnNldENvbnRyYWN0TmFtZSgnc3lzdGVtJylcclxuICAgICAgLnNldE9wZXJhdGlvbk5hbWUoJ2dldEN1cnJlbnRVc2VyJyk7XHJcblxyXG4gICAgcmVxdWVzdC5leGVjdXRlKHt9LCB7XHJcbiAgICAgIHN1Y2Nlc3M6IGxhbmcuaGl0Y2godGhpcywgdGhpcy5vbkF1dGhlbnRpY2F0ZVVzZXJTdWNjZXNzLCBjcmVkZW50aWFscywgb3B0aW9ucy5zdWNjZXNzLCBvcHRpb25zLnNjb3BlKSwgLy8gdGhpcy5vbkF1dGhlbnRpY2F0ZVVzZXJTdWNjZXNzLmNyZWF0ZURlbGVnYXRlKHRoaXMsIFtjcmVkZW50aWFscywgb3B0aW9ucy5zdWNjZXNzLCBvcHRpb25zLnNjb3BlXSwgdHJ1ZSksXHJcbiAgICAgIGZhaWx1cmU6IGxhbmcuaGl0Y2godGhpcywgdGhpcy5vbkF1dGhlbnRpY2F0ZVVzZXJGYWlsdXJlLCBvcHRpb25zLmZhaWx1cmUsIG9wdGlvbnMuc2NvcGUpLCAvLyB0aGlzLm9uQXV0aGVudGljYXRlVXNlckZhaWx1cmUuY3JlYXRlRGVsZWdhdGUodGhpcywgW29wdGlvbnMuZmFpbHVyZSwgb3B0aW9ucy5zY29wZV0sIHRydWUpLFxyXG4gICAgICBhYm9ydGVkOiBsYW5nLmhpdGNoKHRoaXMsIHRoaXMub25BdXRoZW50aWNhdGVVc2VyRmFpbHVyZSwgb3B0aW9ucy5mYWlsdXJlLCBvcHRpb25zLnNjb3BlKSwgLy8gdGhpcy5vbkF1dGhlbnRpY2F0ZVVzZXJGYWlsdXJlLmNyZWF0ZURlbGVnYXRlKHRoaXMsIFtvcHRpb25zLmFib3J0ZWQsIG9wdGlvbnMuc2NvcGVdLCB0cnVlKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuICBoYXNBY2Nlc3NUbzogZnVuY3Rpb24gaGFzQWNjZXNzVG8oc2VjdXJpdHkpIHtcclxuICAgIGlmICghc2VjdXJpdHkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXNlciA9IHRoaXMuY29udGV4dC51c2VyO1xyXG4gICAgY29uc3QgdXNlcklkID0gdXNlciAmJiB1c2VyLiRrZXk7XHJcbiAgICBjb25zdCB1c2VyU2VjdXJpdHkgPSB0aGlzLmNvbnRleHQudXNlclNlY3VyaXR5O1xyXG5cclxuICAgIGlmICgvXkFETUlOXFxzKi9pLnRlc3QodXNlcklkKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIHVzZXJTZWN1cml0eSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgcmV0dXJuIHRydWU7IC8vIHJ1bm5pbmcgYWdhaW5zdCBhIHByZSA4LjAgU2FsZXNMb2dpeCBlbnZpcm9ubWVudFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAhIXVzZXJTZWN1cml0eVtzZWN1cml0eV07XHJcbiAgfSxcclxuICByZWxvYWQ6IGZ1bmN0aW9uIHJlbG9hZCgpIHtcclxuICAgIHRoaXMuUmVVSS5kaXNhYmxlTG9jYXRpb25DaGVjaygpO1xyXG4gICAgdGhpcy5oYXNoKCcnKTtcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICB9LFxyXG4gIGxvZ091dDogZnVuY3Rpb24gbG9nT3V0KCkge1xyXG4gICAgdGhpcy5yZW1vdmVDcmVkZW50aWFscygpO1xyXG4gICAgdGhpcy5fY2xlYXJOYXZpZ2F0aW9uU3RhdGUoKTtcclxuXHJcbiAgICBjb25zdCBzZXJ2aWNlID0gdGhpcy5nZXRTZXJ2aWNlKCk7XHJcbiAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5jb250ZXh0ID0ge307XHJcblxyXG4gICAgaWYgKHNlcnZpY2UpIHtcclxuICAgICAgc2VydmljZVxyXG4gICAgICAgIC5zZXRVc2VyTmFtZShmYWxzZSlcclxuICAgICAgICAuc2V0UGFzc3dvcmQoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldFZpZXcodGhpcy5sb2dPZmZWaWV3SWQpO1xyXG5cclxuICAgIGlmICh2aWV3KSB7XHJcbiAgICAgIHZpZXcuc2hvdygpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgZ2V0Q3JlZGVudGlhbHM6IGZ1bmN0aW9uIGdldENyZWRlbnRpYWxzKCkge1xyXG4gICAgbGV0IGNyZWRlbnRpYWxzID0gbnVsbDtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmVkID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjcmVkZW50aWFscycpO1xyXG4gICAgICAgIGNvbnN0IGVuY29kZWQgPSBzdG9yZWQgJiYgQmFzZTY0LmRlY29kZShzdG9yZWQpO1xyXG4gICAgICAgIGNyZWRlbnRpYWxzID0gZW5jb2RlZCAmJiBqc29uLnBhcnNlKGVuY29kZWQpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7fSAvL2VzbGludC1kaXNhYmxlLWxpbmVcclxuXHJcbiAgICByZXR1cm4gY3JlZGVudGlhbHM7XHJcbiAgfSxcclxuICByZW1vdmVDcmVkZW50aWFsczogZnVuY3Rpb24gcmVtb3ZlQ3JlZGVudGlhbHMoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnY3JlZGVudGlhbHMnKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge30gLy9lc2xpbnQtZGlzYWJsZS1saW5lXHJcbiAgfSxcclxuICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gIGhhc1N0YXRlOiBmYWxzZSxcclxuICBoYW5kbGVBdXRoZW50aWNhdGlvbjogZnVuY3Rpb24gaGFuZGxlQXV0aGVudGljYXRpb24oKSB7XHJcbiAgICBjb25zdCBjcmVkZW50aWFscyA9IHRoaXMuZ2V0Q3JlZGVudGlhbHMoKTtcclxuXHJcbiAgICBpZiAoY3JlZGVudGlhbHMpIHtcclxuICAgICAgdGhpcy5zZXRQcmltYXJ5VGl0bGUodGhpcy5hdXRoVGV4dCk7XHJcbiAgICAgIHRoaXMuYXV0aGVudGljYXRlVXNlcihjcmVkZW50aWFscywge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRoaXMub25IYW5kbGVBdXRoZW50aWNhdGlvblN1Y2Nlc3MsXHJcbiAgICAgICAgZmFpbHVyZTogdGhpcy5vbkhhbmRsZUF1dGhlbnRpY2F0aW9uRmFpbGVkLFxyXG4gICAgICAgIGFib3J0ZWQ6IHRoaXMub25IYW5kbGVBdXRoZW50aWNhdGlvbkFib3J0ZWQsXHJcbiAgICAgICAgc2NvcGU6IHRoaXMsXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5uYXZpZ2F0ZVRvTG9naW5WaWV3KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBvbkhhbmRsZUF1dGhlbnRpY2F0aW9uU3VjY2VzczogZnVuY3Rpb24gb25IYW5kbGVBdXRoZW50aWNhdGlvblN1Y2Nlc3MoKSB7XHJcbiAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IHRydWU7XHJcbiAgICB0aGlzLnNldFByaW1hcnlUaXRsZSh0aGlzLmxvYWRpbmdUZXh0KTtcclxuICAgIHRoaXMuaW5pdEFwcFN0YXRlKCkudGhlbigoKT0+IHtcclxuICAgICAgdGhpcy5vbkluaXRBcHBTdGF0ZVN1Y2Nlc3MoKTtcclxuICAgIH0sIChlcnIpPT4ge1xyXG4gICAgICB0aGlzLm9uSW5pdEFwcFN0YXRlRmFpbGVkKGVycik7XHJcbiAgICB9KTtcclxuICB9LFxyXG4gIG9uSGFuZGxlQXV0aGVudGljYXRpb25GYWlsZWQ6IGZ1bmN0aW9uIG9uSGFuZGxlQXV0aGVudGljYXRpb25GYWlsZWQoKSB7XHJcbiAgICB0aGlzLnJlbW92ZUNyZWRlbnRpYWxzKCk7XHJcbiAgICB0aGlzLm5hdmlnYXRlVG9Mb2dpblZpZXcoKTtcclxuICB9LFxyXG4gIG9uSGFuZGxlQXV0aGVudGljYXRpb25BYm9ydGVkOiBmdW5jdGlvbiBvbkhhbmRsZUF1dGhlbnRpY2F0aW9uQWJvcnRlZCgpIHtcclxuICAgIHRoaXMubmF2aWdhdGVUb0xvZ2luVmlldygpO1xyXG4gIH0sXHJcbiAgb25Jbml0QXBwU3RhdGVTdWNjZXNzOiBmdW5jdGlvbiBvbkluaXRBcHBTdGF0ZVN1Y2Nlc3MoKSB7XHJcbiAgICB0aGlzLl9zYXZlRGVmYXVsdFByZWZlcmVuY2VzKCk7XHJcbiAgICB0aGlzLnNldERlZmF1bHRNZXRyaWNQcmVmZXJlbmNlcygpO1xyXG4gICAgaWYgKHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQpIHtcclxuICAgICAgdGhpcy5pbml0T2ZmbGluZURhdGEoKS50aGVuKCgpID0+IHtcclxuICAgICAgICB0aGlzLmhhc1N0YXRlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLm5hdmlnYXRlVG9Jbml0aWFsVmlldygpO1xyXG4gICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICB0aGlzLmhhc1N0YXRlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmVuYWJsZU9mZmxpbmVTdXBwb3J0ID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHJlc291cmNlLm9mZmxpbmVJbml0RXJyb3JUZXh0O1xyXG4gICAgICAgIEVycm9yTWFuYWdlci5hZGRTaW1wbGVFcnJvcihtZXNzYWdlLCBlcnJvcik7XHJcbiAgICAgICAgRXJyb3JNYW5hZ2VyLnNob3dFcnJvckRpYWxvZyhudWxsLCBtZXNzYWdlLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLm5hdmlnYXRlVG9Jbml0aWFsVmlldygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaGFzU3RhdGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLm5hdmlnYXRlVG9Jbml0aWFsVmlldygpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgb25Jbml0QXBwU3RhdGVGYWlsZWQ6IGZ1bmN0aW9uIG9uSW5pdEFwcFN0YXRlRmFpbGVkKGVycm9yKSB7XHJcbiAgICBjb25zdCBtZXNzYWdlID0gcmVzb3VyY2UuYXBwU3RhdGVJbml0RXJyb3JUZXh0O1xyXG4gICAgRXJyb3JNYW5hZ2VyLmFkZFNpbXBsZUVycm9yKG1lc3NhZ2UsIGVycm9yKTtcclxuICAgIEVycm9yTWFuYWdlci5zaG93RXJyb3JEaWFsb2cobnVsbCwgbWVzc2FnZSwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9jbGVhck5hdmlnYXRpb25TdGF0ZSgpO1xyXG4gICAgICB0aGlzLnJlbW92ZUNyZWRlbnRpYWxzKCk7XHJcbiAgICAgIHRoaXMubmF2aWdhdGVUb0xvZ2luVmlldygpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuICBfY2xlYXJOYXZpZ2F0aW9uU3RhdGU6IGZ1bmN0aW9uIF9jbGVhck5hdmlnYXRpb25TdGF0ZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuaW5pdGlhbE5hdmlnYXRpb25TdGF0ZSA9IG51bGw7XHJcblxyXG4gICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbmF2aWdhdGlvblN0YXRlJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHt9IC8vZXNsaW50LWRpc2FibGUtbGluZVxyXG4gIH0sXHJcbiAgX2xvYWROYXZpZ2F0aW9uU3RhdGU6IGZ1bmN0aW9uIF9sb2FkTmF2aWdhdGlvblN0YXRlKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICB0aGlzLm5hdmlnYXRpb25TdGF0ZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbmF2aWdhdGlvblN0YXRlJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcclxuICB9LFxyXG4gIF9zYXZlRGVmYXVsdFByZWZlcmVuY2VzOiBmdW5jdGlvbiBfc2F2ZURlZmF1bHRQcmVmZXJlbmNlcygpIHtcclxuICAgIGlmICh0aGlzLnByZWZlcmVuY2VzKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB2aWV3cyA9IHRoaXMuZ2V0RGVmYXVsdFZpZXdzKCk7XHJcblxyXG4gICAgdGhpcy5wcmVmZXJlbmNlcyA9IHtcclxuICAgICAgaG9tZToge1xyXG4gICAgICAgIHZpc2libGU6IHZpZXdzLFxyXG4gICAgICB9LFxyXG4gICAgICBjb25maWd1cmU6IHtcclxuICAgICAgICBvcmRlcjogdmlld3Muc2xpY2UoMCksXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH0sXHJcbiAgZ2V0TWV0cmljc0J5UmVzb3VyY2VLaW5kOiBmdW5jdGlvbiBnZXRNZXRyaWNzQnlSZXNvdXJjZUtpbmQocmVzb3VyY2VLaW5kKSB7XHJcbiAgICBsZXQgcmVzdWx0cyA9IFtdO1xyXG4gICAgbGV0IHByZWZzID0gdGhpcy5wcmVmZXJlbmNlcyAmJiB0aGlzLnByZWZlcmVuY2VzLm1ldHJpY3MgJiYgdGhpcy5wcmVmZXJlbmNlcy5tZXRyaWNzO1xyXG5cclxuICAgIGlmIChwcmVmcykge1xyXG4gICAgICBwcmVmcyA9IGFycmF5LmZpbHRlcihwcmVmcywgKGl0ZW0pID0+IHtcclxuICAgICAgICByZXR1cm4gaXRlbS5yZXNvdXJjZUtpbmQgPT09IHJlc291cmNlS2luZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAocHJlZnMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgcmVzdWx0cyA9IHByZWZzWzBdLmNoaWxkcmVuO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSxcclxuICBzZXREZWZhdWx0TWV0cmljUHJlZmVyZW5jZXM6IGZ1bmN0aW9uIHNldERlZmF1bHRNZXRyaWNQcmVmZXJlbmNlcygpIHtcclxuICAgIGlmICghdGhpcy5wcmVmZXJlbmNlcy5tZXRyaWNzKSB7XHJcbiAgICAgIGNvbnN0IGRlZmF1bHRzID0gbmV3IERlZmF1bHRNZXRyaWNzKCk7XHJcbiAgICAgIHRoaXMucHJlZmVyZW5jZXMubWV0cmljcyA9IGRlZmF1bHRzLmdldERlZmluaXRpb25zKCk7XHJcbiAgICAgIHRoaXMucGVyc2lzdFByZWZlcmVuY2VzKCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICByZXF1ZXN0VXNlckRldGFpbHM6IGZ1bmN0aW9uIHJlcXVlc3RVc2VyRGV0YWlscygpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgU2FnZS5TRGF0YS5DbGllbnQuU0RhdGFTaW5nbGVSZXNvdXJjZVJlcXVlc3QodGhpcy5nZXRTZXJ2aWNlKCkpXHJcbiAgICAgIC5zZXRSZXNvdXJjZUtpbmQoJ3VzZXJzJylcclxuICAgICAgLnNldFJlc291cmNlU2VsZWN0b3Ioc3RyaW5nLnN1YnN0aXR1dGUoJ1wiJHswfVwiJywgW3RoaXMuY29udGV4dC51c2VyLiRrZXldKSlcclxuICAgICAgLnNldFF1ZXJ5QXJnKCdzZWxlY3QnLCB0aGlzLnVzZXJEZXRhaWxzUXVlcnlTZWxlY3Quam9pbignLCcpKTtcclxuXHJcbiAgICBjb25zdCBkZWYgPSBuZXcgRGVmZXJyZWQoKTtcclxuXHJcbiAgICByZXF1ZXN0LnJlYWQoe1xyXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGVudHJ5KSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LnVzZXIgPSBlbnRyeTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuZGVmYXVsdE93bmVyID0gZW50cnkgJiYgZW50cnkuRGVmYXVsdE93bmVyO1xyXG4gICAgICAgIGRlZi5yZXNvbHZlKGVudHJ5KTtcclxuICAgICAgfSxcclxuICAgICAgZmFpbHVyZTogZnVuY3Rpb24gZmFpbHVyZSgpIHtcclxuICAgICAgICBkZWYucmVqZWN0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNjb3BlOiB0aGlzLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gIH0sXHJcbiAgcmVxdWVzdFVzZXJPcHRpb25zOiBmdW5jdGlvbiByZXF1ZXN0VXNlck9wdGlvbnMoKSB7XHJcbiAgICBjb25zdCBiYXRjaCA9IG5ldyBTYWdlLlNEYXRhLkNsaWVudC5TRGF0YUJhdGNoUmVxdWVzdCh0aGlzLmdldFNlcnZpY2UoKSlcclxuICAgICAgLnNldENvbnRyYWN0TmFtZSgnc3lzdGVtJylcclxuICAgICAgLnNldFJlc291cmNlS2luZCgndXNlcm9wdGlvbnMnKVxyXG4gICAgICAuc2V0UXVlcnlBcmcoJ3NlbGVjdCcsICduYW1lLHZhbHVlJylcclxuICAgICAgLnVzaW5nKGZ1bmN0aW9uIHVzaW5nKCkge1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSB0aGlzLmdldFNlcnZpY2UoKTtcclxuICAgICAgICBhcnJheS5mb3JFYWNoKHRoaXMudXNlck9wdGlvbnNUb1JlcXVlc3QsIGZ1bmN0aW9uIGZvckVhY2goaXRlbSkge1xyXG4gICAgICAgICAgbmV3IFNhZ2UuU0RhdGEuQ2xpZW50LlNEYXRhU2luZ2xlUmVzb3VyY2VSZXF1ZXN0KHRoaXMpXHJcbiAgICAgICAgICAgIC5zZXRDb250cmFjdE5hbWUoJ3N5c3RlbScpXHJcbiAgICAgICAgICAgIC5zZXRSZXNvdXJjZUtpbmQoJ3VzZXJvcHRpb25zJylcclxuICAgICAgICAgICAgLnNldFJlc291cmNlU2VsZWN0b3Ioc3RyaW5nLnN1YnN0aXR1dGUoJ1wiJHswfVwiJywgW2l0ZW1dKSlcclxuICAgICAgICAgICAgLnJlYWQoKTtcclxuICAgICAgICB9LCBzZXJ2aWNlKTtcclxuICAgICAgfSwgdGhpcyk7XHJcblxyXG4gICAgY29uc3QgZGVmID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICBiYXRjaC5jb21taXQoe1xyXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGZlZWQpIHtcclxuICAgICAgICBjb25zdCB1c2VyT3B0aW9ucyA9IHRoaXMuY29udGV4dC51c2VyT3B0aW9ucyA9IHRoaXMuY29udGV4dC51c2VyT3B0aW9ucyB8fCB7fTtcclxuXHJcbiAgICAgICAgYXJyYXkuZm9yRWFjaChmZWVkICYmIGZlZWQuJHJlc291cmNlcywgKGl0ZW0pID0+IHtcclxuICAgICAgICAgIGNvbnN0IGtleSA9IGl0ZW0gJiYgaXRlbS4kZGVzY3JpcHRvcjtcclxuICAgICAgICAgIGNvbnN0IHZhbHVlID0gaXRlbSAmJiBpdGVtLnZhbHVlO1xyXG5cclxuICAgICAgICAgIGlmICh2YWx1ZSAmJiBrZXkpIHtcclxuICAgICAgICAgICAgdXNlck9wdGlvbnNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBpbnNlcnRTZWNDb2RlID0gdXNlck9wdGlvbnNbJ0dlbmVyYWw6SW5zZXJ0U2VjQ29kZUlEJ107XHJcbiAgICAgICAgY29uc3QgY3VycmVudERlZmF1bHRPd25lciA9IHRoaXMuY29udGV4dC5kZWZhdWx0T3duZXIgJiYgdGhpcy5jb250ZXh0LmRlZmF1bHRPd25lci4ka2V5O1xyXG5cclxuICAgICAgICBpZiAoaW5zZXJ0U2VjQ29kZSAmJiAoIWN1cnJlbnREZWZhdWx0T3duZXIgfHwgKGN1cnJlbnREZWZhdWx0T3duZXIgIT09IGluc2VydFNlY0NvZGUpKSkge1xyXG4gICAgICAgICAgdGhpcy5yZXF1ZXN0T3duZXJEZXNjcmlwdGlvbihpbnNlcnRTZWNDb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubG9hZEN1c3RvbWl6ZWRNb21lbnQoKTtcclxuICAgICAgICBkZWYucmVzb2x2ZShmZWVkKTtcclxuICAgICAgfSxcclxuICAgICAgZmFpbHVyZTogZnVuY3Rpb24gZmFpbHVyZShyZXNwb25zZSwgbykge1xyXG4gICAgICAgIGRlZi5yZWplY3QoKTtcclxuICAgICAgICBFcnJvck1hbmFnZXIuYWRkRXJyb3IocmVzcG9uc2UsIG8sIHt9LCAnZmFpbHVyZScpO1xyXG4gICAgICB9LFxyXG4gICAgICBzY29wZTogdGhpcyxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICB9LFxyXG4gIC8qXHJcbiAgICogTG9hZHMgYSBjdXN0b20gb2JqZWN0IHRvIHBhc3MgaW50byB0aGUgY3VycmVudCBtb21lbnQgbGFuZ3VhZ2UuIFRoZSBvYmplY3QgZm9yIHRoZSBsYW5ndWFnZSBnZXRzIGJ1aWx0IGluIGJ1aWxkQ3VzdG9taXplZE1vbWVudC5cclxuICAgKi9cclxuICBsb2FkQ3VzdG9taXplZE1vbWVudDogZnVuY3Rpb24gbG9hZEN1c3RvbWl6ZWRNb21lbnQoKSB7XHJcbiAgICBjb25zdCBjdXN0b20gPSB0aGlzLmJ1aWxkQ3VzdG9taXplZE1vbWVudCgpO1xyXG4gICAgY29uc3QgY3VycmVudExhbmcgPSBtb21lbnQubG9jYWxlKCk7XHJcblxyXG4gICAgbW9tZW50LmxvY2FsZShjdXJyZW50TGFuZywgY3VzdG9tKTtcclxuICAgIHRoaXMubW9tZW50ID0gbW9tZW50KCkubG9jYWxlKGN1cnJlbnRMYW5nLCBjdXN0b20pO1xyXG4gIH0sXHJcbiAgLypcclxuICAgKiBCdWlsZHMgYW4gb2JqZWN0IHRoYXQgd2lsbCBnZXQgcGFzc2VkIGludG8gbW9tZW50LmxvY2FsZSgpXHJcbiAgICovXHJcbiAgYnVpbGRDdXN0b21pemVkTW9tZW50OiBmdW5jdGlvbiBidWlsZEN1c3RvbWl6ZWRNb21lbnQoKSB7XHJcbiAgICBpZiAoIXRoaXMuY29udGV4dC51c2VyT3B0aW9ucykge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1c2VyV2Vla1N0YXJ0RGF5ID0gcGFyc2VJbnQodGhpcy5jb250ZXh0LnVzZXJPcHRpb25zWydDYWxlbmRhcjpXZWVrU3RhcnQnXSwgMTApO1xyXG4gICAgbGV0IHJlc3VsdHMgPSB7fTsgLy8gMC02LCBTdW4tU2F0XHJcblxyXG4gICAgaWYgKCFpc05hTih1c2VyV2Vla1N0YXJ0RGF5KSkge1xyXG4gICAgICByZXN1bHRzID0ge1xyXG4gICAgICAgIHdlZWs6IHtcclxuICAgICAgICAgIGRvdzogdXNlcldlZWtTdGFydERheSxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG4gIH0sXHJcbiAgcmVxdWVzdFN5c3RlbU9wdGlvbnM6IGZ1bmN0aW9uIHJlcXVlc3RTeXN0ZW1PcHRpb25zKCkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBTYWdlLlNEYXRhLkNsaWVudC5TRGF0YVJlc291cmNlQ29sbGVjdGlvblJlcXVlc3QodGhpcy5nZXRTZXJ2aWNlKCkpXHJcbiAgICAgIC5zZXRDb250cmFjdE5hbWUoJ3N5c3RlbScpXHJcbiAgICAgIC5zZXRSZXNvdXJjZUtpbmQoJ3N5c3RlbW9wdGlvbnMnKVxyXG4gICAgICAuc2V0UXVlcnlBcmcoJ3NlbGVjdCcsICduYW1lLHZhbHVlJyk7XHJcblxyXG4gICAgY29uc3QgZGVmID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICByZXF1ZXN0LnJlYWQoe1xyXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXMoZmVlZCkge1xyXG4gICAgICAgIGNvbnN0IHN5c3RlbU9wdGlvbnMgPSB0aGlzLmNvbnRleHQuc3lzdGVtT3B0aW9ucyA9IHRoaXMuY29udGV4dC5zeXN0ZW1PcHRpb25zIHx8IHt9O1xyXG5cclxuICAgICAgICBhcnJheS5mb3JFYWNoKGZlZWQgJiYgZmVlZC4kcmVzb3VyY2VzLCAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeyBuYW1lLCB2YWx1ZSB9ID0gaXRlbTtcclxuICAgICAgICAgIGlmICh2YWx1ZSAmJiBuYW1lICYmIGFycmF5LmluZGV4T2YodGhpcy5zeXN0ZW1PcHRpb25zVG9SZXF1ZXN0LCBuYW1lKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIHN5c3RlbU9wdGlvbnNbbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzKTtcclxuXHJcbiAgICAgICAgY29uc3QgbXVsdGlDdXJyZW5jeSA9IHN5c3RlbU9wdGlvbnMuTXVsdGlDdXJyZW5jeTtcclxuXHJcbiAgICAgICAgaWYgKG11bHRpQ3VycmVuY3kgJiYgbXVsdGlDdXJyZW5jeSA9PT0gJ1RydWUnKSB7XHJcbiAgICAgICAgICB0aGlzLnJlcXVlc3RFeGNoYW5nZVJhdGVzKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlZi5yZXNvbHZlKGZlZWQpO1xyXG4gICAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICBkZWYucmVqZWN0KCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZGVmLnJlc29sdmUoZmVlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBmYWlsdXJlOiBmdW5jdGlvbiBmYWlsdXJlKHJlc3BvbnNlLCBvKSB7XHJcbiAgICAgICAgRXJyb3JNYW5hZ2VyLmFkZEVycm9yKHJlc3BvbnNlLCBvLCB7fSwgJ2ZhaWx1cmUnKTtcclxuICAgICAgICBkZWYucmVqZWN0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNjb3BlOiB0aGlzLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gIH0sXHJcbiAgcmVxdWVzdEV4Y2hhbmdlUmF0ZXM6IGZ1bmN0aW9uIHJlcXVlc3RFeGNoYW5nZVJhdGVzKCkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBTYWdlLlNEYXRhLkNsaWVudC5TRGF0YVJlc291cmNlQ29sbGVjdGlvblJlcXVlc3QodGhpcy5nZXRTZXJ2aWNlKCkpXHJcbiAgICAgIC5zZXRDb250cmFjdE5hbWUoJ2R5bmFtaWMnKVxyXG4gICAgICAuc2V0UmVzb3VyY2VLaW5kKCdleGNoYW5nZVJhdGVzJylcclxuICAgICAgLnNldFF1ZXJ5QXJnKCdzZWxlY3QnLCAnUmF0ZScpO1xyXG5cclxuICAgIGNvbnN0IGRlZiA9IG5ldyBEZWZlcnJlZCgpO1xyXG4gICAgcmVxdWVzdC5yZWFkKHtcclxuICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhmZWVkKSB7XHJcbiAgICAgICAgY29uc3QgZXhjaGFuZ2VSYXRlcyA9IHRoaXMuY29udGV4dC5leGNoYW5nZVJhdGVzID0gdGhpcy5jb250ZXh0LmV4Y2hhbmdlUmF0ZXMgfHwge307XHJcblxyXG4gICAgICAgIGFycmF5LmZvckVhY2goZmVlZCAmJiBmZWVkLiRyZXNvdXJjZXMsIChpdGVtKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBrZXkgPSBpdGVtICYmIGl0ZW0uJGRlc2NyaXB0b3I7XHJcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW0gJiYgaXRlbS5SYXRlO1xyXG5cclxuICAgICAgICAgIGlmICh2YWx1ZSAmJiBrZXkpIHtcclxuICAgICAgICAgICAgZXhjaGFuZ2VSYXRlc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRlZi5yZXNvbHZlKGZlZWQpO1xyXG4gICAgICB9LFxyXG4gICAgICBmYWlsdXJlOiBmdW5jdGlvbiBmYWlsdXJlKHJlc3BvbnNlLCBvKSB7XHJcbiAgICAgICAgZGVmLnJlamVjdCgpO1xyXG4gICAgICAgIEVycm9yTWFuYWdlci5hZGRFcnJvcihyZXNwb25zZSwgbywge30sICdmYWlsdXJlJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNjb3BlOiB0aGlzLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gIH0sXHJcbiAgcmVxdWVzdE93bmVyRGVzY3JpcHRpb246IGZ1bmN0aW9uIHJlcXVlc3RPd25lckRlc2NyaXB0aW9uKGtleSkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBTYWdlLlNEYXRhLkNsaWVudC5TRGF0YVNpbmdsZVJlc291cmNlUmVxdWVzdCh0aGlzLmdldFNlcnZpY2UoKSlcclxuICAgICAgLnNldFJlc291cmNlS2luZCgnb3duZXJzJylcclxuICAgICAgLnNldFJlc291cmNlU2VsZWN0b3Ioc3RyaW5nLnN1YnN0aXR1dGUoJ1wiJHswfVwiJywgW2tleV0pKVxyXG4gICAgICAuc2V0UXVlcnlBcmcoJ3NlbGVjdCcsICdPd25lckRlc2NyaXB0aW9uJyk7XHJcblxyXG4gICAgcmVxdWVzdC5yZWFkKHtcclxuICAgICAgc3VjY2VzczogdGhpcy5vblJlcXVlc3RPd25lckRlc2NyaXB0aW9uU3VjY2VzcyxcclxuICAgICAgZmFpbHVyZTogdGhpcy5vblJlcXVlc3RPd25lckRlc2NyaXB0aW9uRmFpbHVyZSxcclxuICAgICAgc2NvcGU6IHRoaXMsXHJcbiAgICB9KTtcclxuICB9LFxyXG4gIG9uUmVxdWVzdE93bmVyRGVzY3JpcHRpb25TdWNjZXNzOiBmdW5jdGlvbiBvblJlcXVlc3RPd25lckRlc2NyaXB0aW9uU3VjY2VzcyhlbnRyeSkge1xyXG4gICAgaWYgKGVudHJ5KSB7XHJcbiAgICAgIHRoaXMuY29udGV4dC5kZWZhdWx0T3duZXIgPSBlbnRyeTtcclxuICAgIH1cclxuICB9LFxyXG4gIG9uUmVxdWVzdE93bmVyRGVzY3JpcHRpb25GYWlsdXJlOiBmdW5jdGlvbiBvblJlcXVlc3RPd25lckRlc2NyaXB0aW9uRmFpbHVyZShyZXNwb25zZSwgbykge1xyXG4gICAgRXJyb3JNYW5hZ2VyLmFkZEVycm9yKHJlc3BvbnNlLCBvLCB7fSwgJ2ZhaWx1cmUnKTtcclxuICB9LFxyXG4gIGRlZmF1bHRWaWV3czogW1xyXG4gICAgJ215ZGF5X2xpc3QnLFxyXG4gICAgJ2NhbGVuZGFyX3ZpZXcnLFxyXG4gICAgJ2hpc3RvcnlfbGlzdCcsXHJcbiAgICAnYWNjb3VudF9saXN0JyxcclxuICAgICdjb250YWN0X2xpc3QnLFxyXG4gICAgJ2xlYWRfbGlzdCcsXHJcbiAgICAnb3Bwb3J0dW5pdHlfbGlzdCcsXHJcbiAgICAndGlja2V0X2xpc3QnLFxyXG4gICAgJ215YXR0YWNobWVudF9saXN0JyxcclxuICAgICdyZWNlbnRseV92aWV3ZWRfbGlzdCcsXHJcbiAgICAnYnJpZWZjYXNlX2xpc3QnLFxyXG4gIF0sXHJcbiAgZ2V0RGVmYXVsdFZpZXdzOiBmdW5jdGlvbiBnZXREZWZhdWx0Vmlld3MoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kZWZhdWx0Vmlld3M7XHJcbiAgfSxcclxuICBnZXRFeHBvc2VkVmlld3M6IGZ1bmN0aW9uIGdldEV4cG9zZWRWaWV3cygpIHtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnZpZXdzKS5maWx0ZXIoKGlkKSA9PiB7XHJcbiAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldFZpZXcoaWQpO1xyXG4gICAgICByZXR1cm4gdmlldyAmJiB2aWV3LmlkICE9PSAnaG9tZScgJiYgdmlldy5leHBvc2U7XHJcbiAgICB9KTtcclxuICB9LFxyXG4gIGNsZWFuUmVzdG9yZWRIaXN0b3J5OiBmdW5jdGlvbiBjbGVhblJlc3RvcmVkSGlzdG9yeShyZXN0b3JlZEhpc3RvcnkpIHtcclxuICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgIGxldCBoYXNSb290ID0gZmFsc2U7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IHJlc3RvcmVkSGlzdG9yeS5sZW5ndGggLSAxOyBpID49IDAgJiYgIWhhc1Jvb3Q7IGktLSkge1xyXG4gICAgICBpZiAocmVzdG9yZWRIaXN0b3J5W2ldLmRhdGEub3B0aW9ucyAmJiByZXN0b3JlZEhpc3RvcnlbaV0uZGF0YS5vcHRpb25zLm5lZ2F0ZUhpc3RvcnkpIHtcclxuICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHRoaXMuaGFzVmlldyhyZXN0b3JlZEhpc3RvcnlbaV0ucGFnZSkpIHtcclxuICAgICAgICByZXN1bHQudW5zaGlmdChyZXN0b3JlZEhpc3RvcnlbaV0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBoYXNSb290ID0gKHJlc3RvcmVkSGlzdG9yeVtpXS5wYWdlID09PSAnaG9tZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBoYXNSb290ICYmIHJlc3VsdDtcclxuICB9LFxyXG4gIG5hdmlnYXRlVG9Jbml0aWFsVmlldzogZnVuY3Rpb24gbmF2aWdhdGVUb0luaXRpYWxWaWV3KCkge1xyXG4gICAgdGhpcy5sb2FkU25hcHBlcigpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3RvcmVkU3RhdGUgPSB0aGlzLm5hdmlnYXRpb25TdGF0ZTtcclxuICAgICAgY29uc3QgcmVzdG9yZWRIaXN0b3J5ID0gcmVzdG9yZWRTdGF0ZSAmJiBqc29uLnBhcnNlKHJlc3RvcmVkU3RhdGUpO1xyXG4gICAgICBjb25zdCBjbGVhbmVkSGlzdG9yeSA9IHRoaXMuY2xlYW5SZXN0b3JlZEhpc3RvcnkocmVzdG9yZWRIaXN0b3J5KTtcclxuXHJcbiAgICAgIHRoaXMuX2NsZWFyTmF2aWdhdGlvblN0YXRlKCk7XHJcblxyXG4gICAgICBpZiAoY2xlYW5lZEhpc3RvcnkpIHtcclxuICAgICAgICBSZVVJLmNvbnRleHQudHJhbnNpdGlvbmluZyA9IHRydWU7XHJcbiAgICAgICAgUmVVSS5jb250ZXh0Lmhpc3RvcnkgPSBSZVVJLmNvbnRleHQuaGlzdG9yeS5jb25jYXQoY2xlYW5lZEhpc3Rvcnkuc2xpY2UoMCwgY2xlYW5lZEhpc3RvcnkubGVuZ3RoIC0gMSkpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNsZWFuZWRIaXN0b3J5Lmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBjbGVhbmVkSGlzdG9yeVtpXS5oYXNoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgUmVVSS5jb250ZXh0LnRyYW5zaXRpb25pbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgY29uc3QgbGFzdCA9IGNsZWFuZWRIaXN0b3J5W2NsZWFuZWRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xyXG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldFZpZXcobGFzdC5wYWdlKTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gbGFzdC5kYXRhICYmIGxhc3QuZGF0YS5vcHRpb25zO1xyXG5cclxuICAgICAgICB2aWV3LnNob3cob3B0aW9ucyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvSG9tZVZpZXcoKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICB0aGlzLl9jbGVhck5hdmlnYXRpb25TdGF0ZSgpO1xyXG4gICAgICB0aGlzLm5hdmlnYXRlVG9Ib21lVmlldygpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgc2V0dXBSZWRpcmVjdEhhc2g6IGZ1bmN0aW9uIHNldHVwUmVkaXJlY3RIYXNoKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc1ZhbGlkUmVkaXJlY3QoKSkge1xyXG4gICAgICAvLyBTcGxpdCBieSBcIi9yZWRpcmVjdFRvL1wiXHJcbiAgICAgIGNvbnN0IHNwbGl0ID0gdGhpcy5yZWRpcmVjdEhhc2guc3BsaXQoL1xcL3JlZGlyZWN0VG9cXC8vZ2kpO1xyXG4gICAgICBpZiAoc3BsaXQubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgdGhpcy5yZWRpcmVjdEhhc2ggPSBzcGxpdFsxXTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZWRpcmVjdEhhc2ggPSAnJztcclxuICAgIH1cclxuICB9LFxyXG4gIG9uQ29ubmVjdGlvbkNoYW5nZTogZnVuY3Rpb24gb25Db25uZWN0aW9uQ2hhbmdlKG9ubGluZSkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0VmlldygnbGVmdF9kcmF3ZXInKTtcclxuICAgIGlmICghdGhpcy5lbmFibGVPZmZsaW5lU3VwcG9ydCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZpZXcpIHtcclxuICAgICAgdmlldy5yZWZyZXNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5SZVVJLnJlc2V0SGlzdG9yeSgpO1xyXG4gICAgaWYgKG9ubGluZSkge1xyXG4gICAgICB0aGlzLnRvYXN0LmFkZCh7IG1lc3NhZ2U6IHRoaXMub25saW5lVGV4dCwgdGl0bGU6IHRoaXMuY29ubmVjdGlvblRvYXN0VGl0bGVUZXh0IH0pO1xyXG4gICAgICBpZiAodGhpcy5jb250ZXh0ICYmIHRoaXMuY29udGV4dC51c2VyKSB7XHJcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvSW5pdGlhbFZpZXcoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm5hdmlnYXRlVG9Mb2dpblZpZXcoKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy50b2FzdC5hZGQoeyBtZXNzYWdlOiB0aGlzLm9mZmxpbmVUZXh0LCB0aXRsZTogdGhpcy5jb25uZWN0aW9uVG9hc3RUaXRsZVRleHQgfSk7XHJcbiAgICAgIHRoaXMubmF2aWdhdGVUb0luaXRpYWxWaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zZXRUb29sQmFyTW9kZShvbmxpbmUpO1xyXG4gIH0sXHJcbiAgbmF2aWdhdGVUb0xvZ2luVmlldzogZnVuY3Rpb24gbmF2aWdhdGVUb0xvZ2luVmlldygpIHtcclxuICAgIHRoaXMuc2V0dXBSZWRpcmVjdEhhc2goKTtcclxuXHJcbiAgICBjb25zdCB2aWV3ID0gdGhpcy5nZXRWaWV3KHRoaXMubG9naW5WaWV3SWQpO1xyXG4gICAgaWYgKHZpZXcpIHtcclxuICAgICAgdmlldy5zaG93KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBfaGFzVmFsaWRSZWRpcmVjdDogZnVuY3Rpb24gX2hhc1ZhbGlkUmVkaXJlY3QoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZWRpcmVjdEhhc2ggIT09ICcnICYmIHRoaXMucmVkaXJlY3RIYXNoLmluZGV4T2YoJy9yZWRpcmVjdFRvLycpID4gMDtcclxuICB9LFxyXG4gIHNob3dMZWZ0RHJhd2VyOiBmdW5jdGlvbiBzaG93TGVmdERyYXdlcigpIHtcclxuICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldFZpZXcoJ2xlZnRfZHJhd2VyJyk7XHJcbiAgICBpZiAodmlldykge1xyXG4gICAgICB2aWV3LnNob3coKTtcclxuICAgIH1cclxuICB9LFxyXG4gIHNob3dSaWdodERyYXdlcjogZnVuY3Rpb24gc2hvd1JpZ2h0RHJhd2VyKCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0VmlldygncmlnaHRfZHJhd2VyJyk7XHJcbiAgICBpZiAodmlldykge1xyXG4gICAgICB2aWV3LnNob3coKTtcclxuICAgIH1cclxuICB9LFxyXG4gIG5hdmlnYXRlVG9Ib21lVmlldzogZnVuY3Rpb24gbmF2aWdhdGVUb0hvbWVWaWV3KCkge1xyXG4gICAgdGhpcy5zZXR1cFJlZGlyZWN0SGFzaCgpO1xyXG4gICAgdGhpcy5sb2FkU25hcHBlcigpO1xyXG5cclxuICAgIGNvbnN0IHZpc2libGUgPSB0aGlzLnByZWZlcmVuY2VzICYmIHRoaXMucHJlZmVyZW5jZXMuaG9tZSAmJiB0aGlzLnByZWZlcmVuY2VzLmhvbWUudmlzaWJsZTtcclxuICAgIGlmICh2aXNpYmxlICYmIHZpc2libGUubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLmhvbWVWaWV3SWQgPSB2aXNpYmxlWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERlZmF1bHQgdmlldyB3aWxsIGJlIHRoZSBob21lIHZpZXcsIG92ZXJ3cml0dGVuIGJlbG93IGlmIGEgcmVkaXJlY3QgaGFzaCBpcyBzdXBwbGllZFxyXG4gICAgbGV0IHZpZXcgPSB0aGlzLmdldFZpZXcodGhpcy5ob21lVmlld0lkKTtcclxuXHJcbiAgICBpZiAodGhpcy5yZWRpcmVjdEhhc2gpIHtcclxuICAgICAgY29uc3Qgc3BsaXQgPSB0aGlzLnJlZGlyZWN0SGFzaC5zcGxpdCgnOycpO1xyXG4gICAgICBpZiAoc3BsaXQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IFt2aWV3SWQsIGtleV0gPSBzcGxpdDtcclxuICAgICAgICBjb25zdCByZWRpcmVjdFZpZXcgPSB0aGlzLmdldFZpZXcodmlld0lkKTtcclxuICAgICAgICBpZiAocmVkaXJlY3RWaWV3KSB7XHJcbiAgICAgICAgICB2aWV3ID0gcmVkaXJlY3RWaWV3O1xyXG4gICAgICAgICAgaWYgKGtleSkge1xyXG4gICAgICAgICAgICByZWRpcmVjdFZpZXcuc2hvdyh7XHJcbiAgICAgICAgICAgICAga2V5OiBrZXksXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghdGhpcy5pc09ubGluZSgpKSB7XHJcbiAgICAgIHZpZXcgPSB0aGlzLmdldFZpZXcodGhpcy5vZmZsaW5lSG9tZVZpZXdJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZpZXcpIHtcclxuICAgICAgdmlldy5zaG93KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBuYXZpZ2F0ZVRvQWN0aXZpdHlJbnNlcnRWaWV3OiBmdW5jdGlvbiBuYXZpZ2F0ZVRvQWN0aXZpdHlJbnNlcnRWaWV3KCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0VmlldygnYWN0aXZpdHlfdHlwZXNfbGlzdCcpO1xyXG4gICAgaWYgKHZpZXcpIHtcclxuICAgICAgdmlldy5zaG93KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBpbml0aWF0ZUNhbGw6IGZ1bmN0aW9uIGluaXRpYXRlQ2FsbCgpIHtcclxuICAgIC8vIHNob3J0Y3V0IGZvciBlbnZpcm9ubWVudCBjYWxsXHJcbiAgICBlbnZpcm9ubWVudC5pbml0aWF0ZUNhbGwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICB9LFxyXG4gIGluaXRpYXRlRW1haWw6IGZ1bmN0aW9uIGluaXRpYXRlRW1haWwoKSB7XHJcbiAgICAvLyBzaG9ydGN1dCBmb3IgZW52aXJvbm1lbnQgY2FsbFxyXG4gICAgZW52aXJvbm1lbnQuaW5pdGlhdGVFbWFpbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gIH0sXHJcbiAgc2hvd01hcEZvckFkZHJlc3M6IGZ1bmN0aW9uIHNob3dNYXBGb3JBZGRyZXNzKCkge1xyXG4gICAgLy8gc2hvcnRjdXQgZm9yIGVudmlyb25tZW50IGNhbGxcclxuICAgIGVudmlyb25tZW50LnNob3dNYXBGb3JBZGRyZXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgfSxcclxuICBnZXRWZXJzaW9uSW5mbzogZnVuY3Rpb24gZ2V0VmVyc2lvbkluZm8oKSB7XHJcbiAgICBjb25zdCBpbmZvID0gc3RyaW5nLnN1YnN0aXR1dGUodGhpcy52ZXJzaW9uSW5mb1RleHQsIFtcclxuICAgICAgdGhpcy5tb2JpbGVWZXJzaW9uLm1ham9yLFxyXG4gICAgICB0aGlzLm1vYmlsZVZlcnNpb24ubWlub3IsXHJcbiAgICAgIHRoaXMubW9iaWxlVmVyc2lvbi5yZXZpc2lvbixcclxuICAgICAgdGhpcy5zZXJ2ZXJWZXJzaW9uLm1ham9yLFxyXG4gICAgXSk7XHJcbiAgICByZXR1cm4gaW5mbztcclxuICB9LFxyXG4gIGluaXRPZmZsaW5lRGF0YTogZnVuY3Rpb24gaW5pdE9mZmxpbmVEYXRhKCkge1xyXG4gICAgY29uc3QgZGVmID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMuTW9kZWxNYW5hZ2VyLmdldE1vZGVsKE1PREVMX05BTUVTLkFVVEhFTlRJQ0FUSU9OLCBNT0RFTF9UWVBFUy5PRkZMSU5FKTtcclxuICAgIGlmIChtb2RlbCkge1xyXG4gICAgICBjb25zdCBpbmRpY2F0b3IgPSBuZXcgQnVzeUluZGljYXRvcih7XHJcbiAgICAgICAgaWQ6ICdidXN5SW5kaWNhdG9yX19vZmZsaW5lRGF0YScsXHJcbiAgICAgICAgbGFiZWw6IHJlc291cmNlLm9mZmxpbmVJbml0RGF0YVRleHQsXHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLm1vZGFsLmRpc2FibGVDbG9zZSA9IHRydWU7XHJcbiAgICAgIHRoaXMubW9kYWwuc2hvd1Rvb2xiYXIgPSBmYWxzZTtcclxuICAgICAgdGhpcy5tb2RhbC5hZGQoaW5kaWNhdG9yKTtcclxuICAgICAgaW5kaWNhdG9yLnN0YXJ0KCk7XHJcblxyXG4gICAgICBtb2RlbC5pbml0QXV0aGVudGljYXRpb24odGhpcy5jb250ZXh0LnVzZXIuJGtleSkudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgbGV0IG9wdGlvbnMgPSBvZmZsaW5lTWFuYWdlci5nZXRPcHRpb25zKCk7XHJcbiAgICAgICAgaWYgKHJlc3VsdC5oYXNVc2VyQ2hhbmdlZCkge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgY2xlYXJBbGw6IHRydWUsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVzdWx0Lmhhc1VzZXJDaGFuZ2VkIHx8ICghcmVzdWx0Lmhhc0F1dGhlbnRpY2F0ZWRUb2RheSkpIHtcclxuICAgICAgICAgIG9mZmxpbmVNYW5hZ2VyLmNsZWFyRGF0YShvcHRpb25zKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgbW9kZWwudXBkYXRlRW50cnkocmVzdWx0LmVudHJ5KTtcclxuICAgICAgICAgICAgaW5kaWNhdG9yLmNvbXBsZXRlKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmRpc2FibGVDbG9zZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmhpZGUoKTtcclxuICAgICAgICAgICAgZGVmLnJlc29sdmUoKTtcclxuICAgICAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgaW5kaWNhdG9yLmNvbXBsZXRlKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmRpc2FibGVDbG9zZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmhpZGUoKTtcclxuICAgICAgICAgICAgZGVmLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3VsdC5lbnRyeS5Nb2RpZnlEYXRlID0gbW9tZW50KCkudG9EYXRlKCk7XHJcbiAgICAgICAgICBtb2RlbC51cGRhdGVFbnRyeShyZXN1bHQuZW50cnkpO1xyXG4gICAgICAgICAgaW5kaWNhdG9yLmNvbXBsZXRlKHRydWUpO1xyXG4gICAgICAgICAgdGhpcy5tb2RhbC5kaXNhYmxlQ2xvc2UgPSBmYWxzZTtcclxuICAgICAgICAgIHRoaXMubW9kYWwuaGlkZSgpO1xyXG4gICAgICAgICAgZGVmLnJlc29sdmUoKTsgLy8gRG8gbm90aGluZyBzaW5jZSB0aGlzIG5vdCB0aGUgZmlyc3QgdGltZSBhdGh1ZW50aWNhdGluZy5cclxuICAgICAgICB9XHJcbiAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICBkZWYucmVqZWN0KGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGVmLnJlc29sdmUoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICB9LFxyXG59KTtcclxuXHJcbmxhbmcuc2V0T2JqZWN0KCdNb2JpbGUuU2FsZXNMb2dpeC5BcHBsaWNhdGlvbicsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
