<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Views/_GroupListMixin', ['exports', 'module', 'dojo/_base/declare', 'dojo/json', 'dojo/dom-class', 'dojo/dom-construct', 'argos/Utility', '../GroupUtility', 'dojo/when', 'dojo/_base/lang', 'argos/Store/SData', 'dojo/Deferred', '../Action', 'argos/I18n'], function (exports, module, _dojo_baseDeclare, _dojoJson, _dojoDomClass, _dojoDomConstruct, _argosUtility, _GroupUtility, _dojoWhen, _dojo_baseLang, _argosStoreSData, _dojoDeferred, _Action, _argosI18n) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _json = _interopRequireDefault(_dojoJson);

  var _domClass = _interopRequireDefault(_dojoDomClass);

  var _domConstruct = _interopRequireDefault(_dojoDomConstruct);

  var _utility = _interopRequireDefault(_argosUtility);

  var _GroupUtility2 = _interopRequireDefault(_GroupUtility);

  var _when = _interopRequireDefault(_dojoWhen);

  var _lang = _interopRequireDefault(_dojo_baseLang);

  var _SDataStore = _interopRequireDefault(_argosStoreSData);

  var _Deferred = _interopRequireDefault(_dojoDeferred);

  var _action = _interopRequireDefault(_Action);

  var _getResource = _interopRequireDefault(_argosI18n);

  var resource = (0, _getResource['default'])('groupListMixin');

<span id='crm-Views-_GroupListMixin'>  /**
</span>   * @class crm.Views._GroupListMixin
   *
   * Mixin for slx group list layouts.
   *
   * @since 3.1
   *
   *
   */
  var __class = (0, _declare['default'])('crm.Views._GroupListMixin', null, {
    noDefaultGroupText: resource.noDefaultGroupText,
    currentGroupNotFoundText: resource.currentGroupNotFoundText,
    groupTemplateSummaryText: resource.groupTemplateSummaryText,
    groupTemplateDetailText: resource.groupTemplateDetailText,
    groupsModeText: resource.groupsModeText,
    hasDefaultGroup: true,
    noDefaultGroupTemplate: new Simplate(['&lt;li class=&quot;no-data&quot; data-action=&quot;openConfigure&quot;&gt;', '&lt;h3&gt;{%= $$._getNoDefaultGroupMessage() %}&lt;/h3&gt;', '&lt;/li&gt;']),
    currentGoupNotFoundTemplate: new Simplate(['&lt;li class=&quot;no-data&quot;&gt;', '&lt;h3&gt;{%= $$._getCurrentGroupNotFoundMessage() %}&lt;/h3&gt;', '&lt;/li&gt;']),

    _getNoDefaultGroupMessage: function _getNoDefaultGroupMessage() {
      return resource.noDefaultGroupText;
    },
    _getCurrentGroupNotFoundMessage: function _getCurrentGroupNotFoundMessage() {
      return resource.currentGroupNotFoundText;
    },
    openConfigure: function openConfigure() {
      if (this._selectGroups) {
        this._selectGroups();
      }
    },
    // View Properties
    entityName: null,
    groupsEnabled: false,
    groupsMode: false,
    currentGroupId: null,
    _currentGroup: null,
    _groupInitialized: false,
    _originalProps: null,
    overrideGroupLayoutName: '@MobileLayout',
    _overrideLayoutInitalized: false,
    _overrideGroupLayout: null,
    enableDynamicGroupLayout: true,
    enableOverrideLayout: false,

    selectedColumns: null,
    layout: null,

    postMixInProperties: function postMixInProperties() {
      if (!App.enableGroups) {
        this.groupsMode = false;
        this.groupsEnabled = false;
      }

      if (this.groupsEnabled) {
        this.groupsMode = true;
      }
      this.inherited(arguments);
    },
    startup: function startup() {
      this.createGroupTemplates();
      this.inherited(arguments);
    },
    requestData: function requestData() {
      try {
        if (!this._groupInitialized &amp;&amp; this.groupsMode) {
          _domClass['default'].add(this.domNode, 'list-loading');
          this._setLoading();
          this.initGroup();
        } else {
          this.inherited(arguments);
        }
      } catch (e) {
        console.error(e); // eslint-disable-line
      }
    },

    joinFields: function joinFields(sep, fields) {
      return _utility['default'].joinFields(sep, fields);
    },
    getDescriptor: function getDescriptor(entity) {
      return entity.$descriptor || entity.$key || 'unknown';
    },
    getCurrentGroup: function getCurrentGroup() {
      return this._currentGroup;
    },
    setCurrentGroup: function setCurrentGroup(group) {
      if (group) {
        this.hasDefaultGroup = true;
        this._groupInitialized = false;
        this._currentGroup = group;
        this.currentGroupId = group.$key;
        _GroupUtility2['default'].setDefaultGroupPreference(this.entityName, group.name);
      }
    },
    getDefaultGroup: function getDefaultGroup() {
      var defaultGroup = null;
      var defaultGroupName = null;

      defaultGroup = _GroupUtility2['default'].getDefaultGroup(this.entityName);

      if (defaultGroup) {
        return defaultGroup;
      }

      defaultGroupName = _GroupUtility2['default'].getDefaultGroupPreference(this.entityName);
      if (defaultGroupName) {
        this._requestGroup(defaultGroupName);
      } else {
        // No default group preference
        this.set('listContent', this.noDefaultGroupTemplate.apply(this));
        this.hasDefaultGroup = false;
      }

      return null;
    },
    initOverrideGroupLayout: function initOverrideGroupLayout() {
      this._requestOverrideGroupLayout().then((function groupLayoutOverride(result) {
        this._overrideLayoutInitalized = true;
        this._overrideGroupLayout = result &amp;&amp; result.length &gt; 0 ? result[0].layout : null;
        this.initGroup();
      }).bind(this));
    },
    initGroup: function initGroup() {
      if (this.enableOverrideLayout &amp;&amp; !this._overrideLayoutInitalized &amp;&amp; !this._overrideGroupLayout) {
        this.initOverrideGroupLayout();
        return;
      }
      var group = this.getCurrentGroup();

      if (!group) {
        group = this.getDefaultGroup();
        this.setCurrentGroup(group);
      }

      if (group) {
        this._onApplyGroup(group);
      }
    },
    clear: function clear() {
      this.inherited(arguments);
      this._clearResolvedEntryCache();
    },
    _onApplyGroup: function _onApplyGroup(group) {
      if (!group) {
        throw new Error('Group not found.');
      }
      this._fieldFormatters = {};
      this._startGroupMode();
      this._clearResolvedEntryCache();

      // Set the toolbar title to the current group displayName
      var title = this.getGroupTitle(group);
      App.setPrimaryTitle(title);
      this.set('title', title);

      if (this._groupInitialized) {
        return;
      }

      this.layout = _GroupUtility2['default'].getLayout(group);
      this.selectColumns = _GroupUtility2['default'].getColumnNames(this.layout);
      this.itemTemplate = this.getItemTemplate();

      // Create a custom request that the store will use to execute the group query
      this.request = _GroupUtility2['default'].createGroupRequest({
        groupId: group.$key,
        connection: this.getConnection()
      });

      // Try to select the entity id as well
      this.selectColumns.push(group.family + 'ID');
      this.querySelect = this.selectColumns;
      this.queryOrderBy = '';
      this.idProperty = group.family.toUpperCase() + 'ID';
      this.labelProperty = group.family.toUpperCase();
      this.store = null;
      this.clear(true);
      this.refreshRequired = true;
      this._groupInitialized = true;
      this.requestData();
    },
    _requestOverrideGroupLayout: function _requestOverrideGroupLayout() {
      var def = new _Deferred['default']();
      var groupName = this.overrideGroupLayoutName;
      var store = new _SDataStore['default']({
        service: App.services.crm,
        resourceKind: 'groups',
        contractName: 'system',
        where: &quot;((upper(family) eq '&quot; + this.entityName.toUpperCase() + &quot;') and (upper(Name) eq '&quot; + groupName.toUpperCase() + &quot;'))&quot;,
        include: ['layout', 'tableAliases'],
        idProperty: '$key',
        applicationName: 'slx',
        scope: this
      });

      if (store) {
        var queryResults = store.query();
        (0, _when['default'])(queryResults, function setDeferredResolve(relatedFeed) {
          def.resolve(relatedFeed);
        }, function setDeferredResolveError() {
          def.resolve(null);
        });
      }
      return def.promise;
    },
    _requestGroup: function _requestGroup(groupName, groupId, onSuccess) {
      var store = undefined;
      if (typeof groupName === 'string' &amp;&amp; groupName !== '') {
        store = new _SDataStore['default']({
          service: App.services.crm,
          resourceKind: 'groups',
          contractName: 'system',
          where: &quot;((upper(family) eq '&quot; + this.entityName.toUpperCase() + &quot;') and (upper(Name) eq '&quot; + groupName.toUpperCase() + &quot;') or PluginId eq '&quot; + groupId + &quot;')&quot;,
          include: ['layout', 'tableAliases'],
          idProperty: '$key',
          applicationName: 'slx',
          scope: this
        });
      }

      if (store) {
        var queryResults = store.query();

        (function queryWhen(context, queryResult) {
          try {
            (0, _when['default'])(queryResult, (function queryResultFn(groupFeed) {
              if (typeof onSuccess === 'function') {
                onSuccess.apply(this, arguments);
              } else {
                this._onGroupRequestSuccess(groupFeed);
              }
            }).bind(context));
          } catch (error) {
            console.log('Error fetching group data:' + error); // eslint-disable-line
          }
        })(this, queryResults);
      }
    },
    _onGroupRequestSuccess: function _onGroupRequestSuccess(result) {
      if (result.length &gt; 0) {
        var group = result[0];
        this.setCurrentGroup(group);
        _GroupUtility2['default'].addToGroupPreferences([group], this.entityName);
        this._onApplyGroup(group);
      } else {
        var title = this.getGroupTitle();
        App.setPrimaryTitle(title);
        this.set('title', title);
        this._selectGroups();
      }

      // Reload the right menu
      this.onTransitionAway();
      this.loadRightDrawer();

      _domClass['default'].remove(this.domNode, 'list-loading');
      this.listLoading = false;
    },
    _onGroupRequestFaild: function _onGroupRequestFaild() {},
    getGroupTitle: function getGroupTitle(group) {
      return group.displayName;
    },
    getItemTemplate: function getItemTemplate() {
      var layout = this.enableOverrideLayout &amp;&amp; this._overrideGroupLayout ? this._overrideGroupLayout : this.layout;
      if (this.enableDynamicGroupLayout) {
        var layoutTemplate = this.getSelectedGroupLayoutTemplate();
        if (layoutTemplate) {
          if (layoutTemplate.type === 'Dynamic') {
            return this.getDynamicLayoutItemTemplate(layout, layoutTemplate.options);
          }
          if (layoutTemplate.template) {
            return new Simplate(layoutTemplate.template);
          }
        }
        return this.defaultGroupLayoutItemTemplate;
      }
      var template = layout.map(this.getItemLayoutTemplate);
      return new Simplate(template);
    },
    getItemLayoutTemplate: function getItemLayoutTemplate(item) {
      var jsonString = _json['default'].stringify(item);
      var template = ['&lt;h4&gt;&lt;span class=&quot;group-label&quot;&gt;', item.caption, '&lt;/span&gt; &lt;span class=&quot;group-entry&quot;&gt;{%= $$.groupTransformValue($[$$.getFieldNameByLayout(' + jsonString + ')],' + jsonString + ',$$.getFormatterByLayout(' + jsonString + ')) %}&lt;/span&gt;', '&lt;/h4&gt;'].join('');

      return template;
    },
    defaultGroupLayoutItemTemplate: new Simplate(['&lt;div&gt;&lt;h2&gt;&lt;span class=&quot;group-entry-header&quot;&gt;{%= $$.getGroupFieldValueByIndex($, 0, true) %}&lt;/span&gt;&lt;/h2&gt;&lt;/div&gt;', '&lt;h4&gt;&lt;span class=&quot;group-label&quot;&gt;{%= $$.getGroupFieldLabelByIndex(1) %} &lt;/span&gt;&lt;span class=&quot;group-entry&quot;&gt;{%= $$.getGroupFieldValueByIndex($, 1, true) %}&lt;/span&gt;&lt;/h4&gt;', '&lt;h4&gt;&lt;span class=&quot;group-label&quot;&gt;{%= $$.getGroupFieldLabelByIndex(2) %} &lt;/span&gt;&lt;span class=&quot;group-entry&quot;&gt;{%= $$.getGroupFieldValueByIndex($, 2, true) %}&lt;/span&gt;&lt;/h4&gt;']),
    createGroupTemplateLayouts: function createGroupTemplateLayouts() {
      this.groupTemplateLayouts = [{
        name: 'Summary',
        displayName: resource.groupTemplateSummaryText,
        type: 'Dynamic',
        options: {
          columns: [{
            id: 'col1',
            rows: 3
          }]
        }
      }, {
        name: 'Detail',
        displayName: resource.groupTemplateDetailText,
        type: 'Dynamic',
        options: {
          columns: [{
            id: 'col1',
            rows: 3
          }, {
            id: 'col2',
            rows: 3
          }, {
            id: 'col3',
            rows: 3
          }]
        }
      }];

      return this.groupTemplateLayouts;
    },
    getSelectedGroupLayoutTemplate: function getSelectedGroupLayoutTemplate() {
      var name = _GroupUtility2['default'].getSelectedGroupLayoutTemplate(this.entityName);
      name = name ? name : '';
      var layoutTemplate = null;
      this.groupTemplateLayouts.forEach(function setLayoutTemplate(item) {
        if (item.name === name) {
          layoutTemplate = item;
        }
      });
      if (!layoutTemplate) {
        layoutTemplate = this.groupTemplateLayouts[0];
      }
      return layoutTemplate;
    },
    createGroupTemplates: function createGroupTemplates() {
      this.groupTemplateLayouts = this._createCustomizedLayout(this.createGroupTemplateLayouts(), 'group-templates');
    },
    getDynamicLayoutItemTemplate: function getDynamicLayoutItemTemplate(layout, options) {
      var layoutOptions = this.applyDynamicLayoutOptions(options);
      var rows = 0;
      var columns = 1;
      var column = 1;
      var row = 1;
      columns = layoutOptions.columns.length;
      layoutOptions.columns.forEach(function incrementRows(item) {
        rows = rows + item.rows;
      });
      var columnWidth = _utility['default'].roundNumberTo(100 / columns, 0);

      var template = [];
      template.push('&lt;div class=&quot;group-item&quot;&gt;');
      template.push('&lt;div class=&quot;group-item-header&quot;&gt;');
      template.push('&lt;h2&gt;&lt;span class=&quot;group-entry-header&quot;&gt;{%= $$.getGroupFieldValueByName($,&quot;' + layout[0].propertyPath + '&quot;, true) %}&lt;/span&gt;&lt;/h2&gt;');
      template.push('&lt;/div&quot;&gt;');
      for (var i = 0; i &lt; layout.length; i++) {
        var columnItem = layoutOptions.columns[column - 1];
        if (columnItem &amp;&amp; column &lt;= columns &amp;&amp; i !== 0) {
          if (row === 1) {
            var columnStyle = columnItem.style || 'width:' + columnWidth + '%;';
            var columnClass = columnItem.clss || '';
            template.push('&lt;div class=&quot;group-column ' + columnClass + '&quot;  style=&quot;' + columnStyle + '&quot;&gt;');
          }
          var item = layout[i];
          if (item &amp;&amp; columnItem.rows &gt; 0) {
            if (i !== 0) {
              template.push('&lt;h3&gt;');
              if (!columnItem.hideLabels) {
                template.push('&lt;span class=&quot;group-label&quot;&gt;' + this.getGroupFieldLabelByName(item.propertyPath) + ' &lt;/span&gt;');
              }

              var formatOptions = this.getGroupFieldFormatOptions(item);
              var formatClss = formatOptions.clss || '';
              var jsonString = _json['default'].stringify(formatOptions);
              if (item.format === 'Phone') {
                template.push('&lt;span class=&quot;href&quot; data-action=&quot;groupInvokeListAction&quot; data-name=&quot;callPhone&quot; data-key=&quot;{%:$$.getGroupItemKey($)%}&quot; data-propertyname=&quot;' + item.propertyPath + '&quot;&gt;{%= $$.getGroupFieldValueByName($,&quot;' + item.propertyPath + '&quot;, true,' + jsonString + ') %}&lt;/span&gt;');
              } else if (item.propertyPath === 'Email') {
                template.push('&lt;span class=&quot;href&quot; data-action=&quot;groupInvokeListAction&quot; data-name=&quot;sendEmail&quot; data-key=&quot;{%:$$.getGroupItemKey($)%}&quot; data-propertyname=&quot;' + item.propertyPath + '&quot;&gt;{%= $$.getGroupFieldValueByName($,&quot;' + item.propertyPath + '&quot;, true,' + jsonString + ') %}&lt;/span&gt;');
              } else {
                template.push('&lt;span class=&quot;group-entry ' + formatClss + '&quot;&gt;{%= $$.getGroupFieldValueByName($,&quot;' + item.propertyPath + '&quot;, true,' + jsonString + ') %}&lt;/span&gt;');
              }
              template.push('&lt;/h3&gt;');
            }
          }
          row++;
          if (row === columnItem.rows + 1) {
            row = 1;
            column++;
            template.push('&lt;/div&gt;');
          }
        }
      }
      if (row !== 1) {
        template.push('&lt;/div&gt;');
      }
      template.push('&lt;/div&gt;');
      return new Simplate(template);
    },
    applyDynamicLayoutOptions: function applyDynamicLayoutOptions(options) {
      var layoutOptions = {
        columns: [{
          rows: 3
        }]
      };
      _lang['default'].mixin(layoutOptions, options);
      return layoutOptions;
    },
    getGroupItemKey: function getGroupItemKey(groupEntry) {
      return groupEntry[this.idProperty];
    },
    getGroupFieldFormatOptions: function getGroupFieldFormatOptions(layoutItem) {
      var formatter = this.getFormatterByLayout(layoutItem);
      var options = {
        formatString: formatter &amp;&amp; formatter.formatString ? formatter.formatString : null
      };

      if (formatter &amp;&amp; formatter.options) {
        _lang['default'].mixin(options, formatter.options);
      }
      return options;
    },
    getGroupFieldLabelByName: function getGroupFieldLabelByName(name) {
      var layout = this.enableOverrideLayout &amp;&amp; this._overrideGroupLayout ? this._overrideGroupLayout : this.layout;
      var layoutItem = null;
      layout.forEach(function setLayoutItem(item) {
        if (item.propertyPath === name) {
          layoutItem = item;
        }
      });
      if (layoutItem) {
        return layoutItem.caption;
      }
      return '';
    },
    getGroupFieldValueByName: function getGroupFieldValueByName(entry, name, applyFormat, formatOptions) {
      var layout = this.enableOverrideLayout &amp;&amp; this._overrideGroupLayout ? this._overrideGroupLayout : this.layout;
      var layoutItem = null;
      layout.forEach(function setLayoutItem(item) {
        if (item.propertyPath === name) {
          layoutItem = item;
        }
      });
      return this.getGroupFieldValue(entry, layoutItem, applyFormat, formatOptions);
    },
    getGroupFieldLabelByIndex: function getGroupFieldLabelByIndex(layoutIndex) {
      var layout = this.enableOverrideLayout &amp;&amp; this._overrideGroupLayout ? this._overrideGroupLayout : this.layout;
      if (layout[layoutIndex]) {
        return layout[layoutIndex].caption;
      }
      return '';
    },
    getGroupFieldValueByIndex: function getGroupFieldValueByIndex(entry, layoutIndex, applyFormat, formatOptions) {
      var layout = this.enableOverrideLayout &amp;&amp; this._overrideGroupLayout ? this._overrideGroupLayout : this.layout;
      var layoutItem = layout[layoutIndex];
      return this.getGroupFieldValue(entry, layoutItem, applyFormat, formatOptions);
    },
    getGroupFieldValue: function getGroupFieldValue(entry, layoutItem, applyFormat, formatOptions) {
      var value = null;
      var formatter = null;

      if (layoutItem &amp;&amp; applyFormat) {
        var fieldName = this.getFieldNameByLayout(layoutItem);
        if (applyFormat) {
          formatter = this.getFormatterByLayout(layoutItem);
        }
        if (formatter) {
          value = this.groupTransformValue(entry[fieldName], layoutItem, formatter, formatOptions);
        } else {
          value = entry[fieldName];
        }
      } else if (layoutItem) {
        var fieldName = this.getFieldNameByLayout(layoutItem);
        value = entry[fieldName];
      } else {
        value = null;
      }

      return value;
    },
    getFormatterByLayout: function getFormatterByLayout(layoutItem) {
      if (!this._fieldFormatters) {
        this._fieldFormatters = {};
      }
      var path = layoutItem.propertyPath + '_' + layoutItem.index;
      var formatter = this._fieldFormatters[path];
      if (!formatter) {
        formatter = this.getGroupFieldFormatter(layoutItem);
        this._fieldFormatters[path] = formatter;
      }
      return formatter;
    },
    getGroupFieldFormatter: function getGroupFieldFormatter(layoutItem) {
      var formatter = undefined;
      if (this.groupFieldFormatter) {
        formatter = this.groupFieldFormatter[layoutItem.propertyPath];
      }
      if (!formatter) {
        formatter = _GroupUtility2['default'].getFormatterByLayout(layoutItem);
      }
      return formatter;
    },
    groupTransformValue: function groupTransformValue(value, layout, formatter, formatOptions) {
      try {
        return formatter.formatter(value, formatter.formatString, formatOptions);
      } catch (e) {
        return value;
      }
    },
    getFieldNameByLayout: function getFieldNameByLayout(layoutItem) {
      return _GroupUtility2['default'].getFieldNameByLayout(layoutItem);
    },
    _startGroupMode: function _startGroupMode() {
      if (this._originalProps) {
        return;
      }

      this._originalProps = {};

      var original = this._originalProps;

      original.request = this.request ? this.request.clone() : null;
      original.querySelect = this.querySelect;
      original.queryOrderBy = this.queryOrderBy;
      original.idProperty = this.idProperty;
      original.labelProperty = this.labelProperty;
      original.store = this.store;
      original.rowTemplate = this.rowTemplate;
      original.itemTemplate = this.itemTemplate;
      original.itemFooterTemplate = this.itemFooterTemplate;
      original.relatedViews = this.relatedViews;
      original.title = this.get('title');
      original._model = this._model;

      this._model = null;
      this.itemFooterTemplate = new Simplate(['&lt;div&gt;&lt;/div&gt;']);

      this.groupsMode = true;
    },
    _clearGroupMode: function _clearGroupMode() {
      var original = this._originalProps;

      this.groupsMode = false;

      if (!original) {
        return;
      }

      this.request = original.request || null;
      this.querySelect = original.querySelect;
      this.queryOrderBy = original.queryOrderBy;
      this.idProperty = original.idProperty;
      this.labelProperty = original.labelProperty;
      this.set('store', original.store);
      this.rowTemplate = original.rowTemplate;
      this.itemTemplate = original.itemTemplate;
      this.relatedViews = original.relatedViews;
      this.itemFooterTemplate = original.itemFooterTemplate;
      this._model = original._model;

      this._originalProps = null;

      this._groupInitialized = false;
      this._currentGroup = null;
      this.currentGroupId = null;
      App.setPrimaryTitle(original.title);
      this.set('title', original.title);

      this.clear();
      this.refreshRequired = true;
    },
    _onQueryError: function _onQueryError(queryOptions, error) {
      if (this.groupsEnabled &amp;&amp; this.groupsMode) {
        if (error.status === 404) {
          try {
            this._onGroupNotFound();
            return;
          } catch (e) {
            console.error(e); // eslint-disable-line
          }
        }
      }
      this.inherited(arguments);
    },
    _onGroupNotFound: function _onGroupNotFound() {
      _GroupUtility2['default'].removeGroupPreferences(this.currentGroupId, this.entityName);
      this.refreshRightDrawer();
      _domClass['default'].remove(this.domNode, 'list-loading');
      this.set('listContent', this.currentGoupNotFoundTemplate.apply(this));
    },
    activateEntry: function activateEntry(params) {
      if (this.groupsEnabled &amp;&amp; this.groupsMode &amp;&amp; !params.resolved) {
        this._groupActivateEntry(params);
      } else {
        this.inherited(arguments);
      }
    },
    _groupActivateEntry: function _groupActivateEntry(params) {
      var self = this;

      if (params.key) {
        var resolvedEntry = this._getResolvedEntry(params.key);
        if (!resolvedEntry) {
          this._fetchResolvedEntry(params.key).then(function postFetchResolvedEntry(resolvedEnt) {
            params.descriptor = resolvedEnt.$descriptor;
            params.resolved = true;
            self.activateEntry(params);
          });
        } else {
          params.descriptor = resolvedEntry.$descriptor;
          params.resolved = true;
          this.activateEntry(params);
        }
      }
    },
    _invokeAction: function _invokeAction(theAction, selection) {
      if (this.groupsEnabled &amp;&amp; this.groupsMode &amp;&amp; !selection.resolved) {
        this._groupInvokeAction(theAction, selection);
      } else {
        this.inherited(arguments);
      }
    },
    _groupInvokeAction: function _groupInvokeAction(theAction, selection) {
      var self = this;
      var resolvedEntry = this._getResolvedEntry(selection.data.$key);
      if (!resolvedEntry) {
        this._fetchResolvedEntry(selection.data.$key).then(function postFetchResolvedEntry(resolvedEnt) {
          self._invokeAction(theAction, {
            data: resolvedEnt,
            resolved: true
          });
        });
      } else {
        this._invokeAction(theAction, {
          data: resolvedEntry,
          resolved: true
        });
      }
    },
    showActionPanel: function showActionPanel(rowNode) {
      if (this.groupsEnabled &amp;&amp; this.groupsMode) {
        this._groupShowActionPanel(rowNode);
      } else {
        this.inherited(arguments);
      }
    },
    _groupShowActionPanel: function _groupShowActionPanel(rowNode) {
      var selection = this._getCurrentSelection();
      var self = this;
      var resolvedEntry = this._getResolvedEntry(selection.data.$key);
      if (!resolvedEntry) {
        this._fetchResolvedEntry(selection.data.$key).then(function postFetchResolvedEntry(resolvedEnt) {
          self._groupCheckActionState(resolvedEnt);
          self._groupApplyActionPanel(rowNode);
        });
      } else {
        this._groupCheckActionState(resolvedEntry);
        this._groupApplyActionPanel(rowNode);
      }
    },
    _groupApplyActionPanel: function _groupApplyActionPanel(rowNode) {
      _domClass['default'].add(rowNode, 'list-action-selected');
      this.onApplyRowActionPanel(this.actionsNode, rowNode);
      _domConstruct['default'].place(this.actionsNode, rowNode, 'after');
    },
    _getCurrentSelection: function _getCurrentSelection() {
      var selectedItems = this.get('selectionModel').getSelections();
      var selection = undefined;
      for (var key in selectedItems) {
        if (selectedItems.hasOwnProperty(key)) {
          selection = selectedItems[key];
          selection.data.$key = key;
          break;
        }
      }
      return selection;
    },
    _fetchResolvedEntry: function _fetchResolvedEntry(entryKey) {
      var def = new _Deferred['default']();
      var self = this;
      var store = new _SDataStore['default']({
        service: App.services.crm,
        resourceKind: this.resourceKind,
        contractName: this.contractName,
        scope: this
      });

      var select = this._originalProps.querySelect;

      // Use querySelect from the model if available
      // TODO: Expose _getQueryModelByName better somehow
      if (this._originalProps._model) {
        var queryModel = this._originalProps._model._getQueryModelByName('list');
        if (queryModel &amp;&amp; queryModel.querySelect) {
          select = queryModel.querySelect;
        }
      }

      var queryOptions = {
        select: select,
        where: &quot;Id eq '&quot; + entryKey + &quot;'&quot;
      };

      var queryResults = store.query(null, queryOptions);

      (0, _when['default'])(queryResults, function postWhen(feed) {
        var entry = feed[0];
        entry[self.idProperty] = entry.$key; // we need this because the group key is different, and it used later on when invoking an action;
        self._addResolvedEntry(entry);
        def.resolve(entry);
      }, function postWhenError(err) {
        def.reject(err);
      });

      return def.promise;
    },
    _clearResolvedEntryCache: function _clearResolvedEntryCache() {
      this._resolvedEntryCache = {};
    },
    _getResolvedEntry: function _getResolvedEntry(entryKey) {
      if (!this._resolvedEntryCache) {
        this._resolvedEntryCache = {};
      }
      return this._resolvedEntryCache[entryKey];
    },
    _addResolvedEntry: function _addResolvedEntry(entry) {
      this._resolvedEntryCache[entry.$key] = entry;
    },
    _groupCheckActionState: function _groupCheckActionState(resolvedEntry) {
      var resolvedSelection = {
        data: resolvedEntry
      };
      this._applyStateToActions(resolvedSelection);
    },
    onToolLayoutCreated: function onToolLayoutCreated(tools) {
      if (tools &amp;&amp; !this._refreshAdded &amp;&amp; !window.App.supportsTouch()) {
        var refreshTool = {
          id: 'refresh',
          cls: 'fa fa-refresh fa-fw fa-lg',
          action: '_refreshList'

        };
        if (tools.tbar) {
          tools.tbar.push(refreshTool);
          this._refreshAdded = true;
        }
      }
      this.inherited(arguments);
    },
    _refreshList: function _refreshList() {
      var self = this;
      if (this.groupsEnabled &amp;&amp; this.groupList &amp;&amp; this._currentGroup) {
        this._requestGroup(this._currentGroup.name, this._currentGroup.$key, function checkGroup(results) {
          var group = results[0];
          if (group) {
            _GroupUtility2['default'].addToGroupPreferences([group], this.entityName);
            self.setCurrentGroup(group);
            this.refreshRightDrawer();
          }

          self.clear();
          self.refreshRequired = true;
          self.refresh();
        });
      } else {
        this.clear();
        this.refreshRequired = true;
        this.refresh();
      }
    },
    groupInvokeListAction: function groupInvokeListAction(params) {
      var key = params.key;
      var propertyName = params.propertyname;
      var actionName = params.name;
      var resolvedEntry = this._getResolvedEntry(key);
      if (!resolvedEntry) {
        this._fetchResolvedEntry(key).then((function setOptionsforGroupAction(resolvedEnt) {
          var options = {
            selection: {
              data: resolvedEnt
            },
            propertyName: propertyName
          };
          this.groupInvokeActionByName(actionName, options);
        }).bind(this));
      } else {
        var options = {
          selection: {
            data: resolvedEntry
          },
          propertyName: propertyName
        };
        this.groupInvokeActionByName(actionName, options);
      }
    },
    groupInvokeActionByName: function groupInvokeActionByName(actionName, options) {
      var opt = options;
      if (!opt) {
        opt = {};
      }
      switch (actionName) {
        case 'callPhone':
          _action['default'].callPhone.call(this, null, opt.selection, opt.propertyName);
          break;
        case 'sendEmail':
          _action['default'].sendEmail.call(this, null, opt.selection, opt.propertyName);
          break;
        default:
          break;
      }
    },
    getContextSnapShot: function getContextSnapShot(options) {
      var snapShot = undefined;
      if (this._groupInitialized &amp;&amp; this.groupsMode) {
        var entry = this.entries[options.key];
        var template = this.itemRowContainerTemplate;
        snapShot = template.apply(entry, this);
        return snapShot;
      }
      snapShot = this.inherited(arguments);

      return snapShot;
    },
    initModel: function initModel() {
      if (!this._groupInitialized || !this.groupsMode) {
        this.inherited(arguments);
      }
    }
  });

  _lang['default'].setObject('Mobile.SalesLogix.Views._GroupListMixin', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9WaWV3cy9fR3JvdXBMaXN0TWl4aW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBYUEsTUFBTSxRQUFRLEdBQUcsNkJBQVksZ0JBQWdCLENBQUMsQ0FBQzs7Ozs7Ozs7Ozs7QUFXL0MsTUFBTSxPQUFPLEdBQUcseUJBQVEsMkJBQTJCLEVBQUUsSUFBSSxFQUFFO0FBQ3pELHNCQUFrQixFQUFFLFFBQVEsQ0FBQyxrQkFBa0I7QUFDL0MsNEJBQXdCLEVBQUUsUUFBUSxDQUFDLHdCQUF3QjtBQUMzRCw0QkFBd0IsRUFBRSxRQUFRLENBQUMsd0JBQXdCO0FBQzNELDJCQUF1QixFQUFFLFFBQVEsQ0FBQyx1QkFBdUI7QUFDekQsa0JBQWMsRUFBRSxRQUFRLENBQUMsY0FBYztBQUN2QyxtQkFBZSxFQUFFLElBQUk7QUFDckIsMEJBQXNCLEVBQUUsSUFBSSxRQUFRLENBQUMsQ0FDbkMsa0RBQWtELEVBQ2xELGdEQUFnRCxFQUNoRCxPQUFPLENBQ1IsQ0FBQztBQUNGLCtCQUEyQixFQUFFLElBQUksUUFBUSxDQUFDLENBQ3hDLHNCQUFzQixFQUN0QixzREFBc0QsRUFDdEQsT0FBTyxDQUNSLENBQUM7O0FBRUYsNkJBQXlCLEVBQUUsU0FBUyx5QkFBeUIsR0FBRztBQUM5RCxhQUFPLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQztLQUNwQztBQUNELG1DQUErQixFQUFFLFNBQVMsK0JBQStCLEdBQUc7QUFDMUUsYUFBTyxRQUFRLENBQUMsd0JBQXdCLENBQUM7S0FDMUM7QUFDRCxpQkFBYSxFQUFFLFNBQVMsYUFBYSxHQUFHO0FBQ3RDLFVBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtBQUN0QixZQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7T0FDdEI7S0FDRjs7QUFFRCxjQUFVLEVBQUUsSUFBSTtBQUNoQixpQkFBYSxFQUFFLEtBQUs7QUFDcEIsY0FBVSxFQUFFLEtBQUs7QUFDakIsa0JBQWMsRUFBRSxJQUFJO0FB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Q0FBQztBQUNiLFVBQUksSUFBSSxDQUFDLGlCQUFpQixJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7QUFDN0MsWUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDeEMsWUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDO0FBQy9DLGdCQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDdkMsZUFBTyxRQUFRLENBQUM7T0FDakI7QUFDRCxjQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQzs7QUFFckMsYUFBTyxRQUFRLENBQUM7S0FDakI7QUFDRCxhQUFTLEVBQUUsU0FBUyxTQUFTLEdBQUc7QUFDOUIsVUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUU7QUFDL0MsWUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztPQUMzQjtLQUNGO0dBQ0YsQ0FBQyxDQUFDOztBQUVILG1CQUFLLFNBQVMsQ0FBQyx5Q0FBeUMsRUFBRSxPQUFPLENBQUMsQ0FBQzttQkFDcEQsT0FBTyIsImZpbGUiOiJzcmMvVmlld3MvX0dyb3VwTGlzdE1peGluLmpzIiwic291cmNlUm9vdCI6InNyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWNsYXJlIGZyb20gJ2Rvam8vX2Jhc2UvZGVjbGFyZSc7XHJcbmltcG9ydCBqc29uIGZyb20gJ2Rvam8vanNvbic7XHJcbmltcG9ydCBkb21DbGFzcyBmcm9tICdkb2pvL2RvbS1jbGFzcyc7XHJcbmltcG9ydCBkb21Db25zdHJ1Y3QgZnJvbSAnZG9qby9kb20tY29uc3RydWN0JztcclxuaW1wb3J0IHV0aWxpdHkgZnJvbSAnYXJnb3MvVXRpbGl0eSc7XHJcbmltcG9ydCBHcm91cFV0aWxpdHkgZnJvbSAnLi4vR3JvdXBVdGlsaXR5JztcclxuaW1wb3J0IHdoZW4gZnJvbSAnZG9qby93aGVuJztcclxuaW1wb3J0IGxhbmcgZnJvbSAnZG9qby9fYmFzZS9sYW5nJztcclxuaW1wb3J0IFNEYXRhU3RvcmUgZnJvbSAnYXJnb3MvU3RvcmUvU0RhdGEnO1xyXG5pbXBvcnQgRGVmZXJyZWQgZnJvbSAnZG9qby9EZWZlcnJlZCc7XHJcbmltcG9ydCBhY3Rpb24gZnJvbSAnLi4vQWN0aW9uJztcclxuaW1wb3J0IGdldFJlc291cmNlIGZyb20gJ2FyZ29zL0kxOG4nO1xyXG5cclxuY29uc3QgcmVzb3VyY2UgPSBnZXRSZXNvdXJjZSgnZ3JvdXBMaXN0TWl4aW4nKTtcclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgY3JtLlZpZXdzLl9Hcm91cExpc3RNaXhpblxyXG4gKlxyXG4gKiBNaXhpbiBmb3Igc2x4IGdyb3VwIGxpc3QgbGF5b3V0cy5cclxuICpcclxuICogQHNpbmNlIDMuMVxyXG4gKlxyXG4gKlxyXG4gKi9cclxuY29uc3QgX19jbGFzcyA9IGRlY2xhcmUoJ2NybS5WaWV3cy5fR3JvdXBMaXN0TWl4aW4nLCBudWxsLCB7XHJcbiAgbm9EZWZhdWx0R3JvdXBUZXh0OiByZXNvdXJjZS5ub0RlZmF1bHRHcm91cFRleHQsXHJcbiAgY3VycmVudEdyb3VwTm90Rm91bmRUZXh0OiByZXNvdXJjZS5jdXJyZW50R3JvdXBOb3RGb3VuZFRleHQsXHJcbiAgZ3JvdXBUZW1wbGF0ZVN1bW1hcnlUZXh0OiByZXNvdXJjZS5ncm91cFRlbXBsYXRlU3VtbWFyeVRleHQsXHJcbiAgZ3JvdXBUZW1wbGF0ZURldGFpbFRleHQ6IHJlc291cmNlLmdyb3VwVGVtcGxhdGVEZXRhaWxUZXh0LFxyXG4gIGdyb3Vwc01vZGVUZXh0OiByZXNvdXJjZS5ncm91cHNNb2RlVGV4dCxcclxuICBoYXNEZWZhdWx0R3JvdXA6IHRydWUsXHJcbiAgbm9EZWZhdWx0R3JvdXBUZW1wbGF0ZTogbmV3IFNpbXBsYXRlKFtcclxuICAgICc8bGkgY2xhc3M9XCJuby1kYXRhXCIgZGF0YS1hY3Rpb249XCJvcGVuQ29uZmlndXJlXCI+JyxcclxuICAgICc8aDM+eyU9ICQkLl9nZXROb0RlZmF1bHRHcm91cE1lc3NhZ2UoKSAlfTwvaDM+JyxcclxuICAgICc8L2xpPicsXHJcbiAgXSksXHJcbiAgY3VycmVudEdvdXBOb3RGb3VuZFRlbXBsYXRlOiBuZXcgU2ltcGxhdGUoW1xyXG4gICAgJzxsaSBjbGFzcz1cIm5vLWRhdGFcIj4nLFxyXG4gICAgJzxoMz57JT0gJCQuX2dldEN1cnJlbnRHcm91cE5vdEZvdW5kTWVzc2FnZSgpICV9PC9oMz4nLFxyXG4gICAgJzwvbGk+JyxcclxuICBdKSxcclxuXHJcbiAgX2dldE5vRGVmYXVsdEdyb3VwTWVzc2FnZTogZnVuY3Rpb24gX2dldE5vRGVmYXVsdEdyb3VwTWVzc2FnZSgpIHtcclxuICAgIHJldHVybiByZXNvdXJjZS5ub0RlZmF1bHRHcm91cFRleHQ7XHJcbiAgfSxcclxuICBfZ2V0Q3VycmVudEdyb3VwTm90Rm91bmRNZXNzYWdlOiBmdW5jdGlvbiBfZ2V0Q3VycmVudEdyb3VwTm90Rm91bmRNZXNzYWdlKCkge1xyXG4gICAgcmV0dXJuIHJlc291cmNlLmN1cnJlbnRHcm91cE5vdEZvdW5kVGV4dDtcclxuICB9LFxyXG4gIG9wZW5Db25maWd1cmU6IGZ1bmN0aW9uIG9wZW5Db25maWd1cmUoKSB7XHJcbiAgICBpZiAodGhpcy5fc2VsZWN0R3JvdXBzKSB7XHJcbiAgICAgIHRoaXMuX3NlbGVjdEdyb3VwcygpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgLy8gVmlldyBQcm9wZXJ0aWVzXHJcbiAgZW50aXR5TmFtZTogbnVsbCxcclxuICBncm91cHNFbmFibGVkOiBmYWxzZSxcclxuICBncm91cHNNb2RlOiBmYWxzZSxcclxuICBjdXJyZW50R3JvdXBJZDogbnVsbCxcclxuICBfY3VycmVudEdyb3VwOiBudWxsLFxyXG4gIF9ncm91cEluaXRpYWxpemVkOiBmYWxzZSxcclxuICBfb3JpZ2luYWxQcm9wczogbnVsbCxcclxuICBvdmVycmlkZUdyb3VwTGF5b3V0TmFtZTogJ0BNb2JpbGVMYXlvdXQnLFxyXG4gIF9vdmVycmlkZUxheW91dEluaXRhbGl6ZWQ6IGZhbHNlLFxyXG4gIF9vdmVycmlkZUdyb3VwTGF5b3V0OiBudWxsLFxyXG4gIGVuYWJsZUR5bmFtaWNHcm91cExheW91dDogdHJ1ZSxcclxuICBlbmFibGVPdmVycmlkZUxheW91dDogZmFsc2UsXHJcblxyXG4gIHNlbGVjdGVkQ29sdW1uczogbnVsbCxcclxuICBsYXlvdXQ6IG51bGwsXHJcblxyXG4gIHBvc3RNaXhJblByb3BlcnRpZXM6IGZ1bmN0aW9uIHBvc3RNaXhJblByb3BlcnRpZXMoKSB7XHJcbiAgICBpZiAoIUFwcC5lbmFibGVHcm91cHMpIHtcclxuICAgICAgdGhpcy5ncm91cHNNb2RlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZ3JvdXBzRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmdyb3Vwc0VuYWJsZWQpIHtcclxuICAgICAgdGhpcy5ncm91cHNNb2RlID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcbiAgfSxcclxuICBzdGFydHVwOiBmdW5jdGlvbiBzdGFydHVwKCkge1xyXG4gICAgdGhpcy5jcmVhdGVHcm91cFRlbXBsYXRlcygpO1xyXG4gICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICB9LFxyXG4gIHJlcXVlc3REYXRhOiBmdW5jdGlvbiByZXF1ZXN0RGF0YSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghdGhpcy5fZ3JvdXBJbml0aWFsaXplZCAmJiB0aGlzLmdyb3Vwc01vZGUpIHtcclxuICAgICAgICBkb21DbGFzcy5hZGQodGhpcy5kb21Ob2RlLCAnbGlzdC1sb2FkaW5nJyk7XHJcbiAgICAgICAgdGhpcy5fc2V0TG9hZGluZygpO1xyXG4gICAgICAgIHRoaXMuaW5pdEdyb3VwKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGUpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgam9pbkZpZWxkczogZnVuY3Rpb24gam9pbkZpZWxkcyhzZXAsIGZpZWxkcykge1xyXG4gICAgcmV0dXJuIHV0aWxpdHkuam9pbkZpZWxkcyhzZXAsIGZpZWxkcyk7XHJcbiAgfSxcclxuICBnZXREZXNjcmlwdG9yOiBmdW5jdGlvbiBnZXREZXNjcmlwdG9yKGVudGl0eSkge1xyXG4gICAgcmV0dXJuIGVudGl0eS4kZGVzY3JpcHRvciB8fCBlbnRpdHkuJGtleSB8fCAndW5rbm93bic7XHJcbiAgfSxcclxuICBnZXRDdXJyZW50R3JvdXA6IGZ1bmN0aW9uIGdldEN1cnJlbnRHcm91cCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXJyZW50R3JvdXA7XHJcbiAgfSxcclxuICBzZXRDdXJyZW50R3JvdXA6IGZ1bmN0aW9uIHNldEN1cnJlbnRHcm91cChncm91cCkge1xyXG4gICAgaWYgKGdyb3VwKSB7XHJcbiAgICAgIHRoaXMuaGFzRGVmYXVsdEdyb3VwID0gdHJ1ZTtcclxuICAgICAgdGhpcy5fZ3JvdXBJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9jdXJyZW50R3JvdXAgPSBncm91cDtcclxuICAgICAgdGhpcy5jdXJyZW50R3JvdXBJZCA9IGdyb3VwLiRrZXk7XHJcbiAgICAgIEdyb3VwVXRpbGl0eS5zZXREZWZhdWx0R3JvdXBQcmVmZXJlbmNlKHRoaXMuZW50aXR5TmFtZSwgZ3JvdXAubmFtZSk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBnZXREZWZhdWx0R3JvdXA6IGZ1bmN0aW9uIGdldERlZmF1bHRHcm91cCgpIHtcclxuICAgIGxldCBkZWZhdWx0R3JvdXAgPSBudWxsO1xyXG4gICAgbGV0IGRlZmF1bHRHcm91cE5hbWUgPSBudWxsO1xyXG5cclxuICAgIGRlZmF1bHRHcm91cCA9IEdyb3VwVXRpbGl0eS5nZXREZWZhdWx0R3JvdXAodGhpcy5lbnRpdHlOYW1lKTtcclxuXHJcbiAgICBpZiAoZGVmYXVsdEdyb3VwKSB7XHJcbiAgICAgIHJldHVybiBkZWZhdWx0R3JvdXA7XHJcbiAgICB9XHJcblxyXG4gICAgZGVmYXVsdEdyb3VwTmFtZSA9IEdyb3VwVXRpbGl0eS5nZXREZWZhdWx0R3JvdXBQcmVmZXJlbmNlKHRoaXMuZW50aXR5TmFtZSk7XHJcbiAgICBpZiAoZGVmYXVsdEdyb3VwTmFtZSkge1xyXG4gICAgICB0aGlzLl9yZXF1ZXN0R3JvdXAoZGVmYXVsdEdyb3VwTmFtZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBObyBkZWZhdWx0IGdyb3VwIHByZWZlcmVuY2VcclxuICAgICAgdGhpcy5zZXQoJ2xpc3RDb250ZW50JywgdGhpcy5ub0RlZmF1bHRHcm91cFRlbXBsYXRlLmFwcGx5KHRoaXMpKTtcclxuICAgICAgdGhpcy5oYXNEZWZhdWx0R3JvdXAgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9LFxyXG4gIGluaXRPdmVycmlkZUdyb3VwTGF5b3V0OiBmdW5jdGlvbiBpbml0T3ZlcnJpZGVHcm91cExheW91dCgpIHtcclxuICAgIHRoaXMuX3JlcXVlc3RPdmVycmlkZUdyb3VwTGF5b3V0KCkudGhlbihmdW5jdGlvbiBncm91cExheW91dE92ZXJyaWRlKHJlc3VsdCkge1xyXG4gICAgICB0aGlzLl9vdmVycmlkZUxheW91dEluaXRhbGl6ZWQgPSB0cnVlO1xyXG4gICAgICB0aGlzLl9vdmVycmlkZUdyb3VwTGF5b3V0ID0gKHJlc3VsdCAmJiAocmVzdWx0Lmxlbmd0aCA+IDApKSA/IHJlc3VsdFswXS5sYXlvdXQgOiBudWxsO1xyXG4gICAgICB0aGlzLmluaXRHcm91cCgpO1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuICB9LFxyXG4gIGluaXRHcm91cDogZnVuY3Rpb24gaW5pdEdyb3VwKCkge1xyXG4gICAgaWYgKHRoaXMuZW5hYmxlT3ZlcnJpZGVMYXlvdXQgJiYgIXRoaXMuX292ZXJyaWRlTGF5b3V0SW5pdGFsaXplZCAmJiAhdGhpcy5fb3ZlcnJpZGVHcm91cExheW91dCkge1xyXG4gICAgICB0aGlzLmluaXRPdmVycmlkZUdyb3VwTGF5b3V0KCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBncm91cCA9IHRoaXMuZ2V0Q3VycmVudEdyb3VwKCk7XHJcblxyXG4gICAgaWYgKCFncm91cCkge1xyXG4gICAgICBncm91cCA9IHRoaXMuZ2V0RGVmYXVsdEdyb3VwKCk7XHJcbiAgICAgIHRoaXMuc2V0Q3VycmVudEdyb3VwKGdyb3VwKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZ3JvdXApIHtcclxuICAgICAgdGhpcy5fb25BcHBseUdyb3VwKGdyb3VwKTtcclxuICAgIH1cclxuICB9LFxyXG4gIGNsZWFyOiBmdW5jdGlvbiBjbGVhcigpIHtcclxuICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcbiAgICB0aGlzLl9jbGVhclJlc29sdmVkRW50cnlDYWNoZSgpO1xyXG4gIH0sXHJcbiAgX29uQXBwbHlHcm91cDogZnVuY3Rpb24gX29uQXBwbHlHcm91cChncm91cCkge1xyXG4gICAgaWYgKCFncm91cCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dyb3VwIG5vdCBmb3VuZC4nKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2ZpZWxkRm9ybWF0dGVycyA9IHt9O1xyXG4gICAgdGhpcy5fc3RhcnRHcm91cE1vZGUoKTtcclxuICAgIHRoaXMuX2NsZWFyUmVzb2x2ZWRFbnRyeUNhY2hlKCk7XHJcblxyXG4gICAgLy8gU2V0IHRoZSB0b29sYmFyIHRpdGxlIHRvIHRoZSBjdXJyZW50IGdyb3VwIGRpc3BsYXlOYW1lXHJcbiAgICBjb25zdCB0aXRsZSA9IHRoaXMuZ2V0R3JvdXBUaXRsZShncm91cCk7XHJcbiAgICBBcHAuc2V0UHJpbWFyeVRpdGxlKHRpdGxlKTtcclxuICAgIHRoaXMuc2V0KCd0aXRsZScsIHRpdGxlKTtcclxuXHJcbiAgICBpZiAodGhpcy5fZ3JvdXBJbml0aWFsaXplZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5sYXlvdXQgPSBHcm91cFV0aWxpdHkuZ2V0TGF5b3V0KGdyb3VwKTtcclxuICAgIHRoaXMuc2VsZWN0Q29sdW1ucyA9IEdyb3VwVXRpbGl0eS5nZXRDb2x1bW5OYW1lcyh0aGlzLmxheW91dCk7XHJcbiAgICB0aGlzLml0ZW1UZW1wbGF0ZSA9IHRoaXMuZ2V0SXRlbVRlbXBsYXRlKCk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgY3VzdG9tIHJlcXVlc3QgdGhhdCB0aGUgc3RvcmUgd2lsbCB1c2UgdG8gZXhlY3V0ZSB0aGUgZ3JvdXAgcXVlcnlcclxuICAgIHRoaXMucmVxdWVzdCA9IEdyb3VwVXRpbGl0eS5jcmVhdGVHcm91cFJlcXVlc3Qoe1xyXG4gICAgICBncm91cElkOiBncm91cC4ka2V5LFxyXG4gICAgICBjb25uZWN0aW9uOiB0aGlzLmdldENvbm5lY3Rpb24oKSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFRyeSB0byBzZWxlY3QgdGhlIGVudGl0eSBpZCBhcyB3ZWxsXHJcbiAgICB0aGlzLnNlbGVjdENvbHVtbnMucHVzaChncm91cC5mYW1pbHkgKyAnSUQnKTtcclxuICAgIHRoaXMucXVlcnlTZWxlY3QgPSB0aGlzLnNlbGVjdENvbHVtbnM7XHJcbiAgICB0aGlzLnF1ZXJ5T3JkZXJCeSA9ICcnO1xyXG4gICAgdGhpcy5pZFByb3BlcnR5ID0gZ3JvdXAuZmFtaWx5LnRvVXBwZXJDYXNlKCkgKyAnSUQnO1xyXG4gICAgdGhpcy5sYWJlbFByb3BlcnR5ID0gZ3JvdXAuZmFtaWx5LnRvVXBwZXJDYXNlKCk7XHJcbiAgICB0aGlzLnN0b3JlID0gbnVsbDtcclxuICAgIHRoaXMuY2xlYXIodHJ1ZSk7XHJcbiAgICB0aGlzLnJlZnJlc2hSZXF1aXJlZCA9IHRydWU7XHJcbiAgICB0aGlzLl9ncm91cEluaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgIHRoaXMucmVxdWVzdERhdGEoKTtcclxuICB9LFxyXG4gIF9yZXF1ZXN0T3ZlcnJpZGVHcm91cExheW91dDogZnVuY3Rpb24gX3JlcXVlc3RPdmVycmlkZUdyb3VwTGF5b3V0KCkge1xyXG4gICAgY29uc3QgZGVmID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICBjb25zdCBncm91cE5hbWUgPSB0aGlzLm92ZXJyaWRlR3JvdXBMYXlvdXROYW1lO1xyXG4gICAgY29uc3Qgc3RvcmUgPSBuZXcgU0RhdGFTdG9yZSh7XHJcbiAgICAgIHNlcnZpY2U6IEFwcC5zZXJ2aWNlcy5jcm0sXHJcbiAgICAgIHJlc291cmNlS2luZDogJ2dyb3VwcycsXHJcbiAgICAgIGNvbnRyYWN0TmFtZTogJ3N5c3RlbScsXHJcbiAgICAgIHdoZXJlOiBcIigodXBwZXIoZmFtaWx5KSBlcSAnXCIgKyB0aGlzLmVudGl0eU5hbWUudG9VcHBlckNhc2UoKSArIFwiJykgYW5kICh1cHBlcihOYW1lKSBlcSAnXCIgKyBncm91cE5hbWUudG9VcHBlckNhc2UoKSArIFwiJykpXCIsXHJcbiAgICAgIGluY2x1ZGU6IFsnbGF5b3V0JywgJ3RhYmxlQWxpYXNlcyddLFxyXG4gICAgICBpZFByb3BlcnR5OiAnJGtleScsXHJcbiAgICAgIGFwcGxpY2F0aW9uTmFtZTogJ3NseCcsXHJcbiAgICAgIHNjb3BlOiB0aGlzLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHN0b3JlKSB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5UmVzdWx0cyA9IHN0b3JlLnF1ZXJ5KCk7XHJcbiAgICAgIHdoZW4ocXVlcnlSZXN1bHRzLCBmdW5jdGlvbiBzZXREZWZlcnJlZFJlc29sdmUocmVsYXRlZEZlZWQpIHtcclxuICAgICAgICBkZWYucmVzb2x2ZShyZWxhdGVkRmVlZCk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uIHNldERlZmVycmVkUmVzb2x2ZUVycm9yKCkge1xyXG4gICAgICAgIGRlZi5yZXNvbHZlKG51bGwpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICB9LFxyXG4gIF9yZXF1ZXN0R3JvdXA6IGZ1bmN0aW9uIF9yZXF1ZXN0R3JvdXAoZ3JvdXBOYW1lLCBncm91cElkLCBvblN1Y2Nlc3MpIHtcclxuICAgIGxldCBzdG9yZTtcclxuICAgIGlmICh0eXBlb2YgZ3JvdXBOYW1lID09PSAnc3RyaW5nJyAmJiBncm91cE5hbWUgIT09ICcnKSB7XHJcbiAgICAgIHN0b3JlID0gbmV3IFNEYXRhU3RvcmUoe1xyXG4gICAgICAgIHNlcnZpY2U6IEFwcC5zZXJ2aWNlcy5jcm0sXHJcbiAgICAgICAgcmVzb3VyY2VLaW5kOiAnZ3JvdXBzJyxcclxuICAgICAgICBjb250cmFjdE5hbWU6ICdzeXN0ZW0nLFxyXG4gICAgICAgIHdoZXJlOiBcIigodXBwZXIoZmFtaWx5KSBlcSAnXCIgKyB0aGlzLmVudGl0eU5hbWUudG9VcHBlckNhc2UoKSArIFwiJykgYW5kICh1cHBlcihOYW1lKSBlcSAnXCIgKyBncm91cE5hbWUudG9VcHBlckNhc2UoKSArIFwiJykgb3IgUGx1Z2luSWQgZXEgJ1wiICsgZ3JvdXBJZCArIFwiJylcIixcclxuICAgICAgICBpbmNsdWRlOiBbJ2xheW91dCcsICd0YWJsZUFsaWFzZXMnXSxcclxuICAgICAgICBpZFByb3BlcnR5OiAnJGtleScsXHJcbiAgICAgICAgYXBwbGljYXRpb25OYW1lOiAnc2x4JyxcclxuICAgICAgICBzY29wZTogdGhpcyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHN0b3JlKSB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5UmVzdWx0cyA9IHN0b3JlLnF1ZXJ5KCk7XHJcblxyXG4gICAgICAoZnVuY3Rpb24gcXVlcnlXaGVuKGNvbnRleHQsIHF1ZXJ5UmVzdWx0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHdoZW4ocXVlcnlSZXN1bHQsIGZ1bmN0aW9uIHF1ZXJ5UmVzdWx0Rm4oZ3JvdXBGZWVkKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb25TdWNjZXNzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgb25TdWNjZXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5fb25Hcm91cFJlcXVlc3RTdWNjZXNzKGdyb3VwRmVlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0uYmluZChjb250ZXh0KSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBmZXRjaGluZyBncm91cCBkYXRhOicgKyBlcnJvcik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcclxuICAgICAgICB9XHJcbiAgICAgIH0pKHRoaXMsIHF1ZXJ5UmVzdWx0cyk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBfb25Hcm91cFJlcXVlc3RTdWNjZXNzOiBmdW5jdGlvbiBfb25Hcm91cFJlcXVlc3RTdWNjZXNzKHJlc3VsdCkge1xyXG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGdyb3VwID0gcmVzdWx0WzBdO1xyXG4gICAgICB0aGlzLnNldEN1cnJlbnRHcm91cChncm91cCk7XHJcbiAgICAgIEdyb3VwVXRpbGl0eS5hZGRUb0dyb3VwUHJlZmVyZW5jZXMoW2dyb3VwXSwgdGhpcy5lbnRpdHlOYW1lKTtcclxuICAgICAgdGhpcy5fb25BcHBseUdyb3VwKGdyb3VwKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy5nZXRHcm91cFRpdGxlKCk7XHJcbiAgICAgIEFwcC5zZXRQcmltYXJ5VGl0bGUodGl0bGUpO1xyXG4gICAgICB0aGlzLnNldCgndGl0bGUnLCB0aXRsZSk7XHJcbiAgICAgIHRoaXMuX3NlbGVjdEdyb3VwcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlbG9hZCB0aGUgcmlnaHQgbWVudVxyXG4gICAgdGhpcy5vblRyYW5zaXRpb25Bd2F5KCk7XHJcbiAgICB0aGlzLmxvYWRSaWdodERyYXdlcigpO1xyXG5cclxuICAgIGRvbUNsYXNzLnJlbW92ZSh0aGlzLmRvbU5vZGUsICdsaXN0LWxvYWRpbmcnKTtcclxuICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZTtcclxuICB9LFxyXG4gIF9vbkdyb3VwUmVxdWVzdEZhaWxkOiBmdW5jdGlvbiBfb25Hcm91cFJlcXVlc3RGYWlsZCgpIHtcclxuXHJcbiAgfSxcclxuICBnZXRHcm91cFRpdGxlOiBmdW5jdGlvbiBnZXRHcm91cFRpdGxlKGdyb3VwKSB7XHJcbiAgICByZXR1cm4gZ3JvdXAuZGlzcGxheU5hbWU7XHJcbiAgfSxcclxuICBnZXRJdGVtVGVtcGxhdGU6IGZ1bmN0aW9uIGdldEl0ZW1UZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGxheW91dCA9ICh0aGlzLmVuYWJsZU92ZXJyaWRlTGF5b3V0ICYmIHRoaXMuX292ZXJyaWRlR3JvdXBMYXlvdXQpID8gdGhpcy5fb3ZlcnJpZGVHcm91cExheW91dCA6IHRoaXMubGF5b3V0O1xyXG4gICAgaWYgKHRoaXMuZW5hYmxlRHluYW1pY0dyb3VwTGF5b3V0KSB7XHJcbiAgICAgIGNvbnN0IGxheW91dFRlbXBsYXRlID0gdGhpcy5nZXRTZWxlY3RlZEdyb3VwTGF5b3V0VGVtcGxhdGUoKTtcclxuICAgICAgaWYgKGxheW91dFRlbXBsYXRlKSB7XHJcbiAgICAgICAgaWYgKGxheW91dFRlbXBsYXRlLnR5cGUgPT09ICdEeW5hbWljJykge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RHluYW1pY0xheW91dEl0ZW1UZW1wbGF0ZShsYXlvdXQsIGxheW91dFRlbXBsYXRlLm9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobGF5b3V0VGVtcGxhdGUudGVtcGxhdGUpIHtcclxuICAgICAgICAgIHJldHVybiBuZXcgU2ltcGxhdGUobGF5b3V0VGVtcGxhdGUudGVtcGxhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGhpcy5kZWZhdWx0R3JvdXBMYXlvdXRJdGVtVGVtcGxhdGU7XHJcbiAgICB9XHJcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGxheW91dC5tYXAodGhpcy5nZXRJdGVtTGF5b3V0VGVtcGxhdGUpO1xyXG4gICAgcmV0dXJuIG5ldyBTaW1wbGF0ZSh0ZW1wbGF0ZSk7XHJcbiAgfSxcclxuICBnZXRJdGVtTGF5b3V0VGVtcGxhdGU6IGZ1bmN0aW9uIGdldEl0ZW1MYXlvdXRUZW1wbGF0ZShpdGVtKSB7XHJcbiAgICBjb25zdCBqc29uU3RyaW5nID0ganNvbi5zdHJpbmdpZnkoaXRlbSk7XHJcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IFsnPGg0PjxzcGFuIGNsYXNzPVwiZ3JvdXAtbGFiZWxcIj4nLCBpdGVtLmNhcHRpb24sICc8L3NwYW4+IDxzcGFuIGNsYXNzPVwiZ3JvdXAtZW50cnlcIj57JT0gJCQuZ3JvdXBUcmFuc2Zvcm1WYWx1ZSgkWyQkLmdldEZpZWxkTmFtZUJ5TGF5b3V0KCcgKyBqc29uU3RyaW5nICsgJyldLCcgKyBqc29uU3RyaW5nICsgJywkJC5nZXRGb3JtYXR0ZXJCeUxheW91dCgnICsganNvblN0cmluZyArICcpKSAlfTwvc3Bhbj4nLCAnPC9oND4nXS5qb2luKCcnKTtcclxuXHJcbiAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgfSxcclxuICBkZWZhdWx0R3JvdXBMYXlvdXRJdGVtVGVtcGxhdGU6IG5ldyBTaW1wbGF0ZShbXHJcbiAgICAnPGRpdj48aDI+PHNwYW4gY2xhc3M9XCJncm91cC1lbnRyeS1oZWFkZXJcIj57JT0gJCQuZ2V0R3JvdXBGaWVsZFZhbHVlQnlJbmRleCgkLCAwLCB0cnVlKSAlfTwvc3Bhbj48L2gyPjwvZGl2PicsXHJcbiAgICAnPGg0PjxzcGFuIGNsYXNzPVwiZ3JvdXAtbGFiZWxcIj57JT0gJCQuZ2V0R3JvdXBGaWVsZExhYmVsQnlJbmRleCgxKSAlfSA8L3NwYW4+PHNwYW4gY2xhc3M9XCJncm91cC1lbnRyeVwiPnslPSAkJC5nZXRHcm91cEZpZWxkVmFsdWVCeUluZGV4KCQsIDEsIHRydWUpICV9PC9zcGFuPjwvaDQ+JyxcclxuICAgICc8aDQ+PHNwYW4gY2xhc3M9XCJncm91cC1sYWJlbFwiPnslPSAkJC5nZXRHcm91cEZpZWxkTGFiZWxCeUluZGV4KDIpICV9IDwvc3Bhbj48c3BhbiBjbGFzcz1cImdyb3VwLWVudHJ5XCI+eyU9ICQkLmdldEdyb3VwRmllbGRWYWx1ZUJ5SW5kZXgoJCwgMiwgdHJ1ZSkgJX08L3NwYW4+PC9oND4nLFxyXG4gIF0pLFxyXG4gIGNyZWF0ZUdyb3VwVGVtcGxhdGVMYXlvdXRzOiBmdW5jdGlvbiBjcmVhdGVHcm91cFRlbXBsYXRlTGF5b3V0cygpIHtcclxuICAgIHRoaXMuZ3JvdXBUZW1wbGF0ZUxheW91dHMgPSBbe1xyXG4gICAgICBuYW1lOiAnU3VtbWFyeScsXHJcbiAgICAgIGRpc3BsYXlOYW1lOiByZXNvdXJjZS5ncm91cFRlbXBsYXRlU3VtbWFyeVRleHQsXHJcbiAgICAgIHR5cGU6ICdEeW5hbWljJyxcclxuICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgIGNvbHVtbnM6IFt7XHJcbiAgICAgICAgICBpZDogJ2NvbDEnLFxyXG4gICAgICAgICAgcm93czogMyxcclxuICAgICAgICB9XSxcclxuICAgICAgfSxcclxuICAgIH0sIHtcclxuICAgICAgbmFtZTogJ0RldGFpbCcsXHJcbiAgICAgIGRpc3BsYXlOYW1lOiByZXNvdXJjZS5ncm91cFRlbXBsYXRlRGV0YWlsVGV4dCxcclxuICAgICAgdHlwZTogJ0R5bmFtaWMnLFxyXG4gICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgY29sdW1uczogW3tcclxuICAgICAgICAgIGlkOiAnY29sMScsXHJcbiAgICAgICAgICByb3dzOiAzLFxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIGlkOiAnY29sMicsXHJcbiAgICAgICAgICByb3dzOiAzLFxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIGlkOiAnY29sMycsXHJcbiAgICAgICAgICByb3dzOiAzLFxyXG4gICAgICAgIH1dLFxyXG4gICAgICB9LFxyXG4gICAgfV07XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZ3JvdXBUZW1wbGF0ZUxheW91dHM7XHJcbiAgfSxcclxuICBnZXRTZWxlY3RlZEdyb3VwTGF5b3V0VGVtcGxhdGU6IGZ1bmN0aW9uIGdldFNlbGVjdGVkR3JvdXBMYXlvdXRUZW1wbGF0ZSgpIHtcclxuICAgIGxldCBuYW1lID0gR3JvdXBVdGlsaXR5LmdldFNlbGVjdGVkR3JvdXBMYXlvdXRUZW1wbGF0ZSh0aGlzLmVudGl0eU5hbWUpO1xyXG4gICAgbmFtZSA9IChuYW1lKSA/IG5hbWUgOiAnJztcclxuICAgIGxldCBsYXlvdXRUZW1wbGF0ZSA9IG51bGw7XHJcbiAgICB0aGlzLmdyb3VwVGVtcGxhdGVMYXlvdXRzLmZvckVhY2goZnVuY3Rpb24gc2V0TGF5b3V0VGVtcGxhdGUoaXRlbSkge1xyXG4gICAgICBpZiAoaXRlbS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgbGF5b3V0VGVtcGxhdGUgPSBpdGVtO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmICghbGF5b3V0VGVtcGxhdGUpIHtcclxuICAgICAgbGF5b3V0VGVtcGxhdGUgPSB0aGlzLmdyb3VwVGVtcGxhdGVMYXlvdXRzWzBdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxheW91dFRlbXBsYXRlO1xyXG4gIH0sXHJcbiAgY3JlYXRlR3JvdXBUZW1wbGF0ZXM6IGZ1bmN0aW9uIGNyZWF0ZUdyb3VwVGVtcGxhdGVzKCkge1xyXG4gICAgdGhpcy5ncm91cFRlbXBsYXRlTGF5b3V0cyA9IHRoaXMuX2NyZWF0ZUN1c3RvbWl6ZWRMYXlvdXQodGhpcy5jcmVhdGVHcm91cFRlbXBsYXRlTGF5b3V0cygpLCAnZ3JvdXAtdGVtcGxhdGVzJyk7XHJcbiAgfSxcclxuICBnZXREeW5hbWljTGF5b3V0SXRlbVRlbXBsYXRlOiBmdW5jdGlvbiBnZXREeW5hbWljTGF5b3V0SXRlbVRlbXBsYXRlKGxheW91dCwgb3B0aW9ucykge1xyXG4gICAgY29uc3QgbGF5b3V0T3B0aW9ucyA9IHRoaXMuYXBwbHlEeW5hbWljTGF5b3V0T3B0aW9ucyhvcHRpb25zKTtcclxuICAgIGxldCByb3dzID0gMDtcclxuICAgIGxldCBjb2x1bW5zID0gMTtcclxuICAgIGxldCBjb2x1bW4gPSAxO1xyXG4gICAgbGV0IHJvdyA9IDE7XHJcbiAgICBjb2x1bW5zID0gbGF5b3V0T3B0aW9ucy5jb2x1bW5zLmxlbmd0aDtcclxuICAgIGxheW91dE9wdGlvbnMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIGluY3JlbWVudFJvd3MoaXRlbSkge1xyXG4gICAgICByb3dzID0gcm93cyArIGl0ZW0ucm93cztcclxuICAgIH0pO1xyXG4gICAgY29uc3QgY29sdW1uV2lkdGggPSB1dGlsaXR5LnJvdW5kTnVtYmVyVG8oKDEwMCAvIGNvbHVtbnMpLCAwKTtcclxuXHJcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IFtdO1xyXG4gICAgdGVtcGxhdGUucHVzaCgnPGRpdiBjbGFzcz1cImdyb3VwLWl0ZW1cIj4nKTtcclxuICAgIHRlbXBsYXRlLnB1c2goJzxkaXYgY2xhc3M9XCJncm91cC1pdGVtLWhlYWRlclwiPicpO1xyXG4gICAgdGVtcGxhdGUucHVzaCgnPGgyPjxzcGFuIGNsYXNzPVwiZ3JvdXAtZW50cnktaGVhZGVyXCI+eyU9ICQkLmdldEdyb3VwRmllbGRWYWx1ZUJ5TmFtZSgkLFwiJyArIGxheW91dFswXS5wcm9wZXJ0eVBhdGggKyAnXCIsIHRydWUpICV9PC9zcGFuPjwvaDI+Jyk7XHJcbiAgICB0ZW1wbGF0ZS5wdXNoKCc8L2RpdlwiPicpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXlvdXQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgY29sdW1uSXRlbSA9IGxheW91dE9wdGlvbnMuY29sdW1uc1tjb2x1bW4gLSAxXTtcclxuICAgICAgaWYgKChjb2x1bW5JdGVtKSAmJiAoY29sdW1uIDw9IGNvbHVtbnMpICYmIChpICE9PSAwKSkge1xyXG4gICAgICAgIGlmIChyb3cgPT09IDEpIHtcclxuICAgICAgICAgIGNvbnN0IGNvbHVtblN0eWxlID0gY29sdW1uSXRlbS5zdHlsZSB8fCAnd2lkdGg6JyArIGNvbHVtbldpZHRoICsgJyU7JztcclxuICAgICAgICAgIGNvbnN0IGNvbHVtbkNsYXNzID0gY29sdW1uSXRlbS5jbHNzIHx8ICcnO1xyXG4gICAgICAgICAgdGVtcGxhdGUucHVzaCgnPGRpdiBjbGFzcz1cImdyb3VwLWNvbHVtbiAnICsgY29sdW1uQ2xhc3MgKyAnXCIgIHN0eWxlPVwiJyArIGNvbHVtblN0eWxlICsgJ1wiPicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpdGVtID0gbGF5b3V0W2ldO1xyXG4gICAgICAgIGlmIChpdGVtICYmIChjb2x1bW5JdGVtLnJvd3MgPiAwKSkge1xyXG4gICAgICAgICAgaWYgKGkgIT09IDApIHtcclxuICAgICAgICAgICAgdGVtcGxhdGUucHVzaCgnPGgzPicpO1xyXG4gICAgICAgICAgICBpZiAoIWNvbHVtbkl0ZW0uaGlkZUxhYmVscykge1xyXG4gICAgICAgICAgICAgIHRlbXBsYXRlLnB1c2goJzxzcGFuIGNsYXNzPVwiZ3JvdXAtbGFiZWxcIj4nICsgdGhpcy5nZXRHcm91cEZpZWxkTGFiZWxCeU5hbWUoaXRlbS5wcm9wZXJ0eVBhdGgpICsgJyA8L3NwYW4+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdE9wdGlvbnMgPSB0aGlzLmdldEdyb3VwRmllbGRGb3JtYXRPcHRpb25zKGl0ZW0pO1xyXG4gICAgICAgICAgICBjb25zdCBmb3JtYXRDbHNzID0gZm9ybWF0T3B0aW9ucy5jbHNzIHx8ICcnO1xyXG4gICAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0ganNvbi5zdHJpbmdpZnkoZm9ybWF0T3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmZvcm1hdCA9PT0gJ1Bob25lJykge1xyXG4gICAgICAgICAgICAgIHRlbXBsYXRlLnB1c2goJzxzcGFuIGNsYXNzPVwiaHJlZlwiIGRhdGEtYWN0aW9uPVwiZ3JvdXBJbnZva2VMaXN0QWN0aW9uXCIgZGF0YS1uYW1lPVwiY2FsbFBob25lXCIgZGF0YS1rZXk9XCJ7JTokJC5nZXRHcm91cEl0ZW1LZXkoJCklfVwiIGRhdGEtcHJvcGVydHluYW1lPVwiJyArIGl0ZW0ucHJvcGVydHlQYXRoICsgJ1wiPnslPSAkJC5nZXRHcm91cEZpZWxkVmFsdWVCeU5hbWUoJCxcIicgKyBpdGVtLnByb3BlcnR5UGF0aCArICdcIiwgdHJ1ZSwnICsganNvblN0cmluZyArICcpICV9PC9zcGFuPicpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0ucHJvcGVydHlQYXRoID09PSAnRW1haWwnKSB7XHJcbiAgICAgICAgICAgICAgdGVtcGxhdGUucHVzaCgnPHNwYW4gY2xhc3M9XCJocmVmXCIgZGF0YS1hY3Rpb249XCJncm91cEludm9rZUxpc3RBY3Rpb25cIiBkYXRhLW5hbWU9XCJzZW5kRW1haWxcIiBkYXRhLWtleT1cInslOiQkLmdldEdyb3VwSXRlbUtleSgkKSV9XCIgZGF0YS1wcm9wZXJ0eW5hbWU9XCInICsgaXRlbS5wcm9wZXJ0eVBhdGggKyAnXCI+eyU9ICQkLmdldEdyb3VwRmllbGRWYWx1ZUJ5TmFtZSgkLFwiJyArIGl0ZW0ucHJvcGVydHlQYXRoICsgJ1wiLCB0cnVlLCcgKyBqc29uU3RyaW5nICsgJykgJX08L3NwYW4+Jyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGVtcGxhdGUucHVzaCgnPHNwYW4gY2xhc3M9XCJncm91cC1lbnRyeSAnICsgZm9ybWF0Q2xzcyArICdcIj57JT0gJCQuZ2V0R3JvdXBGaWVsZFZhbHVlQnlOYW1lKCQsXCInICsgaXRlbS5wcm9wZXJ0eVBhdGggKyAnXCIsIHRydWUsJyArIGpzb25TdHJpbmcgKyAnKSAlfTwvc3Bhbj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0ZW1wbGF0ZS5wdXNoKCc8L2gzPicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByb3crKztcclxuICAgICAgICBpZiAocm93ID09PSBjb2x1bW5JdGVtLnJvd3MgKyAxKSB7XHJcbiAgICAgICAgICByb3cgPSAxO1xyXG4gICAgICAgICAgY29sdW1uKys7XHJcbiAgICAgICAgICB0ZW1wbGF0ZS5wdXNoKCc8L2Rpdj4nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChyb3cgIT09IDEpIHtcclxuICAgICAgdGVtcGxhdGUucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICB9XHJcbiAgICB0ZW1wbGF0ZS5wdXNoKCc8L2Rpdj4nKTtcclxuICAgIHJldHVybiBuZXcgU2ltcGxhdGUodGVtcGxhdGUpO1xyXG4gIH0sXHJcbiAgYXBwbHlEeW5hbWljTGF5b3V0T3B0aW9uczogZnVuY3Rpb24gYXBwbHlEeW5hbWljTGF5b3V0T3B0aW9ucyhvcHRpb25zKSB7XHJcbiAgICBjb25zdCBsYXlvdXRPcHRpb25zID0ge1xyXG4gICAgICBjb2x1bW5zOiBbe1xyXG4gICAgICAgIHJvd3M6IDMsXHJcbiAgICAgIH1dLFxyXG4gICAgfTtcclxuICAgIGxhbmcubWl4aW4obGF5b3V0T3B0aW9ucywgb3B0aW9ucyk7XHJcbiAgICByZXR1cm4gbGF5b3V0T3B0aW9ucztcclxuICB9LFxyXG4gIGdldEdyb3VwSXRlbUtleTogZnVuY3Rpb24gZ2V0R3JvdXBJdGVtS2V5KGdyb3VwRW50cnkpIHtcclxuICAgIHJldHVybiBncm91cEVudHJ5W3RoaXMuaWRQcm9wZXJ0eV07XHJcbiAgfSxcclxuICBnZXRHcm91cEZpZWxkRm9ybWF0T3B0aW9uczogZnVuY3Rpb24gZ2V0R3JvdXBGaWVsZEZvcm1hdE9wdGlvbnMobGF5b3V0SXRlbSkge1xyXG4gICAgY29uc3QgZm9ybWF0dGVyID0gdGhpcy5nZXRGb3JtYXR0ZXJCeUxheW91dChsYXlvdXRJdGVtKTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIGZvcm1hdFN0cmluZzogKGZvcm1hdHRlciAmJiBmb3JtYXR0ZXIuZm9ybWF0U3RyaW5nKSA/IGZvcm1hdHRlci5mb3JtYXRTdHJpbmcgOiBudWxsLFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoKGZvcm1hdHRlciAmJiBmb3JtYXR0ZXIub3B0aW9ucykpIHtcclxuICAgICAgbGFuZy5taXhpbihvcHRpb25zLCBmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3B0aW9ucztcclxuICB9LFxyXG4gIGdldEdyb3VwRmllbGRMYWJlbEJ5TmFtZTogZnVuY3Rpb24gZ2V0R3JvdXBGaWVsZExhYmVsQnlOYW1lKG5hbWUpIHtcclxuICAgIGNvbnN0IGxheW91dCA9ICh0aGlzLmVuYWJsZU92ZXJyaWRlTGF5b3V0ICYmIHRoaXMuX292ZXJyaWRlR3JvdXBMYXlvdXQpID8gdGhpcy5fb3ZlcnJpZGVHcm91cExheW91dCA6IHRoaXMubGF5b3V0O1xyXG4gICAgbGV0IGxheW91dEl0ZW0gPSBudWxsO1xyXG4gICAgbGF5b3V0LmZvckVhY2goZnVuY3Rpb24gc2V0TGF5b3V0SXRlbShpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtLnByb3BlcnR5UGF0aCA9PT0gbmFtZSkge1xyXG4gICAgICAgIGxheW91dEl0ZW0gPSBpdGVtO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmIChsYXlvdXRJdGVtKSB7XHJcbiAgICAgIHJldHVybiBsYXlvdXRJdGVtLmNhcHRpb247XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfSxcclxuICBnZXRHcm91cEZpZWxkVmFsdWVCeU5hbWU6IGZ1bmN0aW9uIGdldEdyb3VwRmllbGRWYWx1ZUJ5TmFtZShlbnRyeSwgbmFtZSwgYXBwbHlGb3JtYXQsIGZvcm1hdE9wdGlvbnMpIHtcclxuICAgIGNvbnN0IGxheW91dCA9ICh0aGlzLmVuYWJsZU92ZXJyaWRlTGF5b3V0ICYmIHRoaXMuX292ZXJyaWRlR3JvdXBMYXlvdXQpID8gdGhpcy5fb3ZlcnJpZGVHcm91cExheW91dCA6IHRoaXMubGF5b3V0O1xyXG4gICAgbGV0IGxheW91dEl0ZW0gPSBudWxsO1xyXG4gICAgbGF5b3V0LmZvckVhY2goZnVuY3Rpb24gc2V0TGF5b3V0SXRlbShpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtLnByb3BlcnR5UGF0aCA9PT0gbmFtZSkge1xyXG4gICAgICAgIGxheW91dEl0ZW0gPSBpdGVtO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLmdldEdyb3VwRmllbGRWYWx1ZShlbnRyeSwgbGF5b3V0SXRlbSwgYXBwbHlGb3JtYXQsIGZvcm1hdE9wdGlvbnMpO1xyXG4gIH0sXHJcbiAgZ2V0R3JvdXBGaWVsZExhYmVsQnlJbmRleDogZnVuY3Rpb24gZ2V0R3JvdXBGaWVsZExhYmVsQnlJbmRleChsYXlvdXRJbmRleCkge1xyXG4gICAgY29uc3QgbGF5b3V0ID0gKHRoaXMuZW5hYmxlT3ZlcnJpZGVMYXlvdXQgJiYgdGhpcy5fb3ZlcnJpZGVHcm91cExheW91dCkgPyB0aGlzLl9vdmVycmlkZUdyb3VwTGF5b3V0IDogdGhpcy5sYXlvdXQ7XHJcbiAgICBpZiAobGF5b3V0W2xheW91dEluZGV4XSkge1xyXG4gICAgICByZXR1cm4gbGF5b3V0W2xheW91dEluZGV4XS5jYXB0aW9uO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH0sXHJcbiAgZ2V0R3JvdXBGaWVsZFZhbHVlQnlJbmRleDogZnVuY3Rpb24gZ2V0R3JvdXBGaWVsZFZhbHVlQnlJbmRleChlbnRyeSwgbGF5b3V0SW5kZXgsIGFwcGx5Rm9ybWF0LCBmb3JtYXRPcHRpb25zKSB7XHJcbiAgICBjb25zdCBsYXlvdXQgPSAodGhpcy5lbmFibGVPdmVycmlkZUxheW91dCAmJiB0aGlzLl9vdmVycmlkZUdyb3VwTGF5b3V0KSA/IHRoaXMuX292ZXJyaWRlR3JvdXBMYXlvdXQgOiB0aGlzLmxheW91dDtcclxuICAgIGNvbnN0IGxheW91dEl0ZW0gPSBsYXlvdXRbbGF5b3V0SW5kZXhdO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0R3JvdXBGaWVsZFZhbHVlKGVudHJ5LCBsYXlvdXRJdGVtLCBhcHBseUZvcm1hdCwgZm9ybWF0T3B0aW9ucyk7XHJcbiAgfSxcclxuICBnZXRHcm91cEZpZWxkVmFsdWU6IGZ1bmN0aW9uIGdldEdyb3VwRmllbGRWYWx1ZShlbnRyeSwgbGF5b3V0SXRlbSwgYXBwbHlGb3JtYXQsIGZvcm1hdE9wdGlvbnMpIHtcclxuICAgIGxldCB2YWx1ZSA9IG51bGw7XHJcbiAgICBsZXQgZm9ybWF0dGVyID0gbnVsbDtcclxuXHJcbiAgICBpZiAoKGxheW91dEl0ZW0pICYmIChhcHBseUZvcm1hdCkpIHtcclxuICAgICAgY29uc3QgZmllbGROYW1lID0gdGhpcy5nZXRGaWVsZE5hbWVCeUxheW91dChsYXlvdXRJdGVtKTtcclxuICAgICAgaWYgKGFwcGx5Rm9ybWF0KSB7XHJcbiAgICAgICAgZm9ybWF0dGVyID0gdGhpcy5nZXRGb3JtYXR0ZXJCeUxheW91dChsYXlvdXRJdGVtKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZm9ybWF0dGVyKSB7XHJcbiAgICAgICAgdmFsdWUgPSB0aGlzLmdyb3VwVHJhbnNmb3JtVmFsdWUoZW50cnlbZmllbGROYW1lXSwgbGF5b3V0SXRlbSwgZm9ybWF0dGVyLCBmb3JtYXRPcHRpb25zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB2YWx1ZSA9IGVudHJ5W2ZpZWxkTmFtZV07XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAobGF5b3V0SXRlbSkge1xyXG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSB0aGlzLmdldEZpZWxkTmFtZUJ5TGF5b3V0KGxheW91dEl0ZW0pO1xyXG4gICAgICB2YWx1ZSA9IGVudHJ5W2ZpZWxkTmFtZV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YWx1ZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH0sXHJcbiAgZ2V0Rm9ybWF0dGVyQnlMYXlvdXQ6IGZ1bmN0aW9uIGdldEZvcm1hdHRlckJ5TGF5b3V0KGxheW91dEl0ZW0pIHtcclxuICAgIGlmICghdGhpcy5fZmllbGRGb3JtYXR0ZXJzKSB7XHJcbiAgICAgIHRoaXMuX2ZpZWxkRm9ybWF0dGVycyA9IHt9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgcGF0aCA9IGxheW91dEl0ZW0ucHJvcGVydHlQYXRoICsgJ18nICsgbGF5b3V0SXRlbS5pbmRleDtcclxuICAgIGxldCBmb3JtYXR0ZXIgPSB0aGlzLl9maWVsZEZvcm1hdHRlcnNbcGF0aF07XHJcbiAgICBpZiAoIWZvcm1hdHRlcikge1xyXG4gICAgICBmb3JtYXR0ZXIgPSB0aGlzLmdldEdyb3VwRmllbGRGb3JtYXR0ZXIobGF5b3V0SXRlbSk7XHJcbiAgICAgIHRoaXMuX2ZpZWxkRm9ybWF0dGVyc1twYXRoXSA9IGZvcm1hdHRlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBmb3JtYXR0ZXI7XHJcbiAgfSxcclxuICBnZXRHcm91cEZpZWxkRm9ybWF0dGVyOiBmdW5jdGlvbiBnZXRHcm91cEZpZWxkRm9ybWF0dGVyKGxheW91dEl0ZW0pIHtcclxuICAgIGxldCBmb3JtYXR0ZXI7XHJcbiAgICBpZiAodGhpcy5ncm91cEZpZWxkRm9ybWF0dGVyKSB7XHJcbiAgICAgIGZvcm1hdHRlciA9IHRoaXMuZ3JvdXBGaWVsZEZvcm1hdHRlcltsYXlvdXRJdGVtLnByb3BlcnR5UGF0aF07XHJcbiAgICB9XHJcbiAgICBpZiAoIWZvcm1hdHRlcikge1xyXG4gICAgICBmb3JtYXR0ZXIgPSBHcm91cFV0aWxpdHkuZ2V0Rm9ybWF0dGVyQnlMYXlvdXQobGF5b3V0SXRlbSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZm9ybWF0dGVyO1xyXG4gIH0sXHJcbiAgZ3JvdXBUcmFuc2Zvcm1WYWx1ZTogZnVuY3Rpb24gZ3JvdXBUcmFuc2Zvcm1WYWx1ZSh2YWx1ZSwgbGF5b3V0LCBmb3JtYXR0ZXIsIGZvcm1hdE9wdGlvbnMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHJldHVybiBmb3JtYXR0ZXIuZm9ybWF0dGVyKHZhbHVlLCBmb3JtYXR0ZXIuZm9ybWF0U3RyaW5nLCBmb3JtYXRPcHRpb25zKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgZ2V0RmllbGROYW1lQnlMYXlvdXQ6IGZ1bmN0aW9uIGdldEZpZWxkTmFtZUJ5TGF5b3V0KGxheW91dEl0ZW0pIHtcclxuICAgIHJldHVybiBHcm91cFV0aWxpdHkuZ2V0RmllbGROYW1lQnlMYXlvdXQobGF5b3V0SXRlbSk7XHJcbiAgfSxcclxuICBfc3RhcnRHcm91cE1vZGU6IGZ1bmN0aW9uIF9zdGFydEdyb3VwTW9kZSgpIHtcclxuICAgIGlmICh0aGlzLl9vcmlnaW5hbFByb3BzKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9vcmlnaW5hbFByb3BzID0ge307XHJcblxyXG4gICAgY29uc3Qgb3JpZ2luYWwgPSB0aGlzLl9vcmlnaW5hbFByb3BzO1xyXG5cclxuICAgIG9yaWdpbmFsLnJlcXVlc3QgPSB0aGlzLnJlcXVlc3QgPyB0aGlzLnJlcXVlc3QuY2xvbmUoKSA6IG51bGw7XHJcbiAgICBvcmlnaW5hbC5xdWVyeVNlbGVjdCA9IHRoaXMucXVlcnlTZWxlY3Q7XHJcbiAgICBvcmlnaW5hbC5xdWVyeU9yZGVyQnkgPSB0aGlzLnF1ZXJ5T3JkZXJCeTtcclxuICAgIG9yaWdpbmFsLmlkUHJvcGVydHkgPSB0aGlzLmlkUHJvcGVydHk7XHJcbiAgICBvcmlnaW5hbC5sYWJlbFByb3BlcnR5ID0gdGhpcy5sYWJlbFByb3BlcnR5O1xyXG4gICAgb3JpZ2luYWwuc3RvcmUgPSB0aGlzLnN0b3JlO1xyXG4gICAgb3JpZ2luYWwucm93VGVtcGxhdGUgPSB0aGlzLnJvd1RlbXBsYXRlO1xyXG4gICAgb3JpZ2luYWwuaXRlbVRlbXBsYXRlID0gdGhpcy5pdGVtVGVtcGxhdGU7XHJcbiAgICBvcmlnaW5hbC5pdGVtRm9vdGVyVGVtcGxhdGUgPSB0aGlzLml0ZW1Gb290ZXJUZW1wbGF0ZTtcclxuICAgIG9yaWdpbmFsLnJlbGF0ZWRWaWV3cyA9IHRoaXMucmVsYXRlZFZpZXdzO1xyXG4gICAgb3JpZ2luYWwudGl0bGUgPSB0aGlzLmdldCgndGl0bGUnKTtcclxuICAgIG9yaWdpbmFsLl9tb2RlbCA9IHRoaXMuX21vZGVsO1xyXG5cclxuICAgIHRoaXMuX21vZGVsID0gbnVsbDtcclxuICAgIHRoaXMuaXRlbUZvb3RlclRlbXBsYXRlID0gbmV3IFNpbXBsYXRlKFsnPGRpdj48L2Rpdj4nXSk7XHJcblxyXG4gICAgdGhpcy5ncm91cHNNb2RlID0gdHJ1ZTtcclxuICB9LFxyXG4gIF9jbGVhckdyb3VwTW9kZTogZnVuY3Rpb24gX2NsZWFyR3JvdXBNb2RlKCkge1xyXG4gICAgY29uc3Qgb3JpZ2luYWwgPSB0aGlzLl9vcmlnaW5hbFByb3BzO1xyXG5cclxuICAgIHRoaXMuZ3JvdXBzTW9kZSA9IGZhbHNlO1xyXG5cclxuICAgIGlmICghb3JpZ2luYWwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucmVxdWVzdCA9IG9yaWdpbmFsLnJlcXVlc3QgfHwgbnVsbDtcclxuICAgIHRoaXMucXVlcnlTZWxlY3QgPSBvcmlnaW5hbC5xdWVyeVNlbGVjdDtcclxuICAgIHRoaXMucXVlcnlPcmRlckJ5ID0gb3JpZ2luYWwucXVlcnlPcmRlckJ5O1xyXG4gICAgdGhpcy5pZFByb3BlcnR5ID0gb3JpZ2luYWwuaWRQcm9wZXJ0eTtcclxuICAgIHRoaXMubGFiZWxQcm9wZXJ0eSA9IG9yaWdpbmFsLmxhYmVsUHJvcGVydHk7XHJcbiAgICB0aGlzLnNldCgnc3RvcmUnLCBvcmlnaW5hbC5zdG9yZSk7XHJcbiAgICB0aGlzLnJvd1RlbXBsYXRlID0gb3JpZ2luYWwucm93VGVtcGxhdGU7XHJcbiAgICB0aGlzLml0ZW1UZW1wbGF0ZSA9IG9yaWdpbmFsLml0ZW1UZW1wbGF0ZTtcclxuICAgIHRoaXMucmVsYXRlZFZpZXdzID0gb3JpZ2luYWwucmVsYXRlZFZpZXdzO1xyXG4gICAgdGhpcy5pdGVtRm9vdGVyVGVtcGxhdGUgPSBvcmlnaW5hbC5pdGVtRm9vdGVyVGVtcGxhdGU7XHJcbiAgICB0aGlzLl9tb2RlbCA9IG9yaWdpbmFsLl9tb2RlbDtcclxuXHJcbiAgICB0aGlzLl9vcmlnaW5hbFByb3BzID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLl9ncm91cEluaXRpYWxpemVkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9jdXJyZW50R3JvdXAgPSBudWxsO1xyXG4gICAgdGhpcy5jdXJyZW50R3JvdXBJZCA9IG51bGw7XHJcbiAgICBBcHAuc2V0UHJpbWFyeVRpdGxlKG9yaWdpbmFsLnRpdGxlKTtcclxuICAgIHRoaXMuc2V0KCd0aXRsZScsIG9yaWdpbmFsLnRpdGxlKTtcclxuXHJcbiAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICB0aGlzLnJlZnJlc2hSZXF1aXJlZCA9IHRydWU7XHJcbiAgfSxcclxuICBfb25RdWVyeUVycm9yOiBmdW5jdGlvbiBfb25RdWVyeUVycm9yKHF1ZXJ5T3B0aW9ucywgZXJyb3IpIHtcclxuICAgIGlmICh0aGlzLmdyb3Vwc0VuYWJsZWQgJiYgdGhpcy5ncm91cHNNb2RlKSB7XHJcbiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwNCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB0aGlzLl9vbkdyb3VwTm90Rm91bmQoKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmluaGVyaXRlZChhcmd1bWVudHMpO1xyXG4gIH0sXHJcbiAgX29uR3JvdXBOb3RGb3VuZDogZnVuY3Rpb24gX29uR3JvdXBOb3RGb3VuZCgpIHtcclxuICAgIEdyb3VwVXRpbGl0eS5yZW1vdmVHcm91cFByZWZlcmVuY2VzKHRoaXMuY3VycmVudEdyb3VwSWQsIHRoaXMuZW50aXR5TmFtZSk7XHJcbiAgICB0aGlzLnJlZnJlc2hSaWdodERyYXdlcigpO1xyXG4gICAgZG9tQ2xhc3MucmVtb3ZlKHRoaXMuZG9tTm9kZSwgJ2xpc3QtbG9hZGluZycpO1xyXG4gICAgdGhpcy5zZXQoJ2xpc3RDb250ZW50JywgdGhpcy5jdXJyZW50R291cE5vdEZvdW5kVGVtcGxhdGUuYXBwbHkodGhpcykpO1xyXG4gIH0sXHJcbiAgYWN0aXZhdGVFbnRyeTogZnVuY3Rpb24gYWN0aXZhdGVFbnRyeShwYXJhbXMpIHtcclxuICAgIGlmICh0aGlzLmdyb3Vwc0VuYWJsZWQgJiYgdGhpcy5ncm91cHNNb2RlICYmICFwYXJhbXMucmVzb2x2ZWQpIHtcclxuICAgICAgdGhpcy5fZ3JvdXBBY3RpdmF0ZUVudHJ5KHBhcmFtcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmluaGVyaXRlZChhcmd1bWVudHMpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgX2dyb3VwQWN0aXZhdGVFbnRyeTogZnVuY3Rpb24gX2dyb3VwQWN0aXZhdGVFbnRyeShwYXJhbXMpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIGlmIChwYXJhbXMua2V5KSB7XHJcbiAgICAgIGNvbnN0IHJlc29sdmVkRW50cnkgPSB0aGlzLl9nZXRSZXNvbHZlZEVudHJ5KHBhcmFtcy5rZXkpO1xyXG4gICAgICBpZiAoIXJlc29sdmVkRW50cnkpIHtcclxuICAgICAgICB0aGlzLl9mZXRjaFJlc29sdmVkRW50cnkocGFyYW1zLmtleSkudGhlbihmdW5jdGlvbiBwb3N0RmV0Y2hSZXNvbHZlZEVudHJ5KHJlc29sdmVkRW50KSB7XHJcbiAgICAgICAgICBwYXJhbXMuZGVzY3JpcHRvciA9IHJlc29sdmVkRW50LiRkZXNjcmlwdG9yO1xyXG4gICAgICAgICAgcGFyYW1zLnJlc29sdmVkID0gdHJ1ZTtcclxuICAgICAgICAgIHNlbGYuYWN0aXZhdGVFbnRyeShwYXJhbXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBhcmFtcy5kZXNjcmlwdG9yID0gcmVzb2x2ZWRFbnRyeS4kZGVzY3JpcHRvcjtcclxuICAgICAgICBwYXJhbXMucmVzb2x2ZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYWN0aXZhdGVFbnRyeShwYXJhbXMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBfaW52b2tlQWN0aW9uOiBmdW5jdGlvbiBfaW52b2tlQWN0aW9uKHRoZUFjdGlvbiwgc2VsZWN0aW9uKSB7XHJcbiAgICBpZiAodGhpcy5ncm91cHNFbmFibGVkICYmIHRoaXMuZ3JvdXBzTW9kZSAmJiAhc2VsZWN0aW9uLnJlc29sdmVkKSB7XHJcbiAgICAgIHRoaXMuX2dyb3VwSW52b2tlQWN0aW9uKHRoZUFjdGlvbiwgc2VsZWN0aW9uKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBfZ3JvdXBJbnZva2VBY3Rpb246IGZ1bmN0aW9uIF9ncm91cEludm9rZUFjdGlvbih0aGVBY3Rpb24sIHNlbGVjdGlvbikge1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICBjb25zdCByZXNvbHZlZEVudHJ5ID0gdGhpcy5fZ2V0UmVzb2x2ZWRFbnRyeShzZWxlY3Rpb24uZGF0YS4ka2V5KTtcclxuICAgIGlmICghcmVzb2x2ZWRFbnRyeSkge1xyXG4gICAgICB0aGlzLl9mZXRjaFJlc29sdmVkRW50cnkoc2VsZWN0aW9uLmRhdGEuJGtleSkudGhlbihmdW5jdGlvbiBwb3N0RmV0Y2hSZXNvbHZlZEVudHJ5KHJlc29sdmVkRW50KSB7XHJcbiAgICAgICAgc2VsZi5faW52b2tlQWN0aW9uKHRoZUFjdGlvbiwge1xyXG4gICAgICAgICAgZGF0YTogcmVzb2x2ZWRFbnQsXHJcbiAgICAgICAgICByZXNvbHZlZDogdHJ1ZSxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9pbnZva2VBY3Rpb24odGhlQWN0aW9uLCB7XHJcbiAgICAgICAgZGF0YTogcmVzb2x2ZWRFbnRyeSxcclxuICAgICAgICByZXNvbHZlZDogdHJ1ZSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBzaG93QWN0aW9uUGFuZWw6IGZ1bmN0aW9uIHNob3dBY3Rpb25QYW5lbChyb3dOb2RlKSB7XHJcbiAgICBpZiAodGhpcy5ncm91cHNFbmFibGVkICYmIHRoaXMuZ3JvdXBzTW9kZSkge1xyXG4gICAgICB0aGlzLl9ncm91cFNob3dBY3Rpb25QYW5lbChyb3dOb2RlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBfZ3JvdXBTaG93QWN0aW9uUGFuZWw6IGZ1bmN0aW9uIF9ncm91cFNob3dBY3Rpb25QYW5lbChyb3dOb2RlKSB7XHJcbiAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9nZXRDdXJyZW50U2VsZWN0aW9uKCk7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGNvbnN0IHJlc29sdmVkRW50cnkgPSB0aGlzLl9nZXRSZXNvbHZlZEVudHJ5KHNlbGVjdGlvbi5kYXRhLiRrZXkpO1xyXG4gICAgaWYgKCFyZXNvbHZlZEVudHJ5KSB7XHJcbiAgICAgIHRoaXMuX2ZldGNoUmVzb2x2ZWRFbnRyeShzZWxlY3Rpb24uZGF0YS4ka2V5KS50aGVuKGZ1bmN0aW9uIHBvc3RGZXRjaFJlc29sdmVkRW50cnkocmVzb2x2ZWRFbnQpIHtcclxuICAgICAgICBzZWxmLl9ncm91cENoZWNrQWN0aW9uU3RhdGUocmVzb2x2ZWRFbnQpO1xyXG4gICAgICAgIHNlbGYuX2dyb3VwQXBwbHlBY3Rpb25QYW5lbChyb3dOb2RlKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9ncm91cENoZWNrQWN0aW9uU3RhdGUocmVzb2x2ZWRFbnRyeSk7XHJcbiAgICAgIHRoaXMuX2dyb3VwQXBwbHlBY3Rpb25QYW5lbChyb3dOb2RlKTtcclxuICAgIH1cclxuICB9LFxyXG4gIF9ncm91cEFwcGx5QWN0aW9uUGFuZWw6IGZ1bmN0aW9uIF9ncm91cEFwcGx5QWN0aW9uUGFuZWwocm93Tm9kZSkge1xyXG4gICAgZG9tQ2xhc3MuYWRkKHJvd05vZGUsICdsaXN0LWFjdGlvbi1zZWxlY3RlZCcpO1xyXG4gICAgdGhpcy5vbkFwcGx5Um93QWN0aW9uUGFuZWwodGhpcy5hY3Rpb25zTm9kZSwgcm93Tm9kZSk7XHJcbiAgICBkb21Db25zdHJ1Y3QucGxhY2UodGhpcy5hY3Rpb25zTm9kZSwgcm93Tm9kZSwgJ2FmdGVyJyk7XHJcbiAgfSxcclxuICBfZ2V0Q3VycmVudFNlbGVjdGlvbjogZnVuY3Rpb24gX2dldEN1cnJlbnRTZWxlY3Rpb24oKSB7XHJcbiAgICBjb25zdCBzZWxlY3RlZEl0ZW1zID0gdGhpcy5nZXQoJ3NlbGVjdGlvbk1vZGVsJykuZ2V0U2VsZWN0aW9ucygpO1xyXG4gICAgbGV0IHNlbGVjdGlvbjtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIHNlbGVjdGVkSXRlbXMpIHtcclxuICAgICAgaWYgKHNlbGVjdGVkSXRlbXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgIHNlbGVjdGlvbiA9IHNlbGVjdGVkSXRlbXNba2V5XTtcclxuICAgICAgICBzZWxlY3Rpb24uZGF0YS4ka2V5ID0ga2V5O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2VsZWN0aW9uO1xyXG4gIH0sXHJcbiAgX2ZldGNoUmVzb2x2ZWRFbnRyeTogZnVuY3Rpb24gX2ZldGNoUmVzb2x2ZWRFbnRyeShlbnRyeUtleSkge1xyXG4gICAgY29uc3QgZGVmID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIGNvbnN0IHN0b3JlID0gbmV3IFNEYXRhU3RvcmUoe1xyXG4gICAgICBzZXJ2aWNlOiBBcHAuc2VydmljZXMuY3JtLFxyXG4gICAgICByZXNvdXJjZUtpbmQ6IHRoaXMucmVzb3VyY2VLaW5kLFxyXG4gICAgICBjb250cmFjdE5hbWU6IHRoaXMuY29udHJhY3ROYW1lLFxyXG4gICAgICBzY29wZTogdGhpcyxcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBzZWxlY3QgPSB0aGlzLl9vcmlnaW5hbFByb3BzLnF1ZXJ5U2VsZWN0O1xyXG5cclxuICAgIC8vIFVzZSBxdWVyeVNlbGVjdCBmcm9tIHRoZSBtb2RlbCBpZiBhdmFpbGFibGVcclxuICAgIC8vIFRPRE86IEV4cG9zZSBfZ2V0UXVlcnlNb2RlbEJ5TmFtZSBiZXR0ZXIgc29tZWhvd1xyXG4gICAgaWYgKHRoaXMuX29yaWdpbmFsUHJvcHMuX21vZGVsKSB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5TW9kZWwgPSB0aGlzLl9vcmlnaW5hbFByb3BzLl9tb2RlbC5fZ2V0UXVlcnlNb2RlbEJ5TmFtZSgnbGlzdCcpO1xyXG4gICAgICBpZiAocXVlcnlNb2RlbCAmJiBxdWVyeU1vZGVsLnF1ZXJ5U2VsZWN0KSB7XHJcbiAgICAgICAgc2VsZWN0ID0gcXVlcnlNb2RlbC5xdWVyeVNlbGVjdDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHF1ZXJ5T3B0aW9ucyA9IHtcclxuICAgICAgc2VsZWN0OiBzZWxlY3QsXHJcbiAgICAgIHdoZXJlOiBcIklkIGVxICdcIiArIGVudHJ5S2V5ICsgXCInXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHF1ZXJ5UmVzdWx0cyA9IHN0b3JlLnF1ZXJ5KG51bGwsIHF1ZXJ5T3B0aW9ucyk7XHJcblxyXG4gICAgd2hlbihxdWVyeVJlc3VsdHMsIGZ1bmN0aW9uIHBvc3RXaGVuKGZlZWQpIHtcclxuICAgICAgY29uc3QgZW50cnkgPSBmZWVkWzBdO1xyXG4gICAgICBlbnRyeVtzZWxmLmlkUHJvcGVydHldID0gZW50cnkuJGtleTsgLy8gd2UgbmVlZCB0aGlzIGJlY2F1c2UgdGhlIGdyb3VwIGtleSBpcyBkaWZmZXJlbnQsIGFuZCBpdCB1c2VkIGxhdGVyIG9uIHdoZW4gaW52b2tpbmcgYW4gYWN0aW9uO1xyXG4gICAgICBzZWxmLl9hZGRSZXNvbHZlZEVudHJ5KGVudHJ5KTtcclxuICAgICAgZGVmLnJlc29sdmUoZW50cnkpO1xyXG4gICAgfSwgZnVuY3Rpb24gcG9zdFdoZW5FcnJvcihlcnIpIHtcclxuICAgICAgZGVmLnJlamVjdChlcnIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gIH0sXHJcbiAgX2NsZWFyUmVzb2x2ZWRFbnRyeUNhY2hlOiBmdW5jdGlvbiBfY2xlYXJSZXNvbHZlZEVudHJ5Q2FjaGUoKSB7XHJcbiAgICB0aGlzLl9yZXNvbHZlZEVudHJ5Q2FjaGUgPSB7fTtcclxuICB9LFxyXG4gIF9nZXRSZXNvbHZlZEVudHJ5OiBmdW5jdGlvbiBfZ2V0UmVzb2x2ZWRFbnRyeShlbnRyeUtleSkge1xyXG4gICAgaWYgKCF0aGlzLl9yZXNvbHZlZEVudHJ5Q2FjaGUpIHtcclxuICAgICAgdGhpcy5fcmVzb2x2ZWRFbnRyeUNhY2hlID0ge307XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5fcmVzb2x2ZWRFbnRyeUNhY2hlW2VudHJ5S2V5XTtcclxuICB9LFxyXG4gIF9hZGRSZXNvbHZlZEVudHJ5OiBmdW5jdGlvbiBfYWRkUmVzb2x2ZWRFbnRyeShlbnRyeSkge1xyXG4gICAgdGhpcy5fcmVzb2x2ZWRFbnRyeUNhY2hlW2VudHJ5LiRrZXldID0gZW50cnk7XHJcbiAgfSxcclxuICBfZ3JvdXBDaGVja0FjdGlvblN0YXRlOiBmdW5jdGlvbiBfZ3JvdXBDaGVja0FjdGlvblN0YXRlKHJlc29sdmVkRW50cnkpIHtcclxuICAgIGNvbnN0IHJlc29sdmVkU2VsZWN0aW9uID0ge1xyXG4gICAgICBkYXRhOiByZXNvbHZlZEVudHJ5LFxyXG4gICAgfTtcclxuICAgIHRoaXMuX2FwcGx5U3RhdGVUb0FjdGlvbnMocmVzb2x2ZWRTZWxlY3Rpb24pO1xyXG4gIH0sXHJcbiAgb25Ub29sTGF5b3V0Q3JlYXRlZDogZnVuY3Rpb24gb25Ub29sTGF5b3V0Q3JlYXRlZCh0b29scykge1xyXG4gICAgaWYgKCh0b29scyAmJiAhdGhpcy5fcmVmcmVzaEFkZGVkKSAmJiAhd2luZG93LkFwcC5zdXBwb3J0c1RvdWNoKCkpIHtcclxuICAgICAgY29uc3QgcmVmcmVzaFRvb2wgPSB7XHJcbiAgICAgICAgaWQ6ICdyZWZyZXNoJyxcclxuICAgICAgICBjbHM6ICdmYSBmYS1yZWZyZXNoIGZhLWZ3IGZhLWxnJyxcclxuICAgICAgICBhY3Rpb246ICdfcmVmcmVzaExpc3QnLFxyXG5cclxuICAgICAgfTtcclxuICAgICAgaWYgKHRvb2xzLnRiYXIpIHtcclxuICAgICAgICB0b29scy50YmFyLnB1c2gocmVmcmVzaFRvb2wpO1xyXG4gICAgICAgIHRoaXMuX3JlZnJlc2hBZGRlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuaW5oZXJpdGVkKGFyZ3VtZW50cyk7XHJcbiAgfSxcclxuICBfcmVmcmVzaExpc3Q6IGZ1bmN0aW9uIF9yZWZyZXNoTGlzdCgpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKHRoaXMuZ3JvdXBzRW5hYmxlZCAmJiB0aGlzLmdyb3VwTGlzdCAmJiB0aGlzLl9jdXJyZW50R3JvdXApIHtcclxuICAgICAgdGhpcy5fcmVxdWVzdEdyb3VwKHRoaXMuX2N1cnJlbnRHcm91cC5uYW1lLCB0aGlzLl9jdXJyZW50R3JvdXAuJGtleSwgZnVuY3Rpb24gY2hlY2tHcm91cChyZXN1bHRzKSB7XHJcbiAgICAgICAgY29uc3QgZ3JvdXAgPSByZXN1bHRzWzBdO1xyXG4gICAgICAgIGlmIChncm91cCkge1xyXG4gICAgICAgICAgR3JvdXBVdGlsaXR5LmFkZFRvR3JvdXBQcmVmZXJlbmNlcyhbZ3JvdXBdLCB0aGlzLmVudGl0eU5hbWUpO1xyXG4gICAgICAgICAgc2VsZi5zZXRDdXJyZW50R3JvdXAoZ3JvdXApO1xyXG4gICAgICAgICAgdGhpcy5yZWZyZXNoUmlnaHREcmF3ZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNlbGYuY2xlYXIoKTtcclxuICAgICAgICBzZWxmLnJlZnJlc2hSZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgc2VsZi5yZWZyZXNoKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICB0aGlzLnJlZnJlc2hSZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgZ3JvdXBJbnZva2VMaXN0QWN0aW9uOiBmdW5jdGlvbiBncm91cEludm9rZUxpc3RBY3Rpb24ocGFyYW1zKSB7XHJcbiAgICBjb25zdCBrZXkgPSBwYXJhbXMua2V5O1xyXG4gICAgY29uc3QgcHJvcGVydHlOYW1lID0gcGFyYW1zLnByb3BlcnR5bmFtZTtcclxuICAgIGNvbnN0IGFjdGlvbk5hbWUgPSBwYXJhbXMubmFtZTtcclxuICAgIGNvbnN0IHJlc29sdmVkRW50cnkgPSB0aGlzLl9nZXRSZXNvbHZlZEVudHJ5KGtleSk7XHJcbiAgICBpZiAoIXJlc29sdmVkRW50cnkpIHtcclxuICAgICAgdGhpcy5fZmV0Y2hSZXNvbHZlZEVudHJ5KGtleSkudGhlbihmdW5jdGlvbiBzZXRPcHRpb25zZm9yR3JvdXBBY3Rpb24ocmVzb2x2ZWRFbnQpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgICAgICAgIGRhdGE6IHJlc29sdmVkRW50LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5ncm91cEludm9rZUFjdGlvbkJ5TmFtZShhY3Rpb25OYW1lLCBvcHRpb25zKTtcclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgICAgICBkYXRhOiByZXNvbHZlZEVudHJ5LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsXHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMuZ3JvdXBJbnZva2VBY3Rpb25CeU5hbWUoYWN0aW9uTmFtZSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBncm91cEludm9rZUFjdGlvbkJ5TmFtZTogZnVuY3Rpb24gZ3JvdXBJbnZva2VBY3Rpb25CeU5hbWUoYWN0aW9uTmFtZSwgb3B0aW9ucykge1xyXG4gICAgbGV0IG9wdCA9IG9wdGlvbnM7XHJcbiAgICBpZiAoIW9wdCkge1xyXG4gICAgICBvcHQgPSB7fTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAoYWN0aW9uTmFtZSkge1xyXG4gICAgICBjYXNlICdjYWxsUGhvbmUnOlxyXG4gICAgICAgIGFjdGlvbi5jYWxsUGhvbmUuY2FsbCh0aGlzLCBudWxsLCBvcHQuc2VsZWN0aW9uLCBvcHQucHJvcGVydHlOYW1lKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnc2VuZEVtYWlsJzpcclxuICAgICAgICBhY3Rpb24uc2VuZEVtYWlsLmNhbGwodGhpcywgbnVsbCwgb3B0LnNlbGVjdGlvbiwgb3B0LnByb3BlcnR5TmFtZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfSxcclxuICBnZXRDb250ZXh0U25hcFNob3Q6IGZ1bmN0aW9uIGdldENvbnRleHRTbmFwU2hvdChvcHRpb25zKSB7XHJcbiAgICBsZXQgc25hcFNob3Q7XHJcbiAgICBpZiAodGhpcy5fZ3JvdXBJbml0aWFsaXplZCAmJiB0aGlzLmdyb3Vwc01vZGUpIHtcclxuICAgICAgY29uc3QgZW50cnkgPSB0aGlzLmVudHJpZXNbb3B0aW9ucy5rZXldO1xyXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IHRoaXMuaXRlbVJvd0NvbnRhaW5lclRlbXBsYXRlO1xyXG4gICAgICBzbmFwU2hvdCA9IHRlbXBsYXRlLmFwcGx5KGVudHJ5LCB0aGlzKTtcclxuICAgICAgcmV0dXJuIHNuYXBTaG90O1xyXG4gICAgfVxyXG4gICAgc25hcFNob3QgPSB0aGlzLmluaGVyaXRlZChhcmd1bWVudHMpO1xyXG5cclxuICAgIHJldHVybiBzbmFwU2hvdDtcclxuICB9LFxyXG4gIGluaXRNb2RlbDogZnVuY3Rpb24gaW5pdE1vZGVsKCkge1xyXG4gICAgaWYgKCF0aGlzLl9ncm91cEluaXRpYWxpemVkIHx8ICF0aGlzLmdyb3Vwc01vZGUpIHtcclxuICAgICAgdGhpcy5pbmhlcml0ZWQoYXJndW1lbnRzKTtcclxuICAgIH1cclxuICB9LFxyXG59KTtcclxuXHJcbmxhbmcuc2V0T2JqZWN0KCdNb2JpbGUuU2FsZXNMb2dpeC5WaWV3cy5fR3JvdXBMaXN0TWl4aW4nLCBfX2NsYXNzKTtcclxuZXhwb3J0IGRlZmF1bHQgX19jbGFzcztcclxuIl19
</pre>
</body>
</html>
