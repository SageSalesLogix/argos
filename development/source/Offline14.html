<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('argos/Models/RecentlyViewed/Offline', ['exports', 'module', 'dojo/_base/declare', '../_OfflineModelBase', '../Manager', '../Types', '../../I18n'], function (exports, module, _dojo_baseDeclare, _OfflineModelBase2, _Manager, _Types, _I18n) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _OfflineModelBase3 = _interopRequireDefault(_OfflineModelBase2);

  var _Manager2 = _interopRequireDefault(_Manager);

  var _MODEL_TYPES = _interopRequireDefault(_Types);

  var _getResource = _interopRequireDefault(_I18n);

  var resource = (0, _getResource['default'])('recentlyViewedModel');

<span id='argos-Models-RecentlyViewed-Offline'>  /**
</span>   * @class argos.Models.RecentlyViewed.Offline
   */
  var __class = (0, _declare['default'])('argos.Models.RecentlyViewed.Offline', [_OfflineModelBase3['default']], {
    id: 'recentlyviewed_offline_model',
    entityName: 'RecentlyViewed',
    modelName: 'RecentlyViewed',
    entityDisplayName: resource.entityDisplayName,
    entityDisplayNamePlural: resource.entityDisplayNamePlural,
    isSystem: true,
    createEntry: function createEntity(viewId, entry, model) {
      var entity = {}; // need to dynamicly create Properties;
      entity.$key = viewId + '_' + model.getEntityId(entry);
      entity.$descriptor = model.getEntityDescription(entry);
      entity.createDate = moment().toDate();
      entity.modifyDate = moment().toDate();
      entity.entityId = model.getEntityId(entry);
      entity.entityName = model.entityName;
      entity.description = model.getEntityDescription(entry);
      entity.entityDisplayName = model.entityDisplayName;
      entity.resourceKind = model.resourceKind;
      entity.viewId = viewId;
      entity.iconClass = model.getIconClass(entry);
      return entity;
    },
    deleteEntryByEntityContext: function deleteEntryByEntityContext(entityId, entityName) {
      var _this = this;

      var queryExpression = function map(doc, emit) {
        if (doc.entity.entityId === entityId &amp;&amp; doc.entity.entityName === entityName) {
          emit(doc.entity);
        }
      };
      this.getEntries(queryExpression).then(function (entries) {
        if (entries) {
          entries.forEach(function (entry) {
            _this.deleteEntry(entry.$key);
          });
        }
      });
    }
  });

  _Manager2['default'].register('RecentlyViewed', _MODEL_TYPES['default'].OFFLINE, __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Nb2RlbHMvUmVjZW50bHlWaWV3ZWQvT2ZmbGluZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBTUEsTUFBTSxRQUFRLEdBQUcsNkJBQVkscUJBQXFCLENBQUMsQ0FBQzs7Ozs7QUFLcEQsTUFBTSxPQUFPLEdBQUcseUJBQVEscUNBQXFDLEVBQUUsK0JBQW1CLEVBQUU7QUFDbEYsTUFBRSxFQUFFLDhCQUE4QjtBQUNsQyxjQUFVLEVBQUUsZ0JBQWdCO0FBQzVCLGFBQVMsRUFBRSxnQkFBZ0I7QUFDM0IscUJBQWlCLEVBQUUsUUFBUSxDQUFDLGlCQUFpQjtBQUM3QywyQkFBdUIsRUFBRSxRQUFRLENBQUMsdUJBQXVCO0FBQ3pELFlBQVEsRUFBRSxJQUFJO0FBQ2QsZUFBVyxFQUFFLFNBQVMsWUFBWSxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQ3ZELFVBQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUNsQixZQUFNLENBQUMsSUFBSSxHQUFHLE1BQU0sR0FBRyxHQUFHLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN0RCxZQUFNLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN2RCxZQUFNLENBQUMsVUFBVSxHQUFHLE1BQU0sRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQ3RDLFlBQU0sQ0FBQyxVQUFVLEdBQUcsTUFBTSxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDdEMsWUFBTSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzNDLFlBQU0sQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQztBQUNyQyxZQUFNLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN2RCxZQUFNLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDO0FBQ25ELFlBQU0sQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDLFlBQVksQ0FBQztBQUN6QyxZQUFNLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztBQUN2QixZQUFNLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDN0MsYUFBTyxNQUFNLENBQUM7S0FDZjtBQUNELDhCQUEwQixFQUFFLFNBQVMsMEJBQTBCLENBQUMsUUFBUSxFQUFFLFVBQVUsRUFBRTs7O0FBQ3BGLFVBQU0sZUFBZSxHQUFHLFNBQVMsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUU7QUFDOUMsWUFBSSxBQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsUUFBUSxLQUFLLFFBQVEsSUFBTSxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVUsS0FBSyxVQUFVLEFBQUMsRUFBRTtBQUNoRixjQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2xCO09BQ0YsQ0FBQztBQUNGLFVBQUksQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsT0FBTyxFQUFJO0FBQ2hELFlBQUksT0FBTyxFQUFFO0FBQ1gsaUJBQU8sQ0FBQyxPQUFPLENBQUMsVUFBQyxLQUFLLEVBQUs7QUFDekIsa0JBQUssV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztXQUM5QixDQUFDLENBQUM7U0FDSjtPQUNGLENBQUMsQ0FBQztLQUNKO0dBQ0YsQ0FBQyxDQUFDOztBQUVILHVCQUFRLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSx3QkFBWSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7bUJBQ2xELE9BQU8iLCJmaWxlIjoic3JjL01vZGVscy9SZWNlbnRseVZpZXdlZC9PZmZsaW5lLmpzIiwic291cmNlUm9vdCI6InNyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWNsYXJlIGZyb20gJ2Rvam8vX2Jhc2UvZGVjbGFyZSc7XHJcbmltcG9ydCBfT2ZmbGluZU1vZGVsQmFzZSBmcm9tICcuLi9fT2ZmbGluZU1vZGVsQmFzZSc7XHJcbmltcG9ydCBNYW5hZ2VyIGZyb20gJy4uL01hbmFnZXInO1xyXG5pbXBvcnQgTU9ERUxfVFlQRVMgZnJvbSAnLi4vVHlwZXMnO1xyXG5pbXBvcnQgZ2V0UmVzb3VyY2UgZnJvbSAnLi4vLi4vSTE4bic7XHJcblxyXG5jb25zdCByZXNvdXJjZSA9IGdldFJlc291cmNlKCdyZWNlbnRseVZpZXdlZE1vZGVsJyk7XHJcblxyXG4vKipcclxuICogQGNsYXNzIGFyZ29zLk1vZGVscy5SZWNlbnRseVZpZXdlZC5PZmZsaW5lXHJcbiAqL1xyXG5jb25zdCBfX2NsYXNzID0gZGVjbGFyZSgnYXJnb3MuTW9kZWxzLlJlY2VudGx5Vmlld2VkLk9mZmxpbmUnLCBbX09mZmxpbmVNb2RlbEJhc2VdLCB7XHJcbiAgaWQ6ICdyZWNlbnRseXZpZXdlZF9vZmZsaW5lX21vZGVsJyxcclxuICBlbnRpdHlOYW1lOiAnUmVjZW50bHlWaWV3ZWQnLFxyXG4gIG1vZGVsTmFtZTogJ1JlY2VudGx5Vmlld2VkJyxcclxuICBlbnRpdHlEaXNwbGF5TmFtZTogcmVzb3VyY2UuZW50aXR5RGlzcGxheU5hbWUsXHJcbiAgZW50aXR5RGlzcGxheU5hbWVQbHVyYWw6IHJlc291cmNlLmVudGl0eURpc3BsYXlOYW1lUGx1cmFsLFxyXG4gIGlzU3lzdGVtOiB0cnVlLFxyXG4gIGNyZWF0ZUVudHJ5OiBmdW5jdGlvbiBjcmVhdGVFbnRpdHkodmlld0lkLCBlbnRyeSwgbW9kZWwpIHtcclxuICAgIGNvbnN0IGVudGl0eSA9IHt9OyAvLyBuZWVkIHRvIGR5bmFtaWNseSBjcmVhdGUgUHJvcGVydGllcztcclxuICAgIGVudGl0eS4ka2V5ID0gdmlld0lkICsgJ18nICsgbW9kZWwuZ2V0RW50aXR5SWQoZW50cnkpO1xyXG4gICAgZW50aXR5LiRkZXNjcmlwdG9yID0gbW9kZWwuZ2V0RW50aXR5RGVzY3JpcHRpb24oZW50cnkpO1xyXG4gICAgZW50aXR5LmNyZWF0ZURhdGUgPSBtb21lbnQoKS50b0RhdGUoKTtcclxuICAgIGVudGl0eS5tb2RpZnlEYXRlID0gbW9tZW50KCkudG9EYXRlKCk7XHJcbiAgICBlbnRpdHkuZW50aXR5SWQgPSBtb2RlbC5nZXRFbnRpdHlJZChlbnRyeSk7XHJcbiAgICBlbnRpdHkuZW50aXR5TmFtZSA9IG1vZGVsLmVudGl0eU5hbWU7XHJcbiAgICBlbnRpdHkuZGVzY3JpcHRpb24gPSBtb2RlbC5nZXRFbnRpdHlEZXNjcmlwdGlvbihlbnRyeSk7XHJcbiAgICBlbnRpdHkuZW50aXR5RGlzcGxheU5hbWUgPSBtb2RlbC5lbnRpdHlEaXNwbGF5TmFtZTtcclxuICAgIGVudGl0eS5yZXNvdXJjZUtpbmQgPSBtb2RlbC5yZXNvdXJjZUtpbmQ7XHJcbiAgICBlbnRpdHkudmlld0lkID0gdmlld0lkO1xyXG4gICAgZW50aXR5Lmljb25DbGFzcyA9IG1vZGVsLmdldEljb25DbGFzcyhlbnRyeSk7XHJcbiAgICByZXR1cm4gZW50aXR5O1xyXG4gIH0sXHJcbiAgZGVsZXRlRW50cnlCeUVudGl0eUNvbnRleHQ6IGZ1bmN0aW9uIGRlbGV0ZUVudHJ5QnlFbnRpdHlDb250ZXh0KGVudGl0eUlkLCBlbnRpdHlOYW1lKSB7XHJcbiAgICBjb25zdCBxdWVyeUV4cHJlc3Npb24gPSBmdW5jdGlvbiBtYXAoZG9jLCBlbWl0KSB7XHJcbiAgICAgIGlmICgoZG9jLmVudGl0eS5lbnRpdHlJZCA9PT0gZW50aXR5SWQpICYmIChkb2MuZW50aXR5LmVudGl0eU5hbWUgPT09IGVudGl0eU5hbWUpKSB7XHJcbiAgICAgICAgZW1pdChkb2MuZW50aXR5KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuZ2V0RW50cmllcyhxdWVyeUV4cHJlc3Npb24pLnRoZW4oKGVudHJpZXMpPT4ge1xyXG4gICAgICBpZiAoZW50cmllcykge1xyXG4gICAgICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnkpID0+IHtcclxuICAgICAgICAgIHRoaXMuZGVsZXRlRW50cnkoZW50cnkuJGtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuTWFuYWdlci5yZWdpc3RlcignUmVjZW50bHlWaWV3ZWQnLCBNT0RFTF9UWVBFUy5PRkZMSU5FLCBfX2NsYXNzKTtcclxuZXhwb3J0IGRlZmF1bHQgX19jbGFzcztcclxuIl19
</pre>
</body>
</html>
