<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('argos/Models/RecentlyViewed/Offline', ['exports', 'module', 'dojo/_base/declare', '../_OfflineModelBase', '../Manager', '../Types', '../../I18n'], function (exports, module, _dojo_baseDeclare, _OfflineModelBase2, _Manager, _Types, _I18n) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _OfflineModelBase3 = _interopRequireDefault(_OfflineModelBase2);

  var _Manager2 = _interopRequireDefault(_Manager);

  var _MODEL_TYPES = _interopRequireDefault(_Types);

  var _getResource = _interopRequireDefault(_I18n);

  var resource = (0, _getResource['default'])('recentlyViewedModel');

<span id='argos-Models-RecentlyViewed-Offline'>  /**
</span>   * @class argos.Models.RecentlyViewed.Offline
   */
  var __class = (0, _declare['default'])('argos.Models.RecentlyViewed.Offline', [_OfflineModelBase3['default']], {
    entityName: 'RecentlyViewed',
    modelName: 'RecentlyViewed',
    entityDisplayName: resource.entityDisplayName,
    entityDisplayNamePlural: resource.entityDisplayNamePlural,
    isSystem: true,
    createEntry: function createEntity(viewId, entry, model) {
      var entity = {}; // need to dynamicly create Properties;
      entity.$key = viewId + '_' + model.getEntityId(entry);
      entity.$descriptor = model.getEntityDescription(entry);
      entity.createDate = moment().toDate();
      entity.modifyDate = moment().toDate();
      entity.entityId = model.getEntityId(entry);
      entity.entityName = model.entityName;
      entity.description = model.getEntityDescription(entry);
      entity.entityDisplayName = model.entityDisplayName;
      entity.resourceKind = model.resourceKind;
      entity.viewId = viewId;
      entity.iconClass = model.getIconClass(entry);
      return entity;
    },
    deleteEntryByEntityContext: function deleteEntryByEntityContext(entityId, entityName) {
      var _this = this;

      var queryExpression = function map(doc, emit) {
        if (doc.entity.entityId === entityId &amp;&amp; doc.entity.entityName === entityName) {
          emit(doc.entity);
        }
      };
      this.getEntries(queryExpression).then(function (entries) {
        if (entries) {
          entries.forEach(function (entry) {
            _this.deleteEntry(entry.$key);
          });
        }
      });
    }
  });

  _Manager2['default'].register('RecentlyViewed', _MODEL_TYPES['default'].OFFLINE, __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Nb2RlbHMvUmVjZW50bHlWaWV3ZWQvT2ZmbGluZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBTUEsTUFBTSxRQUFRLEdBQUcsNkJBQVkscUJBQXFCLENBQUMsQ0FBQzs7Ozs7QUFLcEQsTUFBTSxPQUFPLEdBQUcseUJBQVEscUNBQXFDLEVBQUUsK0JBQW1CLEVBQUU7QUFDbEYsY0FBVSxFQUFFLGdCQUFnQjtBQUM1QixhQUFTLEVBQUUsZ0JBQWdCO0FBQzNCLHFCQUFpQixFQUFFLFFBQVEsQ0FBQyxpQkFBaUI7QUFDN0MsMkJBQXVCLEVBQUUsUUFBUSxDQUFDLHVCQUF1QjtBQUN6RCxZQUFRLEVBQUUsSUFBSTtBQUNkLGVBQVcsRUFBRSxTQUFTLFlBQVksQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRTtBQUN2RCxVQUFNLE1BQU0sR0FBRyxFQUFFLENBQUM7QUFDbEIsWUFBTSxDQUFDLElBQUksR0FBRyxNQUFNLEdBQUcsR0FBRyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEQsWUFBTSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdkQsWUFBTSxDQUFDLFVBQVUsR0FBRyxNQUFNLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUN0QyxZQUFNLENBQUMsVUFBVSxHQUFHLE1BQU0sRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQ3RDLFlBQU0sQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMzQyxZQUFNLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUM7QUFDckMsWUFBTSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdkQsWUFBTSxDQUFDLGlCQUFpQixHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztBQUNuRCxZQUFNLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxZQUFZLENBQUM7QUFDekMsWUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFDdkIsWUFBTSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzdDLGFBQU8sTUFBTSxDQUFDO0tBQ2Y7QUFDRCw4QkFBMEIsRUFBRSxTQUFTLDBCQUEwQixDQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUU7OztBQUNwRixVQUFNLGVBQWUsR0FBRyxTQUFTLEdBQUcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFO0FBQzlDLFlBQUksQUFBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsS0FBSyxRQUFRLElBQU0sR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEtBQUssVUFBVSxBQUFDLEVBQUU7QUFDaEYsY0FBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUNsQjtPQUNGLENBQUM7QUFDRixVQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLE9BQU8sRUFBSTtBQUNoRCxZQUFJLE9BQU8sRUFBRTtBQUNYLGlCQUFPLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBSyxFQUFLO0FBQ3pCLGtCQUFLLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7V0FDOUIsQ0FBQyxDQUFDO1NBQ0o7T0FDRixDQUFDLENBQUM7S0FDSjtHQUNGLENBQUMsQ0FBQzs7QUFFSCx1QkFBUSxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsd0JBQVksT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO21CQUNsRCxPQUFPIiwiZmlsZSI6InNyYy9Nb2RlbHMvUmVjZW50bHlWaWV3ZWQvT2ZmbGluZS5qcyIsInNvdXJjZVJvb3QiOiJzcmMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVjbGFyZSBmcm9tICdkb2pvL19iYXNlL2RlY2xhcmUnO1xyXG5pbXBvcnQgX09mZmxpbmVNb2RlbEJhc2UgZnJvbSAnLi4vX09mZmxpbmVNb2RlbEJhc2UnO1xyXG5pbXBvcnQgTWFuYWdlciBmcm9tICcuLi9NYW5hZ2VyJztcclxuaW1wb3J0IE1PREVMX1RZUEVTIGZyb20gJy4uL1R5cGVzJztcclxuaW1wb3J0IGdldFJlc291cmNlIGZyb20gJy4uLy4uL0kxOG4nO1xyXG5cclxuY29uc3QgcmVzb3VyY2UgPSBnZXRSZXNvdXJjZSgncmVjZW50bHlWaWV3ZWRNb2RlbCcpO1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyBhcmdvcy5Nb2RlbHMuUmVjZW50bHlWaWV3ZWQuT2ZmbGluZVxyXG4gKi9cclxuY29uc3QgX19jbGFzcyA9IGRlY2xhcmUoJ2FyZ29zLk1vZGVscy5SZWNlbnRseVZpZXdlZC5PZmZsaW5lJywgW19PZmZsaW5lTW9kZWxCYXNlXSwge1xyXG4gIGVudGl0eU5hbWU6ICdSZWNlbnRseVZpZXdlZCcsXHJcbiAgbW9kZWxOYW1lOiAnUmVjZW50bHlWaWV3ZWQnLFxyXG4gIGVudGl0eURpc3BsYXlOYW1lOiByZXNvdXJjZS5lbnRpdHlEaXNwbGF5TmFtZSxcclxuICBlbnRpdHlEaXNwbGF5TmFtZVBsdXJhbDogcmVzb3VyY2UuZW50aXR5RGlzcGxheU5hbWVQbHVyYWwsXHJcbiAgaXNTeXN0ZW06IHRydWUsXHJcbiAgY3JlYXRlRW50cnk6IGZ1bmN0aW9uIGNyZWF0ZUVudGl0eSh2aWV3SWQsIGVudHJ5LCBtb2RlbCkge1xyXG4gICAgY29uc3QgZW50aXR5ID0ge307IC8vIG5lZWQgdG8gZHluYW1pY2x5IGNyZWF0ZSBQcm9wZXJ0aWVzO1xyXG4gICAgZW50aXR5LiRrZXkgPSB2aWV3SWQgKyAnXycgKyBtb2RlbC5nZXRFbnRpdHlJZChlbnRyeSk7XHJcbiAgICBlbnRpdHkuJGRlc2NyaXB0b3IgPSBtb2RlbC5nZXRFbnRpdHlEZXNjcmlwdGlvbihlbnRyeSk7XHJcbiAgICBlbnRpdHkuY3JlYXRlRGF0ZSA9IG1vbWVudCgpLnRvRGF0ZSgpO1xyXG4gICAgZW50aXR5Lm1vZGlmeURhdGUgPSBtb21lbnQoKS50b0RhdGUoKTtcclxuICAgIGVudGl0eS5lbnRpdHlJZCA9IG1vZGVsLmdldEVudGl0eUlkKGVudHJ5KTtcclxuICAgIGVudGl0eS5lbnRpdHlOYW1lID0gbW9kZWwuZW50aXR5TmFtZTtcclxuICAgIGVudGl0eS5kZXNjcmlwdGlvbiA9IG1vZGVsLmdldEVudGl0eURlc2NyaXB0aW9uKGVudHJ5KTtcclxuICAgIGVudGl0eS5lbnRpdHlEaXNwbGF5TmFtZSA9IG1vZGVsLmVudGl0eURpc3BsYXlOYW1lO1xyXG4gICAgZW50aXR5LnJlc291cmNlS2luZCA9IG1vZGVsLnJlc291cmNlS2luZDtcclxuICAgIGVudGl0eS52aWV3SWQgPSB2aWV3SWQ7XHJcbiAgICBlbnRpdHkuaWNvbkNsYXNzID0gbW9kZWwuZ2V0SWNvbkNsYXNzKGVudHJ5KTtcclxuICAgIHJldHVybiBlbnRpdHk7XHJcbiAgfSxcclxuICBkZWxldGVFbnRyeUJ5RW50aXR5Q29udGV4dDogZnVuY3Rpb24gZGVsZXRlRW50cnlCeUVudGl0eUNvbnRleHQoZW50aXR5SWQsIGVudGl0eU5hbWUpIHtcclxuICAgIGNvbnN0IHF1ZXJ5RXhwcmVzc2lvbiA9IGZ1bmN0aW9uIG1hcChkb2MsIGVtaXQpIHtcclxuICAgICAgaWYgKChkb2MuZW50aXR5LmVudGl0eUlkID09PSBlbnRpdHlJZCkgJiYgKGRvYy5lbnRpdHkuZW50aXR5TmFtZSA9PT0gZW50aXR5TmFtZSkpIHtcclxuICAgICAgICBlbWl0KGRvYy5lbnRpdHkpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5nZXRFbnRyaWVzKHF1ZXJ5RXhwcmVzc2lvbikudGhlbigoZW50cmllcyk9PiB7XHJcbiAgICAgIGlmIChlbnRyaWVzKSB7XHJcbiAgICAgICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5kZWxldGVFbnRyeShlbnRyeS4ka2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxufSk7XHJcblxyXG5NYW5hZ2VyLnJlZ2lzdGVyKCdSZWNlbnRseVZpZXdlZCcsIE1PREVMX1RZUEVTLk9GRkxJTkUsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
