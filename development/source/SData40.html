<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Models/UserActivity/SData', ['exports', 'module', 'dojo/_base/declare', './Base', 'argos/Models/_SDataModelBase', 'argos/Models/Manager', 'dojo/string', 'argos/Convert', 'argos/Models/Types', '../Names'], function (exports, module, _dojo_baseDeclare, _Base, _argosModels_SDataModelBase, _argosModelsManager, _dojoString, _argosConvert, _argosModelsTypes, _Names) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _Base2 = _interopRequireDefault(_Base);

  var _SDataModelBase2 = _interopRequireDefault(_argosModels_SDataModelBase);

  var _Manager = _interopRequireDefault(_argosModelsManager);

  var _string = _interopRequireDefault(_dojoString);

  var _convert = _interopRequireDefault(_argosConvert);

  var _MODEL_TYPES = _interopRequireDefault(_argosModelsTypes);

  var _MODEL_NAMES = _interopRequireDefault(_Names);

  var __class = (0, _declare['default'])('crm.Models.UserActivity.SData', [_Base2['default'], _SDataModelBase2['default']], {
    id: 'useractivity_sdata_model',
    createQueryModels: function createQueryModels() {
      return [{
        name: 'list',
        queryOrderBy: 'Activity.StartDate desc',
        querySelect: ['Alarm', 'AlarmTime', 'Status', 'Activity/Description', 'Activity/StartDate', 'Activity/EndDate', 'Activity/Type', 'Activity/AccountName', 'Activity/AccountId', 'Activity/ContactId', 'Activity/ContactName', 'Activity/Leader', 'Activity/LeadName', 'Activity/LeadId', 'Activity/OpportunityId', 'Activity/TicketId', 'Activity/UserId', 'Activity/Timeless', 'Activity/PhoneNumber', 'Activity/Recurring', 'Activity/Alarm', 'Activity/ModifyDate', 'Activity/Priority'],
        queryInclude: ['$descriptors']
      }, {
        name: 'myday',
        queryWhere: function queryWhere() {
          var now = moment();
          var todayStart = now.clone().startOf('day');
          var todayEnd = todayStart.clone().endOf('day');

          var theQuery = _string['default'].substitute('((Activity.Timeless eq false and Activity.StartDate between @${0}@ and @${1}@) or (Activity.Timeless eq true and Activity.StartDate between @${2}@ and @${3}@))', [_convert['default'].toIsoStringFromDate(todayStart.toDate()), _convert['default'].toIsoStringFromDate(todayEnd.toDate()), todayStart.format('YYYY-MM-DDT00:00:00[Z]'), todayEnd.format('YYYY-MM-DDT23:59:59[Z]')]);
          var userQuery = _string['default'].substitute('(User.Id eq &quot;${0}&quot; and Status ne &quot;asDeclned&quot; and Activity.Type ne &quot;atLiterature&quot;)', [App.context.user.$key]);

          return [userQuery, theQuery].join(' and ');
        },
        queryOrderBy: 'Activity.StartDate desc',
        querySelect: ['Alarm', 'AlarmTime', 'Status', 'Activity/Description', 'Activity/StartDate', 'Activity/EndDate', 'Activity/Type', 'Activity/AccountName', 'Activity/AccountId', 'Activity/ContactId', 'Activity/ContactName', 'Activity/Leader', 'Activity/LeadName', 'Activity/LeadId', 'Activity/OpportunityId', 'Activity/TicketId', 'Activity/UserId', 'Activity/Timeless', 'Activity/PhoneNumber', 'Activity/Recurring', 'Activity/Alarm', 'Activity/ModifyDate', 'Activity/Priority'],
        queryInclude: ['$descriptors']
      }];
    },
    getMyDayQuery: function getMyDayQuery() {
      var queryModel = this._getQueryModelByName('myday');
      return queryModel &amp;&amp; queryModel.queryWhere();
    }
  });

  _Manager['default'].register(_MODEL_NAMES['default'].USERACTIVITY, _MODEL_TYPES['default'].SDATA, __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Nb2RlbHMvVXNlckFjdGl2aXR5L1NEYXRhLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTQSxNQUFNLE9BQU8sR0FBRyx5QkFBUSwrQkFBK0IsRUFBRSxnREFBdUIsRUFBRTtBQUNoRixNQUFFLEVBQUUsMEJBQTBCO0FBQzlCLHFCQUFpQixFQUFFLFNBQVMsaUJBQWlCLEdBQUc7QUFDOUMsYUFBTyxDQUFDO0FBQ04sWUFBSSxFQUFFLE1BQU07QUFDWixvQkFBWSxFQUFFLHlCQUF5QjtBQUN2QyxtQkFBVyxFQUFFLENBQ1gsT0FBTyxFQUNQLFdBQVcsRUFDWCxRQUFRLEVBQ1Isc0JBQXNCLEVBQ3RCLG9CQUFvQixFQUNwQixrQkFBa0IsRUFDbEIsZUFBZSxFQUNmLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsb0JBQW9CLEVBQ3BCLHNCQUFzQixFQUN0QixpQkFBaUIsRUFDakIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQix3QkFBd0IsRUFDeEIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQixtQkFBbUIsRUFDbkIsc0JBQXNCLEVBQ3RCLG9CQUFvQixFQUNwQixnQkFBZ0IsRUFDaEIscUJBQXFCLEVBQ3JCLG1CQUFtQixDQUNwQjtBQUNELG9CQUFZLEVBQUUsQ0FDWixjQUFjLENBQ2Y7T0FDRixFQUFFO0FBQ0QsWUFBSSxFQUFFLE9BQU87QUFDYixrQkFBVSxFQUFFLFNBQVMsVUFBVSxHQUFHO0FBQ2hDLGNBQU0sR0FBRyxHQUFHLE1BQU0sRUFBRSxDQUFDO0FBQ3JCLGNBQU0sVUFBVSxHQUFHLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDOUMsY0FBTSxRQUFRLEdBQUcsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQzs7QUFFakQsY0FBTSxRQUFRLEdBQUcsbUJBQU8sVUFBVSxDQUNoQyxpS0FBaUssRUFBRSxDQUNqSyxvQkFBUSxtQkFBbUIsQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUMsRUFDaEQsb0JBQVEsbUJBQW1CLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQzlDLFVBQVUsQ0FBQyxNQUFNLENBQUMsd0JBQXdCLENBQUMsRUFDM0MsUUFBUSxDQUFDLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxDQUMxQyxDQUNGLENBQUM7QUFDRixjQUFNLFNBQVMsR0FBRyxtQkFBTyxVQUFVLENBQUMsbUZBQW1GLEVBQUUsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDOztBQUVsSixpQkFBTyxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDNUM7QUFDRCxvQkFBWSxFQUFFLHlCQUF5QjtBQUN2QyxtQkFBVyxFQUFFLENBQ1gsT0FBTyxFQUNQLFdBQVcsRUFDWCxRQUFRLEVBQ1Isc0JBQXNCLEVBQ3RCLG9CQUFvQixFQUNwQixrQkFBa0IsRUFDbEIsZUFBZSxFQUNmLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsb0JBQW9CLEVBQ3BCLHNCQUFzQixFQUN0QixpQkFBaUIsRUFDakIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQix3QkFBd0IsRUFDeEIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQixtQkFBbUIsRUFDbkIsc0JBQXNCLEVBQ3RCLG9CQUFvQixFQUNwQixnQkFBZ0IsRUFDaEIscUJBQXFCLEVBQ3JCLG1CQUFtQixDQUNwQjtBQUNELG9CQUFZLEVBQUUsQ0FDWixjQUFjLENBQ2Y7T0FDRixDQUNBLENBQUM7S0FDSDtBQUNELGlCQUFhLEVBQUUsU0FBUyxhQUFhLEdBQUc7QUFDdEMsVUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3RELGFBQU8sVUFBVSxJQUFJLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztLQUM5QztHQUNELENBQUMsQ0FBQzs7QUFFSixzQkFBUSxRQUFRLENBQUMsd0JBQVksWUFBWSxFQUFFLHdCQUFZLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQzttQkFDeEQsT0FBTyIsImZpbGUiOiJzcmMvTW9kZWxzL1VzZXJBY3Rpdml0eS9TRGF0YS5qcyIsInNvdXJjZVJvb3QiOiJzcmMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVjbGFyZSBmcm9tICdkb2pvL19iYXNlL2RlY2xhcmUnO1xyXG5pbXBvcnQgQmFzZSBmcm9tICcuL0Jhc2UnO1xyXG5pbXBvcnQgX1NEYXRhTW9kZWxCYXNlIGZyb20gJ2FyZ29zL01vZGVscy9fU0RhdGFNb2RlbEJhc2UnO1xyXG5pbXBvcnQgTWFuYWdlciBmcm9tICdhcmdvcy9Nb2RlbHMvTWFuYWdlcic7XHJcbmltcG9ydCBzdHJpbmcgZnJvbSAnZG9qby9zdHJpbmcnO1xyXG5pbXBvcnQgY29udmVydCBmcm9tICdhcmdvcy9Db252ZXJ0JztcclxuaW1wb3J0IE1PREVMX1RZUEVTIGZyb20gJ2FyZ29zL01vZGVscy9UeXBlcyc7XHJcbmltcG9ydCBNT0RFTF9OQU1FUyBmcm9tICcuLi9OYW1lcyc7XHJcblxyXG5jb25zdCBfX2NsYXNzID0gZGVjbGFyZSgnY3JtLk1vZGVscy5Vc2VyQWN0aXZpdHkuU0RhdGEnLCBbQmFzZSwgX1NEYXRhTW9kZWxCYXNlXSwge1xyXG4gIGlkOiAndXNlcmFjdGl2aXR5X3NkYXRhX21vZGVsJyxcclxuICBjcmVhdGVRdWVyeU1vZGVsczogZnVuY3Rpb24gY3JlYXRlUXVlcnlNb2RlbHMoKSB7XHJcbiAgICByZXR1cm4gW3tcclxuICAgICAgbmFtZTogJ2xpc3QnLFxyXG4gICAgICBxdWVyeU9yZGVyQnk6ICdBY3Rpdml0eS5TdGFydERhdGUgZGVzYycsXHJcbiAgICAgIHF1ZXJ5U2VsZWN0OiBbXHJcbiAgICAgICAgJ0FsYXJtJyxcclxuICAgICAgICAnQWxhcm1UaW1lJyxcclxuICAgICAgICAnU3RhdHVzJyxcclxuICAgICAgICAnQWN0aXZpdHkvRGVzY3JpcHRpb24nLFxyXG4gICAgICAgICdBY3Rpdml0eS9TdGFydERhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9FbmREYXRlJyxcclxuICAgICAgICAnQWN0aXZpdHkvVHlwZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0FjY291bnROYW1lJyxcclxuICAgICAgICAnQWN0aXZpdHkvQWNjb3VudElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdE5hbWUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkTmFtZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0xlYWRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L09wcG9ydHVuaXR5SWQnLFxyXG4gICAgICAgICdBY3Rpdml0eS9UaWNrZXRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1VzZXJJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1RpbWVsZXNzJyxcclxuICAgICAgICAnQWN0aXZpdHkvUGhvbmVOdW1iZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9SZWN1cnJpbmcnLFxyXG4gICAgICAgICdBY3Rpdml0eS9BbGFybScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L01vZGlmeURhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9Qcmlvcml0eScsXHJcbiAgICAgIF0sXHJcbiAgICAgIHF1ZXJ5SW5jbHVkZTogW1xyXG4gICAgICAgICckZGVzY3JpcHRvcnMnLFxyXG4gICAgICBdLFxyXG4gICAgfSwge1xyXG4gICAgICBuYW1lOiAnbXlkYXknLFxyXG4gICAgICBxdWVyeVdoZXJlOiBmdW5jdGlvbiBxdWVyeVdoZXJlKCkge1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IG1vbWVudCgpO1xyXG4gICAgICAgIGNvbnN0IHRvZGF5U3RhcnQgPSBub3cuY2xvbmUoKS5zdGFydE9mKCdkYXknKTtcclxuICAgICAgICBjb25zdCB0b2RheUVuZCA9IHRvZGF5U3RhcnQuY2xvbmUoKS5lbmRPZignZGF5Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRoZVF1ZXJ5ID0gc3RyaW5nLnN1YnN0aXR1dGUoXHJcbiAgICAgICAgICAnKChBY3Rpdml0eS5UaW1lbGVzcyBlcSBmYWxzZSBhbmQgQWN0aXZpdHkuU3RhcnREYXRlIGJldHdlZW4gQCR7MH1AIGFuZCBAJHsxfUApIG9yIChBY3Rpdml0eS5UaW1lbGVzcyBlcSB0cnVlIGFuZCBBY3Rpdml0eS5TdGFydERhdGUgYmV0d2VlbiBAJHsyfUAgYW5kIEAkezN9QCkpJywgW1xyXG4gICAgICAgICAgICBjb252ZXJ0LnRvSXNvU3RyaW5nRnJvbURhdGUodG9kYXlTdGFydC50b0RhdGUoKSksXHJcbiAgICAgICAgICAgIGNvbnZlcnQudG9Jc29TdHJpbmdGcm9tRGF0ZSh0b2RheUVuZC50b0RhdGUoKSksXHJcbiAgICAgICAgICAgIHRvZGF5U3RhcnQuZm9ybWF0KCdZWVlZLU1NLUREVDAwOjAwOjAwW1pdJyksXHJcbiAgICAgICAgICAgIHRvZGF5RW5kLmZvcm1hdCgnWVlZWS1NTS1ERFQyMzo1OTo1OVtaXScpLFxyXG4gICAgICAgICAgXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgdXNlclF1ZXJ5ID0gc3RyaW5nLnN1YnN0aXR1dGUoJyhVc2VyLklkIGVxIFwiJHswfVwiIGFuZCBTdGF0dXMgbmUgXCJhc0RlY2xuZWRcIiBhbmQgQWN0aXZpdHkuVHlwZSBuZSBcImF0TGl0ZXJhdHVyZVwiKScsIFtBcHAuY29udGV4dC51c2VyLiRrZXldKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFt1c2VyUXVlcnksIHRoZVF1ZXJ5XS5qb2luKCcgYW5kICcpO1xyXG4gICAgICB9LFxyXG4gICAgICBxdWVyeU9yZGVyQnk6ICdBY3Rpdml0eS5TdGFydERhdGUgZGVzYycsXHJcbiAgICAgIHF1ZXJ5U2VsZWN0OiBbXHJcbiAgICAgICAgJ0FsYXJtJyxcclxuICAgICAgICAnQWxhcm1UaW1lJyxcclxuICAgICAgICAnU3RhdHVzJyxcclxuICAgICAgICAnQWN0aXZpdHkvRGVzY3JpcHRpb24nLFxyXG4gICAgICAgICdBY3Rpdml0eS9TdGFydERhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9FbmREYXRlJyxcclxuICAgICAgICAnQWN0aXZpdHkvVHlwZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0FjY291bnROYW1lJyxcclxuICAgICAgICAnQWN0aXZpdHkvQWNjb3VudElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdE5hbWUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkTmFtZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0xlYWRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L09wcG9ydHVuaXR5SWQnLFxyXG4gICAgICAgICdBY3Rpdml0eS9UaWNrZXRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1VzZXJJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1RpbWVsZXNzJyxcclxuICAgICAgICAnQWN0aXZpdHkvUGhvbmVOdW1iZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9SZWN1cnJpbmcnLFxyXG4gICAgICAgICdBY3Rpdml0eS9BbGFybScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L01vZGlmeURhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9Qcmlvcml0eScsXHJcbiAgICAgIF0sXHJcbiAgICAgIHF1ZXJ5SW5jbHVkZTogW1xyXG4gICAgICAgICckZGVzY3JpcHRvcnMnLFxyXG4gICAgICBdLFxyXG4gICAgfSxcclxuICAgIF07XHJcbiAgfSxcclxuICBnZXRNeURheVF1ZXJ5OiBmdW5jdGlvbiBnZXRNeURheVF1ZXJ5KCkge1xyXG4gICAgY29uc3QgcXVlcnlNb2RlbCA9IHRoaXMuX2dldFF1ZXJ5TW9kZWxCeU5hbWUoJ215ZGF5Jyk7XHJcbiAgICByZXR1cm4gcXVlcnlNb2RlbCAmJiBxdWVyeU1vZGVsLnF1ZXJ5V2hlcmUoKTtcclxuICB9LFxyXG4gfSk7XHJcblxyXG5NYW5hZ2VyLnJlZ2lzdGVyKE1PREVMX05BTUVTLlVTRVJBQ1RJVklUWSwgTU9ERUxfVFlQRVMuU0RBVEEsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
