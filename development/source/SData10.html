<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Models/UserActivity/SData', ['exports', 'module', 'dojo/_base/declare', './Base', 'argos/Models/_SDataModelBase', 'argos/Models/Manager', 'dojo/string', 'argos/Convert', 'argos/Models/Types', '../Names'], function (exports, module, _dojo_baseDeclare, _Base, _argosModels_SDataModelBase, _argosModelsManager, _dojoString, _argosConvert, _argosModelsTypes, _Names) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _Base2 = _interopRequireDefault(_Base);

  var _SDataModelBase2 = _interopRequireDefault(_argosModels_SDataModelBase);

  var _Manager = _interopRequireDefault(_argosModelsManager);

  var _string = _interopRequireDefault(_dojoString);

  var _convert = _interopRequireDefault(_argosConvert);

  var _MODEL_TYPES = _interopRequireDefault(_argosModelsTypes);

  var _MODEL_NAMES = _interopRequireDefault(_Names);

  var __class = (0, _declare['default'])('crm.Models.UserActivity.SData', [_Base2['default'], _SDataModelBase2['default']], {
    createQueryModels: function createQueryModels() {
      return [{
        name: 'list',
        queryOrderBy: 'Activity.StartDate desc',
        querySelect: ['Alarm', 'AlarmTime', 'Status', 'Activity/Description', 'Activity/StartDate', 'Activity/EndDate', 'Activity/Type', 'Activity/AccountName', 'Activity/AccountId', 'Activity/ContactId', 'Activity/ContactName', 'Activity/Leader', 'Activity/LeadName', 'Activity/LeadId', 'Activity/OpportunityId', 'Activity/TicketId', 'Activity/UserId', 'Activity/Timeless', 'Activity/PhoneNumber', 'Activity/Recurring', 'Activity/Alarm', 'Activity/ModifyDate', 'Activity/Priority'],
        queryInclude: ['$descriptors']
      }, {
        name: 'myday',
        queryWhere: function queryWhere() {
          var now = moment();
          var todayStart = now.clone().startOf('day');
          var todayEnd = todayStart.clone().endOf('day');

          var theQuery = _string['default'].substitute('((Activity.Timeless eq false and Activity.StartDate between @${0}@ and @${1}@) or (Activity.Timeless eq true and Activity.StartDate between @${2}@ and @${3}@))', [_convert['default'].toIsoStringFromDate(todayStart.toDate()), _convert['default'].toIsoStringFromDate(todayEnd.toDate()), todayStart.format('YYYY-MM-DDT00:00:00[Z]'), todayEnd.format('YYYY-MM-DDT23:59:59[Z]')]);
          var userQuery = _string['default'].substitute('(User.Id eq &quot;${0}&quot; and Status ne &quot;asDeclned&quot; and Activity.Type ne &quot;atLiterature&quot;)', [App.context.user.$key]);

          return [userQuery, theQuery].join(' and ');
        },
        queryOrderBy: 'Activity.StartDate desc',
        querySelect: ['Alarm', 'AlarmTime', 'Status', 'Activity/Description', 'Activity/StartDate', 'Activity/EndDate', 'Activity/Type', 'Activity/AccountName', 'Activity/AccountId', 'Activity/ContactId', 'Activity/ContactName', 'Activity/Leader', 'Activity/LeadName', 'Activity/LeadId', 'Activity/OpportunityId', 'Activity/TicketId', 'Activity/UserId', 'Activity/Timeless', 'Activity/PhoneNumber', 'Activity/Recurring', 'Activity/Alarm', 'Activity/ModifyDate', 'Activity/Priority'],
        queryInclude: ['$descriptors']
      }];
    },
    getMyDayQuery: function getMyDayQuery() {
      var queryModel = this._getQueryModelByName('myday');
      return queryModel &amp;&amp; queryModel.queryWhere();
    }
  });

  _Manager['default'].register(_MODEL_NAMES['default'].USERACTIVITY, _MODEL_TYPES['default'].SDATA, __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Nb2RlbHMvVXNlckFjdGl2aXR5L1NEYXRhLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTQSxNQUFNLE9BQU8sR0FBRyx5QkFBUSwrQkFBK0IsRUFBRSxnREFBdUIsRUFBRTtBQUNoRixxQkFBaUIsRUFBRSxTQUFTLGlCQUFpQixHQUFHO0FBQzlDLGFBQU8sQ0FBQztBQUNOLFlBQUksRUFBRSxNQUFNO0FBQ1osb0JBQVksRUFBRSx5QkFBeUI7QUFDdkMsbUJBQVcsRUFBRSxDQUNYLE9BQU8sRUFDUCxXQUFXLEVBQ1gsUUFBUSxFQUNSLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsa0JBQWtCLEVBQ2xCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsb0JBQW9CLEVBQ3BCLG9CQUFvQixFQUNwQixzQkFBc0IsRUFDdEIsaUJBQWlCLEVBQ2pCLG1CQUFtQixFQUNuQixpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLG1CQUFtQixFQUNuQixpQkFBaUIsRUFDakIsbUJBQW1CLEVBQ25CLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsZ0JBQWdCLEVBQ2hCLHFCQUFxQixFQUNyQixtQkFBbUIsQ0FDcEI7QUFDRCxvQkFBWSxFQUFFLENBQ1osY0FBYyxDQUNmO09BQ0YsRUFBRTtBQUNELFlBQUksRUFBRSxPQUFPO0FBQ2Isa0JBQVUsRUFBRSxTQUFTLFVBQVUsR0FBRztBQUNoQyxjQUFNLEdBQUcsR0FBRyxNQUFNLEVBQUUsQ0FBQztBQUNyQixjQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzlDLGNBQU0sUUFBUSxHQUFHLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7O0FBRWpELGNBQU0sUUFBUSxHQUFHLG1CQUFPLFVBQVUsQ0FDaEMsaUtBQWlLLEVBQUUsQ0FDakssb0JBQVEsbUJBQW1CLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQ2hELG9CQUFRLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUM5QyxVQUFVLENBQUMsTUFBTSxDQUFDLHdCQUF3QixDQUFDLEVBQzNDLFFBQVEsQ0FBQyxNQUFNLENBQUMsd0JBQXdCLENBQUMsQ0FDMUMsQ0FDRixDQUFDO0FBQ0YsY0FBTSxTQUFTLEdBQUcsbUJBQU8sVUFBVSxDQUFDLG1GQUFtRixFQUFFLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzs7QUFFbEosaUJBQU8sQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzVDO0FBQ0Qsb0JBQVksRUFBRSx5QkFBeUI7QUFDdkMsbUJBQVcsRUFBRSxDQUNYLE9BQU8sRUFDUCxXQUFXLEVBQ1gsUUFBUSxFQUNSLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsa0JBQWtCLEVBQ2xCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsb0JBQW9CLEVBQ3BCLG9CQUFvQixFQUNwQixzQkFBc0IsRUFDdEIsaUJBQWlCLEVBQ2pCLG1CQUFtQixFQUNuQixpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLG1CQUFtQixFQUNuQixpQkFBaUIsRUFDakIsbUJBQW1CLEVBQ25CLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsZ0JBQWdCLEVBQ2hCLHFCQUFxQixFQUNyQixtQkFBbUIsQ0FDcEI7QUFDRCxvQkFBWSxFQUFFLENBQ1osY0FBYyxDQUNmO09BQ0YsQ0FDQSxDQUFDO0tBQ0g7QUFDRCxpQkFBYSxFQUFFLFNBQVMsYUFBYSxHQUFHO0FBQ3RDLFVBQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN0RCxhQUFPLFVBQVUsSUFBSSxVQUFVLENBQUMsVUFBVSxFQUFFLENBQUM7S0FDOUM7R0FDRCxDQUFDLENBQUM7O0FBRUosc0JBQVEsUUFBUSxDQUFDLHdCQUFZLFlBQVksRUFBRSx3QkFBWSxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7bUJBQ3hELE9BQU8iLCJmaWxlIjoic3JjL01vZGVscy9Vc2VyQWN0aXZpdHkvU0RhdGEuanMiLCJzb3VyY2VSb290Ijoic3JjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRlY2xhcmUgZnJvbSAnZG9qby9fYmFzZS9kZWNsYXJlJztcclxuaW1wb3J0IEJhc2UgZnJvbSAnLi9CYXNlJztcclxuaW1wb3J0IF9TRGF0YU1vZGVsQmFzZSBmcm9tICdhcmdvcy9Nb2RlbHMvX1NEYXRhTW9kZWxCYXNlJztcclxuaW1wb3J0IE1hbmFnZXIgZnJvbSAnYXJnb3MvTW9kZWxzL01hbmFnZXInO1xyXG5pbXBvcnQgc3RyaW5nIGZyb20gJ2Rvam8vc3RyaW5nJztcclxuaW1wb3J0IGNvbnZlcnQgZnJvbSAnYXJnb3MvQ29udmVydCc7XHJcbmltcG9ydCBNT0RFTF9UWVBFUyBmcm9tICdhcmdvcy9Nb2RlbHMvVHlwZXMnO1xyXG5pbXBvcnQgTU9ERUxfTkFNRVMgZnJvbSAnLi4vTmFtZXMnO1xyXG5cclxuY29uc3QgX19jbGFzcyA9IGRlY2xhcmUoJ2NybS5Nb2RlbHMuVXNlckFjdGl2aXR5LlNEYXRhJywgW0Jhc2UsIF9TRGF0YU1vZGVsQmFzZV0sIHtcclxuICBjcmVhdGVRdWVyeU1vZGVsczogZnVuY3Rpb24gY3JlYXRlUXVlcnlNb2RlbHMoKSB7XHJcbiAgICByZXR1cm4gW3tcclxuICAgICAgbmFtZTogJ2xpc3QnLFxyXG4gICAgICBxdWVyeU9yZGVyQnk6ICdBY3Rpdml0eS5TdGFydERhdGUgZGVzYycsXHJcbiAgICAgIHF1ZXJ5U2VsZWN0OiBbXHJcbiAgICAgICAgJ0FsYXJtJyxcclxuICAgICAgICAnQWxhcm1UaW1lJyxcclxuICAgICAgICAnU3RhdHVzJyxcclxuICAgICAgICAnQWN0aXZpdHkvRGVzY3JpcHRpb24nLFxyXG4gICAgICAgICdBY3Rpdml0eS9TdGFydERhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9FbmREYXRlJyxcclxuICAgICAgICAnQWN0aXZpdHkvVHlwZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0FjY291bnROYW1lJyxcclxuICAgICAgICAnQWN0aXZpdHkvQWNjb3VudElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdE5hbWUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkTmFtZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0xlYWRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L09wcG9ydHVuaXR5SWQnLFxyXG4gICAgICAgICdBY3Rpdml0eS9UaWNrZXRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1VzZXJJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1RpbWVsZXNzJyxcclxuICAgICAgICAnQWN0aXZpdHkvUGhvbmVOdW1iZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9SZWN1cnJpbmcnLFxyXG4gICAgICAgICdBY3Rpdml0eS9BbGFybScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L01vZGlmeURhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9Qcmlvcml0eScsXHJcbiAgICAgIF0sXHJcbiAgICAgIHF1ZXJ5SW5jbHVkZTogW1xyXG4gICAgICAgICckZGVzY3JpcHRvcnMnLFxyXG4gICAgICBdLFxyXG4gICAgfSwge1xyXG4gICAgICBuYW1lOiAnbXlkYXknLFxyXG4gICAgICBxdWVyeVdoZXJlOiBmdW5jdGlvbiBxdWVyeVdoZXJlKCkge1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IG1vbWVudCgpO1xyXG4gICAgICAgIGNvbnN0IHRvZGF5U3RhcnQgPSBub3cuY2xvbmUoKS5zdGFydE9mKCdkYXknKTtcclxuICAgICAgICBjb25zdCB0b2RheUVuZCA9IHRvZGF5U3RhcnQuY2xvbmUoKS5lbmRPZignZGF5Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRoZVF1ZXJ5ID0gc3RyaW5nLnN1YnN0aXR1dGUoXHJcbiAgICAgICAgICAnKChBY3Rpdml0eS5UaW1lbGVzcyBlcSBmYWxzZSBhbmQgQWN0aXZpdHkuU3RhcnREYXRlIGJldHdlZW4gQCR7MH1AIGFuZCBAJHsxfUApIG9yIChBY3Rpdml0eS5UaW1lbGVzcyBlcSB0cnVlIGFuZCBBY3Rpdml0eS5TdGFydERhdGUgYmV0d2VlbiBAJHsyfUAgYW5kIEAkezN9QCkpJywgW1xyXG4gICAgICAgICAgICBjb252ZXJ0LnRvSXNvU3RyaW5nRnJvbURhdGUodG9kYXlTdGFydC50b0RhdGUoKSksXHJcbiAgICAgICAgICAgIGNvbnZlcnQudG9Jc29TdHJpbmdGcm9tRGF0ZSh0b2RheUVuZC50b0RhdGUoKSksXHJcbiAgICAgICAgICAgIHRvZGF5U3RhcnQuZm9ybWF0KCdZWVlZLU1NLUREVDAwOjAwOjAwW1pdJyksXHJcbiAgICAgICAgICAgIHRvZGF5RW5kLmZvcm1hdCgnWVlZWS1NTS1ERFQyMzo1OTo1OVtaXScpLFxyXG4gICAgICAgICAgXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgdXNlclF1ZXJ5ID0gc3RyaW5nLnN1YnN0aXR1dGUoJyhVc2VyLklkIGVxIFwiJHswfVwiIGFuZCBTdGF0dXMgbmUgXCJhc0RlY2xuZWRcIiBhbmQgQWN0aXZpdHkuVHlwZSBuZSBcImF0TGl0ZXJhdHVyZVwiKScsIFtBcHAuY29udGV4dC51c2VyLiRrZXldKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFt1c2VyUXVlcnksIHRoZVF1ZXJ5XS5qb2luKCcgYW5kICcpO1xyXG4gICAgICB9LFxyXG4gICAgICBxdWVyeU9yZGVyQnk6ICdBY3Rpdml0eS5TdGFydERhdGUgZGVzYycsXHJcbiAgICAgIHF1ZXJ5U2VsZWN0OiBbXHJcbiAgICAgICAgJ0FsYXJtJyxcclxuICAgICAgICAnQWxhcm1UaW1lJyxcclxuICAgICAgICAnU3RhdHVzJyxcclxuICAgICAgICAnQWN0aXZpdHkvRGVzY3JpcHRpb24nLFxyXG4gICAgICAgICdBY3Rpdml0eS9TdGFydERhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9FbmREYXRlJyxcclxuICAgICAgICAnQWN0aXZpdHkvVHlwZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0FjY291bnROYW1lJyxcclxuICAgICAgICAnQWN0aXZpdHkvQWNjb3VudElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdElkJyxcclxuICAgICAgICAnQWN0aXZpdHkvQ29udGFjdE5hbWUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9MZWFkTmFtZScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L0xlYWRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L09wcG9ydHVuaXR5SWQnLFxyXG4gICAgICAgICdBY3Rpdml0eS9UaWNrZXRJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1VzZXJJZCcsXHJcbiAgICAgICAgJ0FjdGl2aXR5L1RpbWVsZXNzJyxcclxuICAgICAgICAnQWN0aXZpdHkvUGhvbmVOdW1iZXInLFxyXG4gICAgICAgICdBY3Rpdml0eS9SZWN1cnJpbmcnLFxyXG4gICAgICAgICdBY3Rpdml0eS9BbGFybScsXHJcbiAgICAgICAgJ0FjdGl2aXR5L01vZGlmeURhdGUnLFxyXG4gICAgICAgICdBY3Rpdml0eS9Qcmlvcml0eScsXHJcbiAgICAgIF0sXHJcbiAgICAgIHF1ZXJ5SW5jbHVkZTogW1xyXG4gICAgICAgICckZGVzY3JpcHRvcnMnLFxyXG4gICAgICBdLFxyXG4gICAgfSxcclxuICAgIF07XHJcbiAgfSxcclxuICBnZXRNeURheVF1ZXJ5OiBmdW5jdGlvbiBnZXRNeURheVF1ZXJ5KCkge1xyXG4gICAgY29uc3QgcXVlcnlNb2RlbCA9IHRoaXMuX2dldFF1ZXJ5TW9kZWxCeU5hbWUoJ215ZGF5Jyk7XHJcbiAgICByZXR1cm4gcXVlcnlNb2RlbCAmJiBxdWVyeU1vZGVsLnF1ZXJ5V2hlcmUoKTtcclxuICB9LFxyXG4gfSk7XHJcblxyXG5NYW5hZ2VyLnJlZ2lzdGVyKE1PREVMX05BTUVTLlVTRVJBQ1RJVklUWSwgTU9ERUxfVFlQRVMuU0RBVEEsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
