<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Format', ['exports', 'module', 'dojo/_base/lang', 'dojo/_base/array', 'dojo/string', 'dojo/number', './Template', 'argos/Format'], function (exports, module, _dojo_baseLang, _dojo_baseArray, _dojoString, _dojoNumber, _Template, _argosFormat) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _lang = _interopRequireDefault(_dojo_baseLang);

  var _array = _interopRequireDefault(_dojo_baseArray);

  var _string = _interopRequireDefault(_dojoString);

  var _dojoNumber2 = _interopRequireDefault(_dojoNumber);

  var _template = _interopRequireDefault(_Template);

  var _format = _interopRequireDefault(_argosFormat);

<span id='crm-Format'>  /**
</span>   * @class crm.Format
   *
   * @extends argos.Format
   * @requires crm.Template
   *
   */
  var __class = _lang['default'].setObject('crm.Format', _lang['default'].mixin({}, _format['default'], {
<span id='crm-Format-property-addressCultureFormats'>    /**
</span>     * Address Culture Formats as defined by crm.Format.address
     * http://msdn.microsoft.com/en-us/library/cc195167.aspx
     */
    addressCultureFormats: {
      'en': 'a1|a2|a3|m, R p|C',
      'en-GB': 'a1|a2|a3|M|P|C',
      'fr': 'a1|a2|a3|p M|C',
      'de': 'a1|a2|a3|p m|C',
      'it': 'a1|a2|a3|p m Z|C',
      'ru': 'a1|a2|a3|p m|C'
    },
<span id='crm-Format-property-countryCultures'>    /**
</span>     * Country name to culture identification
     * http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx
     */
    countryCultures: {
      'USA': 'en',
      'United States': 'en',
      'United States of America': 'en',
      'US': 'en',
      'United Kingdom': 'en-GB',
      'UK': 'en-GB',
      'Britain': 'en-GB',
      'England': 'en-GB',
      'Russia': 'ru',
      'Россия': 'ru',
      'Italy': 'it',
      'Italia': 'it',
      'France': 'fr',
      'Germany': 'de',
      'Deutschland': 'de'
    },
<span id='crm-Format-method-address'>    /**
</span>    Converts the given value using the provided format, joining with the separator character
    If no format given, will use predefined format for the addresses Country (or en-US as final fallback)
    &lt;pre&gt;
    Format    Description                                    Example
    ------    -----------------------------------------    -----------------------
     s         Salutation (Attention, Name)                ATTN: Mr. Bob
     S         Salutation Uppercase                        ATTN: MR. BOB
     a1        Address Line 1                              555 Oak Ave
     a2        Address Line 2                                #2038
     a3        Address Line 3
     m        Municipality (City, town, hamlet)            Phoenix
     M        Municipality Uppercase                        PHOENIX
     z        County (parish, providence)                    Maricopa
     Z         County Uppercase                            MARICOPA
     r        Region (State, area)                        AZ
     R        Region Uppercase                            AZ
     p         Postal Code (ZIP code)                        85021
     P         Postal Code Uppercase                        85021
     c         Country                                     France
     C         Country Uppercase                            FRANCE
       |        separator                                    as defined by separator variable
     &lt;/pre&gt;
     @param {object} o Address Entity containing all the SData properties
     @param {boolean} asText If set to true returns text only, if false returns anchor link to google maps
     @param {string|boolean} separator If false - separates with html &lt;br&gt;,
                          if true - separates with line return,
                          if defined as string - uses string to separate
     @param {string} fmt Address format to use, may also pass a culture string to use predefined format
     @return {string} Formatted address
    */
    address: function addressFormatter(o, asText, s, f) {
      function isEmpty(line) {
        var filterSymbols = _lang['default'].trim(line.replace(/,|\(|\)|\.|&gt;|-|&lt;|;|:|'|&quot;|\/|\?|\[|\]|{|}|_|=|\+|\\|\||!|@|#|\$|%|\^|&amp;|\*|`|~/g, ''));
        return filterSymbols === '';
      }

      var self = crm.Format;
      var fmt = f;
      var separator = s;

      if (!fmt) {
        var culture = self.resolveAddressCulture(o);
        fmt = self.addressCultureFormats[culture] || self.addressCultureFormats.en;
      }

      var lines = fmt.indexOf('|') === -1 ? [fmt] : fmt.split('|');
      lines = _array['default'].map(lines, function (line) {
        return self.replaceAddressPart(line, o);
      });

      var addressItems = [];

      var filtered = _array['default'].filter(lines, function (line) {
        return !isEmpty(line);
      });

      addressItems = _array['default'].map(filtered, function (line) {
        return self.encode(self.collapseSpace(line));
      });

      if (asText) {
        if (separator === true) {
          separator = '\n';
        }
        return addressItems.join(separator || '&lt;br /&gt;');
      }

      return _string['default'].substitute('&lt;a target=&quot;_blank&quot; href=&quot;http://maps.google.com/maps?q=${1}&quot;&gt;${0}&lt;/a&gt;', [addressItems.join('&lt;br /&gt;'), encodeURIComponent(self.decode(addressItems.join(' ')))]);
    },
    collapseSpace: function collapseSpace(text) {
      return _lang['default'].trim(text.replace(/\s+/g, ' '));
    },
    resolveAddressCulture: function resolveAddressCulture(o) {
      return crm.Format.countryCultures[o.Country] || Mobile.CultureInfo.name;
    },
    replaceAddressPart: function replaceAddressPart(fmt, o) {
      return fmt.replace(/s|S|a1|a2|a3|a4|m|M|z|Z|r|R|p|P|c|C/g, function replacePart(part) {
        switch (part) {// eslint-disable-line
          case 's':
            return o.Salutation || '';
          case 'S':
            return o.Salutation &amp;&amp; o.Salutation.toUpperCase() || '';
          case 'a1':
            return o.Address1 || '';
          case 'a2':
            return o.Address2 || '';
          case 'a3':
            return o.Address3 || '';
          case 'a4':
            return o.Address4 || '';
          case 'm':
            return o.City || '';
          case 'M':
            return o.City &amp;&amp; o.City.toUpperCase() || '';
          case 'z':
            return o.County || '';
          case 'Z':
            return o.County &amp;&amp; o.County.toUpperCase() || '';
          case 'r':
            return o.State || '';
          case 'R':
            return o.State &amp;&amp; o.State.toUpperCase() || '';
          case 'p':
            return o.PostalCode || '';
          case 'P':
            return o.PostalCode &amp;&amp; o.PostalCode.toUpperCase() || '';
          case 'c':
            return o.Country || '';
          case 'C':
            return o.Country &amp;&amp; o.Country.toUpperCase() || '';
        }
      });
    },
    // These were added to the SDK, and should not be here. Keeping the alias to not break anyone with a minor update.
    phoneFormat: _format['default'].phoneFormat,
    phone: _format['default'].phone,
    currency: function currency(_val) {
      var val = _val;
      if (isNaN(val) || val === null) {
        return val;
      }

      if (typeof val === 'string') {
        val = parseFloat(val);
      }

      var v = val.toFixed(2); // only 2 decimal places
      var f = Math.floor(parseFloat((100 * (v - Math.floor(v))).toPrecision(2))); // for fractional part, only need 2 significant digits

      return _string['default'].substitute('${0}' + Mobile.CultureInfo.numberFormat.currencyDecimalSeparator + '${1}', [Math.floor(v).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + Mobile.CultureInfo.numberFormat.currencyGroupSeparator.replace('\\.', '.')), f.toString().length &lt; 2 ? '0' + f.toString() : f.toString()]).replace(/ /g, ' '); // keep numbers from breaking
    },
    bigNumberAbbrText: {
      'billion': 'B',
      'million': 'M',
      'thousand': 'K'
    },
    bigNumber: function bigNumber(val) {
      var numParse = typeof val !== 'number' ? parseFloat(val) : val;
      var absVal = Math.abs(numParse);
      var text = crm.Format.bigNumberAbbrText;

      if (isNaN(numParse)) {
        return val;
      }

      var results = numParse.toString();
      if (absVal &gt;= 1000000000) {
        numParse = numParse / 1000000000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.billion;
      } else if (absVal &gt;= 1000000) {
        numParse = numParse / 1000000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.million;
      } else if (absVal &gt;= 1000) {
        numParse = numParse / 1000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.thousand;
      }

      return results;
    },
    relativeDate: function relativeDate(_date, timeless) {
      var date = moment(_date);
      if (!date || !date.isValid()) {
        throw new Error('Invalid date passed into crm.Format.relativeDate');
      }

      if (timeless) {
        // utc
        date = date.subtract({
          minutes: date.utcOffset()
        });
      }

      return date.fromNow();
    },
    multiCurrency: function multiCurrency(val, code) {
      return _string['default'].substitute('${0} ${1}', [crm.Format.currency(val), code]);
    },
    nameLF: function nameLF(val) {
      if (!val) {
        return '';
      }

      var name = _template['default'].nameLF.apply(val);
      return name;
    },
    mail: function mail(val) {
      if (typeof val !== 'string') {
        return val;
      }

      return _string['default'].substitute('&lt;a href=&quot;mailto:${0}&quot;&gt;${0}&lt;/a&gt;', [val]);
    },
    userActivityFormatText: {
      'asUnconfirmed': 'Unconfirmed',
      'asAccepted': 'Accepted',
      'asDeclned': 'Declined'
    },
    userActivityStatus: function userActivityStatus(val) {
      return crm.Format.userActivityFormatText[val];
    },
<span id='crm-Format-method-formatUserInitial'>    /**
</span>     * Takes a string input and converts name to First amd Last initials
     * `Lee Hogan` -&gt; `LH`
     * @param val
     * @returns {String}
     */
    formatUserInitial: function formatUserInitial(user) {
      var firstLast = this.resolveFirstLast(user);
      var initials = [firstLast[0].substr(0, 1)];

      if (firstLast[1]) {
        initials.push(firstLast[1].substr(0, 1));
      }

      return initials.join('').toUpperCase();
    },
<span id='crm-Format-method-formatByUser'>    /**
</span>     * Takes a string input and the user name to First amd Last name
     * `Hogan, Lee` -&gt; `Lee Hogan`
     * @param val
     * @returns {String}
     */
    formatByUser: function formatByUser(user) {
      var name = this.resolveFirstLast(user);
      return name.join(' ');
    },
<span id='crm-Format-method-resolveFirstLast'>    /**
</span>     * Takes a string input and the user name to First amd Last name
     * `Hogan, Lee` -&gt; `Lee Hogan`
     * @param val
     * @returns {String}
     */
    resolveFirstLast: function resolveFirstLast(name) {
      var firstLast = [];
      if (name.indexOf(' ') !== -1) {
        var names = name.split(' ');
        if (names[0].indexOf(',') !== -1) {
          firstLast = [names[1], names[0].slice(0, -1)];
        } else {
          firstLast = [names[0], names[1]];
        }
      } else {
        firstLast = [name];
      }
      return firstLast;
    },
    fixedLocale: function fixedLocale(_val, _d) {
      var val = _val;
      var d = _d;
      var p = undefined;
      var v = undefined;
      var f = undefined;
      var fVal = undefined;
      var num = undefined;

      if (isNaN(val) || val === null) {
        return val;
      }
      if (typeof val === 'string') {
        val = parseFloat(val);
      }
      if (typeof d !== 'number') {
        d = 2;
      }
      if (d &gt; 0) {
        p = Math.pow(10, d);
        v = val.toFixed(d); // only d decimal places
        f = Math.floor(parseFloat((p * (v - Math.floor(v))).toPrecision(d))); // for fractional part, only need d significant digits
        if (f === 0) {
          f = String(p).slice(1);
        }
      } else {
        // zero decimal palces
        p = Math.pow(10, 0);
        v = Math.round(val * p) / p;
        f = 0;
      }
      num = Math.floor(v).toString();
      num = num.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + Mobile.CultureInfo.numberFormat.numberGroupSeparator.replace('\\.', '.'));
      if (d &gt; 0) {
        var frac = f.toString().length &lt; d ? '' : f.toString();
        fVal = _string['default'].substitute('${0}' + Mobile.CultureInfo.numberFormat.numberDecimalSeparator + '${1}', [num, frac]);
      } else {
        fVal = num;
      }
      return fVal.replace(/ /g, ' '); // keep numbers from breaking
    }
  }));

  _lang['default'].setObject('Mobile.SalesLogix.Format', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,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QU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUM5SCxVQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7QUFDVCxZQUFNLElBQUksR0FBRyxBQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDM0QsWUFBSSxHQUFHLG1CQUFPLFVBQVUsQ0FDdEIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLHNCQUFzQixHQUFHLE1BQU0sRUFBRSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO09BQzFGLE1BQU07QUFDTCxZQUFJLEdBQUcsR0FBRyxDQUFDO09BQ1o7QUFDRCxhQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEdBQVEsQ0FBQyxDQUFDO0tBQ3JDO0dBQ0YsQ0FBQyxDQUFDLENBQUM7O0FBRUosbUJBQUssU0FBUyxDQUFDLDBCQUEwQixFQUFFLE9BQU8sQ0FBQyxDQUFDO21CQUNyQyxPQUFPIiwiZmlsZSI6InNyYy9Gb3JtYXQuanMiLCJzb3VyY2VSb290Ijoic3JjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxhbmcgZnJvbSAnZG9qby9fYmFzZS9sYW5nJztcclxuaW1wb3J0IGFycmF5IGZyb20gJ2Rvam8vX2Jhc2UvYXJyYXknO1xyXG5pbXBvcnQgc3RyaW5nIGZyb20gJ2Rvam8vc3RyaW5nJztcclxuaW1wb3J0IGRvam9OdW1iZXIgZnJvbSAnZG9qby9udW1iZXInO1xyXG5pbXBvcnQgdGVtcGxhdGUgZnJvbSAnLi9UZW1wbGF0ZSc7XHJcbmltcG9ydCBmb3JtYXQgZnJvbSAnYXJnb3MvRm9ybWF0JztcclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgY3JtLkZvcm1hdFxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBhcmdvcy5Gb3JtYXRcclxuICogQHJlcXVpcmVzIGNybS5UZW1wbGF0ZVxyXG4gKlxyXG4gKi9cclxuY29uc3QgX19jbGFzcyA9IGxhbmcuc2V0T2JqZWN0KCdjcm0uRm9ybWF0JywgbGFuZy5taXhpbih7fSwgZm9ybWF0LCB7XHJcbiAgLyoqXHJcbiAgICogQWRkcmVzcyBDdWx0dXJlIEZvcm1hdHMgYXMgZGVmaW5lZCBieSBjcm0uRm9ybWF0LmFkZHJlc3NcclxuICAgKiBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvY2MxOTUxNjcuYXNweFxyXG4gICAqL1xyXG4gIGFkZHJlc3NDdWx0dXJlRm9ybWF0czoge1xyXG4gICAgJ2VuJzogJ2ExfGEyfGEzfG0sIFIgcHxDJyxcclxuICAgICdlbi1HQic6ICdhMXxhMnxhM3xNfFB8QycsXHJcbiAgICAnZnInOiAnYTF8YTJ8YTN8cCBNfEMnLFxyXG4gICAgJ2RlJzogJ2ExfGEyfGEzfHAgbXxDJyxcclxuICAgICdpdCc6ICdhMXxhMnxhM3xwIG0gWnxDJyxcclxuICAgICdydSc6ICdhMXxhMnxhM3xwIG18QycsXHJcbiAgfSxcclxuICAvKipcclxuICAgKiBDb3VudHJ5IG5hbWUgdG8gY3VsdHVyZSBpZGVudGlmaWNhdGlvblxyXG4gICAqIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvZ29nbG9iYWwvYmI4OTYwMDEuYXNweFxyXG4gICAqL1xyXG4gIGNvdW50cnlDdWx0dXJlczoge1xyXG4gICAgJ1VTQSc6ICdlbicsXHJcbiAgICAnVW5pdGVkIFN0YXRlcyc6ICdlbicsXHJcbiAgICAnVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhJzogJ2VuJyxcclxuICAgICdVUyc6ICdlbicsXHJcbiAgICAnVW5pdGVkIEtpbmdkb20nOiAnZW4tR0InLFxyXG4gICAgJ1VLJzogJ2VuLUdCJyxcclxuICAgICdCcml0YWluJzogJ2VuLUdCJyxcclxuICAgICdFbmdsYW5kJzogJ2VuLUdCJyxcclxuICAgICdSdXNzaWEnOiAncnUnLFxyXG4gICAgJ9Cg0L7RgdGB0LjRjyc6ICdydScsXHJcbiAgICAnSXRhbHknOiAnaXQnLFxyXG4gICAgJ0l0YWxpYSc6ICdpdCcsXHJcbiAgICAnRnJhbmNlJzogJ2ZyJyxcclxuICAgICdHZXJtYW55JzogJ2RlJyxcclxuICAgICdEZXV0c2NobGFuZCc6ICdkZScsXHJcbiAgfSxcclxuICAvKipcclxuICBDb252ZXJ0cyB0aGUgZ2l2ZW4gdmFsdWUgdXNpbmcgdGhlIHByb3ZpZGVkIGZvcm1hdCwgam9pbmluZyB3aXRoIHRoZSBzZXBhcmF0b3IgY2hhcmFjdGVyXHJcbiAgSWYgbm8gZm9ybWF0IGdpdmVuLCB3aWxsIHVzZSBwcmVkZWZpbmVkIGZvcm1hdCBmb3IgdGhlIGFkZHJlc3NlcyBDb3VudHJ5IChvciBlbi1VUyBhcyBmaW5hbCBmYWxsYmFjaylcclxuICA8cHJlPlxyXG4gIEZvcm1hdCAgICBEZXNjcmlwdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4YW1wbGVcclxuICAtLS0tLS0gICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgcyAgICAgICAgIFNhbHV0YXRpb24gKEF0dGVudGlvbiwgTmFtZSkgICAgICAgICAgICAgICAgQVRUTjogTXIuIEJvYlxyXG4gICBTICAgICAgICAgU2FsdXRhdGlvbiBVcHBlcmNhc2UgICAgICAgICAgICAgICAgICAgICAgICBBVFROOiBNUi4gQk9CXHJcbiAgIGExICAgICAgICBBZGRyZXNzIExpbmUgMSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU1NSBPYWsgQXZlXHJcbiAgIGEyICAgICAgICBBZGRyZXNzIExpbmUgMiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIzIwMzhcclxuICAgYTMgICAgICAgIEFkZHJlc3MgTGluZSAzXHJcbiAgIG0gICAgICAgIE11bmljaXBhbGl0eSAoQ2l0eSwgdG93biwgaGFtbGV0KSAgICAgICAgICAgIFBob2VuaXhcclxuICAgTSAgICAgICAgTXVuaWNpcGFsaXR5IFVwcGVyY2FzZSAgICAgICAgICAgICAgICAgICAgICAgIFBIT0VOSVhcclxuICAgeiAgICAgICAgQ291bnR5IChwYXJpc2gsIHByb3ZpZGVuY2UpICAgICAgICAgICAgICAgICAgICBNYXJpY29wYVxyXG4gICBaICAgICAgICAgQ291bnR5IFVwcGVyY2FzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVJJQ09QQVxyXG4gICByICAgICAgICBSZWdpb24gKFN0YXRlLCBhcmVhKSAgICAgICAgICAgICAgICAgICAgICAgIEFaXHJcbiAgIFIgICAgICAgIFJlZ2lvbiBVcHBlcmNhc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVpcclxuICAgcCAgICAgICAgIFBvc3RhbCBDb2RlIChaSVAgY29kZSkgICAgICAgICAgICAgICAgICAgICAgICA4NTAyMVxyXG4gICBQICAgICAgICAgUG9zdGFsIENvZGUgVXBwZXJjYXNlICAgICAgICAgICAgICAgICAgICAgICAgODUwMjFcclxuICAgYyAgICAgICAgIENvdW50cnkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbmNlXHJcbiAgIEMgICAgICAgICBDb3VudHJ5IFVwcGVyY2FzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUkFOQ0VcclxuXHJcbiAgIHwgICAgICAgIHNlcGFyYXRvciAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzIGRlZmluZWQgYnkgc2VwYXJhdG9yIHZhcmlhYmxlXHJcbiAgIDwvcHJlPlxyXG4gICBAcGFyYW0ge29iamVjdH0gbyBBZGRyZXNzIEVudGl0eSBjb250YWluaW5nIGFsbCB0aGUgU0RhdGEgcHJvcGVydGllc1xyXG4gICBAcGFyYW0ge2Jvb2xlYW59IGFzVGV4dCBJZiBzZXQgdG8gdHJ1ZSByZXR1cm5zIHRleHQgb25seSwgaWYgZmFsc2UgcmV0dXJucyBhbmNob3IgbGluayB0byBnb29nbGUgbWFwc1xyXG4gICBAcGFyYW0ge3N0cmluZ3xib29sZWFufSBzZXBhcmF0b3IgSWYgZmFsc2UgLSBzZXBhcmF0ZXMgd2l0aCBodG1sIDxicj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRydWUgLSBzZXBhcmF0ZXMgd2l0aCBsaW5lIHJldHVybixcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGVmaW5lZCBhcyBzdHJpbmcgLSB1c2VzIHN0cmluZyB0byBzZXBhcmF0ZVxyXG4gICBAcGFyYW0ge3N0cmluZ30gZm10IEFkZHJlc3MgZm9ybWF0IHRvIHVzZSwgbWF5IGFsc28gcGFzcyBhIGN1bHR1cmUgc3RyaW5nIHRvIHVzZSBwcmVkZWZpbmVkIGZvcm1hdFxyXG4gICBAcmV0dXJuIHtzdHJpbmd9IEZvcm1hdHRlZCBhZGRyZXNzXHJcbiAgKi9cclxuICBhZGRyZXNzOiBmdW5jdGlvbiBhZGRyZXNzRm9ybWF0dGVyKG8sIGFzVGV4dCwgcywgZikge1xyXG4gICAgZnVuY3Rpb24gaXNFbXB0eShsaW5lKSB7XHJcbiAgICAgIGNvbnN0IGZpbHRlclN5bWJvbHMgPSBsYW5nLnRyaW0obGluZS5yZXBsYWNlKC8sfFxcKHxcXCl8XFwufD58LXw8fDt8OnwnfFwifFxcL3xcXD98XFxbfFxcXXx7fH18X3w9fFxcK3xcXFxcfFxcfHwhfEB8I3xcXCR8JXxcXF58JnxcXCp8YHx+L2csICcnKSk7XHJcbiAgICAgIHJldHVybiBmaWx0ZXJTeW1ib2xzID09PSAnJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZWxmID0gY3JtLkZvcm1hdDtcclxuICAgIGxldCBmbXQgPSBmO1xyXG4gICAgbGV0IHNlcGFyYXRvciA9IHM7XHJcblxyXG4gICAgaWYgKCFmbXQpIHtcclxuICAgICAgY29uc3QgY3VsdHVyZSA9IHNlbGYucmVzb2x2ZUFkZHJlc3NDdWx0dXJlKG8pO1xyXG4gICAgICBmbXQgPSBzZWxmLmFkZHJlc3NDdWx0dXJlRm9ybWF0c1tjdWx0dXJlXSB8fCBzZWxmLmFkZHJlc3NDdWx0dXJlRm9ybWF0cy5lbjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbGluZXMgPSAoZm10LmluZGV4T2YoJ3wnKSA9PT0gLTEpID8gW2ZtdF0gOiBmbXQuc3BsaXQoJ3wnKTtcclxuICAgIGxpbmVzID0gYXJyYXkubWFwKGxpbmVzLCAobGluZSkgPT4ge1xyXG4gICAgICByZXR1cm4gc2VsZi5yZXBsYWNlQWRkcmVzc1BhcnQobGluZSwgbyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgYWRkcmVzc0l0ZW1zID0gW107XHJcblxyXG4gICAgY29uc3QgZmlsdGVyZWQgPSBhcnJheS5maWx0ZXIobGluZXMsIChsaW5lKSA9PiB7XHJcbiAgICAgIHJldHVybiAhaXNFbXB0eShsaW5lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFkZHJlc3NJdGVtcyA9IGFycmF5Lm1hcChmaWx0ZXJlZCwgKGxpbmUpID0+IHtcclxuICAgICAgcmV0dXJuIHNlbGYuZW5jb2RlKHNlbGYuY29sbGFwc2VTcGFjZShsaW5lKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoYXNUZXh0KSB7XHJcbiAgICAgIGlmIChzZXBhcmF0b3IgPT09IHRydWUpIHtcclxuICAgICAgICBzZXBhcmF0b3IgPSAnXFxuJztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYWRkcmVzc0l0ZW1zLmpvaW4oc2VwYXJhdG9yIHx8ICc8YnIgLz4nKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc3RyaW5nLnN1YnN0aXR1dGUoXHJcbiAgICAgICc8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBzP3E9JHsxfVwiPiR7MH08L2E+JywgW2FkZHJlc3NJdGVtcy5qb2luKCc8YnIgLz4nKSwgZW5jb2RlVVJJQ29tcG9uZW50KHNlbGYuZGVjb2RlKGFkZHJlc3NJdGVtcy5qb2luKCcgJykpKV1cclxuICAgICk7XHJcbiAgfSxcclxuICBjb2xsYXBzZVNwYWNlOiBmdW5jdGlvbiBjb2xsYXBzZVNwYWNlKHRleHQpIHtcclxuICAgIHJldHVybiBsYW5nLnRyaW0odGV4dC5yZXBsYWNlKC9cXHMrL2csICcgJykpO1xyXG4gIH0sXHJcbiAgcmVzb2x2ZUFkZHJlc3NDdWx0dXJlOiBmdW5jdGlvbiByZXNvbHZlQWRkcmVzc0N1bHR1cmUobykge1xyXG4gICAgcmV0dXJuIGNybS5Gb3JtYXQuY291bnRyeUN1bHR1cmVzW28uQ291bnRyeV0gfHwgTW9iaWxlLkN1bHR1cmVJbmZvLm5hbWU7XHJcbiAgfSxcclxuICByZXBsYWNlQWRkcmVzc1BhcnQ6IGZ1bmN0aW9uIHJlcGxhY2VBZGRyZXNzUGFydChmbXQsIG8pIHtcclxuICAgIHJldHVybiBmbXQucmVwbGFjZSgvc3xTfGExfGEyfGEzfGE0fG18TXx6fFp8cnxSfHB8UHxjfEMvZyxcclxuICAgICAgZnVuY3Rpb24gcmVwbGFjZVBhcnQocGFydCkge1xyXG4gICAgICAgIHN3aXRjaCAocGFydCkgey8vIGVzbGludC1kaXNhYmxlLWxpbmVcclxuICAgICAgICAgIGNhc2UgJ3MnOlxyXG4gICAgICAgICAgICByZXR1cm4gby5TYWx1dGF0aW9uIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnUyc6XHJcbiAgICAgICAgICAgIHJldHVybiAoby5TYWx1dGF0aW9uICYmIG8uU2FsdXRhdGlvbi50b1VwcGVyQ2FzZSgpKSB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ2ExJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQWRkcmVzczEgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdhMic6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkFkZHJlc3MyIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnYTMnOlxyXG4gICAgICAgICAgICByZXR1cm4gby5BZGRyZXNzMyB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ2E0JzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQWRkcmVzczQgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdtJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQ2l0eSB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ00nOlxyXG4gICAgICAgICAgICByZXR1cm4gKG8uQ2l0eSAmJiBvLkNpdHkudG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICd6JzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQ291bnR5IHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnWic6XHJcbiAgICAgICAgICAgIHJldHVybiAoby5Db3VudHkgJiYgby5Db3VudHkudG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdyJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uU3RhdGUgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdSJzpcclxuICAgICAgICAgICAgcmV0dXJuIChvLlN0YXRlICYmIG8uU3RhdGUudG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdwJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uUG9zdGFsQ29kZSB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ1AnOlxyXG4gICAgICAgICAgICByZXR1cm4gKG8uUG9zdGFsQ29kZSAmJiBvLlBvc3RhbENvZGUudG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdjJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQ291bnRyeSB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ0MnOlxyXG4gICAgICAgICAgICByZXR1cm4gKG8uQ291bnRyeSAmJiBvLkNvdW50cnkudG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH0sXHJcbiAgLy8gVGhlc2Ugd2VyZSBhZGRlZCB0byB0aGUgU0RLLCBhbmQgc2hvdWxkIG5vdCBiZSBoZXJlLiBLZWVwaW5nIHRoZSBhbGlhcyB0byBub3QgYnJlYWsgYW55b25lIHdpdGggYSBtaW5vciB1cGRhdGUuXHJcbiAgcGhvbmVGb3JtYXQ6IGZvcm1hdC5waG9uZUZvcm1hdCxcclxuICBwaG9uZTogZm9ybWF0LnBob25lLFxyXG4gIGN1cnJlbmN5OiBmdW5jdGlvbiBjdXJyZW5jeShfdmFsKSB7XHJcbiAgICBsZXQgdmFsID0gX3ZhbDtcclxuICAgIGlmIChpc05hTih2YWwpIHx8IHZhbCA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xyXG4gICAgICB2YWwgPSBwYXJzZUZsb2F0KHZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdiA9IHZhbC50b0ZpeGVkKDIpOyAvLyBvbmx5IDIgZGVjaW1hbCBwbGFjZXNcclxuICAgIGNvbnN0IGYgPSBNYXRoLmZsb29yKHBhcnNlRmxvYXQoKDEwMCAqICh2IC0gTWF0aC5mbG9vcih2KSkpLnRvUHJlY2lzaW9uKDIpKSk7IC8vIGZvciBmcmFjdGlvbmFsIHBhcnQsIG9ubHkgbmVlZCAyIHNpZ25pZmljYW50IGRpZ2l0c1xyXG5cclxuICAgIHJldHVybiBzdHJpbmcuc3Vic3RpdHV0ZShcclxuICAgICAgJyR7MH0nICsgTW9iaWxlLkN1bHR1cmVJbmZvLm51bWJlckZvcm1hdC5jdXJyZW5jeURlY2ltYWxTZXBhcmF0b3IgKyAnJHsxfScsIFtcclxuICAgICAgICAoTWF0aC5mbG9vcih2KSkudG9TdHJpbmcoKS5yZXBsYWNlKC8oXFxkKSg/PShcXGR7M30pKyg/IVxcZCkpL2csICckMScgKyBNb2JpbGUuQ3VsdHVyZUluZm8ubnVtYmVyRm9ybWF0LmN1cnJlbmN5R3JvdXBTZXBhcmF0b3IucmVwbGFjZSgnXFxcXC4nLCAnLicpKSwgKGYudG9TdHJpbmcoKS5sZW5ndGggPCAyKSA/ICcwJyArIGYudG9TdHJpbmcoKSA6IGYudG9TdHJpbmcoKSxcclxuICAgICAgXVxyXG4gICAgKS5yZXBsYWNlKC8gL2csICdcXHUwMEEwJyk7IC8vIGtlZXAgbnVtYmVycyBmcm9tIGJyZWFraW5nXHJcbiAgfSxcclxuICBiaWdOdW1iZXJBYmJyVGV4dDoge1xyXG4gICAgJ2JpbGxpb24nOiAnQicsXHJcbiAgICAnbWlsbGlvbic6ICdNJyxcclxuICAgICd0aG91c2FuZCc6ICdLJyxcclxuICB9LFxyXG4gIGJpZ051bWJlcjogZnVuY3Rpb24gYmlnTnVtYmVyKHZhbCkge1xyXG4gICAgbGV0IG51bVBhcnNlID0gdHlwZW9mIHZhbCAhPT0gJ251bWJlcicgPyBwYXJzZUZsb2F0KHZhbCkgOiB2YWw7XHJcbiAgICBjb25zdCBhYnNWYWwgPSBNYXRoLmFicyhudW1QYXJzZSk7XHJcbiAgICBjb25zdCB0ZXh0ID0gY3JtLkZvcm1hdC5iaWdOdW1iZXJBYmJyVGV4dDtcclxuXHJcbiAgICBpZiAoaXNOYU4obnVtUGFyc2UpKSB7XHJcbiAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJlc3VsdHMgPSBudW1QYXJzZS50b1N0cmluZygpO1xyXG4gICAgaWYgKGFic1ZhbCA+PSAxMDAwMDAwMDAwKSB7XHJcbiAgICAgIG51bVBhcnNlID0gbnVtUGFyc2UgLyAxMDAwMDAwMDAwO1xyXG4gICAgICByZXN1bHRzID0gZG9qb051bWJlci5mb3JtYXQobnVtUGFyc2UsIHtcclxuICAgICAgICBwbGFjZXM6IDEsXHJcbiAgICAgIH0pICsgdGV4dC5iaWxsaW9uO1xyXG4gICAgfSBlbHNlIGlmIChhYnNWYWwgPj0gMTAwMDAwMCkge1xyXG4gICAgICBudW1QYXJzZSA9IG51bVBhcnNlIC8gMTAwMDAwMDtcclxuICAgICAgcmVzdWx0cyA9IGRvam9OdW1iZXIuZm9ybWF0KG51bVBhcnNlLCB7XHJcbiAgICAgICAgcGxhY2VzOiAxLFxyXG4gICAgICB9KSArIHRleHQubWlsbGlvbjtcclxuICAgIH0gZWxzZSBpZiAoYWJzVmFsID49IDEwMDApIHtcclxuICAgICAgbnVtUGFyc2UgPSBudW1QYXJzZSAvIDEwMDA7XHJcbiAgICAgIHJlc3VsdHMgPSBkb2pvTnVtYmVyLmZvcm1hdChudW1QYXJzZSwge1xyXG4gICAgICAgIHBsYWNlczogMSxcclxuICAgICAgfSkgKyB0ZXh0LnRob3VzYW5kO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG4gIH0sXHJcbiAgcmVsYXRpdmVEYXRlOiBmdW5jdGlvbiByZWxhdGl2ZURhdGUoX2RhdGUsIHRpbWVsZXNzKSB7XHJcbiAgICBsZXQgZGF0ZSA9IG1vbWVudChfZGF0ZSk7XHJcbiAgICBpZiAoIWRhdGUgfHwgIWRhdGUuaXNWYWxpZCgpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBkYXRlIHBhc3NlZCBpbnRvIGNybS5Gb3JtYXQucmVsYXRpdmVEYXRlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRpbWVsZXNzKSB7XHJcbiAgICAgIC8vIHV0Y1xyXG4gICAgICBkYXRlID0gZGF0ZS5zdWJ0cmFjdCh7XHJcbiAgICAgICAgbWludXRlczogZGF0ZS51dGNPZmZzZXQoKSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRhdGUuZnJvbU5vdygpO1xyXG4gIH0sXHJcbiAgbXVsdGlDdXJyZW5jeTogZnVuY3Rpb24gbXVsdGlDdXJyZW5jeSh2YWwsIGNvZGUpIHtcclxuICAgIHJldHVybiBzdHJpbmcuc3Vic3RpdHV0ZSgnJHswfSAkezF9JywgW2NybS5Gb3JtYXQuY3VycmVuY3kodmFsKSwgY29kZV0pO1xyXG4gIH0sXHJcbiAgbmFtZUxGOiBmdW5jdGlvbiBuYW1lTEYodmFsKSB7XHJcbiAgICBpZiAoIXZhbCkge1xyXG4gICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbmFtZSA9IHRlbXBsYXRlLm5hbWVMRi5hcHBseSh2YWwpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbiAgfSxcclxuICBtYWlsOiBmdW5jdGlvbiBtYWlsKHZhbCkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN0cmluZy5zdWJzdGl0dXRlKCc8YSBocmVmPVwibWFpbHRvOiR7MH1cIj4kezB9PC9hPicsIFt2YWxdKTtcclxuICB9LFxyXG4gIHVzZXJBY3Rpdml0eUZvcm1hdFRleHQ6IHtcclxuICAgICdhc1VuY29uZmlybWVkJzogJ1VuY29uZmlybWVkJyxcclxuICAgICdhc0FjY2VwdGVkJzogJ0FjY2VwdGVkJyxcclxuICAgICdhc0RlY2xuZWQnOiAnRGVjbGluZWQnLFxyXG4gIH0sXHJcbiAgdXNlckFjdGl2aXR5U3RhdHVzOiBmdW5jdGlvbiB1c2VyQWN0aXZpdHlTdGF0dXModmFsKSB7XHJcbiAgICByZXR1cm4gY3JtLkZvcm1hdC51c2VyQWN0aXZpdHlGb3JtYXRUZXh0W3ZhbF07XHJcbiAgfSxcclxuICAvKipcclxuICAgKiBUYWtlcyBhIHN0cmluZyBpbnB1dCBhbmQgY29udmVydHMgbmFtZSB0byBGaXJzdCBhbWQgTGFzdCBpbml0aWFsc1xyXG4gICAqIGBMZWUgSG9nYW5gIC0+IGBMSGBcclxuICAgKiBAcGFyYW0gdmFsXHJcbiAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgKi9cclxuICBmb3JtYXRVc2VySW5pdGlhbDogZnVuY3Rpb24gZm9ybWF0VXNlckluaXRpYWwodXNlcikge1xyXG4gICAgY29uc3QgZmlyc3RMYXN0ID0gdGhpcy5yZXNvbHZlRmlyc3RMYXN0KHVzZXIpO1xyXG4gICAgY29uc3QgaW5pdGlhbHMgPSBbZmlyc3RMYXN0WzBdLnN1YnN0cigwLCAxKV07XHJcblxyXG4gICAgaWYgKGZpcnN0TGFzdFsxXSkge1xyXG4gICAgICBpbml0aWFscy5wdXNoKGZpcnN0TGFzdFsxXS5zdWJzdHIoMCwgMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBpbml0aWFscy5qb2luKCcnKS50b1VwcGVyQ2FzZSgpO1xyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICogVGFrZXMgYSBzdHJpbmcgaW5wdXQgYW5kIHRoZSB1c2VyIG5hbWUgdG8gRmlyc3QgYW1kIExhc3QgbmFtZVxyXG4gICAqIGBIb2dhbiwgTGVlYCAtPiBgTGVlIEhvZ2FuYFxyXG4gICAqIEBwYXJhbSB2YWxcclxuICAgKiBAcmV0dXJucyB7U3RyaW5nfVxyXG4gICAqL1xyXG4gIGZvcm1hdEJ5VXNlcjogZnVuY3Rpb24gZm9ybWF0QnlVc2VyKHVzZXIpIHtcclxuICAgIGNvbnN0IG5hbWUgPSB0aGlzLnJlc29sdmVGaXJzdExhc3QodXNlcik7XHJcbiAgICByZXR1cm4gbmFtZS5qb2luKCcgJyk7XHJcbiAgfSxcclxuICAvKipcclxuICAgKiBUYWtlcyBhIHN0cmluZyBpbnB1dCBhbmQgdGhlIHVzZXIgbmFtZSB0byBGaXJzdCBhbWQgTGFzdCBuYW1lXHJcbiAgICogYEhvZ2FuLCBMZWVgIC0+IGBMZWUgSG9nYW5gXHJcbiAgICogQHBhcmFtIHZhbFxyXG4gICAqIEByZXR1cm5zIHtTdHJpbmd9XHJcbiAgICovXHJcbiAgcmVzb2x2ZUZpcnN0TGFzdDogZnVuY3Rpb24gcmVzb2x2ZUZpcnN0TGFzdChuYW1lKSB7XHJcbiAgICBsZXQgZmlyc3RMYXN0ID0gW107XHJcbiAgICBpZiAobmFtZS5pbmRleE9mKCcgJykgIT09IC0xKSB7XHJcbiAgICAgIGNvbnN0IG5hbWVzID0gbmFtZS5zcGxpdCgnICcpO1xyXG4gICAgICBpZiAobmFtZXNbMF0uaW5kZXhPZignLCcpICE9PSAtMSkge1xyXG4gICAgICAgIGZpcnN0TGFzdCA9IFtuYW1lc1sxXSwgbmFtZXNbMF0uc2xpY2UoMCwgLTEpXTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmaXJzdExhc3QgPSBbbmFtZXNbMF0sIG5hbWVzWzFdXTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmlyc3RMYXN0ID0gW25hbWVdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpcnN0TGFzdDtcclxuICB9LFxyXG4gIGZpeGVkTG9jYWxlOiBmdW5jdGlvbiBmaXhlZExvY2FsZShfdmFsLCBfZCkge1xyXG4gICAgbGV0IHZhbCA9IF92YWw7XHJcbiAgICBsZXQgZCA9IF9kO1xyXG4gICAgbGV0IHA7XHJcbiAgICBsZXQgdjtcclxuICAgIGxldCBmO1xyXG4gICAgbGV0IGZWYWw7XHJcbiAgICBsZXQgbnVtO1xyXG5cclxuICAgIGlmIChpc05hTih2YWwpIHx8IHZhbCA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsKTtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZCAhPT0gJ251bWJlcicpIHtcclxuICAgICAgZCA9IDI7XHJcbiAgICB9XHJcbiAgICBpZiAoZCA+IDApIHtcclxuICAgICAgcCA9IE1hdGgucG93KDEwLCBkKTtcclxuICAgICAgdiA9IHZhbC50b0ZpeGVkKGQpOyAvLyBvbmx5IGQgZGVjaW1hbCBwbGFjZXNcclxuICAgICAgZiA9IE1hdGguZmxvb3IocGFyc2VGbG9hdCgocCAqICh2IC0gTWF0aC5mbG9vcih2KSkpLnRvUHJlY2lzaW9uKGQpKSk7IC8vIGZvciBmcmFjdGlvbmFsIHBhcnQsIG9ubHkgbmVlZCBkIHNpZ25pZmljYW50IGRpZ2l0c1xyXG4gICAgICBpZiAoZiA9PT0gMCkge1xyXG4gICAgICAgIGYgPSAoU3RyaW5nKHApKS5zbGljZSgxKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHsgLy8gemVybyBkZWNpbWFsIHBhbGNlc1xyXG4gICAgICBwID0gTWF0aC5wb3coMTAsIDApO1xyXG4gICAgICB2ID0gKE1hdGgucm91bmQodmFsICogcCkgLyBwKTtcclxuICAgICAgZiA9IDA7XHJcbiAgICB9XHJcbiAgICBudW0gPSBNYXRoLmZsb29yKHYpLnRvU3RyaW5nKCk7XHJcbiAgICBudW0gPSBudW0ucmVwbGFjZSgvKFxcZCkoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCAnJDEnICsgTW9iaWxlLkN1bHR1cmVJbmZvLm51bWJlckZvcm1hdC5udW1iZXJHcm91cFNlcGFyYXRvci5yZXBsYWNlKCdcXFxcLicsICcuJykpO1xyXG4gICAgaWYgKGQgPiAwKSB7XHJcbiAgICAgIGNvbnN0IGZyYWMgPSAoZi50b1N0cmluZygpLmxlbmd0aCA8IGQpID8gJycgOiBmLnRvU3RyaW5nKCk7XHJcbiAgICAgIGZWYWwgPSBzdHJpbmcuc3Vic3RpdHV0ZShcclxuICAgICAgICAnJHswfScgKyBNb2JpbGUuQ3VsdHVyZUluZm8ubnVtYmVyRm9ybWF0Lm51bWJlckRlY2ltYWxTZXBhcmF0b3IgKyAnJHsxfScsIFtudW0sIGZyYWNdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZWYWwgPSBudW07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZlZhbC5yZXBsYWNlKC8gL2csICdcXHUwMEEwJyk7IC8vIGtlZXAgbnVtYmVycyBmcm9tIGJyZWFraW5nXHJcbiAgfSxcclxufSkpO1xyXG5cclxubGFuZy5zZXRPYmplY3QoJ01vYmlsZS5TYWxlc0xvZ2l4LkZvcm1hdCcsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
