/**
* Soho XI Controls v4.2.1-rc.1 
* Date: 21/09/2016 2:20:17 PM 
* Revision: dca25746ab00034dc8aa98db05b015602a0c2159 
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){function b(b){return this.element=a(b),this.url=this.getCurrentURL(),this}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}function d(b){var d,e,f,g=b.nodeName.toLowerCase(),h=!isNaN(a.attr(b,"tabindex"));return"area"===g?(d=b.parentNode,e=d.name,b.href&&e&&"map"===d.nodeName.toLowerCase()?(f=a("img[usemap=#"+e+"]")[0],!!f&&c(f)):!1):(/input|select|textarea|button|object/.test(g)?!b.disabled:"a"===g?b.href||h:h)&&c(b)}function e(b){this.settings=a.extend({},D,b),this.init()}function f(a){return a&&!(a instanceof jQuery)}function g(a,b){var c=f(a);return c?a[b]&&"function"==typeof a[b]:!1}function h(a,b){return g(a,b)?(a[b](),!0):!1}function i(b,c){var d=[];return a.each(b,function(b,e){a.each(a(e).data(),function(b,f){h(f,c)&&d.push({elem:a(e),control:f})})}),d}function j(b,c){if(b&&c){b=a(b);var d=b.find("*").add(b),e=i(d,c);return b.trigger("sift-"+c+"-complete",[e]),b}}function k(a,b,c){var d;return b&&"object"==typeof b&&(void 0!==b[a]?d=b[a]:c&&b.get&&"function"==typeof b.get&&(d=b.get(a))),d}function l(a){return"t.b("+a+");"}function m(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].o===a.n)return a.tag="#",!0}function n(a,b,c){for(var d=0,e=c.length;e>d;d++)if(c[d].c===a&&c[d].o===b)return!0}function o(a){return a.replace(K,"\\\\").replace(R,"\\'").replace(I,"\\n").replace(J,"\\r").replace(L,"\\u2028").replace(M,"\\u2029")}function p(a,b,c,d,e,f){function g(){}function h(){}g.prototype=a,h.prototype=a.subs;var i,j=new g;j.subs=new h,j.subsText={},j.buf="",d=d||{},j.stackSubs=d,j.subsText=f;for(i in b)d[i]||(d[i]=b[i]);for(i in d)j.subs[i]=d[i];e=e||{},j.stackPartials=e;for(i in c)e[i]||(e[i]=c[i]);for(i in e)j.partials[i]=e[i];return j}function q(a){return String(null===a||void 0===a?"":a)}function r(a){"}"===a.n.substr(a.n.length-1)&&(a.n=a.n.substring(0,a.n.length-1))}function s(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}function t(a,b,c){if(b.charAt(c)!==a.charAt(0))return!1;for(var d=1,e=a.length;e>d;d++)if(b.charAt(c+d)!==a.charAt(d))return!1;return!0}function u(a){return a=q(a),S.test(a)?a.replace(N,"&amp;").replace(O,"&lt;").replace(P,"&gt;").replace(Q,"&#39;").replace(R,"&quot;"):a}function v(a,b,c,d){var e=[],f=null,g=null,h=null;for(g=c[c.length-1];a.length>0;){if(h=a.shift(),g&&"<"===g.tag&&!(h.tag in T))throw new Error("Illegal content in < super tag.");if(G.tags[h.tag]<=G.tags.$||m(h,d))c.push(h),h.nodes=v(a,h.tag,c,d);else{if("/"===h.tag){if(0===c.length)throw new Error("Closing tag without opener: /"+h.n);if(f=c.pop(),h.n!==f.n&&!n(h.n,f.n,d))throw new Error("Nesting error: "+f.n+" vs. "+h.n);return f.end=h.i,e}"\n"===h.tag&&(h.last=0===a.length||"\n"===a[0].tag)}e.push(h)}if(c.length>0)throw new Error("missing closing tag: "+c.pop().n);return e}function w(a){var b=[];for(var c in a)b.push('"'+o(c)+'": function(c,p,t,i) {'+a[c]+"}");return"{ "+b.join(",")+" }"}function x(a){var b=[];for(var c in a.partials)b.push('"'+o(c)+'":{name:"'+o(a.partials[c].name)+'", '+x(a.partials[c])+"}");return"partials: {"+b.join(",")+"}, subs: "+w(a.subs)}function y(a){return~a.indexOf(".")?"d":"f"}function z(a,b){var c="<"+(b.prefix||""),d=c+a.n+U++;return b.partials[d]={name:a.n,partials:{}},b.code+='t.b(t.rp("'+o(d)+'",c,p,"'+(a.indent||"")+'"));',d}function A(a,b){b.code+="t.b(t.t(t."+y(a.n)+'("'+o(a.n)+'",c,p,0)));'}function B(b){this.element=a(b),this.init()}a.fn.initialize=function(b){"use strict";function c(b,c){this.settings=a.extend({},c),this.element=a(b),this.init()}var d,e="initialize",f={locale:Locale.currentLocale.name||"en-US"};return"string"==typeof b?(d={},d.locale=b):d=a.extend({},f,b),c.prototype={init:function(){var a=this;return Locale.set(this.settings.locale).done(function(){a.initAll()}),this},initAll:function(){return this.element.filter(":not(.no-init)").each(function(){function b(b,c){var d=a.fn.parseOptions(b);a(b)[c](d)}function c(a){var b=e.find(a);return e.filter(a).length&&(b=b.add(e)),b}function d(d,e){"undefined"==typeof e&&(e="."+d),a.fn[d]&&c(e).each(function(){var c=a(this);c.is(f)&&'[data-trackdirty="true"]'!==e||c.parents().hasClass("no-init")||(c.is(".icon")||!c.parents(".toolbar").length||c.parents().hasClass("masthead"))&&b(this,d)}),c(".radio-section input:radio.handle").change(function(){if(this.checked){var b=a(this).closest(".option"),c=b.siblings(),d='button, select, input[type="text"]';a(d,b).removeAttr("disabled"),a(d,c).attr("disabled","disabled")}})}var e=a(this),f=".no-init, [data-init]";a.fn.zoom&&a("head").zoom(),a.fn.applicationmenu&&c("#application-menu").applicationmenu({triggers:e.find(".application-menu-trigger")}),a.fn.personalize&&c("body").personalize();for(var g=[["icon"],["tabs",".tab-container:not(.vertical)"],["verticaltabs",".tab-container.vertical"],["dropdown","select.dropdown:not(.multiselect)"],["dropdown","select.dropdown-xs:not(.multiselect)"],["dropdown","select.dropdown-sm:not(.multiselect)"],["dropdown","select.dropdown-lg:not(.multiselect)"],["modal"],["slider",'input[type="range"], .slider'],["editor"],["tooltip","[title]"],["tree"],["rating"],["lightbox"],["progress",".progress-bar"],["mask","input[data-mask]"],["autocomplete",".autocomplete:not([data-init])"],["multiselect","select[multiple]:not(.dropdown), .multiselect:not([data-init])"],["button",".btn, .btn-secondary, .btn-primary, .btn-modal-primary, .btn-tertiary, .btn-icon, .btn-actions, .btn-menu, .btn-split, .btn-secondary-border"],["hideFocus","a.hide-focus, a.tick, a.hyperlink"],["pager",".paginated"],["trackdirty",'[data-trackdirty="true"]'],["clearable",'[data-clearable="true"]'],["textarea","textarea"],["spinbox"],["arrange"],["swaplist"],["colorpicker"],["datepicker"],["timepicker"],["tag"],["busyindicator",".busy, .busy-xs, .busy-sm"],["header"],["fileupload"],["fileuploadadvanced",".fileupload-advanced"],["about"],["contextualactionpanel",".contextual-action-panel-trigger"],["sidebar",".sidebar-nav"],["expandablearea",".expandable-area"],["modalsearch",".modal-search"],["signin"],["homepage"],["lookup",".lookup:not([data-init])"],["wizard"],["splitter"],["popdown","[data-popdown]"]],h=0;h<g.length;h++)d.apply(null,g[h]);if(a.fn.popupmenu){var i=", .btn-actions, .btn-filter, .btn-menu";c("[data-popupmenu]:not("+f+i+")").each(function(){var b=a(this),c=a.extend({},a.fn.parseOptions(this)),d=b.attr("data-popupmenu");d&&(c.menuId=d),b.popupmenu(c)}),c(".btn-filter, .btn-menu, .btn-actions").filter(":not("+f+")").each(function(){var c=a(this);c.parents(".toolbar").length>0||b(c,"popupmenu")})}if(a.fn.popover&&c("[data-popover]:not("+f+")").each(function(){var b=a(this),c=b.attr("data-trigger"),d=b.attr("data-title");b.popover({content:a("#"+b.attr("data-popover")),trigger:c?c:"click",title:d?d:void 0,placement:"right"})}),a.fn.listview&&c(".listview:not("+f+")").each(function(){var b=a(this),c=b.attr("data-dataset"),d=b.attr("data-tmpl"),e=a.fn.parseOptions(this)||{};e.dataset=e.dataset||c,e.template=e.template||d,window[e.dataset]&&(e.dataset=window[e.dataset]),e.template&&e.template.length&&(e.template=a("#"+e.template).html()),b.listview(e)}),a.fn.searchfield){var j=c(".searchfield:not("+f+")"),k=j.filter(function(){return a(this).parents(".toolbar").length});j=j.not(k),j.each(function(){b(this,"searchfield")})}a.fn.accordion&&c(".accordion:not("+f+")").each(function(){var c=a(this);c.parents(".application-menu").length||b(c,"accordion")}),a.fn.toolbar&&c(".toolbar:not("+f+")").each(function(){var c=a(this);c.parents(".header").length||c.parents(".contextual-action-panel").length||b(c,"toolbar")}),c('[data-translate="text"]').each(function(){var b=a(this);b.text(Locale.translate(b.text()))}),c(".block").on("click",function(){a(this).toggleClass("is-selected")}),a.fn.validate&&(c("[data-validate]").validate(),c('[data-validate-on="submit"]').validate()),a.fn.validate&&(c("[data-validate]").validate(),c('[data-validate-on="submit"]').validate()),c(".breadcrumb ol").attr("aria-label",Locale.translate("Breadcrumb"))}),this.element.triggerHandler("initialized"),this}},this.each(function(){var b=a.data(this,e);b||(b=a.data(this,e,new c(this,d)))})},b.prototype={getCurrentURL:function(){return window.location.href.replace(window.location.hash,"")},getBaseURL:function(a){return a?0===a.indexOf("/")?window.location.origin+a:(a=(-1===a.indexOf("#")?"#":"")+a,this.url+a):this.url}},a.getBaseURL=function(a){return a},a.detectBaseTag=function(){var c=a("base[href]");c.length&&(window.Soho.base=new b(c),a.getBaseURL=window.Soho.base.getBaseURL.bind(window.Soho.base))},a.fn.bindFirst=function(b,c){this.on(b,c),this.each(function(){var c=a._data(this,"events")[b.split(".")[0]],d=c.pop();c.splice(0,0,d)})},a.fn.uniqueId=function(b,c,d){var e=a(this).attr("id");if(e&&a("#"+e).length<2)return e;c=c?c+"-":"",d=d?"-"+d:"",b=b?b:a(this).attr("class");var f=a("."+b).length;return c+b+f+d},a.fn.cssPropSupport=function(b){"use strict";if(!b)return null;var c=a("<div></div>")[0],d=b.toString(),e=["Moz","Webkit","O","ms"],f=d.charAt(0).toUpperCase()+d.substr(1);if(b in c.style)return a(c).remove(),b;for(var g=0;g<e.length;g++){var h=e[g]+f;if(h in c.style)return a(c).remove(),h}return a(c).remove(),null},a.fn.transitionEndName=function(){var b=a.fn.cssPropSupport("transition"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",OTransition:"oTransitionEnd",transition:"transitionend"};return c[b]||null},a.extend(a.expr[":"],{focusable:function(b){return d(b,!isNaN(a.attr(b,"tabindex")))}}),a.fn.onTouchClick=function(b,c,d){return b=null!==b||void 0!==b?"."+b:"",c=null!==c||void 0!==c?c:"",this.each(function(){var e,f=a(this),g=d?"one":"on",h=10,i=!1;return f[g]("touchstart"+b,c,function(a){e={x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY}}),f[g]("touchmove"+b,c,function(a){var b;b={x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY},(b.x>=e.x+h||b.x<=e.x-h||b.y>=e.y+h||b.y<=e.y-h)&&(i=!0)}),f[g]("touchend"+b+" touchcancel"+b,c,function(b){var c=a(this);return i?void(i=!1):(setTimeout(function(){i=!1,b.preventDefault(),c.attr("disabled")||c.trigger("click")},0),!1)}),f})},a.fn.offTouchClick=function(b,c){return b=null!==b||void 0!==b?"."+b:"",c=null!==c||void 0!==c?c:"",this.each(function(){return a(this).off("touchend"+b+" touchcancel"+b+" touchstart"+b+" touchmove"+b,c)})},a.fn.listEvents=function(){var b={};return this.each(function(){b=a._data(this,"events")}),b},a.fn.placeholderPolyfill=function(b){if(!("placeholder"in document.createElement("input"))){var c=a.extend({className:"is-placeholder"},b),d=function(a,b,c){c&&a.attr("type",b)};a("[placeholder]").each(function(){var b=a(this),e=b.is('input[type="password"]');b.removeClass(c.className).on("focus.placeholderPolyfill, click.placeholderPolyfill",function(){b.val()===b.attr("placeholder")&&b.data("placeholder")&&b.get(0).setSelectionRange(0,0)}).on("keydown.placeholderPolyfill",function(){d(b,"password",e),b.val()===b.attr("placeholder")&&b.data("placeholder")&&(b.val(""),b.removeClass(c.className))}).on("blur.placeholderPolyfill",function(){""===b.val()?(d(b,"text",e),b.addClass(c.className),b.val(b.attr("placeholder")),b.data("placeholder",!0)):b.data("placeholder",!1)}).trigger("blur.placeholderPolyfill").parents("form").on("submit",function(){a("[placeholder]",this).each(function(){var b=a(this);b.val()===b.attr("placeholder")&&b.data("placeholder")&&b.val("")})})})}return this},a.fn.parseOptions=function(b,c){var d;if(c=c||"data-options",d=a(b).attr(c),d&&d.length&&d.indexOf("{")>-1)try{d=JSON.parse(d.replace(/'/g,'"'))}catch(e){var f=/({|,)(?:\s*)(?:')?([A-Za-z_$\.][A-Za-z0-9_ \-\.$]*)(?:')?(?:\s*):/g;d=d.replace(f,'$1"$2":'),f=/:(?:\s*)(?!(true|false|null|undefined))([A-Za-z_$\.#][A-Za-z0-9_ \-\.$]*)/g,d=d.replace(f,':"$2"'),d=JSON.parse(d.replace(/'/g,'"'))}return d||(d={}),d},a.fn.timer=function(b,c){var d,e=a(this),f=10,g=0,h=function(){e.triggerHandler("cancel"),clearInterval(d),g=0},i=function(){e.triggerHandler("pause"),clearInterval(d)},j=function(){d=setInterval(function(){g+=f,e.triggerHandler("update",[{counter:g}]),g>c&&(e.triggerHandler("timeout"),b.apply(arguments),clearInterval(d),g=0)},f)},k=function(){e.triggerHandler("resume"),j()};return j(),{event:this,cancel:h,pause:i,resume:k}},a.copyToClipboard=function(a){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",a);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var b=document.createElement("textarea");b.textContent=a,b.style.position="fixed",document.body.appendChild(b),b.select();try{return document.execCommand("copy")}catch(c){return!1}finally{document.body.removeChild(b)}}},a.escapeHTML=function(a){var b=a;return"string"==typeof a&&(b=b.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;").replace(/>/g,"&gt;")),b},a.unescapeHTML=function(a){var b=a;return"string"==typeof a&&(b=b.replace(/&lt;/g,"<").replace(/&gt;/g,">"),b=b.replace(/&amp;/g,"&")),b},a.fn.hideFocus=function(){var b=a(this),c=!1,d=!1;b.addClass("hide-focus").on("mousedown.hide-focus touchstart.hide-focus",function(){c=!0,a(this).addClass("hide-focus")}).on("focusin.hide-focus",function(){var b=a(this);c||d||b.removeClass("hide-focus"),c=!1,d=!0}).on("focusout.hide-focus",function(){a(this).addClass("hide-focus"),c=!1,d=!1})},a.fn.clearable=function(){var b=this;this.element=a(this),this.xButton=a.createIconElement({classes:"close is-empty",icon:"close"}).icon(),this.checkContents=function(){var a=b.element.val();a&&a.length?this.xButton.removeClass("is-empty"):this.xButton.addClass("is-empty"),this.element.trigger("contents-checked")},b.element.parent().append(this.xButton),this.xButton.offTouchClick("clearable").off().onTouchClick("clearable",".clearable").on("click.clearable",function(){b.element.val("").trigger("change").focus().trigger("cleared"),b.checkContents()}),this.element.on("change.clearable, blur.clearable, keyup.clearable",function(){b.checkContents()}),this.checkContents()},a.actualChar=function(a){var b=a.which,c="",d={188:"44",190:"46",191:"47",192:"96",220:"92",222:"39",221:"93",219:"91",173:"45",187:"61",186:"59",189:"45"},e={96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",37:"%",38:"&",39:'"',44:"<",46:">",47:"?"};return d.hasOwnProperty(b)&&(b=d[b]),c=!a.shiftKey&&b>=65&&90>=b?String.fromCharCode(b+32):a.shiftKey&&e.hasOwnProperty(b)?e[b]:String.fromCharCode(b)},a.fn.animateOpen=function(b){"use strict";var c={direction:"vertical",distance:"auto",timing:300,transition:"cubic-bezier(.17, .04, .03, .94)"},d=a.extend({},c,b);return this.each(function(){function b(){c&&clearTimeout(c),f.data("ignore-animation-once")&&a.removeData(f[0],"ignore-animation-once"),f.data("is-animating")&&a.removeData(f[0],"is-animating"),f.off(g+".animateopen"),e.style.transition="",e.style[h]=j,f.trigger("animateopencomplete")}var c,e=this,f=a(this),g=a.fn.transitionEndName(),h="horizontal"===d.direction?"width":"height",i=h.charAt(0).toUpperCase()+h.slice(1),j=isNaN(d.distance)?"auto":parseInt(d.distance,10)+"px";f.one("animateopenstart.animation",function(a){a.stopPropagation(),f.off(g+".animateopen")}),f.trigger("animateopenstart"),g&&f.one(g+".animateopen",b),f.data("is-animating",!0);var k=this.style[h];this.style[h]=j;var l=getComputedStyle(this)[h];this.style[h]=k,this["offset"+i],this.style.transition=h+" "+d.timing+"ms "+d.transition,c=setTimeout(b,d.timing),this.style[h]=l,(f.is(":hidden")||f.is(".no-transition")||f.data("ignore-animation-once"))&&b()})},a.fn.animateClosed=function(b){var c={direction:"vertical",timing:300,transition:"cubic-bezier(.17, .04, .03, .94)"},d=a.extend({},c,b);return this.each(function(){function b(){c&&clearTimeout(c),f.data("ignore-animation-once")&&a.removeData(f[0],"ignore-animation-once"),f.data("is-animating")&&a.removeData(f[0],"is-animating"),f.off(g+".animatedclosed"),e.style.transition="",e.style[h]="0px",f.trigger("animateclosedcomplete")}var c,e=this,f=a(this),g=a.fn.transitionEndName(),h="horizontal"===d.direction?"width":"height",i=h.charAt(0).toUpperCase()+h.slice(1);f.one("animateclosedstart",function(a){a.stopPropagation(),f.off(g+".animatedclosed")}),f.trigger("animateclosedstart"),g&&f.one(g+".animatedclosed",b),f.data("is-animating",!0),this.style[h]=getComputedStyle(this)[h],this["offset"+i],this.style.transition=h+" "+d.timing+"ms "+d.transition,c=setTimeout(b,d.timing),this.style[h]="0px",(f.is(":hidden")||f.is(".no-transition")||f.data("ignore-animation-once"))&&b()})},a.fn.isAnimating=function(){return this.each(function(){return a(this).data("is-animating")===!0})},a.fn.cssVendorProp=function(b,c){var d,e={propertyName:"",propertyValue:""},f={};if(b)return"object"==typeof b&&(f=b),"string"==typeof b&&(f.propertyName=b,void 0!==c&&(f.propertyValue=c)),d=a.extend({},e,f),this.each(function(){var b=["-moz-","-ms-","-o-","-webkit-",""];d.propertyName=d.propertyName.toString(),d.propertyValue=d.propertyValue.toString();for(var c=0;c<b.length;c++)a(this).css(b[c]+d.propertyName,d.propertyValue)})};var C="";window.Locale&&window.Locale.hasOwnProperty("culturesPath")&&(C=window.Locale.culturesPath),window.Locale={currentLocale:{name:"",data:{}},cultures:{},culturesPath:C,updateLang:function(){var b=a("html");b.attr("lang",this.currentLocale.name),this.isRTL()?b.attr("dir","rtl"):b.removeAttr("dir")},getCulturesPath:function(){if(!this.culturesPath)for(var a=document.getElementsByTagName("script"),b="sohoxi.min.js",c="sohoxi.js",d=0;d<a.length;d++){var e=a[d].src,f=e.indexOf("?");if(""!==e&&f>-1&&(e=e.substr(0,f)),"sohoxi-script"===a[d].id)return e.substring(0,e.lastIndexOf("/"))+"/";e.indexOf(b)>-1&&(this.culturesPath=e.replace(b,"")+"cultures/"),e.indexOf(c)>-1&&(this.culturesPath=e.replace(c,"")+"cultures/")}return this.culturesPath},cultureInHead:function(){for(var a=!1,b=document.getElementsByTagName("script"),c="cultures",d=0;d<b.length;d++){var e=b[d].src;e.indexOf(c)>-1&&(a=!0)}return a},addCulture:function(a,b){this.cultures[a]=b},set:function(b){var c=this;return this.dff=a.Deferred(),"in-ID"===b&&(b="id-ID"),b&&!this.cultures[b]&&this.currentLocale.name!==b&&(this.setCurrentLocale(b),a.ajax({url:this.getCulturesPath()+this.currentLocale.name+".js",dataType:"script",error:function(){c.dff.reject()}}).done(function(){c.setCurrentLocale(b,c.cultures[b]),c.addCulture(b,c.currentLocale.data),c.dff.resolve(c.currentLocale.name)})),b&&c.currentLocale.data&&c.currentLocale.dataName===b&&c.dff.resolve(c.currentLocale.name),c.setCurrentLocale(b,c.cultures[b]),c.cultures[b]&&this.cultureInHead()&&c.dff.resolve(c.currentLocale.name),this.dff.promise()},setCurrentLocale:function(a,b){this.currentLocale.name=a,b&&(this.currentLocale.data=b,this.currentLocale.dataName=a),this.updateLang()},formatDate:function(a,b){if(b||(b={date:"short"}),!a)return void 0;a instanceof Date||(a=new Date(a));var c,d=this.currentLocale.data,e="",f=d.calendars?d.calendars[0]:null;b.pattern&&(c=b.pattern),b.date&&(c=f.dateFormat[b.date]);var g=a.getDate(),h=a.getMonth(),i=a.getFullYear(),j=a.getMinutes(),k=a.getHours(),l=a.getSeconds();c=c.replace("ngày","nnnn"),c=c.replace("tháng","t1áng"),e=c.replace("dd",this.pad(g,2)),e=e.replace("d",g),e=e.replace("yyyy",i),e=e.replace("yy",i.toString().substr(2)),e=e.replace("y",i);var m=e.indexOf(" a")>-1;return m&&0===k&&(e=e.replace("hh",12),e=e.replace("h",12)),e=e.replace("hh",k>12?k-12:k),e=e.replace("h",k>12?k-12:k),e=e.replace("HH",k),e=e.replace("mm",this.pad(j,2)),e=e.replace("ss",this.pad(l,2)),e=e.replace("SSS",this.pad(a.getMilliseconds(),0)),e=e.replace("MMMM",f?f.months.wide[h]:null),e=e.replace("MMM",f?f.months.abbreviated[h]:null),-1===c.indexOf("MMM")&&(e=e.replace("MM",this.pad(h+1,2)),e=e.replace("M",h+1)),f&&(e=e.replace(" a"," "+(k>=12?f.dayPeriods[1]:f.dayPeriods[0])),e=e.replace("EEEE",f.days.wide[a.getDay()])),f&&(e=e.replace("EEEE",f.days.wide[a.getDay()])),e=e.replace("nnnn","ngày"),e=e.replace("t1áng","tháng"),e.trim()},isValidDate:function(a){return"[object Date]"===Object.prototype.toString.call(a)?isNaN(a.getTime())?!1:!0:!1},parseDate:function(a,b,c){var d=this.calendar(),e=a;if(!a)return void 0;b||(b=this.calendar().dateFormat["short"]),b.pattern&&(b=b.pattern);var f,g,h={},i=b.toLowerCase().indexOf("h")>-1;if(i&&(b=b.replace(/[\s:.-]/g,"/"),a=a.replace(/[\s:.]/g,"/")),("Mdyyyy"===b||"dMyyyy"===b)&&(a=a.substr(0,a.length-4)+"/"+a.substr(a.length-4,a.length),a=a.substr(0,a.indexOf("/")/2)+"/"+a.substr(a.indexOf("/")/2)),"Mdyyyy"===b&&(b="M/d/yyyy"),"dMyyyy"===b&&(b="d/M/yyyy"),-1!==b.indexOf(" ")&&(b=b.replace(/[\s:.]/g,"/"),a=a.replace(/[\s:.]/g,"/")),-1===b.indexOf(" ")&&-1===b.indexOf(".")&&-1===b.indexOf("/")&&-1===b.indexOf("-")){for(var j=b[0],k="",l="",m=0;m<b.length;m++)k+=b[m]!==j?"/"+b[m]:b[m],l+=b[m]!==j?"/"+a[m]:a[m],m>1&&(j=b[m]);a=l,b=k}f=b.split("/"),g=a.split("/"),1===f.length&&(f=b.split(".")),1===g.length&&(g=a.split(".")),1===f.length&&(f=b.split("-")),1===g.length&&(g=a.split("-")),1===f.length&&(f=b.split(" ")),1===g.length&&(g=a.split(" "));for(var n=this.getDatePart(f,g,"M","MM","MMM"),o=this.getDatePart(f,g,"yy","yyyy"),p=0;p<g.length;p++){var q=f[p],r=g[p],s=parseInt(r);switch(q){case"d":var t=new Date(o,n,0).getDate();if(1>s||s>31||s>t)return;h.day=r;break;case"dd":if(1>s||s>31||10>s&&"0"!==r.substr(0,1))return;h.day=r;break;case"M":if(1>s||s>12)return;h.month=r-1;break;case"MM":if(1>s||s>12||10>s&&"0"!==r.substr(0,1))return;h.month=r-1;break;case"MMM":for(var u=this.calendar().months.abbreviated,v=0;v<u.length;v++)e.indexOf(u[v])>-1&&(h.month=v);break;case"MMMM":for(var w=this.calendar().months.wide,x=0;x<w.length;x++)e.indexOf(w[x])>-1&&(h.month=x);break;case"yy":h.year=parseInt("20"+r,10);break;case"yyyy":h.year=r;break;case"h":if(0>s||s>12)return;h.h=r;break;case"HH":if(0>s||s>24)return;h.h=r;break;case"ss":if(0>s||s>60){h.ss=0;break}h.ss=r;break;case"mm":if(0>s||s>60){h.mm=0;break}h.mm=r;break;case"a":(r.toLowerCase()===d.dayPeriods[0]||r.toUpperCase()===d.dayPeriods[0])&&(h.a="AM"),(r.toLowerCase()===d.dayPeriods[1]||r.toUpperCase()===d.dayPeriods[1])&&(h.a="PM",h.h&&(h.h=parseInt(h.h)+12))}}return h["return"]=void 0,h.leapYear=h.year%4===0&&h.year%100!==0||h.year%400===0,!i||h.h||h.mm?(h.year||0===h.year||c||(h.year=(new Date).getFullYear()),h.month||0===h.month||c||(h.month=(new Date).getMonth()),h.day||0===h.day||c||(h.day=1),i?(h.h&&(h["return"]=new Date(h.year,h.month,h.day,h.h,h.mm)),void 0!==h.ss&&(h["return"]=new Date(h.year,h.month,h.day,h.h,h.mm,h.ss))):h["return"]=new Date(h.year,h.month,h.day),this.isValidDate(h["return"])?h["return"]:void 0):void 0},getDatePart:function(b,c,d,e,f){var g=0;return a.each(c,function(a){(d===b[a]||e===b[a]||f===b[a])&&(g=c[a])}),g},formatNumber:function(a,b){var c,d,e,f=b&&b.decimal?b.decimal:this.numbers().decimal,g=b&&void 0!==b.group?b.group:this.numbers().group,h=b&&void 0!==b.minimumFractionDigits?b.minimumFractionDigits:(b&&b.style&&("currency"===b.style||"percent"===b.style),2),i=b&&void 0!==b.maximumFractionDigits?b.maximumFractionDigits:b&&b.style&&("currency"===b.style||"percent"===b.style)?2:b&&b.minimumFractionDigits?b.minimumFractionDigits:3;if(void 0===a||null===a||""===a)return void 0;if(b&&"integer"===b.style&&(i=0,h=0),b&&"percent"===b.style&&(h=2),b&&"currency"===b.style){var j=this.currentLocale.data.currencySign;d=this.currentLocale.data.currencyFormat,d=d.replace("¤",j)}if(b&&"percent"===b.style){var k=this.currentLocale.data.numbers.percentSign;e=this.currentLocale.data.numbers.percentFormat,e=e.replace("¤",k)}"string"==typeof a&&("."!==f&&(a=a.replace(f,".")),a=Locale.parseNumber(a)),b&&"percent"===b.style&&(a=100*a);var l=this.truncateDecimals(a,h,i,b&&b.round).split(".");if(l[0]=l[0].replace(/\B(?=(\d{3})+(?!\d))/g,g),c=l.join(f),0===h&&(c=c.replace(/(\.[0-9]*?)0+$/,"$1"),c=c.replace(/\.$/,"")),0===h&&"."!==f&&(c=c.replace(/(\,[0-9]*?)0+$/,"$1"),c=c.replace(/\,$/,"")),h>0){var m=new RegExp("(\\..{"+h+"}[0-9]*?)0+$");c=c.replace(m,"$1"),c=c.replace(/\.$/,"")}return b&&"currency"===b.style&&(c=d.replace("#,##0.00",c)),b&&"percent"===b.style&&(c=e.replace("#,##0",c)),c},decimalPlaces:function(a){var b=/^-?[0-9]+\.([0-9]+)$/.exec(a);return null===b?0:b[1].length},truncateDecimals:function(a,b,c,d){var e,f=Math.pow(10,c),g=a*f,h=this.decimalPlaces(a);return e=Math[0>g?"ceil":"floor"](g),d&&h>=c&&g>0&&(e=Math.round(g)),d&&c>=h&&h>0&&(e=Math.round(g)),c>h&&h>0&&(e=Math.floor(g),c=Math.max(h,b)),(e/f).toFixed(c)},parseNumber:function(a){var b,c=this.currentLocale.data.numbers;return(b=a)?(b=b.replace(new RegExp("\\"+c.group,"g"),""),b=b.replace(c.decimal,"."),b=b.replace(c.percentSign,""),b=b.replace(this.currentLocale.data.currencySign,""),b=b.replace(" ",""),parseFloat(b)):0/0},translate:function(a){return void 0===this.currentLocale.data||void 0===this.currentLocale.data.messages?a:void 0===this.currentLocale.data.messages[a]?this.cultures["en-US"]&&void 0!==this.cultures["en-US"].messages[a]?this.cultures["en-US"].messages[a].value:void 0:this.currentLocale.data.messages[a].value},translateDayPeriod:function(a){return/am|pm|AM|PM/i.test(a)?Locale.calendar().dayPeriods[/AM|am/i.test(a)?0:1]:a},calendar:function(){return this.currentLocale.data.calendars?this.currentLocale.data.calendars[0]:{dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm:ss"}},numbers:function(){return this.currentLocale.data.numbers?this.currentLocale.data.numbers:{percentSign:"%",percentFormat:"#,##0 %",minusSign:"-",decimal:".",group:","}},pad:function(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a},isRTL:function(){return"right-to-left"===this.currentLocale.data.direction},flipIconsHorizontally:function(){var b=["attach","bottom-aligned","bullet-list","cancel","cart","collapse-app-tray","cut","document","drilldown","duplicate","expand-app-tray","export","first-page","folder","import","last-page","launch","left-align","left-text-align","left-arrow","new-document","next-page","number-list","paste","previous-page","quote","redo","refresh","right-align","right-arrow","right-text-align","save","search-folder","search-list","search","send","tack","tree-collapse","tree-expand","undo","unlocked","add-grid-record","add-grid-row","additional-help","bubble","cascade","change-font","clear-screen","script","clockwise-90","close-cancel","close-save","contacts","copy-from","copy-mail","copy-url","counter-clockwise-90","create-report","delete-grid-record","delete-grid-row","display","employee-directory","export-2","export-to-pdf","generate-key","get-more-rows","group-selection","headphones","help","helper-list-select","history","invoice-released","language","logout","key","lasso","line-bar-chart","line-chart","new-expense-report","new-payment-request","new-time-sheet","new-travel-plan","no-attachment","no-comment","no-filter","overlay-line","pdf-file","phone","payment-request","pie-chart","queries","quick-access","refresh-current","restore-user","run-quick-access","save-close","save-new","search-results-history","select","send-submit","show-last-x-days","special-item","stacked","timesheet","unsubscribe","update-preview","zoom-100","zoom-in","zoom-out","caret-left","caret-right"];a("svg").each(function(){var c=a(this).getIconName();c&&-1!==a.inArray(c,b)&&a(this).addClass("icon-rtl-rotate")})}},a(function(){window.Locale.cultureInHead()||window.Locale.set("en-US"),setTimeout(function(){window.Locale.isRTL()&&window.Locale.flipIconsHorizontally()},50)});var D={caseSensitive:!1,filterMode:"startsWith",highlightMatchedText:!1,highlightCallback:null},E=["startsWith","contains"];e.prototype={init:function(){function b(b,c,d){-1===a.inArray(b,c)&&(b=d)}for(var c=[{setting:this.settings.filterMode,limits:E,preset:D.filterMode}],d=0;d<c.length;d++)b(c[d].setting,c[d].limits,c[d].preset);return this},filter:function(b,c){function d(b){var d="string"==typeof b,g=d?b:a(b).html(),h=g.split(" "),i=!1;if("startsWith"===e.settings.filterMode){for(var j=0;j<h.length;j++)if(0===h[j].toLowerCase().indexOf(c)){i=!0;break}0===g.toLowerCase().indexOf(c)&&(i=!0),c.indexOf(" ")>0&&g.toLowerCase().indexOf(c)>0&&(i=!0)}"contains"===e.settings.filterMode&&g.toLowerCase().indexOf(c)>=0&&(i=!0),i&&f.push(b)}if(!b)return!1;if(!(a.isArray(b)||b instanceof jQuery))return!1;if(!c||"string"!=typeof c||!c.length)return!1;var e=this,f=[],g=!1;if(this.settings.caseSensitive||(c=c.toLowerCase()),a.isArray(b)||(b instanceof jQuery||"object"==typeof b)&&(b=a.makeArray(b),g=!0),b.forEach(d),g){var h=a();f.forEach(function(b){h=h.add(a(b))}),f=h}return f},updated:function(b){return this.settings=a.extend({},this.settings,b),this.teardown().init()},teardown:function(){return this},destroy:function(){return this.teardown()}},window.ListFilter=e,a.fn.about=function(b){function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="about",e={appName:"Infor Application Name",content:void 0,copyrightYear:(new Date).getFullYear(),deviceSpecs:!0,productName:void 0,useDefaultCopyright:!0,version:void 0},f=a.extend({},e,b);return c.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){this.isBody=a(this.element).is("body");var b=this.element.attr("data-appname");this.settings.appName=void 0!==b?b.toString():this.settings.appName;var c=this.element.attr("data-about-content");this.settings.content=void 0!==c?c.toString():this.settings.content;var d=this.element.attr("data-copyright-year");this.settings.copyrightYear=void 0!==d?d.toString():this.settings.copyrightYear;var e=this.element.attr("data-device-specs");e&&(this.settings.deviceSpecs="true"===e);var f=this.element.attr("data-product-name");this.settings.productName=void 0!==f?f.toString():this.settings.productName;var g=this.element.attr("data-use-default");void 0!==g&&(this.settings.useDefaultCopyright="true"===g);var h=this.element.attr("data-version");return this.settings.version=void 0!==h?h.toString():this.settings.version,this.defaultCopyright=Locale.translate("AboutText")+' <a class="hyperlink" href="http://www.infor.com" target="_blank">www.infor.com</a>.',this.defaultCopyright=this.defaultCopyright.replace("{0}",this.settings.copyrightYear),this},build:function(){this.modal=a('<div class="modal about" id="about-modal"></div>'),a('<div class="modal-content"></div>').appendTo(this.modal);var b=a('<div class="modal-header"></div>').appendTo(this.modal.find(".modal-content"));a('<div class="close-container"></div>').append(a('<button name="close" type="button" class="btn-icon hide-focus"></button>').append(a.createIconElement({icon:"close",classes:"icon-close"})).append("<span>"+Locale.translate("Close")+"</span>")).appendTo(b),a.createIconElement({icon:"logo-trademark",classes:["icon","about-logo"]}).attr({viewBox:"0 0 44 44"}).appendTo(b),this.title=a('<h1 class="title"></h1>').text(this.settings.appName).appendTo(this.modal.find(".modal-header"));var c=a('<div class="modal-body"></div>').appendTo(this.modal.find(".modal-content"));if(this.settings.version||this.settings.productName){var d=""+(this.settings.productName?this.settings.productName+" ":"")+(this.settings.version?this.settings.version:"");a("<p></p>").text(d).appendTo(c)}if(this.settings.content&&a('<div class="additional-content"></div>').html(this.settings.content).appendTo(c),(this.settings.useDefaultCopyright||!this.settings.content)&&a("<p></p>").html(this.defaultCopyright).appendTo(c),this.settings.deviceSpecs){var e=this.getDeviceSpecs(),f='<span class="browser">Browser: '+e.browser+'</span><br><span class="platform">Platform: '+e.os+'</span><br><span class="locale">Locale: '+e.locale+'</span><br><span class="cookiesEnabled">Cookies Enabled: '+e.cookiesEnabled+"</span><br>";a("<p></p>").html(f).appendTo(c)}return this.buttons=this.modal.find("button"),this.modal.find(".hide-focus").one("blur",function(){
a(this).removeClass("hide-focus")}),this.element.attr("data-modal","about-modal"),a(".modal-body",this.modal)[0].tabIndex=0,this.modal.appendTo("body"),this.modal.modal({trigger:this.isBody?"immediate":"click"}),this},handleEvents:function(){var b=this;return this.element.on("open.about",function(a){a.stopPropagation(),b.element.trigger("click")}),this.buttons.filter('[name="done"], [name="close"]').on("click.about",function(){b.close()}),this.modal.data("modal").element.on("beforeopen.about",function(){b.modal.find(".modal-body").scrollTop(0)}),a(document).on("keydown.about",function(a){(0===a.which||27===a.which)&&b.close()}),this},getDeviceSpecs:function(){var a="Microsoft Internet Explorer"===navigator.appName?navigator.userLanguage:navigator.language,b=function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(a[1]||"")):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!==a)?"Opera "+a[1]:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),c.join(" "))}();return{browser:b,os:navigator.platform,cookiesEnabled:navigator.cookieEnabled,locale:a}},close:function(){var a=this.modal.data("modal");a&&a.close(),this.isBody&&this.destroy()},destroy:function(){var b=this.modal.data("modal");b&&(b.element.off("beforeopen.about"),b.destroy()),this.buttons.off(),this.element.off("open.about"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?e.settings=a.extend({},e.settings,b):e=a.data(this,d,new c(this,f))})},a.fn.accordion=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="accordion",e={allowOnePane:!0,displayChevron:!0,rerouteOnLinkClick:!0,source:null},f=a.extend({},e,b);return c.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){return this},build:function(){var b=this;this.headers=this.element.find(".accordion-header"),this.anchors=this.headers.children("a"),this.panes=this.headers.next(".accordion-pane");var c=!1;if(this.headers.each(function(){function d(){return h?void 0:f?void g.addClass("has-icons"):void e.addClass("no-icon")}var e=a(this),f=!1,g=e.parent(),h=g.is(".accordion");e.attr("role","presentation").hideFocus(),e.children("a").find("svg").detach().insertBefore(e.children("a"));var i=e.children(".icon, svg");if(i.addClass("icon").attr({role:"presentation","aria-hidden":"true",focusable:"false"}),h&&i.length&&(c=!0),(e.is(".list-item")||!h&&e.find("button").length)&&(f=!0),e.hasClass("is-disabled")&&e.children("a, button").attr("tabindex","-1"),!e.next(".accordion-pane").length)return void d();f=!0;var j=e.children(".btn");if(!j.length){j=a('<button class="btn" type="button"></button>');var k="insertBefore";b.settings.displayChevron&&h&&(e.addClass("has-chevron"),k="insertAfter"),j[k](e.children("a")),e.data("addedExpander",j)}j.hideFocus(),i.length&&!b.settings.displayChevron&&i.appendTo(j);var l=j.children(".icon, .svg, .plus-minus");if(!l.length){if(b.settings.displayChevron&&h)l=a.createIconElement({icon:"caret-down",classes:["chevron"]});else{var m=b.isExpanded(e)?" active":"";l=a('<span class="icon plus-minus'+m+'" aria-hidden="true" role="presentation"></span>')}l.appendTo(j)}var n={role:"presentation","aria-hidden":"true"};l.is("span")||(n.focusable="false"),l.attr(n),l.is(".chevron")?(e.addClass("has-chevron"),j.insertAfter(e.children("a"))):(e.removeClass("has-chevron"),j.insertBefore(e.children("a"))),!b.settings.displayChevron&&h&&(c=!0),d();var o=j.children(".audible");o.length||(o=a('<span class="audible"></span>').appendTo(j)),o.text(Locale.translate("Expand"))}),c&&this.element.addClass("has-icons"),this.panes.each(function(){var c=a(this),d=c.prev(".accordion-header");d.children("a").attr({"aria-haspopup":"true",role:"button"}),b.isExpanded(d)||(c.data("ignore-animation-once",!0),b.collapse(d))}),!this.element.data("updating")){var d=this.headers.filter(".is-selected, .is-expanded");this.settings.allowOnePane&&(d=d.first()),this.expand(d),this.select(d.last())}return this},handleEvents:function(){function b(a){var b="Header";return a.is("a")&&(b="Anchor"),a.is("button")&&(b="Expander"),b}function c(a,c){g=!0;var d=b(c),f=e["handle"+d+"Click"](a,c);return f||a.preventDefault(),f}function d(a,c){var d=b(c);return g?(g=null,!1):e["handle"+d+"Click"](a,c)}var e=this,f=null,g=null;return this.headers.on("touchend.accordion",function(b){return c(b,a(this))}).on("click.accordion",function(b){return d(b,a(this))}).on("focusin.accordion",function(b){var c=a(b.target);e.originalSelection||(e.originalSelection=c),c.is(":not(.btn)")&&a(this).addClass("is-focused")}).on("focusout.accordion",function(){(!a.contains(this,f)||a(this).is(a(f)))&&a(this).removeClass("is-focused")}).on("keydown.accordion",function(a){e.handleKeys(a)}).on("mousedown.accordion",function(b){a(this).addClass("is-focused"),f=b.target}).on("mouseup.accordion",function(){f=null}),this.anchors.on("touchend.accordion",function(b){return c(b,a(this))}).on("click.accordion",function(b){return d(b,a(this))}),this.headers.children('[class^="btn"]').on("touchend.accordion",function(b){return c(b,a(this))}).on("click.accordion",function(b){return d(b,a(this))}).on("keydown.accordion",function(a){e.handleKeys(a)}),this.element.on("selected.accordion",function(a){a.stopPropagation()}).on("updated.accordion",function(a){a.stopPropagation(),e.updated()}),this},handleHeaderClick:function(b,c){if(!c||!c.length||this.isDisabled(c)||c.data("is-animating"))return void b.preventDefault();if(a(b.target).is('[class^="btn"]'))return void b.preventDefault();var d=c.children("a");return this.handleAnchorClick(b,d)},handleAnchorClick:function(a,b){function c(){var a=b.attr("href");return a&&""!==a&&"#"!==a?e.settings.rerouteOnLinkClick?(window.location.href=a,!0):!0:!1}function d(){g.length&&e.toggle(f),b.focus()}var e=this,f=b.parent(".accordion-header"),g=f.next(".accordion-pane"),h=b.attr("ng-reflect-href");return a&&!h&&a.preventDefault(),!f.length||this.isDisabled(f)?!1:(e.element.trigger("selected",[f]),this.originalSelection=b,this.select(b),a&&a.stopPropagation(),c()?(this.element.trigger("followlink",[b]),!0):(d(),!0))},handleExpanderClick:function(a,b){var c=b.parent(".accordion-header");if(c.length&&!this.isDisabled(c)&&!c.data("is-animating")){this.originalSelection=b,a&&a.stopPropagation();var d=c.next(".accordion-pane");return d.length?(this.toggle(c),this.select(c),void b.focus()):this.handleAnchorClick(null,c.children("a"))}},handleKeys:function(b){function c(a){a||(a=f),d.originalSelection||(d.originalSelection=a)}var d=this,e=b.which,f=a(b.target),g=f.parent(),h=g.children('[class^="btn"]').first(),i=g.children("a");if(9===e&&(this.headers.removeClass("is-selected"),c(f.is("a")&&h.length?h:i)),32===e){if(b.preventDefault(),f.is('[class^="btn"]')&&(b.stopPropagation(),b.stopImmediatePropagation(),a("html").hasClass("is-firefox")))return;return h.length?(c(h),this.handleExpanderClick(null,f)):(c(i),this.handleAnchorClick(null,f))}return 37===e||38===e?(b.preventDefault(),c(),b.shiftKey?this.ascend(g):this.prevHeader(g)):39===e||40===e?(b.preventDefault(),c(),b.shiftKey?this.descend(g):this.nextHeader(g)):void 0},select:function(a){if(a&&a.length){var b=a,c=b.parent();if(a.is(".accordion-header")&&(c=a,b=c.children("a")),b.is('[class^="btn"]')&&(b=a.next("a")),!this.isDisabled(c)){this.headers.removeClass("child-selected").removeClass("is-selected"),c.addClass("is-selected");var d=c.parentsUntil(this.element,".accordion-pane").prev(".accordion-header");d.addClass("child-selected")}}},isDisabled:function(a){return this.element.hasClass("is-disabled")?!0:a?a.hasClass("is-disabled"):!1},isExpanded:function(a){return a&&a.length?"true"===a.children("a").attr("aria-expanded"):void 0},toggle:function(a){return a&&a.length&&!this.isDisabled(a)?this.isExpanded(a)?void this.collapse(a):void this.expand(a):void 0},expand:function(b){function c(){var c=b.children(".btn");c.length&&(c.children(".plus-minus, .chevron").addClass("active"),c.children(".audible").text(Locale.translate("Collapse")));var g=b.parentsUntil(d.element).filter(".accordion-pane").prev(".accordion-header").add(b);d.settings.allowOnePane&&d.headers.not(g).each(function(){var b=a(this);d.isExpanded(b)&&d.collapse(b)}),g.not(b).each(function(){var b=a(this);d.isExpanded(b)||d.expand(b)}),e.addClass("is-expanded"),d.element.trigger("expand",[f]),e.one("animateopencomplete",function(a){a.stopPropagation(),b.children("a").attr("aria-expanded","true"),d.element.trigger("afterexpand",[f])}).css("display","block").animateOpen()}if(b&&b.length){var d=this,e=b.next(".accordion-pane"),f=b.children("a"),g=this.element.triggerHandler("beforeexpand",[f]);g!==!1&&(this.callSource(f,c)||c.apply(this))}},collapse:function(a){if(a&&a.length){var b=this,c=a.next(".accordion-pane"),d=a.children("a"),e=this.element.triggerHandler("beforecollapse",[d]);if(e!==!1){var f=a.children(".btn");f.length&&(f.children(".plus-minus, .chevron").removeClass("active"),f.children(".audible").text(Locale.translate("Expand"))),c.removeClass("is-expanded").closeChildren(),d.attr("aria-expanded","false"),c.one("animateclosedcomplete",function(a){a.stopPropagation(),c.css("display","none"),b.element.trigger("aftercollapse",[d])}).animateClosed()}}},callSource:function(a,b){function c(){d.updated(),setTimeout(function(){b.apply(d)},1)}if(!this.settings.source||"function"!=typeof this.settings.source)return!1;var d=this,e=a.parent(),f=e.next(".accordion-pane"),g={anchor:a,header:e,pane:f};return this.settings.source(g,c)},getElements:function(b){var c,d,e,f,g=a(b);return g.is(".accordion-header")&&(c=g,e=g.children('[class^="btn"]'),d=g.children("a")),g.is(".btn")&&(e=g,c=e.parent(),d=c.children("a")),g.is("a")&&(d=g,c=d.parent(),e=c.children(".btn")),f=c.next(".accordion-pane"),{header:c,expander:e,anchor:d,pane:f}},prevHeader:function(b,c){var d=this.getElements(b),e=d.header.parent().children(),f=e.index(d.header),g=a(e.get(f-1));if(!e.length||0===f){if(d.header.parent(".accordion-pane").length)return this.ascend(d.header);g=e.last()}for(;g.is(".accordion-content")||this.isDisabled(g);){if(g.is(":only-child")||g.is(":first-child"))return this.ascend(d.header);g=g.prev()}if(g.is(".accordion-pane")){var h=g.prev(".accordion-header");if(this.isExpanded(h)){var i=h.next(".accordion-pane").children(":not(.accordion-content)");if(i.length&&!c)return this.descend(h,-1)}if(g=h,!g.length){if(d.header.parent(".accordion-pane").length)return this.ascend(d.header);for(g=e.last();g.is(".accordion-content")||this.isDisabled(g);)g=g.prev()}}this.focusOriginalType(g)},nextHeader:function(b,c){var d=this.getElements(b),e=d.header.parent().children(),f=e.index(d.header),g=a(e.get(f+1));if(!e.length||f===e.length-1){if(d.header.parent(".accordion-pane").length)return this.ascend(d.header,-1);g=e.first()}for(;g.is(".accordion-content")||this.isDisabled(g);){if(g.is(":only-child")||g.is(":last-child"))return this.ascend(d.header);g=g.next()}if(g.is(".accordion-pane")){var h=g.prev(".accordion-header");if(this.isExpanded(h)){var i=h.next(".accordion-pane").children(":not(.accordion-content)");if(i.length&&!c)return this.descend(h)}if(g=a(e.get(f+2)),!g.length){if(d.header.parent(".accordion-pane").length)return this.ascend(d.header,-1);for(g=e.first();g.is(".accordion-content")||this.isDisabled(g);)g=g.next()}}this.focusOriginalType(g)},ascend:function(a,b){b||(b=0);var c=a.parent(".accordion-pane"),d=c.prev();return-1!==b||(d=c.next(".accordion-header"),d.length)?void this.focusOriginalType(d):c.parent(".accordion").length?this.nextHeader(c.prev().children("a"),!0):this.ascend(c.prev(),-1)},descend:function(a,b){b||(b=0);var c=a.next(".accordion-pane"),d=c.children(".accordion-header").first();return-1===b&&(d=c.children(".accordion-header").last()),d.length?this.isExpanded(d)?this.descend(d,-1):void this.focusOriginalType(d):this.focusOriginalType(a)},focusOriginalType:function(a){this.originalSelection.is(".btn")&&a.children(".btn").length?a.children(".btn").focus():a.children("a").focus()},disable:function(){this.element.addClass("is-disabled"),this.anchors.add(this.headers.children('[class^="btn"]')).attr("tabindex","-1")},enable:function(){this.element.removeClass("is-disabled"),this.anchors.add(this.headers.children('[class^="btn"]')).removeAttr("tabindex")},updated:function(){this.element.data("updating",!0);var b=a(document.activeElement);return a.contains(this.element[0],b[0])||(b=void 0),this.teardown().init(),b&&b.length&&b.focus(),a.removeData(this.element[0],"updating"),this},teardown:function(){return this.headers.off("touchend.accordion click.accordion focusin.accordion focusout.accordion keydown.accordion").each(function(){var b=a(this).data("addedExpander");b&&(b.remove(),a.removeData(this,"addedExpander"))}),this.anchors.off("touchend.accordion keydown.accordion click.accordion"),this.headers.children('[class^="btn"]').off("touchend.accordion click.accordion keydown.accordion"),this.element.off("updated.accordion"),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.applicationmenu=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="applicationmenu",e={breakpoint:"phablet",openOnLarge:!1,triggers:[]},f=a.extend({},e,b);return c.prototype={init:function(){this.setup().handleEvents()},setup:function(){this.hasTrigger=!1,this.isAnimating=!1,this.triggers=a(),this.menu=this.element;var b=this.element.attr("data-open-on-large");this.settings.openOnLarge=void 0!==b?"true"===b:this.settings.openOnLarge;var c={tablet:767,phablet:968,desktop:1024,large:1280},d=this.element.attr("data-breakpoint");this.settings.breakpoint=void 0!==c[d]?d:this.settings.breakpoint,this.breakpoint=c[this.settings.breakpoint],this.modifyTriggers(this.settings.triggers,!1,!0),this.scrollTarget=this.menu.parents(".header");var e=this.menu.prevAll(".masthead"),f=this.menu.prevAll(".module-tabs");e.length>0&&(this.scrollTarget=e,this.menu.addClass("short")),f.length>0&&(this.scrollTarget=f),this.accordion=this.menu.find(".accordion"),this.accordion.addClass("panel").addClass("inverse");var g=this.accordion.data("accordion");if(!g){var h=a.fn.parseOptions(this.accordion[0]);this.accordion.accordion(h)}return this.adjustHeight(),this},handleEvents:function(){var b=this;return this.triggers.length&&this.triggers.on("touchend.applicationmenu touchcancel.applicationmenu",function(b){b.preventDefault(),b.stopImmediatePropagation(),a(b.target).click()}).on("click.applicationmenu",function(){return a(this).find(".icon.app-header").hasClass("go-back")?!1:void(b.menu.hasClass("is-open")||b.isAnimating!==!1?b.menu.hasClass("is-open")&&b.closeMenu():b.openMenu())}),this.menu.on("notify.applicationmenu",function(a,c,d){b.notify(c,d)}).on("updated.applicationmenu",function(){b.updated()}),this.accordion.on("blur.applicationmenu",function(){b.closeMenu()}),a(document).on("open-applicationmenu",function(){b.openMenu()}).on("close-applicationmenu",function(){b.closeMenu()}),a(window).on("scroll.applicationmenu",function(){b.adjustHeight()}).on("resize.applicationmenu",function(){b.testWidth()}),this.settings.openOnLarge&&this.isLargerThanBreakpoint()&&(this.menu.addClass("no-transition"),a(".page-container").addClass("no-transition")),this.testWidth(),setTimeout(function(){b.menu.removeClass("no-transition"),a(".page-container").removeClass("no-transition")},800),this},handleKeyDown:function(a){var b=a.which;return 27===b?(a.preventDefault(),this.closeMenu(),this.triggers.length&&this.triggers.eq(0).focus(),!1):void 0},notify:function(b,c){if(b&&void 0!==b&&(b instanceof HTMLElement&&(b=a(b)),b.is("a"))){var d=b.find(".tag");return c&&void 0!==c&&0!==parseInt(c,10)?(d.length||(d=a('<span class="tag"></span>').appendTo(b)),d.text(c.toString()),d):void(d.length&&d.remove())}},adjustHeight:function(){var b=this.scrollTarget.is(".is-sticky"),c=this.scrollTarget.outerHeight(!0),d=c-(b?0:a(window).scrollTop());this.scrollTarget.prev().is(".masthead")&&(d+=this.scrollTarget.prev().outerHeight(!0)),this.menu.css("height",d>0?"calc(100% - "+d+"px)":"100%")},isLargerThanBreakpoint:function(){return a(window).width()>this.breakpoint},testWidth:function(){this.isLargerThanBreakpoint()?(this.menu.removeClass("show-shadow"),this.settings.openOnLarge&&!this.menu.hasClass("is-open")&&this.isAnimating===!1&&this.openMenu(!0)):(this.menu.addClass("show-shadow"),!this.element.find(document.activeElement).length&&this.menu.is(".is-open")&&this.isAnimating===!1&&this.closeMenu())},openMenu:function(b){function c(){null!==d.timeout&&(clearTimeout(d.timeout),d.timeout=null),d.isAnimating=!1,d.element.trigger("applicationmenuopen"),d.menu.removeClass("no-transition"),a(".page-container").removeClass("no-transition")}if(this.isAnimating!==!0){var d=this,e=a.fn.transitonEndName;this.isAnimating=!0,this.adjustHeight(),this.triggers.each(function(){var b=a(this);if(b.parents(".header").length>0||b.parents(".masthead").length>0){var c=b.parents(".header, .masthead");if(c.parents(".page-container").length)return;b.find(".icon.app-header").removeClass("go-back").addClass("close"),b.trigger("icon-change")}}),this.menu.off(e+".applicationmenu").css("display",""),this.menu[0].offsetHeight,this.menu.addClass("is-open"),b&&b===!0||this.menu.find(".is-selected > a").focus(),this.menu.one(e+".applicationmenu",c),this.timeout=setTimeout(c,300),setTimeout(function(){a(document).on("touchend.applicationmenu touchcancel.applicationmenu",function(b){b.preventDefault(),a(b.target).click()}).on("click.applicationmenu",function(b){a(b.target).parents(".application-menu").length<1&&!d.isLargerThanBreakpoint()&&d.closeMenu(a(b.target).hasClass("application-menu-trigger"))}).on("keydown.applicationmenu",function(a){d.handleKeyDown(a)})},0)}},closeMenu:function(){function b(){null!==c.timeout&&(clearTimeout(c.timeout),c.timeout=null),c.menu.off(d+".applicationmenu").css("display","none"),c.isAnimating=!1,c.element.trigger("applicationmenuclose")}if(this.isAnimating!==!0){var c=this,d=a.fn.transitionEndName();this.isAnimating=!0,this.triggers.each(function(){var b=a(this);(b.parents(".header").length>0||b.parents(".masthead").length>0)&&(b.find(".icon.app-header").removeClass("close"),b.trigger("icon-change"))}),this.menu.one(d+".applicationmenu",b),this.timeout=setTimeout(b,300),this.menu.removeClass("is-open").find("[tabindex]"),a(document).off("touchend.applicationmenu touchcancel.applicationmenu click.applicationmenu keydown.applicationmenu")}},modifyTriggers:function(b,c,d){if(b&&b.length){var e=a();a.each(b,function(b,c){e=e.add(a(c))}),this.triggers=this.triggers[c?"not":"add"](e),d&&d===!0||this.updated()}},teardown:function(){return this.accordion.off("blur.applicationmenu"),this.menu.off("animateopencomplete animateclosedcomplete"),a(window).off("scroll.applicationmenu"),a(document).off("touchend.applicationmenu touchcancel.applicationmenu click.applicationmenu open-applicationmenu close-applicationmenu"),this.accordion.data("accordion").destroy(),this},updated:function(){return this.teardown().init()},destroy:function(){this.teardown(),this.menu.detach().appendTo(this.originalParent).removeClass("short").removeAttr("style"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.autocomplete=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="autocomplete",e={source:[],template:void 0,filterMode:"startsWith",delay:300,width:null,offset:null},f=a.extend({},e,b),g='<li id="{{listItemId}}" {{#hasValue}}data-value="{{value}}"{{/hasValue}} role="listitem">\n\n<a href="#" tabindex="-1">\n\n<span>{{{label}}}</span>\n\n</a>\n\n</li>';return c.prototype={init:function(){var a=this.element.attr("data-autocomplete");a&&"source"!==a&&(this.settings.source=a),this.addMarkup(),this.handleEvents()},addMarkup:function(){this.element.addClass("autocomplete").attr({role:"combobox",autocomplete:"off"})},openList:function(b,c){if(!this.element.is("[disabled], [readonly]")){var d=this,e=[];b=b.toLowerCase(),this.list=a("#autocomplete-list"),0===this.list.length&&(this.list=a('<ul id="autocomplete-list" aria-expanded="true"></ul>').appendTo("body")),this.list.css({height:"auto",width:this.element.outerWidth()}).addClass("autocomplete"),this.list.empty(),this.settings.width&&this.list.css({width:this.settings.width});var f=a(this.element.attr("data-tmpl"));this.tmpl=a(f).length?a(f).text():"string"==typeof f?f:a(this.settings.template).length?a(this.settings.template).text():"string"==typeof this.settings.template?this.settings.template:g;for(var h=0;h<c.length;h++){var i="string"==typeof c[h],j=i?c[h]:c[h].label,k={label:j},l=i?k:a.extend(k,c[h]),m=j.split(" "),n=this.settings.filterMode?!1:!0;if("startsWith"===this.settings.filterMode){for(var o=0;o<m.length;o++)0===m[o].toLowerCase().indexOf(b)&&(n=!0);0===j.toLowerCase().indexOf(b)&&(n=!0),b.indexOf(" ")>0&&j.toLowerCase().indexOf(b)>0&&(n=!0)}if("contains"===this.settings.filterMode&&j.toLowerCase().indexOf(b)>=0&&(n=!0),n){if(e.push(j),l.listItemId="ac-list-option"+h,"contains"===this.settings.filterMode)l.label=l.label.replace(new RegExp("("+b+")","ig"),"<i>$1</i>");else{l.label=0===j.toLowerCase().indexOf(b)?"<i>"+j.substr(0,b.length)+"</i>"+j.substr(b.length):j;var p=j.toLowerCase().indexOf(b);p>0&&(l.label=j.substr(0,p)+"<i>"+j.substr(p,b.length)+"</i>"+j.substr(b.length+p))}if(l.hasValue=!i&&void 0!==c[h].value,l.hasValue&&(l.value=c[h].value),"undefined"!=typeof G){var q=G.compile(this.tmpl),r=q.render(l);d.list.append(r)}else{var s=a('<li role="listitem"></li>');s.attr("id",l.listItemId),s.attr("data-value",l.value),s.append('<a href="#" tabindex="-1"><span>'+l.label+"</span></a>"),d.list.append(s)}}}this.element.addClass("is-open").popupmenu({menuId:"autocomplete-list",ariaListbox:!0,mouseFocus:!1,trigger:"immediate",autoFocus:!1}).on("close.autocomplete",function(){d.list.parent(".popupmenu-wrapper").remove(),d.element.removeClass("is-open")}),this.element.trigger("populated",[e]),d.list.off("click touchend").on("touchend.autocomplete click.autocomplete","a",function(b){var e=a(b.currentTarget),f=e.text().trim();if(d.element.attr("aria-activedescendant",e.parent().attr("id")),e.parent().attr("data-value"))for(var g=0;g<c.length;g++)c[g].value.toString()===e.parent().attr("data-value")&&(f=c[g]);return d.element.trigger("selected",[e,f]).focus().data("popupmenu").close(),b.preventDefault(),!1});var t=d.list.find("a").on("focus.autocomplete touchend.autocomplete",function(){var b=a(this),c=b.text().trim();b.find(".display-value").length>0&&(c=b.find(".display-value").text().trim()),t.parent("li").removeClass("is-selected"),b.parent("li").addClass("is-selected"),d.element.val(c).focus()});this.settings.offset&&this.settings.offset.left&&this.list.parent().css("left",parseInt(this.list.parent().css("left"))+this.settings.offset.left+"px"),this.settings.offset&&this.settings.offset.top&&this.list.parent().css("top",parseInt(this.list.parent().css("top"))+this.settings.offset.top+"px"),d.list.parent(".popupmenu-wrapper").append('<span id="ac-is-arialive" aria-live="polite" class="audible">'+a.trim(this.list.find(">li:first-child").text())+"</span>"),this.noSelect=!0,this.element.trigger("listopen",[c])}},handleEvents:function(){var b,c,d="",e=this;this.element.on("updated.autocomplete",function(){e.updated()}).on("keydown.autocomplete",function(a){var b="li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)";40===a.keyCode&&e.list&&e.list.is(":visible")&&(c=e.list.find(".is-selected"),c.length&&(e.noSelect=!0,c.removeClass("is-selected is-focused"),c.next(b).addClass("is-selected").find("a").focus(),a.preventDefault(),a.stopPropagation())),38===a.keyCode&&e.list&&e.list.is(":visible")&&(c=e.list.find(".is-selected"),c.length&&(e.noSelect=!0,c.removeClass("is-selected is-focused"),c.prev(b).addClass("is-selected").find("a").focus(),a.preventDefault(),a.stopPropagation())),(9===a.keyCode||13===a.keyCode)&&e.list&&e.list.is(":visible")&&(e.list.find(".is-selected").find("a").trigger("click"),e.element.data("popupmenu")&&e.element.data("popupmenu").close(),a.stopPropagation(),a.preventDefault()),8===a.keyCode&&e.list&&e.element.trigger("keypress")}).on("keypress.autocomplete",function(c){var f=a(this);return clearTimeout(b),c.altKey&&40===c.keyCode?void e.openList(f.val(),e.settings.source):void(b=setTimeout(function(){if(d=f.val(),""===d)return void(e.element.data("popupmenu")&&e.element.data("popupmenu").close());if(d=d,!(0===c.which||0===c.charCode&&8!==c.which||c.ctrlKey||c.metaKey||c.altKey)){var b=typeof e.settings.source,g=function(a,b){e.element.removeClass("is-busy"),e.element.trigger("requestend",[a,b])};if(e.element.addClass("busy").trigger("requeststart",[d]),"function"===b)e.settings.source(d,g);else if("object"===b){var h=a.isArray(e.settings.source)?e.settings.source:[e.settings.source];g(d,h)}else{if(!e.settings.source)return;var i=e.settings.source.toString(),j=a.getJSON(i+d);j.done(function(a){g(d,a)}).fail(function(){g(d,[])})}}},e.settings.delay))}).on("focus.autocomplete",function(){return e.noSelect?void(e.noSelect=!1):void setTimeout(function(){e.element.select()},10)}).on("requestend.autocomplete",function(a,b,c){e.openList(b,c)})},updated:function(){return this.teardown().init(),this},enable:function(){this.element.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0)},teardown:function(){var a=this.element.data("popupmenu");return a&&a.destroy(),this.element.off("keypress.autocomplete focus.autocomplete requestend.autocomplete updated.autocomplete"),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.busyindicator=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="busyindicator",e={blockUI:!0,text:null,delay:1e3,timeToComplete:0,timeToClose:0},f=a.extend({},e,b);return c.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.setup().handleEvents()},setup:function(){var a=this.element.attr("data-block-ui"),b=this.element.attr("data-delay"),c=this.element.attr("data-completion-time"),d=this.element.attr("data-close-time");return this.blockUI=void 0!==a?a:this.settings.blockUI,this.loadingText=this.settings.text?this.settings.text:Locale.translate("Loading"),this.delay=void 0!==b&&!isNaN(b)&&parseInt(b,10)>20?b:!isNaN(this.settings.delay)&&this.settings.delay>=20?this.settings.delay:20,this.completionTime=void 0===c||isNaN(c)?this.settings.timeToComplete:parseInt(c,10),this.closeTime=void 0===d||isNaN(d)?this.settings.timeToClose:parseInt(d,10),this},handleEvents:function(){var a=this;return a.element.on("start.busyindicator",function(b){b.stopPropagation(),a.activate()}).on("afterstart.busyindicator",function(){a.element.on("complete.busyindicator",function(b){b.stopPropagation(),a.close()})}).on("updated.busyindicator",function(){a.updated()}),this},activate:function(){var b=this;if(this.container)return b.closeTimeout&&clearTimeout(b.closeTimeout),this.label.remove(),this.label=a("<span>"+this.loadingText+"</span>").appendTo(this.container),this.element.is("input, .dropdown, .multiselect, .busy-xs, .busy-sm")&&this.label.addClass("audible"),void this.container.removeClass("is-hidden").trigger("afterstart");if(this.container=a('<div class="busy-indicator-container is-hidden"></div>').attr({"aria-live":"polite",role:"status"}),this.loader=a('<div class="busy-indicator active"></div>').appendTo(this.container),a('<div class="bar one"></div><div class="bar two"></div><div class="bar three"></div><div class="bar four"></div><div class="bar five"></div>').appendTo(this.loader),this.label=a("<span>"+this.loadingText+"</span>").appendTo(this.container),this.blockUI&&(this.originalPositionProp=this.element.css("position"),this.element.css("position","relative"),this.overlay=a('<div class="overlay busy is-hidden"></div>').appendTo(this.element),this.container.addClass("blocked-ui")),this.element.is(".busy-xs, .busy-sm")&&this.label.addClass("audible"),this.element.is("input, .dropdown, .multiselect")){this.label.addClass("audible");var c;if(this.element.is("input"))c=this.element,this.container.insertAfter(this.isInlineLabel?this.inlineLabel:this.element);else{var d=this.element.data("dropdown");c=d.input,this.container.appendTo(c.parent())}this.overlay&&this.overlay.insertAfter(this.container);var e=c.position(),f=c.outerHeight(),g=c.outerWidth();this.container.add(this.overlay).css({left:e.left,top:e.top,bottom:e.bottom,right:e.right,height:f,width:g})}else this.container.appendTo(this.element);setTimeout(function(){b.container&&b.container.removeClass("is-hidden"),b.overlay&&b.overlay.removeClass("is-hidden")},b.delay),this.element.trigger("afterstart"),a.fn.cssPropSupport("animation")||(b.isAnimating=!0,b.animateWithJS()),this.completionTime>0&&setTimeout(function(){b.element.trigger("complete")},b.completionTime)},close:function(){var a=this;this.container&&this.container.addClass("is-hidden"),this.overlay&&this.overlay.addClass("is-hidden"),a.closeTimeout=setTimeout(function(){clearTimeout(a.closeTimeout),a.container&&a.container.remove(),a.container=void 0,a.loader=void 0,a.overlay&&(a.overlay.remove(),a.element.css("position",a.originalPositionProp),a.originalPositionProp=void 0),a.element.trigger("aftercomplete.busyindicator"),a.element.off("complete.busyindicator")},500)},animateWithJS:function(){function a(){return c.isAnimating?(i+=1,1===i&&d.addClass("half"),13===i&&(d.removeClass("half").addClass("full"),e.addClass("half")),26===i&&(d.removeClass("full").addClass("half"),e.removeClass("half").addClass("full"),f.addClass("half")),39===i&&(d.removeClass("half"),e.removeClass("full").addClass("half"),f.removeClass("half").addClass("full"),g.addClass("half")),51===i&&(e.removeClass("half"),f.removeClass("full").addClass("half"),g.removeClass("half").addClass("full"),h.addClass("half")),64===i&&(f.removeClass("half"),g.removeClass("full").addClass("half"),h.removeClass("half").addClass("full")),77===i&&(g.removeClass("half"),h.removeClass("full").addClass("half")),90===i&&h.removeClass("half"),void(103===i&&(i=0))):void clearInterval(b)}var b,c=this,d=this.container.find(".bar.one"),e=this.container.find(".bar.two"),f=this.container.find(".bar.three"),g=this.container.find(".bar.four"),h=this.container.find(".bar.five"),i=0;setInterval(a,10)},updated:function(){return this.setup()},destroy:function(){this.element.off("start.busyindicator complete.busyindicator afterstart.busyindicator aftercomplete.busyindicator updated.busyindicator"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.button=function(){"use strict";function b(b){this.element=a(b),this.init()}var c="button";return b.prototype={init:function(){var b=this;if(this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isSafari=a("html").is(".is-safari"),this.isFirefox=a("html").is(".is-firefox"),!this.element.hasClass("no-ripple")){if(this.element.hasClass("btn-menu")&&!this.element.hasClass("btn-icon")&&!this.element.hasClass("btn-actions")){var c=this.element.children("svg.icon"),d=c.find("use"),e=!1;c.length>0&&1===d.length?e=d.attr("xlink:href").indexOf("#icon-dropdown")>-1:c.length>0&&(e="dropdown"===c.attr("data-icon")),
e||(c=a.createIconElement({icon:"dropdown",classes:["icon-dropdown"]}),this.element.append(c)),c.hasClass("icon-dropdown")||c.addClass("icon-dropdown")}this.element.hasClass("icon-favorite")&&this.element.on("click.button",function(){var b=a(this).find("svg:not(.ripple-effect)");b.changeIcon("star-outlined"===b.attr("data-icon")?"star-filled":"star-outlined")}),this.element.parent().is(".field")||!this.element.hasClass("btn-actions")||this.element.data("tooltip")||this.element.attr("title",Locale.translate("More")).tooltip({content:Locale.translate("More")}),this.element.hideFocus(),this.element.on("touchstart.button click.button",function(c){if(!(b.element.attr("disabled")||b.element.is(".is-disabled")||!b.isTouch&&1!==c.which||a(".ripple-effect",this).length||b.isTouch&&"touchstart"!==c.type)){var d=a(this),e=d.offset(),f=c.pageX-e.left,g=c.pageY-e.top,h=a('<svg class="ripple-effect" focusable="false" aria-hidden="true" role="presentation"><circle r="0" class="ripple-circle"></circle></svg>');if(b.isTouch&&(c=c.originalEvent,c&&c.touches&&1===c.touches.length&&(f=c.touches[0].pageX-e.left,g=c.touches[0].pageY-e.top)),f=0>f?b.element.outerWidth()/2:f,g=0>g?b.element.outerHeight()/2:g,a("svg.ripple-effect",d).remove(),h.css({left:f,top:g}),d.prepend(h),!a.fn.cssPropSupport("animation")||b.isSafari||b.isFirefox)h.removeClass("is-animation"),b.animateWithJS(h);else{var i=a("svg.ripple-effect",d);i.attr("class",i.attr("class")+" is-animation")}setTimeout(function(){h.remove()},1e3)}})}},animateWithJS:function(a){var b=200,c=parseFloat(a.css("left"))-b/2+"px",d=parseFloat(a.css("top"))-b/2+"px";a.css({opacity:.4}).animate({opacity:0,left:c,top:d,width:b,height:b},1e3)},destroy:function(){this.element.off("touchstart.button touchend.button touchcancel.button mousedown.button mouseup.button mouseleave.button focusout.button");var b=this.element.data("tooltip");this.element.hasClass("btn-actions")&&b&&b.destroy(),a.removeData(this.element[0],c)}},this.each(function(){var d=a.data(this,c);d||(d=a.data(this,c,new b(this)))})},window.Chart=function(b){"use strict";var c=this;if("undefined"==typeof d3)return a(b).append('<p class="chart-message"></p>'),null;var d=["#1D5F8A","#8ED1C6","#8E72A4","#5C5C5C","#F2BC41","#76B051","#AD4242","#8DC9E6","#DE7223","#317C73","#EB9D9D","#999999","#44831F","#C7B4DB","#4EA0D1","#6C4B81","#AFDC91","#69ADA3","#DE7223","#D8D8D8"];this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.pieColors=d3.scale.ordinal().range(d),this.greyColors=d3.scale.ordinal().range(["#737373","#999999","#bdbdbd","#d8d8d8"]),this.sparklineColors=d3.scale.ordinal().range(["#1D5F8A","#999999","#bdbdbd","#d8d8d8"]),this.colors=d3.scale.ordinal().range(d),this.chartColor=function(a,b,c){var d=c&&c.color?c.color:null;if(d){if("error"===d)return"#e84f4f";if("alert"===d)return"#ff9426";if("alertYellow"===d)return"#ffd726";if("good"===d)return"#80ce4d";if("neutral"===d)return"#dbdbdb";if(d&&0===d.indexOf("#"))return c.color}return"pie"===b?this.pieColors(a):"bar-single"===b||"column-single"===b?"#368AC0":"bar"===b||"line"===b?this.colors(a):void 0},this.selectElem=function(b,d){var e,f=a(b).index(),g=d[f],h=c.settings;if("Pie"===h.chartType)e=d3.select(h.svg.selectAll(".arc")[0][f]);else if("column-positive-negative"===h.type){if(!g.option||g.option&&"target"===g.option)return;e=h.svg.select(".bar."+g.option)}else if(-1!==["Column","HorizontalBar"].indexOf(h.chartType))if(h.isGrouped||h.isSingular)e=h.svg.select(".series-"+f);else if(h.isStacked&&!h.isSingular){var i=d3.select(h.svg.selectAll("HorizontalBar"===h.chartType?".series-group":".g")[0][f]);e=i.select(".bar")}-1!==["Pie","Column","HorizontalBar"].indexOf(h.chartType)&&(h.isByLegends=!0,e.on("click").call(e.node(),e.datum(),f)),g.selectionObj&&c.selectElement(d3.select(g.selectionObj[0][f]),g.selectionInverse,g.data)},this.addLegend=function(d){var e,f=c.settings,g=a('<div class="chart-legend"></div>');if(0!==d.length){var h,i,j=0;for(e=0;e<d.length;e++)h=6*d[e].name.length,j=d[e].name&&h>j?h:j;for(j+=55,i=j/a(b).width()*100,e=0;e<d.length;e++)if(d[e].name){var k="";!d[e].display||"block"!==d[e].display&&"twocolumn"!==d[e].display||(k+=" lg"),"column-positive-negative"===f.type&&d[e].option&&(k+=" "+d[e].option);var l=a('<span class="chart-legend-item'+k+'" tabindex="0"></span>'),m=c.chartColor(e,1===d.length?"bar-single":"bar",d[e]),n=a('<span class="chart-legend-color"></span>').css("background-color",d[e].pattern?"transparent":m),o=a('<span class="chart-legend-item-text">'+d[e].name+"</span>");if(d[e].pattern&&n.append('<svg width="12" height="12"><rect style="fill: '+m+'" mask="url(#'+d[e].pattern+')" height="12" width="12" /></svg>'),d[e].percent){var p=a('<span class="chart-legend-percent"></span>').text(d[e].percent);o.append(p)}d[e].display&&"block"===d[e].display&&l.css({"float":"none",display:"block",margin:"0 auto",width:j}),d[e].display&&"twocolumn"===d[e].display&&(g.css({margin:"2em auto auto","border-top":"1px solid #ccc","padding-top":"1em"}),l.css(i>45?{"float":"none",display:"block",margin:"0 auto",width:j}:{"float":"none",display:"inline-block",width:"45%"})),l.append(n,o),g.append(l)}g.on("click.chart",".chart-legend-item",function(){c.selectElem(this,d)}).on("keypress.chart",".chart-legend-item",function(a){(13===a.which||32===a.which)&&c.selectElem(this,d)}),a(b).append(g)}},this.renderLegend=function(){if(c.legendformatter&&"function"==typeof c.legendformatter)var d="",e=!0,f=setInterval(function(){e&&(e=!1,c.legendformatter(function(a){d=a})),""!==d&&(clearInterval(f),a(b).append(d))},10)},this.appendTooltip=function(){this.tooltip=a("#svg-tooltip"),0===this.tooltip.length&&(this.tooltip=a('<div id="svg-tooltip" class="tooltip right is-hidden"><div class="arrow"></div><div class="tooltip-content"><p><b>32</b> Element</p></div></div>').appendTo("body"),this.isTouch&&this.tooltip.css({"pointer-events":"auto"}).on("touchend.svgtooltip",function(){c.hideTooltip()}))},this.triggerContextMenu=function(c,d){d3.event.preventDefault(),d3.event.stopPropagation(),d3.event.stopImmediatePropagation();var e=a.Event("contextmenu");e.target=c,e.pageX=d3.event.pageX,e.pageY=d3.event.pageY,a(b).trigger(e,[c,d])},this.showTooltip=function(a,b,c,d){0>a&&(a=2),this.tooltip.css({left:a+"px",top:b+"px"}).find(".tooltip-content").html(c),this.tooltip.removeClass("bottom top left right").addClass(d),this.tooltip.removeClass("is-hidden")},this.getTooltipSize=function(a){return this.tooltip.find(".tooltip-content").html(a),{height:this.tooltip.outerHeight(),width:this.tooltip.outerWidth()}},this.hideTooltip=function(){d3.select("#svg-tooltip").classed("is-hidden",!0).style("left","-999px")},this.formatCurrency=function(a){var b=Locale.currentLocale.data?Locale.currentLocale.data.currencySign:"$";return a=isNaN(1*a)?0:a,b+(1*a).toFixed(2)},this.HorizontalBar=function(d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G={formatterString:null},H=a.extend(!0,G,c.options),I=!!H.formatterString,J=function(a){return I?d3.format(H.formatterString)(a):a},K=[],L=c.options.tooltip,M=30,N=40,O=.5;f=void 0===f?!0:f;var P=a(b).parent().width()<450,Q={top:f?30:20,left:30,right:30,bottom:30};g=d,a(b).addClass("chart-vertical-bar"),i=parseInt(a(b).parent().width())-Q.left-Q.right,j=parseInt(a(b).parent().height())-Q.top-Q.bottom-N,k=g.map(function(a){return{name:a.name,color:a.color,pattern:a.pattern}}),g=g.map(function(b){return b.data.map(function(b){return a.extend({},b,{y:b.value,x:b.name,color:b.color,pattern:b.pattern})})}),n=d3.layout.stack(),n(g),h=0,g=g.map(function(b,c){return f||k[c]&&(h=k[c].name.length>h?k[c].name.length:h),b.map(function(b){return f&&(h=b.x.length>h?b.x.length:h),a.extend({},b,{x:b.y,y:b.x,x0:b.y0,color:b.color,pattern:b.pattern})})});var R=parseInt(a(b).parent().height())-Q.bottom-(f?0:N/2),S=parseInt(a(b).parent().width())-Q.left,T=Q.left+6*h;if(m=d3.select(b).append("svg").attr("width",S).attr("height",R).append("g").attr("class","group").attr("transform","translate("+T+","+Q.top+")"),o=d3.min(g,function(a){return d3.min(a,function(a){return f?a.x+a.x0:a.x})}),p=d3.max(g,function(a){return d3.max(a,function(a){return f?a.x+a.x0:a.x})}),f&&e){var U=[];g.forEach(function(a){a.forEach(function(a,b){U[b]=(void 0===U[b]?0:U[b])+a.x})}),g.forEach(function(a){a.forEach(function(a,b){var c=U[b]/100;a.x=a.x/c,a.x0=a.x0/c})}),p=100}var V=S-T-Q.left;return q=d3.scale.linear().domain([0>o?o:0,p]).nice().range([0,V]).nice(),f?(t=g[0].map(function(a){return a.y}),E=.32):(t=k.map(function(a){return a.name}),function(){var b,c,d;for(b=g.length-1,c=-1;b>c;b--)d=g[b].map(function(a){return a}),a.extend(!0,y,d),y=a.map(y,function(a){return a})}(),z=0,A=y.length,B=j/t.length,E=B/A,C=A>1?B-E*O:M,D=B-C,M=C/A,E=0),r=d3.scale.ordinal().domain(t).rangeRoundBands([0,j],E,E),u=d3.svg.axis().scale(q).tickSize(-j).orient("middle"),P&&u.ticks(100>T?5:3),f&&e&&u.tickFormat(function(a){return a+"%"}),s=d3.svg.axis().scale(r).tickSize(0).orient("left"),m.append("g").attr("class","axis x").attr("transform","translate(0,"+j+")").call(u),m.append("g").attr("class","axis y").call(s),v=m.selectAll("g.group").data(g).enter().append("g").attr("class","series-group").attr("data-group-id",function(a,b){return b}),w=m.selectAll(".series-group")[0].length>1&&!f,x=1===m.selectAll(".series-group")[0].length&&f,a.extend(c.settings,{svg:m,chartType:"HorizontalBar",isSingle:x,isGrouped:w,isStacked:f}),l=v.selectAll("rect").data(function(a,b){return a.forEach(function(a){a.index=b,f||(a.gindex=z++)}),a}).enter().append("rect").attr("class",function(a,b){return"bar series-"+b}).style("fill",function(a,b){return f?1===k.length?c.chartColor(b,"bar-single",a):c.chartColor(a.index,"bar",k[a.index]):c.chartColor(b,"bar",y[b])}).attr("mask",function(a,b){return 1===g.length&&g[0][b].pattern?"url(#"+g[0][b].pattern+")":f&&k[a.index].pattern?"url(#"+k[a.index].pattern+")":!f&&y[b].pattern?"url(#"+y[b].pattern+")":void 0}).attr("x",function(a){return q(f&&!x?a.x0:0)}).attr("y",function(a){return f?r(a.y):(B-C)/2+a.gindex*M+a.index*D}).attr("height",function(){return f?r.rangeBand():M}).attr("width",0).on("mouseenter",function(b,d){var e,h,i,j=0,l=[],m="",n=d3.select(this.parentNode).datum(),o=Math.round(n.length/2),p=d3.select(this),q=function(a,b){return a&&b?'<svg width="12" height="12"><rect style="fill: '+b+'" mask="url(#'+a+')" height="12" width="12" /></svg>':""},r=function(a,b,d){var e=c.getTooltipSize(m),f=a+parseFloat(p.attr("width"))/2-e.width/2,g=d?b:b-e.height-13;""!==m&&c.showTooltip(f,g,m,d?"bottom":"top")};if(1===g.length)m="<p><b>"+b.y+" </b>"+b.x+"</p>";else{if(m='<div class="chart-swatch">',f)for(e=0,h=g.length;h>e;e++){j=0,i=c.chartColor(e,"bar",k[e]);for(var s=0,t=g.length;t>s;s++)j+=g[s][d].x,l[s]=g[s][d].x;m+='<div class="swatch-row"><div style="background-color:'+(k[e].pattern?"transparent":i)+';">'+q(k[e].pattern,i)+"</div><span>"+k[e].name+"</span><b> "+Math.round(l[e]/j*100)+"% </b></div>"}else for(o>1&&(p=d3.select(this.parentNode).select(".series-"+o)),e=0,h=n.length;h>e;e++)i=c.chartColor(e,"bar",y[e]),m+='<div class="swatch-row"><div style="background-color:'+(y[e].pattern?"transparent":i)+';">'+q(y[e].pattern,i)+"</div><span>"+n[e].name+"</span><b>"+J(n[e].value)+"</b></div>";m+="</div>"}j>0&&(m='<span class="chart-tooltip-total"><b>'+j+"</b> "+Locale.translate("Total")+"</span>"+m);var u=p[0][0].getBoundingClientRect().top+a(window).scrollTop(),v=p[0][0].getBoundingClientRect().left+a(window).scrollLeft(),w=6,x=!f&&n.length>w;if(L&&"function"==typeof L&&!K[d]){m="";var z=!0;F=setInterval(function(){z&&(z=!1,L(function(a){m=K[d]=a})),""!==m&&(clearInterval(F),r(v,u,x))},10)}else m=K[d]||L||b.tooltip||m||"",r(v,u,x)}).on("mouseleave",function(){clearInterval(F),c.hideTooltip()}).on("click",function(d,e){var f=this&&d3.select(this).classed("is-selected"),g=parseInt(d3.select(this.parentNode).attr("data-group-id"),10);c.setSelectedElement({task:f?"unselected":"selected",container:b,selector:this,isTrigger:!f,triggerGroup:w,d:d,i:e}),f&&a(b).triggerHandler("selected",[d3.select(this)[0],{},w?g:e])}),m.selectAll(".axis.y text").attr({x:-15}),m.selectAll(".bar").transition().duration(1e3).attr("width",function(a){return Math.abs(q(a.x)-q(0))}).attr("x",function(a){return q(f&&!x?a.x0:a.x<0?a.x:0)}),c.addLegend(f?k:y),c.appendTooltip(),function(){var b,c,e,g=0,h=m.node().parentNode.nextSibling,i=d3.select(h),j=i.node()&&i.classed("chart-legend"),k=function(a){a=a?d3.select(a):m,a.selectAll(".bar").each(function(a,d){a&&a.selected&&1>g&&(g++,c=d3.select(this),b=d)})},l=function(){var a=m.selectAll(".series-group");a[0].length&&a.each(function(){k(this)})};w||f&&!x?(d.forEach(function(a,d){a.selected&&1>g&&(g++,c=m.select('[data-group-id="'+d+'"]').select(".bar"),b=d,f&&!w&&(e=!0))}),1>g&&l()):k(),g>0&&(e?j&&a(i.selectAll(".chart-legend-item")[0][b]).trigger("click.chart"):c.on("click").call(c.node(),c.datum(),b))}(),a(b).trigger("rendered"),a(b)},this.Pie=function(d,e,f){var g={labels:{hideLabels:!0,isTwoline:!0,contentsTop:"percentage",contentsBottom:"name",formatterTop:null,formatterBottom:null,colorTop:"color-as-arc",colorBottom:"default",lineColor:"default",lineWidth:2,linehideWhenMoreThanPercentage:10}},h=a.extend(!0,g,f),i=h.labels;i.isTwoline||!f||f.labels.colorTop||(i.colorTop=i.colorBottom);var j,k=this,l=a(b).parent(),m=[],n=c.options.tooltip;c.appendTooltip();var o=c.legendshow||!1,p=d[0].data;p=p.sort(function(a,b){return+a.value-+b.value});var q=d3.sum(p,function(a){return a.value});p=p.map(function(a){return{data:a,elm:a,name:a.name,color:a.color,value:a.value,percent:d3.round(100*(a.value/q))}});var r=d3.select(b).append("svg"),s=r.append("g").attr("class","arcs"),t=r.append("g").attr("class","lines"),u=d[0].centerLabel;a(b).addClass("chart-pie");var v=d3.layout.pie().value(function(a){return a.value}),w={height:parseInt(l.height()),width:parseInt(l.width()),widgetheight:318},x=w.width<405;w.height=w.height>w.widgetheight?w.widgetheight:w.height,w.height=x&&!i.hideLabels?w.width:w.height,w.outerRadius=Math.min(w.width,w.height)/2-35,w.innerRadius=e?w.outerRadius-(i.hideLabels?30:50):0,w.labelRadius=w.outerRadius+20,w.center={x:w.width/2,y:w.height/2},r.attr({width:"100%",height:x&&!i.hideLabels||w.height===w.widgetheight?w.height-50:"100%",viewBox:"0 0 "+w.width+" "+w.height}),s.attr("transform","translate("+w.center.x+","+w.center.y+")"),t.attr("transform","translate("+w.center.x+","+w.center.y+")");var y=v(p),z=d3.svg.arc().innerRadius(w.innerRadius).outerRadius(w.outerRadius),A=d3.svg.arc().innerRadius(w.outerRadius).outerRadius(w.outerRadius),B=d3.svg.arc().innerRadius(w.labelRadius).outerRadius(w.labelRadius);a.extend(c.settings,{svg:r,chartType:"Pie"});var C=s.selectAll(".arc").data(y).enter();C.append("path").attr("class","arc").on("contextmenu",function(a){k.triggerContextMenu(d3.select(this).select("path")[0][0],a)}).on("click",function(d,e){var f=this&&d3.select(this).classed("is-selected");f?(c.setSelectedElement({task:"unselected",container:b,selector:".chart-container .is-selected",isTrigger:!1,d:d.data,i:e}),a(b).triggerHandler("selected",[d3.select(this)[0],{},e])):c.setSelectedElement({task:"selected",container:b,selector:this,isTrigger:!0,d:d.data,i:e})}).on("mouseenter",function(a,b){var d,e,f,g,h,i,k=l.offset(),o="",p=function(){d=c.getTooltipSize(o),e-=d.width/2,f-=d.height/2,""!==o&&c.showTooltip(e,f,o,"top")},q=r.selectAll(".pie-circle");if(g=d3.transform(d3.select(q[0][b]).attr("transform")),h=g.translate[0]+(g.translate[0]>0?-10:10),i=g.translate[1]+(g.translate[1]>0?-10:10),i+=g.translate[0]>0&&g.translate[1]>0?-32:0,h+=g.translate[1]>0&&g.translate[0]<0?17:0,i+=g.translate[1]<0&&g.translate[0]<0?-17:0,i+=g.translate[0]<0&&g.translate[1]>0?-24:0,e=h+k.left+w.center.x,f=i+k.top+w.center.y,n&&"function"==typeof n&&!m[b]){var s=!0;j=setInterval(function(){s&&(s=!1,n(function(a){o=m[b]=a})),""!==o&&(clearInterval(j),p())},10)}else n="object"==typeof n?"":n,o=m[b]||n||a.data.tooltip||a.data.data.tooltip||"",o=o.replace("{{percent}}",a.data.percent+"%"),o=o.replace("{{value}}",a.value),o=o.replace("%percent%",a.data.percent+"%"),o=o.replace("%value%",a.value),p()}).on("mouseleave",function(){clearInterval(j),c.hideTooltip()}).style("fill",function(a,b){return c.chartColor(b,"pie",a.data)}).transition().duration(750).attrTween("d",function(a){var b=d3.interpolate(a.startAngle+.1,a.endAngle);return function(c){return a.endAngle=b(c),z(a)}});var D,E=[],F=[],G=function(a,b,c,d){c=/percentage/i.test(b)?"0.0%":c;var e,f=d3.format(c||""),g=f(a.value/q),h=d?a.data.shortName||a.data.name.substring(0,6)+"...":a.data.name,i=c&&"0.0%"!==c?f(a.value):a.value;switch(b){case"name":e=h;break;case"value":e=i;break;case"percentage":e=g;break;case"name, value":e=h+", "+i;break;case"name (value)":e=h+" ("+i+")";break;case"name (percentage)":e=h+" ("+g+")";break;default:e=h+", "+i+" ("+g+")"}return e||""},H=function(a,b,d){return"color-as-arc"===d?c.chartColor(b,"pie",a.data):"default"===d?"":d},I=function(a){r.selectAll(".lb-top").each(function(b,c){d3.select(this).text(function(){return G(b,i.contentsTop,i.formatterTop,a)}).style({"font-weight":i.isTwoline?"bold":"normal","font-size":i.isTwoline?w.width>450?"1.3em":"1.1em":"1em",fill:function(){return H(b,c,i.colorTop)}})}),i.isTwoline&&r.selectAll(".lb-bottom").each(function(b,c){d3.select(this).text(function(){return G(b,i.contentsBottom,i.formatterBottom,a)}).style({"font-size":"1em",fill:function(){return H(b,c,i.colorBottom)}})})},J=function(){r.selectAll(".labels").remove();var a=r.append("g").attr("class","labels"),b=a.selectAll(".label").data(y).enter(),c=b.append("g").attr("class","label");a.attr("transform","translate("+w.center.x+","+w.center.y+")"),c.append("circle").style("fill","none").attr({"class":"pie-circle",x:0,y:0,r:1,transform:function(a){var b=A.centroid(a)[0],c=A.centroid(a)[1];return"translate("+b+","+c+")"}}),c.append("circle").style("fill","none").attr({"class":"label-circle",x:0,y:0,r:1,transform:function(a){var b=B.centroid(a)[0],c=B.centroid(a)[1];return"translate("+b+","+c+")"}}),D=c.append("text").attr({"class":"label-text",x:function(a){var b=z.centroid(a),c=Math.atan2(b[1],b[0]),d=Math.cos(c)*w.labelRadius,e=d>0?1:-1,f=d+1*e;return E.push(f),f},y:function(a){var b=z.centroid(a),c=Math.atan2(b[1],b[0]),d=Math.sin(c)*w.labelRadius;return F.push(d),d},"text-anchor":function(a){var b=z.centroid(a),c=Math.atan2(b[1],b[0]),d=Math.cos(c)*w.labelRadius;return d>0?"start":"end"}}),D.append("tspan").attr("class","lb-top"),i.isTwoline&&D.append("tspan").attr({"class":"lb-bottom",x:function(a,b){return E[b]-2},dy:"18"}),i.hideLabels&&(I(),e&&s.append("text").attr("dy",".35em").style("text-anchor","middle").attr("class","chart-donut-text").html(u))};J(),i.hideLabels?(!function(){function a(){var c=!1;D.each(function(a,d){var e=this,f=d3.select(e),g=+f.attr("y");D.each(function(a,e){if(e>d){var h,i=this,j=d3.select(i),k=+j.attr("y");f.attr("text-anchor")===j.attr("text-anchor")&&(h=g-k,Math.abs(h)<b&&(c=!0,j.attr("y",k>0?k-1:k+1)))}})}),c&&a()}var b=Math.round(D.node().getBBox().height)+1,c=D[0].map(function(a){return a=d3.select(a),{x:+a.attr("x"),y:+a.attr("y")}});a(),D.each(function(a,d){var e=d3.select(this),f=+e.attr("x"),g=+e.attr("y"),h=f>0?1:-1,j=(w.labelRadius-Math.abs(g)+Math.abs(c[d].x+2.5*b))*h;(c[d].y!==g||0===d&&p[d].percent<10)&&(j+=p[d].percent<10?f:Math.ceil(f/3),e.attr("x",j),i.isTwoline&&e.select(".lb-bottom").attr("x",j))})}(),function(){var a=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("basis"),b=r.selectAll(".label"),c=r.select(".labels").node().getBoundingClientRect();(c.left<45||c.width>w.width-15)&&(I({isShortName:!0}),r.selectAll(".label-text tspan").each(function(){"..."===d3.select(this).text().substring(5)&&(o=!0)})),b.each(function(b,c){var d=d3.select(this),e=d.select(".pie-circle"),f=d.select(".label-circle"),g=d.select(".label-text"),h=d3.transform(e.attr("transform")),j=d3.transform(f.attr("transform")),k=[{x:Number(h.translate[0]),y:Number(h.translate[1])},{x:Number(j.translate[0]),y:Number(j.translate[1])},{x:Number(g.attr("x")),y:Number(g.attr("y"))+(i.isTwoline?5:0)}];i.linehideWhenMoreThanPercentage>p[c].percent&&t.append("path").attr({"class":"label-line",d:a(k)}).style({"stroke-width":i.lineWidth,stroke:function(){return H(b,c,i.lineColor)}})})}()):o=!0;var K=p.map(function(a){var b=a.name+" ("+a.percent+"%)";return{name:b,display:"twocolumn",color:a.color}});return(o||c.legendformatter)&&c[c.legendformatter?"renderLegend":"addLegend"](K),function(){var a,b=0;s.selectAll(".arc").each(function(c,d){c&&c.data&&c.data.data&&c.data.data.selected&&1>b&&(b++,a=d3.select(this),a.on("click").call(a.node(),a.datum(),d))})}(),a(b).trigger("rendered"),a(b)},this.elementTransform=function(a){a.element.attr("transform",function(){var b=a.sameAs||this,c=d3.transform(d3.select(b).attr("transform")),d=c.translate[0],e=c.translate[1];return d=a.addtoX?d>0?d+a.addtoX:d-a.addtoX:d,e=a.addtoY?e>0?e+a.addtoY:e-a.addtoY:e,"translate("+d+","+e+")"})},this.moveLabels=function(a){var b=a.textLabels[0];a.addtoX?(a.textLabels.attr("x",function(){var b=d3.select(this).attr("x");return b>0?b+a.addtoX:b-a.addtoX}),a.textLines.attr("x2",function(a,c){var d=d3.select(b[c]);return d.attr("x")})):a.addtoY&&(a.textLabels.attr("y",function(){var b=Number(d3.select(this).attr("y"));return b>0?b+a.addtoY:b-a.addtoY}),a.textLines.attr("y2",function(a,c){var d=d3.select(b[c]);return d.attr("y")}))},this.handleResize=function(){function c(){clearTimeout(d),d=setTimeout(function(){var c=a(b).data("chart"),d=a(b);if(e!==d.width()){if(e=d.width(),!d.is(":visible"))return!0;d.empty(),c.initChartType(c.settings)}},100)}var d=null,e=0;this.redrawOnResize&&(a(window).on("resize.charts",c),a(b).off("resize").on("resize",c))},this.Ring=function(a){return c.Pie(a,!0)},this.calculateAspectRatioFit=function(a){var b=Math.min(a.maxWidth/a.srcWidth,a.maxHeight/a.srcHeight);return{width:a.srcWidth*b,height:a.srcHeight*b}},this.Sparkline=function(d,e){var f,g,h,i=[],j=[],k=c.options.tooltip,l=0,m=0,n=0,o=this.calculateAspectRatioFit({srcWidth:385,srcHeight:65,maxWidth:a(b).width(),maxHeight:600}),p=o.width>300?4:3;for(h=0;h<d.length;h++)m=d3.min([d3.min(d[h].data),m]),l=d3.max([d3.max(d[h].data),l]),n=d3.max([d[h].data.length,n]);var q=10,r=o.width,s=o.height,t=d3.scale.linear().domain([0,n]).range([q,r-q]),u=d3.scale.linear().domain([m,l]).range([s-q,q]),v=d3.svg.line().x(function(a,b){return t(b)}).y(function(a){return u(a)});c.appendTooltip();var w=d3.select(b).append("svg").attr("height",s).attr("width",r);if(e.isMedianRange){l=d3.max(d[0].data),m=d3.min(d[0].data);var x=10,y=r-45,z=d3.median(d[0].data),A=l-m,B=d3.scale.linear().domain([m,l]).range([0,s]),C=s-B(z>A?z:A),D=s-B(A>z?z:A);w.append("g").attr("class","medianrange").attr("transform",function(){return"translate("+x+","+C+")"}).append("rect").attr("width",y).attr("height",D).style("fill","#d8d8d8").on("mouseenter",function(a,b){var g=this.getBoundingClientRect(),h="<p>"+(d[0].name?d[0].name+"<br> ":"")+Locale.translate("Median")+": <b>"+z+"</b><br>"+Locale.translate("Range")+": <b>"+A+"</b>"+(e.isPeakDot?"<br>"+Locale.translate("Peak")+": <b>"+l+"</b>":"")+"</p>",j=function(){var a=c.getTooltipSize(h),b=g.left+(g.width-a.width)/2,d=g.top-a.height-5;""!==h&&c.showTooltip(b,d,h,"top")};if(k&&"function"==typeof k&&!i[b]){h="";var m=!0;f=setInterval(function(){m&&(m=!1,k(function(a){h=i[b]=a})),""!==h&&(clearInterval(f),j())},10)}else k="object"==typeof k?"":k,h=i[b]||k||d[0].tooltip||h||"",j()}).on("mouseleave",function(){clearInterval(f),c.hideTooltip()})}for(h=0;h<d.length;h++){var E=d[h],F=w.append("g");F.append("path").attr("d",v(E.data)).attr("stroke",e.isMinMax?"#999999":c.sparklineColors(h)).attr("class","team")}return m=d3.min(d[0].data),w.selectAll(".point").data(d[0].data).enter().append("circle").attr("r",function(a){return e.isMinMax&&l===a||e.isMinMax&&m===a?p+1:e.isDots||e.isPeakDot&&l===a?p:0}).attr("class",function(a){return e.isPeakDot&&l===a&&!e.isMinMax?"point peak":e.isMinMax&&l===a?"point max":e.isMinMax&&m===a?"point min":"point"}).style("fill",function(a){return e.isPeakDot&&l===a&&!e.isMinMax?"#ffffff":e.isMinMax&&l===a?"#56932E":e.isMinMax&&m===a?"#941E1E":c.sparklineColors(0)}).style("stroke",function(a){return e.isPeakDot&&l===a&&!e.isMinMax?c.sparklineColors(0):e.isMinMax&&l===a?"none":e.isMinMax&&m===a?"none":"#ffffff"}).style("cursor","pointer").attr("cx",function(a,b){return t(b)}).attr("cy",function(a){return u(a)}).on("mouseenter",function(a){var b=this.getBoundingClientRect(),f="<p>"+(d[0].name?d[0].name+"<br> "+(e.isMinMax&&l===a?Locale.translate("Highest")+": ":e.isMinMax&&m===a?Locale.translate("Lowest")+": ":e.isPeakDot&&l===a?Locale.translate("Peak")+": ":""):"")+"<b>"+a+"</b></p>",i=function(){var a=c.getTooltipSize(f),d=b.left-a.width/2+6,e=b.top-a.height-8;""!==f&&c.showTooltip(d,e,f,"top")};if(k&&"function"==typeof k&&!j[h]){f="";var n=!0;g=setInterval(function(){n&&(n=!1,k(function(a){f=j[h]=a})),""!==f&&(clearInterval(g),i())},10)}else k="object"==typeof k?"":k,f=j[h]||k||d[0].tooltip||f||"",i();d3.select(this).attr("r",e.isMinMax&&l===a||e.isMinMax&&m===a?p+2:p+1)}).on("mouseleave",function(a){clearInterval(g),c.hideTooltip(),d3.select(this).attr("r",e.isMinMax&&l===a||e.isMinMax&&m===a?p+1:p)}),a(b).trigger("rendered"),a(b)},this.Column=function(d,e){function f(a){var b;if(a=y&&a,z||y){if(b=R.selectAll("rect"+(a?".target-bar":".bar")).data(e?g:U).enter().append("rect").attr("class",function(b,c){var d="bar series-"+c;return y&&(d=(a?"target-bar series-"+c:d)+(b.value>0?" positive":" negative")),d}).attr("width",Math.min.apply(null,[I.rangeBand()-2,Y])).attr("x",function(a){return e?L(0):I(a.name)+(I.rangeBand()-Y)/2}).attr("y",function(){return J(0)>D?D:J(0)}).attr("height",function(){return 0}).attr("mask",function(b){return y?a?o.target?"url(#"+o.target+")":null:b.value<0?o.negative?"url(#"+o.negative+")":null:o.positive?"url(#"+o.positive+")":null:null}).style("fill",function(b){return y?Z(a?n.target:b.value<0?n.negative:n.positive):null}),y){var c=12;R.selectAll(a?".target-bartext":".bartext").data(U).enter().append("text").attr("class",function(b){return(a?"target-bartext":"bartext")+(b.value>0?" positive":" negative")}).attr("text-anchor","middle").attr("x",function(a){return I(a.name)+I.rangeBand()/2}).attr("y",function(b){return a?J(b.target)-c/2:J(b.value>0?0:b.value)+c}).style("opacity",0).style("fill",function(b){return a?"":Z(b.value<0?n.negative:n.positive)}).style("font-weight","bold").text(function(b){return u(a?b.target:b.value)})}b.transition().duration(1e3).call($,function(){R.selectAll(".target-bartext, .bartext").transition().duration(300).style("opacity",1)}).attr("y",function(b){var c=e?D-M(b[0].y)-M(b[0].y0):J(b.value<0?0:b.value);return a?J(b.target):b.value<0?c:c>D-3?D-2:c}).attr("height",function(b){var c;return c=e?M(b[0].y):b.value<0?D-J(0)-(D-J(b.value)):D-J(b.value)-(D-J(0)),c=b.value<0?c:3>c?2:c>D?D-J(b.value):c,a?D-J(b.target)-(D-J(0)):c})}else{var d=R.selectAll(".x-value").data(e?g:U).enter().append("g").attr("class","series-group g").attr("data-group-id",function(a,b){return b}).attr("transform",function(a){return"translate("+H(e?O[0]:a.name)+",0)"});b=d.selectAll("rect").data(function(a){return e?a:a.values}).enter().append("rect").attr("class",function(a,b){return"series-"+b+" bar"}).attr("width",Math.min.apply(null,[I.rangeBand()-2,Y])).attr("x",function(a,b){var c=Math.min.apply(null,[I.rangeBand()-2,Y]);return e?L(b):I.rangeBand()/2+(c+2)*b-(1===U[0].values.length||5===U[0].values.length||4===U[0].values.length?c/2:0)}).attr("y",function(){return J(0)>D?D:J(0)}).attr("height",function(){return 0}),b.transition().duration(1e3).attr("y",function(a){var b=e?D-M(a.y)-M(a.y0):J(a.value<0?0:a.value);return a.value<0?b:b>D-3?D-2:b}).attr("height",function(a){var b;return b=e?M(a.y):a.value<0?D-J(0)-(D-J(a.value)):D-J(a.value)-(D-J(0)),a.value<0?b:3>b?2:b>D?D-J(a.value):b})}return b}var g,h,i,j,k,l,m,n,o,p,q,r={formatterString:null},s=a.extend(!0,r,c.options),t=!!s.formatterString,u=function(a){return t?d3.format(s.formatterString)(a):a},v=d,w=this,x=a(b).parent(),y="column-positive-negative"===c.settings.type,z=1===v.length,A={top:40,right:40,bottom:z&&void 0===d[0].name?e?20:50:35,left:45},B=40,C=x.width()-A.left-A.right-10,D=x.height()-A.top-A.bottom-(z&&void 0===d[0].name?e||y?B:0:B);h=d3.min(v,function(a){return d3.min(a.data,function(a){return a.value})}),i=d3.max(v,function(a){return d3.max(a.data,function(a){return a.value})}),y&&(j=d3.min(v,function(a){return d3.min(a.data,function(a){return a.target})}),k=d3.max(v,function(a){return d3.max(a.data,function(a){return a.target})}),h=d3.min([h,j]),i=d3.max([i,k]),p={target:"Target",positive:"Positive",negative:"Negative"},n={target:"neutral",positive:"good",negative:"error"},o={},v[0]&&(v[0].colors&&a.extend(!0,n,v[0].colors),v[0].legends&&a.extend(!0,p,v[0].legends),v[0].patterns&&a.extend(!0,o,v[0].patterns)),q=[],a.each(p,function(a,b){q.push({name:b,color:n[a],pattern:o[a],option:a})})),a(b).addClass("column-chart");var E,F=[],G=c.options.tooltip,H=d3.scale.ordinal().rangeRoundBands([0,C],.1),I=d3.scale.ordinal(),J=d3.scale.linear().range([D,0]);if(e){g=z?v[0].data.map(function(b){return[a.extend({},b,{y:b.value,x:b.name,color:b.color,pattern:b.pattern,parentName:b.name,tooltip:b.tooltip})]}):v.map(function(b){return b.data.map(function(c){return a.extend({},c,{y:c.value,x:c.name,color:c.color,pattern:c.pattern,parentName:b.name,tooltip:b.tooltip})})});var K=d3.layout.stack();K(g);var L=d3.scale.ordinal().domain(d3.range(g[0].length)).rangeRoundBands([0,C],.05),M=d3.scale.linear().domain([0,d3.max(g,function(a){return d3.max(a,function(a){return a.y0+a.y})})]).range([0,D])}var N,O=v[0].data.map(function(a){return a.name}),P=d3.svg.axis().scale(H).tickSize(0).tickPadding(12).orient("bottom"),Q=d3.svg.axis().scale(J).tickSize(-C).tickPadding(12).tickFormat(d3.format(c.format||"s")).orient("left"),R=d3.select(b).append("svg").attr("width",C+A.left+A.right).attr("height",D+A.top+A.bottom).append("g").attr("transform","translate("+A.left+","+A.top+")"),S=v.map(function(a){return a.name}),T=v.map(function(a){return d3.max(a.data,function(a){return y?a.target:a.value})});e&&(N=g.map(function(a){return d3.max(a,function(a){return a.y+a.y0})})),z&&(S=v[0].data.map(function(a){return a.name})),y&&(h+=h/J.ticks().length,T[0]+=T[0]/J.ticks().length),function(){if(e&&z)l=v[0].data;else{var b,c,d;for(b=v.length-1,c=-1;b>c;b--)d=v[b].data.map(function(a){return a}),a.extend(!0,l,d),l=a.map(l,function(a){return a})}}(),e&&!z&&(m=S.map(function(a,b){return v[b]})),H.domain(e?O:S),I.domain(O).rangeRoundBands([0,z||e?C:H.rangeBand()]),J.domain([0>h?h:c.settings.minValue||0,d3.max(e?N:T)]).nice(),(!z||z&&!e)&&R.append("g").attr("class","x axis").attr("transform","translate(0,"+D+")").call(P),R.append("g").attr("class","y axis").call(Q);var U=[];d.forEach(function(b){U.push(a.extend({},b,{values:b.data}))}),z&&(U=[],S=v[0].data.forEach(function(a){U.push(a)}));var V,W,X,Y=35,Z=function(a){return c.chartColor(0,"",{color:a})},$=function(a,b){var c;a.empty()?b():(c=a.size(),a.each("end",function(){c--,0===c&&b()}))};y&&(W=f(!0)),V=f(),y&&(X=d3.selectAll(".empty-bars"),c.mergeArrays(X[0],W[0],V[0])),y||(e?e&&!z?V.style("fill",function(){var a=d3.select(this.parentNode).attr("data-group-id");return c.chartColor(a,"bar",v[a])}).attr("mask",function(){var a=d3.select(this.parentNode).attr("data-group-id");return v[a].pattern?"url(#"+v[a].pattern+")":null}):e&&z&&V.style("fill",function(a,b){return c.chartColor(b,"bar",a[0])}).attr("mask",function(a){return a[0].pattern?"url(#"+a[0].pattern+")":null}):V.style("fill",function(a,b){return z?c.chartColor(b,"column-single",d[0].data[b]):c.chartColor(b,"bar",l[b])}).attr("mask",function(a,b){return z?d[0].data[b].pattern?"url(#"+d[0].data[b].pattern+")":null:l[b].pattern?"url(#"+l[b].pattern+")":null;

}));var _=z||!z&&e,aa=!_;return a.extend(c.settings,{svg:R,chartType:"Column",isSingle:_,isGrouped:aa,isStacked:e,isSingular:z}),(y?X:V).on("mouseenter",function(b,d){var f,h,i,j,k,m,q,r=6,s=this,t=a(this),w="",x=d3.event.pageY,A=function(a,b){return a&&b?'<svg width="12" height="12"><rect style="fill: '+b+'" mask="url(#'+a+')" height="12" width="12" /></svg>':""},B=function(a){m=c.getTooltipSize(w),f=t[0].getBoundingClientRect().left-m.width/2+t.attr("width")/2,e?h=t[0].getBoundingClientRect().top-m.height-10:(h=x-c.tooltip.outerHeight()-25,v.length>1&&(f=s.parentNode.getBoundingClientRect().left-m.width/2+s.parentNode.getBoundingClientRect().width/2,a?(h+=c.tooltip.outerHeight()+50,h>s.parentNode.getBoundingClientRect().bottom+10&&(h=s.parentNode.getBoundingClientRect().bottom+10)):h=s.parentNode.getBoundingClientRect().top-c.tooltip.outerHeight()+25)),""!==w&&c.showTooltip(f,h,w,a?"bottom":"top")};if(e){if(z)w="<p><b>"+u(b[0].value)+"</b> "+b[0].name+"</p>";else{for(w='<div class="chart-swatch"><div class="swatch-caption"><b>'+g[0][d].name+"</b></div>",i=g.length-1,j=0;i>=j;i--)k=c.chartColor(i,"bar",v[i]),w+='<div class="swatch-row"><div style="background-color:'+(v[i].pattern?"transparent":k)+';">'+A(v[i].pattern,k)+"</div><span>"+g[i][d].parentName+"</span><b>"+u(g[i][d].value)+"</b></div>";w+="</div>"}m=c.getTooltipSize(w),f=t[0].getBoundingClientRect().left-m.width/2+t.attr("width")/2,h=t[0].getBoundingClientRect().top-m.height-10}else{if(y)w='<div class="chart-swatch"><div class="swatch-caption"><b>'+b.name+'</b></div><div class="swatch-row"><div style="background-color:'+(o.target?"transparent":Z(n.target))+';">'+A(o.target,Z(n.target))+"</div><span>"+p.target+"</span><b>"+u(b.target)+'</b></div><div class="swatch-row"><div style="background-color:'+(b.value<0?o.negative?"transparent":Z(n.negative):o.positive?"transparent":Z(n.positive))+';">'+(b.value<0?A(o.negative,Z(n.negative)):A(o.positive,Z(n.positive)))+"</div><span>"+p[b.value<0?"negative":"positive"]+"</span><b>"+u(b.value)+"</b></div></div>";else if(1===v.length)w="<p><b>"+u(b.value)+"</b> "+b.name+"</p>";else{var C=d3.select(this.parentNode).datum().values;for(w='<div class="chart-swatch">',i=0,j=C.length;j>i;i++)k=c.chartColor(i,"bar",l[i]),w+='<div class="swatch-row"><div style="background-color:'+(l[i].pattern?"transparent":k)+';">'+A(l[i].pattern,k)+"</div><span>"+C[i].name+"</span><b>"+u(C[i].value)+"</b></div>";w+="</div>",q=C.length>r}m=c.getTooltipSize(w),f=t[0].getBoundingClientRect().left-m.width/2+t.attr("width")/2,h=x-c.tooltip.outerHeight()-25,v.length>1&&(f=this.parentNode.getBoundingClientRect().left-m.width/2+this.parentNode.getBoundingClientRect().width/2,h=this.parentNode.getBoundingClientRect().top-c.tooltip.outerHeight()+25)}if(G&&"function"==typeof G&&!F[d]){w="";var D=!0;E=setInterval(function(){D&&(D=!1,G(function(a){w=F[d]=a})),""!==w&&(clearInterval(E),B())},10)}else{if(w=F[d]||G||w||"",b.tooltip){var H=b.tooltip.replace("{{value}}",u(b.value));w="<p>"+H+"</p>"}B(q)}}).on("mouseleave",function(){clearInterval(E),c.hideTooltip()}).on("click",function(d,e){var f,g=this&&d3.select(this).classed("target-bar");if(g)return f=R.select(".bar.series-"+e),void f.on("click").call(f.node(),f.datum(),e);var h=this&&d3.select(this).classed("is-selected"),i=parseInt(d3.select(this.parentNode).attr("data-group-id"),10);c.setSelectedElement({task:h?"unselected":"selected",container:b,selector:this,isTrigger:!h,triggerGroup:aa,d:d,i:e}),h&&a(b).triggerHandler("selected",[d3.select(this)[0],{},aa?i:e])}).on("contextmenu",function(a){w.triggerContextMenu(d3.select(this)[0][0],a)}),z&&d[0].name?c.addLegend([{name:d[0].name}]):y?c.addLegend(q):e&&z?c.addLegend(l):z||c.addLegend(e?m:l),c.appendTooltip(),c.labelsColide(R)&&c.applyAltLabels(R,U,"shortName"),c.labelsColide(R)&&c.applyAltLabels(R,U,"abbrName"),c.labelsColide(R)&&c.applyAltLabels(R,U,null,null,!0),function(){var b,c,f,g=0,h=R.node().parentNode.nextSibling,i=d3.select(h),j=i.node()&&i.classed("chart-legend"),k=function(a){a=a?d3.select(a):R,a.selectAll(".bar").each(function(a,d){a&&(z&&e?a[0].selected:a.selected)&&1>g&&(g++,c=d3.select(this),b=d)})},l=function(){var a=R.selectAll(".series-group");a[0].length&&a.each(function(){k(this)})};aa||e&&!z&&!aa?(d.forEach(function(a,d){a.selected&&1>g&&(g++,c=R.select('[data-group-id="'+d+'"]').select(".bar"),b=d,!e||z||aa||(f=!0))}),1>g&&l()):k(),g>0&&(f?j&&a(i.selectAll(".chart-legend-item")[0][b]).trigger("click.chart"):c.on("click").call(c.node(),c.datum(),b))}(),a(b).trigger("rendered"),a(b)},this.mergeArrays=function(){var a,b=arguments.length;if(b>1)for(a=1;b>a;a++)arguments[a].forEach(function(a){this.push(a)},arguments[0])},this.labelsColide=function(a){var b=a.selectAll(".x text"),c=!1;return b.each(function(a,d){var e,f=this.getBoundingClientRect();b.each(function(a,b){if(d!==b){e=this.getBoundingClientRect();var g=!(f.right<e.left||f.left>e.right||f.bottom<e.top||f.top>e.bottom);g&&(c=!0)}})}),c},this.applyAltLabels=function(a,b,c,d,e){var f=a.selectAll(d?d:".x text");f.each(function(a,d){var f=b[d][c];f=f||(e?d3.select(this).text().substring(0,1):d3.select(this).text().substring(0,6)+"..."),d3.select(this).text(f)})},this.Line=function(d,e,f,g){var h={formatterString:null},i=a.extend(!0,h,c.options),j=!!i.formatterString,k=function(a){return j?d3.format(i.formatterString)(a):a};a(b).addClass("line-chart"+(g?" bubble":""));var l,m,n=[],o=c.options.tooltip,p=d,q=e.hideDots,r=a(b).parent(),s=r.width()<450,t={top:30,right:s?35:55,bottom:35,left:s?45:65},u=r.width()-t.left-t.right,v=r.height()-t.top-t.bottom-30,w=d3.select(b).append("svg").attr("width",u+t.left+t.right).attr("height",v+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")"),x=p[0].data.map(function(a){return a.name}),y={};p[0]&&p[0].valueFormatterString&&a.extend(!0,y,p[0].valueFormatterString),m=function(b,c){return!a.isEmptyObject(y)&&b?d3.format(b)("0.0%"===b?c/100:c):c};var z={name:"Name",value:{x:"Value.x",y:"Value.y",z:"Value.z"}};p[0]&&p[0].labels&&a.extend(!0,z,p[0].labels);var A,B=d3.scale.linear().range([0,u]),C=d3.scale.linear().range([v,0]),D=d3.scale.linear().range([1,25]),E=function(a,b){return d3.max(a.data,function(a){return b?a.value[b]:a.value})};A=g?{x:p.map(function(a){return E(a,"x")}),y:p.map(function(a){return E(a,"y")}),z:p.map(function(a){return E(a,"z")})}:p.map(function(a){return E(a)});var F=d3.max(p.map(function(a){return a.data.length}))-1,G=B.domain([0,g?d3.max(A.x):F]).nice(),H=C.domain([0,d3.max(g?A.y:A)]).nice(),I=D.domain([0,d3.max(g?A.z:A)]).nice(),J=d3.svg.axis().scale(G).orient("bottom").tickSize(g?-(v+10):0).ticks(g&&s?Math.round(F/2):F).tickPadding(10).tickFormat(function(a,b){return g?a:x[b]}),K=d3.svg.axis().scale(H).tickSize(-(u+20)).tickPadding(20).orient("left");w.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").call(J),w.append("g").attr("class","y axis").call(K),w.selectAll(".tick line").attr("x1","-10"),g&&(w.selectAll(".x.axis .tick line, .y.axis .tick line").style("opacity",0),w.select(".x.axis .tick line").attr("x2","-10").style("opacity",1),w.select(".y.axis .tick line").style("opacity",1));var L=d3.svg.line().x(function(a,b){return G(g?a.value.x:b)}).y(function(a){return H(g?a.value.y:a.value)});p.forEach(function(a,b){var d=w.append("g").attr({"data-group-id":b,"class":"line-group"});if(f){var e=d3.svg.area().x(function(a,b){return G(b)}).y0(v).y1(function(a){return H(g?a.value.y:a.value)});d.append("path").datum(a.data).attr("fill",function(a){return c.chartColor(b,"line",a)}).style("opacity",".2").attr("class","area").attr("d",e)}var h=d.append("path").attr("d",L(a.data)).attr("stroke",function(a){return g?"":c.chartColor(b,"line",a)}).attr("stroke-width",2).attr("fill","none").attr("class","line").on("click.chart",function(a){c.selectElement(d3.select(this.parentNode),w.selectAll(".line-group"),a)}),i=h.node().getTotalLength();h.attr("stroke-dasharray",i+" "+i).attr("stroke-dashoffset",i).transition().duration(750).ease("cubic").attr("stroke-dashoffset",0),q||(d.selectAll("circle").data(a.data).enter().append("circle").attr("class","dot").attr("cx",function(a,b){return G(g?a.value.x:b)}).attr("cy",function(a){return H(g?0:a.value)}).attr("r",g?0:5).style("stroke","#ffffff").style("stroke-width",g?0:2).style("fill",function(a){return c.chartColor(b,"line",a)}).style("opacity",g?".7":"1").on("mouseenter.chart",function(d){var e=this.getBoundingClientRect(),f="<p><b>"+d.name+" </b> "+k(d.value)+"</p>",h=function(){var a=c.getTooltipSize(f),b=e.left-a.width/2+6,d=e.top-a.height-18;b=g?e.left+e.width/2-a.width/2:b,""!==f&&c.showTooltip(b,d,f,"top")};if(g){f='<div class="chart-swatch" style="min-width: 95px;"><div class="swatch-caption"><span style="background-color:'+c.chartColor(b,"line",a)+';" class="indicator-box"></span><b>'+a.name+"</b></div>";var i=d;for(var j in i)if(i.hasOwnProperty(j))if("object"!=typeof i[j])f+='<div class="swatch-row"><span>'+z[j]+"</span><b>"+i[j]+"</b></div>";else{var p=i[j];for(var q in p)p.hasOwnProperty(q)&&(f+='<div class="swatch-row"><span style="text-transform: capitalize;">'+z[j][q]+"</span><b>"+m(y[q],p[q])+"</b></div>")}f+="</div>"}if(o&&"function"==typeof o&&!n[b]){f="";var r=!0;l=setInterval(function(){r&&(r=!1,o(function(a){f=n[b]=a})),""!==f&&(clearInterval(l),h())},10)}else o="object"==typeof o?"":o,f=n[b]||o||d.tooltip||a.tooltip||f||"",h();d3.select(this).attr("r",function(a){return 2+(g?I(a.value.z):5)})}).on("mouseleave.chart",function(){clearInterval(l),c.hideTooltip(),d3.select(this).attr("r",function(a){return g?I(a.value.z):5})}).on("click.chart",function(a){c.selectElement(d3.select(this.parentNode),w.selectAll(".line-group"),a)}),g&&d.selectAll("circle").attr("cy",function(a){return H(a.value.y)}).transition().duration(750).ease("cubic").attr("r",function(a){return I(a.value.z)}))});var M=p.map(function(a){return{name:a.name,selectionObj:w.selectAll(".line-group"),selectionInverse:w.selectAll(".line-group"),data:a}});return c.addLegend(M),c.appendTooltip(),function(){var a,b,d=0,e=function(c,e,f){c.selected&&1>d&&(d++,a=d3.select(w.selectAll(".line-group")[0][f]),b=e)};p.forEach(function(a,b){a&&e(a,a,b)}),p.forEach(function(a,b){(a||a.data)&&a.data.forEach(function(c){e(c,a,b)})}),d>0&&c.selectElement(a,w.selectAll(".line-group"),b)}(),a(b).trigger("rendered"),a(b)},this.Bullet=function(d){function e(a){var b=a(0);return function(c){return Math.abs(a(c)-b)}}a(b).addClass("bullet-chart");for(var f,g=[],h=c.options.tooltip,i=d,j=!1,k=a(b).parent(),l={top:30,right:55,bottom:35,left:65},m=k.width()-l.left-l.right,n=k.height()-l.top-l.bottom-30,o=d3.select(b).append("svg").attr("width",m+l.left+l.right).attr("height",n+l.top+l.bottom).append("g").attr("transform","translate("+l.left+","+l.top+")"),p=0;p<i[0].data.length;p++){var q=600,r=25,s=i[0].data[p],t=s.ranges.slice().sort(d3.descending),u=s.markers?s.markers.slice().sort(d3.descending):[],v=s.measures?s.measures.slice().sort(d3.descending):[];0===u.length&&(u=v,j=!0);var w=o.append("g").attr("class","bullet").attr("transform","translate(0, "+3*p*r+")"),x=w.append("g"),y=x.append("text").attr("class","title").attr("dy","-6px").text(function(){return s.title});y.append("tspan").attr("class","subtitle").attr("dx","15px").text(function(){return s.subtitle});var z=d3.scale.linear().domain([0,Math.max(t[0],u[0],v[0])]).range([0,m]),A=e(z),B=w.selectAll("rect.range").data(t);B.enter().append("rect").attr("class",function(a,b){return"range s"+b}).attr("data-idx",p).attr("width",0).style("fill",function(a,b){return d[0].barColors?d[0].barColors[b]:void 0}).attr("height",r).on("click",function(){var c=d3.select(this);a(b).trigger("selected",[c,d[0].data[c.attr("data-idx")]])}).on("mouseenter",function(b,e){var i=d3.select(this),j=d[0].data[i.attr("data-idx")],k=this.getBoundingClientRect(),l="<p>"+b+"</p>",m=function(){var b=c.getTooltipSize(l),d=k.left+k.width-b.width/2,e=k.top-b.height+a(window).scrollTop()-5;""!==l&&c.showTooltip(d,e,l,"top")};if(j.tooltip&&j.tooltip[e]&&(l=j.tooltip[j.tooltip.length-e-1]),h&&"function"==typeof h&&!g[e]){l="";var n=!0;f=setInterval(function(){n&&(n=!1,h(function(a){l=g[e]=a})),""!==l&&(clearInterval(f),m())},10)}else h="object"==typeof h?"":h,l=g[e]||h||l||"",m()}).on("mouseleave",function(){clearInterval(f),c.hideTooltip()}),B.transition().duration(q).attr("width",A);var C=w.selectAll("rect.measure").data(v);C.enter().append("rect").attr("class",function(a,b){return"measure s"+b}).attr("width",0).attr("height",3).style("fill",function(a,b){return d[0].lineColors?d[0].lineColors[b]:void 0}).attr("y",11),C.transition().duration(q).attr("width",A);var D=w.selectAll("line.marker").data(u);D.enter().append("line").attr("class",j?"hidden":"marker").attr("x1",0).attr("x2",0).style("stroke",function(a,b){return d[0].markerColors?d[0].markerColors[b]:void 0}).attr("y1",r/6).attr("y2",5*r/6),D.transition().duration(q).attr("x1",z).attr("x2",z).attr("y1",r/6).attr("y2",5*r/6);var E=(u[0]>v[0]?"-":"+")+Math.abs(u[0]-v[0]);0!==Math.abs(u[0]-v[0])&&D.enter().append("text").attr("class","inverse").attr("text-anchor","middle").attr("y",r/2+4).attr("dx","-50px").attr("x",0).text(E),D.transition().duration(q).attr("x",m);var F=w.selectAll("g.tick").data(z.ticks(8)),G=F.enter().append("g").attr("class","tick").attr("transform","translate(0,0)").style("opacity",0);G.append("line").attr("y1",r).attr("y2",7*r/6),G.append("text").attr("text-anchor","middle").attr("dy","1.1em").attr("y",7*r/6).text(function(a){return a}),G.transition().duration(q).attr("transform",function(a){return"translate("+z(a)+",0)"}).style("opacity",1)}c.appendTooltip(),a(b).trigger("rendered")},this.selectElement=function(c,d,e){var f=c.node()&&c.classed("is-selected");d.classed("is-not-selected",!1).classed("is-selected",!1).classed("is-not-selected",!f),c.classed("is-not-selected",!1).classed("is-selected",!f),a(b).triggerHandler("selected",[c,f?{}:e])},this.setSelectedElement=function(b){var d=c.settings,e="column-positive-negative"===d.type,f="HorizontalBar"===d.chartType,g="Column"===d.chartType,h="Pie"===d.chartType,i=d.svg,j=d.isSingle,k=d.isGrouped,l=d.isStacked,m=d.isSingular,n="selected"===b.task,o=d3.select(b.selector),p=o.classed("positive"),q=i.selectAll(".axis.x .tick"),r=i.selectAll(".axis.y .tick"),s=i.selectAll(".bartext.positive, .target-bartext.positive"),t=i.selectAll(".bartext.negative, .target-bartext.negative"),u=d3.select(b.selector.parentNode),v=parseInt(u.node()?u.attr("data-group-id"):0,10),w=[o[0],b.d,k?v:b.i],x=[];if(q.style("font-weight","normal"),r.style("font-weight","normal"),s.style("font-weight","normal"),t.style("font-weight","normal"),i.selectAll(".is-selected").classed("is-selected",!1),n)if(i.selectAll(".bar, .target-bar").style("opacity",.6),d.isByLegends)e?(d.svg.selectAll(p?".bar.positive, .target-bar.positive":".bar.negative, .target-bar.negative").classed("is-selected",!0).style("opacity",1),(p?s:t).style("font-weight","bolder"),i.selectAll(".bar.is-selected").each(function(a,b){x.push([d3.select(this)[0],a,b])}),w.push(x)):(g||f)&&(k||m?d.svg.selectAll(".series-"+b.i).classed("is-selected",!0).style("opacity",1):u.classed("is-selected",!0).selectAll(".bar").classed("is-selected",!0).style("opacity",1),i.selectAll(".bar.is-selected").each(function(a,b){x.push([d3.select(this)[0],a,b])}),w.push(x));else if(m&&l&&g)o.classed("is-selected",!0).style("opacity",1);else if(!j&&!k||l||!g&&!f){if(g||f)i.selectAll((g?".axis.x":".axis.y")+" .tick:nth-child("+(b.i+1)+")").style("font-weight","bolder"),i.selectAll(".bar:nth-child("+(b.i+1)+")").classed("is-selected",!0).style("opacity",1),i.selectAll(".bar.is-selected").each(function(a,b){x.push([d3.select(this)[0],a,b])}),w.push(x);else if(h){var y=c.chartColor(b.i,"pie",b.d.data);o.classed("is-selected",!0).style({stroke:y,"stroke-width":0}).attr("transform","scale(1.025, 1.025)")}}else i.selectAll((g?".axis.x":".axis.y")+" .tick:nth-child("+((k?v:b.i)+1)+")").style("font-weight","bolder"),o.classed("is-selected",!0).style("opacity",1),i.select(".target-bar.series-"+b.i).style("opacity",1),d3.select(i.selectAll(".bartext")[0][b.i]).style("font-weight","bolder"),d3.select(i.selectAll(".target-bartext")[0][b.i]).style("font-weight","bolder"),(k||e)&&(e||u.classed("is-selected",!0).selectAll(".bar").classed("is-selected",!0).style("opacity",1),i.selectAll(".bar.is-selected").each(function(a,b){x.push([d3.select(this)[0],a,b])}),w.push(x,u[0]));else i.selectAll(".bar, .target-bar").style("opacity",1),s.style("font-weight","bolder"),t.style("font-weight","bolder"),h&&o.classed("is-selected",!1).style("stroke","#fff").style("stroke-width","1px").attr("transform","");d.isByLegends&&(d.isByLegends=!1),b.isTrigger&&a(b.container).triggerHandler(n?"selected":"unselected",w)},this.initChartType=function(a){this.options=a,this.redrawOnResize=!0,void 0!==a.redrawOnResize&&(this.redrawOnResize=a.redrawOnResize),a.format&&(this.format=a.format),a.tooltip&&(this.tooltip=a.tooltip),a.legendshow&&(this.legendshow=a.legendshow),a.legendformatter&&(this.legendformatter=a.legendformatter),"pie"===a.type&&this.Pie(a.dataset,!1,a),("bar"===a.type||"bar-stacked"===a.type)&&this.HorizontalBar(a.dataset),"bar-normalized"===a.type&&this.HorizontalBar(a.dataset,!0),"bar-grouped"===a.type&&this.HorizontalBar(a.dataset,!0,!1),"column-stacked"===a.type&&this.Column(a.dataset,!0),["column","column-grouped","column-positive-negative"].indexOf(a.type)>-1&&this.Column(a.dataset),"donut"===a.type&&this.Pie(a.dataset,!0,a),"sparkline"===a.type&&this.Sparkline(a.dataset,a),"sparkline-dots"===a.type&&this.Sparkline(a.dataset,{isDots:!0}),"sparkline-peak"===a.type&&this.Sparkline(a.dataset,{isPeakDot:!0}),"sparkline-dots-n-peak"===a.type&&this.Sparkline(a.dataset,{isDots:!0,isPeakDot:!0}),"sparkline-minmax"===a.type&&this.Sparkline(a.dataset,{isMinMax:!0}),"sparkline-medianrange"===a.type&&this.Sparkline(a.dataset,{isMedianRange:!0}),"sparkline-medianrange-n-peak"===a.type&&this.Sparkline(a.dataset,{isMedianRange:!0,isPeakDot:!0}),"line"===a.type&&this.Line(a.dataset,a),"area"===a.type&&this.Line(a.dataset,a,!0),"bubble"===a.type&&this.Line(a.dataset,a,!1,!0),"bullet"===a.type&&this.Bullet(a.dataset,a)}},a.fn.chart=function(b){return this.each(function(){var c,d=a.data(this,"chart");d&&(a(window).off("resize.line"),a(window).off("resize.pie"),a(window).off("resize.charts load.charts"),a(this).empty()),c=new Chart(this,b),d=a.data(this,"chart",c),d.settings=b,a.isEmptyObject(c)||setTimeout(function(){c.initChartType(b),c.handleResize()},d?0:300)})},a.fn.colorpicker=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="colorpicker",e={themes:{"grey-theme":{border:"matched-only",checkmark:{one:[1,2],two:[3,10]}},"dark-theme":{border:"matched-only",checkmark:{one:[1,2],two:[3,10]}},"high-contrast-theme":{border:"all",checkmark:{one:[1,3],two:[4,10]}}},colors:[{label:"Slate",number:"10",value:"1a1a1a"},{label:"Slate",number:"09",value:"292929"},{label:"Slate",number:"08",value:"383838",border:"dark-theme"},{label:"Slate",number:"07",value:"454545",border:"dark-theme"},{label:"Slate",number:"06",value:"5C5C5C"},{label:"Slate",number:"05",value:"737373"},{label:"Slate",number:"04",value:"999999"},{label:"Slate",number:"03",value:"BDBDBD"},{label:"Slate",number:"02",value:"D8D8D8"},{label:"Slate",number:"01",value:"F0F0F0",border:"grey-theme, high-contrast-theme"},{label:"Amber",number:"10",value:"D66221"},{label:"Amber",number:"09",value:"DE7223"},{label:"Amber",number:"08",value:"E68425"},{label:"Amber",number:"07",value:"EB9728"},{label:"Amber",number:"06",value:"EFAA30"},{label:"Amber",number:"05",value:"F2BC41"},{label:"Amber",number:"04",value:"F4C951"},{label:"Amber",number:"03",value:"F7D475"},{label:"Amber",number:"02",value:"F8E09C"},{label:"Amber",number:"01",value:"FBE9BF"},{label:"Ruby",number:"10",value:"880E0E"},{label:"Ruby",number:"09",value:"941E1E"},{label:"Ruby",number:"08",value:"A13030"},{label:"Ruby",number:"07",value:"AD4242"},{label:"Ruby",number:"06",value:"B94E4E"},{label:"Ruby",number:"05",value:"C65F5F"},{label:"Ruby",number:"04",value:"D26D6D"},{label:"Ruby",number:"03",value:"DE8181"},{label:"Ruby",number:"02",value:"EB9D9D"},{label:"Ruby",number:"01",value:"F4BCBC"},{label:"Turquoise",number:"10",value:"0E5B52"},{label:"Turquoise",number:"09",value:"206B62"},{label:"Turquoise",number:"08",value:"317C73"},{label:"Turquoise",number:"07",value:"448D83"},{label:"Turquoise",number:"06",value:"579E95"},{label:"Turquoise",number:"05",value:"69ADA3"},{label:"Turquoise",number:"04",value:"7BBFB5"},{label:"Turquoise",number:"03",value:"8ED1C6"},{label:"Turquoise",number:"02",value:"A9E1D6"},{label:"Turquoise",number:"01",value:"C0EDE3"},{label:"Emerald",number:"10",value:"397514"},{label:"Emerald",number:"09",value:"44831F"},{label:"Emerald",number:"08",value:"56932E"},{label:"Emerald",number:"07",value:"66A140"},{label:"Emerald",number:"06",value:"76B051"},{label:"Emerald",number:"05",value:"89BF65"},{label:"Emerald",number:"04",value:"9CCE7C"},{label:"Emerald",number:"03",value:"AFDC91"},{label:"Emerald",number:"02",value:"C3E8AC"},{label:"Emerald",number:"01",value:"D5F6C0"},{label:"Amethyst",number:"10",value:"4B2A5E"},{label:"Amethyst",number:"09",value:"5A3A6F"},{label:"Amethyst",number:"08",value:"6C4B81"},{label:"Amethyst",number:"07",value:"7D5F92"},{label:"Amethyst",number:"06",value:"8E72A4"},{label:"Amethyst",number:"05",value:"A189B8"},{label:"Amethyst",number:"04",value:"B59ECA"},{label:"Amethyst",number:"03",value:"C7B4DB"},{label:"Amethyst",number:"02",value:"DACCEC"},{label:"Amethyst",number:"01",value:"EDE3FC"},{label:"Azure",number:"10",value:"133C59"},{label:"Azure",number:"09",value:"134D71"},{label:"Azure",number:"08",value:"1D5F8A"},{label:"Azure",number:"07",value:"2876A8"},{label:"Azure",number:"06",value:"368AC0"},{label:"Azure",number:"05",value:"4EA0D1"},{label:"Azure",number:"04",value:"69B5DD"},{label:"Azure",number:"03",value:"8DC9E6"},{label:"Azure",number:"02",value:"ADD8EB"},{label:"Azure",number:"01",value:"CBEBF4"}]},f=a.extend({},e,b);return c.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.build(),this.handleEvents()},build:function(){var b=this.element,c=this.element.val();this.isInlineLabel?this.inlineLabel.addClass("colorpicker-container"):(this.container=a('<span class="colorpicker-container"></span>'),b.wrap(this.container)),this.container=b.parent(),this.swatch=a('<span class="swatch"></span>').prependTo(this.container),this.icon=a.createIconElement("dropdown").appendTo(this.container),this.icon.wrap('<span class="trigger"></span>'),b.attr("data-mask","*******").mask(),"#"!==c.substr(0,1)&&(c="#"+c,this.element.val(c)),7===c.length&&(this.setColor(c),this.element.val(c)),this.element.is(":disabled")&&this.disable(),this.addAria()},addAria:function(){this.element.attr("role","combobox").attr("aria-autocomplete","list"),a('label[for="'+this.element.attr("id")+'"]').append('<span class="audible">'+Locale.translate("UseArrow")+"</span>")},handleEvents:function(){var b=this;this.icon.parent().onTouchClick().on("click.colorpicker",function(){b.toggleList()}),this.element.on("focus.colorpicker",function(){a(this).parent().addClass("is-focused")}).on("blur.colorpicker",function(){a(this).parent().removeClass("is-focused")}),this.element.on("keypress.colorpicker",function(){var c=a(this),d=c.val();"#"!==d.substr(0,1)&&c.val("#"+d),7===d.length&&b.setColor(d)}),this.element.on("keydown.colorpicker",function(a){(38===a.keyCode||40===a.keyCode)&&b.toggleList()})},toggleList:function(){var b=this,c=!!a("#colorpicker-menu").length;c||b.element.is(":disabled")||(b.updateColorMenu(),b.element.popupmenu({trigger:"immediate",ariaListbox:!0,menuId:"colorpicker-menu"}).on("open.colorpicker",function(){b.element.parent().addClass("is-open")}).on("close.colorpicker",function(){a("#colorpicker-menu").parent(".popupmenu-wrapper").remove(),b.element.parent().removeClass("is-open")}).on("selected.colorpicker",function(a,c){b.element.val("#"+c.data("value")),b.swatch.css("background-color","#"+c.data("value")),b.element.focus()}),this.menu=a("#colorpicker-menu"),setTimeout(function(){b.menu.find(".is-selected").focus()},1))},setColor:function(a,b){this.swatch.css("background-color",a),this.element.attr("aria-describedby",b)},updateColorMenu:function(){var b=!!a("#colorpicker-menu").length,c=a('<ul id="colorpicker-menu" class="popupmenu colorpicker"></ul>'),d=a("#sohoxi-stylesheet").get(0).href.replace(/^.*[\\\/]/,"").replace(/\.[^\.]+$/,""),e=d.indexOf("?");""!==d&&e>-1&&(d=d.substr(0,e).replace(".css",""));for(var g="all"===f.themes[d].border,h=f.themes[d].checkmark,i="",j=0,k=f.colors.length;k>j;j++){var l=a("<li></li>"),m=a('<a href="#"><span class="swatch"></span></a>').appendTo(l),n=f.colors[j].number,o=parseInt(n,10),p=(Locale.translate(f.colors[j].label)||f.colors[j].label)+(f.colors[j].number||""),q=f.colors[j].value,r=!1,s=new RegExp("\\b"+d+"\\b");(g||s.test(f.colors[j].border))&&(r=!0),this.element.val().replace("#","")===q&&(h&&a.each(h,function(a,b){o>=b[0]&&o<=b[1]&&(i=" checkmark-"+a)}),m.addClass("is-selected"+i)),m.find(".swatch").css("background-color","#"+q).addClass(r?"is-border":"").end().data("label",p).data("value",q).attr("title",p+" #"+q).tooltip(),b||c.append(l)}b||a("body").append(c)},enable:function(){this.element.prop("disabled",!1),this.element.parent().removeClass("is-disabled")},disable:function(){this.element.prop("disabled",!0),this.element.parent().addClass("is-disabled")},isDisabled:function(){return this.element.prop("disabled")},rgb2hex:function(a){if(-1===a.search("rgb"))return a;if("rgba(0, 0, 0, 0)"===a)return"transparent";var b=function(a){return("0"+parseInt(a).toString(16)).slice(-2)};return a=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/),"#"+b(a[1])+b(a[2])+b(a[3])},destroy:function(){this.swatch.remove(),this.element.off("keypress.colorpicker"),this.swatch.off("click.colorpicker"),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.contextualactionpanel=function(b){function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="contextualactionpanel",e={id:"contextual-action-modal-"+(parseInt(a(".modal").length,10)+1),buttons:null,title:"Contextual Action Panel",content:null,trigger:"click"},f=a.extend({},e,b);return c.prototype={init:function(){this.setup().build().handleEvents()},setup:function(){return this.panel=this.element.next(".contextual-action-panel"),this.panel.css("display","none"),this},build:function(){var b=this;if(0===this.panel.length)if(this.settings.content instanceof jQuery){if(this.settings.content.is(".contextual-action-panel")?this.panel=this.settings.content:(this.settings.content.wrap('<div class="contextual-action-panel"></div>'),this.panel=this.settings.content.parent()),this.panel.addClass("modal").appendTo("body"),this.settings.content.is("iframe"))return this.settings.content.ready(function(){b.completeBuild(),b.settings.content.show()}),b;this.settings.content.show()}else this.panel=a('<div class="contextual-action-panel">'+this.settings.content+"</div>").appendTo("body"),this.panel.addClass("modal").attr("id",this.settings.id);return this.completeBuild(),this},completeBuild:function(){var b,c,d=this,e=!1;if(0===this.panel.find(".modal-content").length&&(b=this.panel.children(),b.is("iframe")&&(c=b.contents(),this.toolbar=c.find(".toolbar"),e=!0),e||(b.wrapAll('<div class="modal-content"></div>').wrapAll('<div class="modal-body"></div>'),this.panel.addClass("modal"))),0===this.panel.find(".modal-header").length){this.header=a('<div class="modal-header"></div>'),this.header.insertBefore(this.panel.find(".modal-body")),this.toolbar||(this.toolbar=this.panel.find(".toolbar")),this.toolbar.length||(this.toolbar=a('<div class="toolbar"></div>')),this.toolbar.appendTo(this.header);var f=this.toolbar.find(".title");f.length||(f=a('<div class="title">'+this.settings.title+"</div>"),this.toolbar.prepend(f));var g=this.toolbar.find(".buttonset");g.length||(g=a('<div class="buttonset"></div>'),g.insertAfter(f))}return e||this.panel.detach().appendTo("body"),this.element.attr("data-modal",this.settings.id),this.panel.attr("id")||this.panel.attr("id",this.settings.id),this.panel.modal({buttons:d.settings.buttons,trigger:d.settings.trigger?d.settings.trigger:"click"}),this.buttons=this.panel.find(".buttonset").children("button"),this.closeButton=this.buttons.filter('.btn-close, [name="close"], .icon-close'),this.toolbar||(this.toolbar=this.panel.find(".toolbar")),this.toolbar.length&&this.toolbar.toolbar(),this},handleEvents:function(){function b(a){c.element.triggerHandler(a.type)}var c=this;return this.panel.on("open.contextualactionpanel close.contextualactionpanel",function(a){b(a)}).on("beforeopen.contextualactionpanel",function(c){a(this).initialize(),b(c)}).on("afteropen.contextualactionpanel",function(){if(c.toolbar&&c.toolbar.trigger("recalculatebuttons"),c.toolbar.length){var a=c.toolbar.find(".buttonset > .is-selected");a.length||(a=c.toolbar.find(".buttonset > *:first-child"),a.is(".searchfield-wrapper")&&(a=a.children(".searchfield"))),c.toolbar.data("toolbar").setActiveButton(a,!0)}c.panel.find(".modal-body-wrapper").find(":focusable").first().focus()}).on("beforedestroy.contextualactionpanel",function(){c.teardown()}),this.toolbar&&this.toolbar.children(".buttonset").children('.btn-close, [name="close"], .icon-close').onTouchClick("contextualactionpanel").on("click.contextualactionpanel",function(){c.handleToolbarSelected()}),this},handleToolbarSelected:function(){this.close()},teardown:function(){var b=this,c=b.toolbar.children(".buttonset");this.panel.off("open.contextualactionpanel close.contextualactionpanel beforeopen.contextualactionpanel afterclose.contextualactionpanel"),c.children("*:not(.searchfield)").offTouchClick("contextualactionpanel").off("click.contextualactionpanel");var d=c.children(".btn-menu");d.each(function(){var b=a(this).data("popupmenu");b&&b.destroy()}),b.toolbar.data("toolbar").destroy(),b.header&&b.header.remove();var e=b.panel.find(".modal-body").children();e.first().unwrap().unwrap(),b.element.removeAttr("data-modal"),b.element.trigger("afterteardown")},close:function(){var a;"immediate"===this.settings.trigger&&(a=!0),this.panel.data("modal").close(a)},disable:function(){this.element.prop("disabled",!0),this.panel.hasClass("is-visible")&&this.close()},enable:function(){this.element.prop("disabled",!1)},destroy:function(){this.panel.data("modal").destroy(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),"immediate"===f.trigger&&(e=a.data(this,d,new c(this,f)))):e=a.data(this,d,new c(this,f))})},a.fn.datepicker=function(b){"use strict";function c(b){this.element=a(b),this.settings=f,this.init()}var d="datepicker",e={showTime:!1,timeFormat:void 0,minuteInterval:void 0,mode:void 0,roundToInterval:void 0,timepickerMarkup:'<label class="label"><input class="timepicker" name="calendar-timepicker" type="text"></label>',dateFormat:"locale",placeholder:!1,disable:{dates:[],minDate:"",maxDate:"",dayOfWeek:[],isEnable:!1}},f=a.extend({},e,b);return c.prototype={init:function(){this.build(),this.handleEvents()},build:function(){this.element.is(":disabled")&&this.element.closest(".field").addClass("is-disabled"),this.trigger=a.createIconElement("calendar").insertAfter(this.element),this.addAria()},addAria:function(){this.label=a('label[for="'+this.element.attr("id")+'"]'),this.label.append('<span class="audible">'+Locale.translate("PressDown")+"</span>")},handleEvents:function(){var a=this;this.trigger.on("click.datepicker",function(){a.isOpen()?a.closeCalendar():a.openCalendar()}),a.mask(),this.handleKeys(this.element)},handleKeys:function(b){
var c=this;b.off("keydown.datepicker").on("keydown.datepicker",function(b){var d=!1,e=b.keyCode||b.charCode||0,f=a(":focus"),g=f.attr("aria-label");if(g){var h=new Date(g);c.currentDate=new Date(h.getTime())}else if(f.hasClass("alternate")){var i=parseInt(c.header.find(".year").text()),j=parseInt(c.header.find(".month").attr("data-month")),k=parseInt(f.text());f.hasClass("prev-month")?0===j?(j=11,i--):j--:f.hasClass("next-month")&&(11===j?(j=0,i++):j++),c.currentDate=new Date(i,j,k)}if(40!==e||c.isOpen()||(d=!0,c.openCalendar(),setTimeout(function(){c.setFocusAfterOpen()},200)),40===e&&c.isOpen()&&(d=!0,c.currentDate.setDate(c.currentDate.getDate()+7),c.insertDate(c.currentDate)),38===e&&c.isOpen()&&(d=!0,c.currentDate.setDate(c.currentDate.getDate()-7),c.insertDate(c.currentDate)),37===e&&c.isOpen()&&(d=!0,c.currentDate.setDate(c.currentDate.getDate()-1),c.insertDate(c.currentDate)),39===e&&c.isOpen()&&(d=!0,c.currentDate.setDate(c.currentDate.getDate()+1),c.insertDate(c.currentDate)),33===e&&!b.altKey&&c.isOpen()&&(d=!0,c.currentDate.setMonth(c.currentDate.getMonth()+1),c.insertDate(c.currentDate)),34===e&&!b.altKey&&c.isOpen()&&(d=!0,c.currentDate.setMonth(c.currentDate.getMonth()-1),c.insertDate(c.currentDate)),33===e&&b.altKey&&c.isOpen()&&(d=!0,c.currentDate.setFullYear(c.currentDate.getFullYear()+1),c.insertDate(c.currentDate)),34===e&&b.altKey&&c.isOpen()&&(d=!0,c.currentDate.setFullYear(c.currentDate.getFullYear()-1),c.insertDate(c.currentDate)),35===e&&c.isOpen()){d=!0;var l=new Date(c.currentDate.getFullYear(),c.currentDate.getMonth()+1,0);c.currentDate=l,c.insertDate(c.currentDate)}if(36===e&&c.isOpen()){var m=new Date(c.currentDate.getFullYear(),c.currentDate.getMonth(),1);c.currentDate=m,c.insertDate(c.currentDate)}return 84===e&&(d=!0,c.currentDate=new Date,c.isOpen()?c.insertDate(c.currentDate,!0):c.element.val(Locale.formatDate(c.currentDate,{pattern:c.pattern})).trigger("change")),(32===e&&c.isOpen()||13===e&&c.isOpen())&&(c.closeCalendar(),c.element.focus(),d=!0),9===e&&c.isOpen()&&(c.settings.showTime||(c.element.focus(),c.closeCalendar())),27===e&&c.isOpen()&&(c.closeCalendar(),c.element.focus()),d?(b.stopPropagation(),b.preventDefault(),!1):void 0})},setFormat:function(){var a="object"==typeof Locale&&Locale.calendar().dateFormat?Locale.calendar().dateFormat:null,b="object"==typeof Locale&&Locale.calendar().timeFormat?Locale.calendar().timeFormat:null;this.pattern="locale"===this.settings.dateFormat?a["short"]+(this.settings.showTime?" "+b:""):this.settings.dateFormat+(this.settings.showTime?" "+this.settings.timeFormat:""),this.show24Hours=(this.pattern.match("HH")||[]).length>0},mask:function(){this.setFormat();var b="date availableDate",c={date:"blur",availableDate:"blur"},d=this.element.attr("data-validate"),e=this.element.attr("data-validation-events"),f=this.pattern.toLowerCase().replace(/yyyy/g,"####").replace(/mmm/g,"***").replace(/mm/g,"##").replace(/dd/g,"##").replace(/hh/g,"##").replace(/[mdh]/g,"##").replace(/[a]/g,"am");f=this.settings.showTime&&this.show24Hours?f.substr(0,16):f,"required"!==d||e?d&&e&&(d.indexOf("no-default-validation")>-1?(b=d.replace(/no-default-validation/g,""),c=a.fn.parseOptions(this.element,"data-validation-events")):(b=d+" "+b,a.extend(c,a.fn.parseOptions(this.element,"data-validation-events")))):(b=d+" "+b,a.extend(c,{required:"change blur"})),this.element.attr({"data-mask":f,"data-validate":b,"data-validation-events":JSON.stringify(c),"data-mask-mode":"date"}).mask().validate(),!this.settings.placeholder||this.element.attr("placeholder")&&"M / D / YYYY"!==this.element.attr("placeholder")||this.element.attr("placeholder",this.pattern)},isOpen:function(){return this.popup&&this.popup.is(":visible")&&!this.popup.hasClass("is-hidden")},open:function(){return this.openCalendar()},openCalendar:function(){var b=this;if(!this.element.is(":disabled")&&!this.element.attr("readonly")){if(a("#validation-tooltip").addClass("is-hidden"),this.popup&&this.popup.is(":visible")&&b.closeCalendar(),this.element.addClass("is-active"),this.element.trigger("listopened"),this.table=a('<table class="calendar-table" aria-label="'+Locale.translate("Calendar")+'" role="application"></table>'),this.header=a('<div class="calendar-header"><span class="month">november</span><span class="year"> 2015</span><button type="button" class="btn-icon prev" tabindex="-1">'+a.createIcon("caret-left")+"<span>"+Locale.translate("PreviousMonth")+'</span></button><button type="button" class="btn-icon next" tabindex="-1">'+a.createIcon("caret-right")+"<span>"+Locale.translate("NextMonth")+"</span></button></div>"),this.dayNames=a("<thead><tr><th>SU</th> <th>MO</th> <th>TU</th> <th>WE</th> <th>TH</th> <th>FR</th> <th>SA</th> </tr> </thead>").appendTo(this.table),this.days=a('<tbody> <tr> <td class="alternate">26</td> <td class="alternate">27</td> <td class="alternate">28</td> <td class="alternate">29</td> <td class="alternate" >30</td> <td class="alternate">31</td> <td>1</td> </tr> <tr> <td>2</td> <td>3</td> <td>4</td> <td>5</td> <td>6</td> <td>7</td> <td>8</td> </tr> <tr> <td>9</td> <td>10</td> <td>11</td> <td>12</td> <td>13</td> <td>14</td> <td>15</td> </tr> <tr> <td>16</td> <td>17</td> <td>18</td> <td>19</td> <td class="is-today">20</td> <td>21</td> <td>22</td> </tr> <tr> <td>23</td> <td>24</td> <td>25</td> <td>26</td> <td>27</td> <td>28</td> <td class="alternate">1</td> </tr> <tr> <td class="alternate">2</td> <td class="alternate">3</td> <td class="alternate">4</td> <td class="alternate">5</td> <td class="alternate">6</td> <td class="alternate">7</td> <td class="alternate">8</td> </tr> </tbody>').appendTo(this.table),this.timepickerInput=a(this.settings.timepickerMarkup),this.footer=a('<div class="popup-footer"> <button type="button" class="cancel btn-tertiary" tabindex="-1">'+Locale.translate("Clear")+'</button> <button type="button" tabindex="-1" class="is-today btn-tertiary">'+Locale.translate("Today")+"</button> </div>"),this.settings.showTime){var c={};void 0!==this.settings.timeFormat&&(c.timeFormat=this.settings.timeFormat),void 0!==this.settings.minuteInterval&&(c.minuteInterval=this.settings.minuteInterval),void 0!==this.settings.mode&&(c.mode=this.settings.mode),void 0!==this.settings.roundToInterval&&(c.roundToInterval=this.settings.roundToInterval),a(".timepicker",this.timepickerInput).attr("data-options",JSON.stringify(c))}this.calendar=a('<div class="calendar'+(this.settings.showTime?" is-timepicker":"")+'"></div').append(this.header,this.table,this.settings.showTime?this.timepickerInput:"",this.footer);var d=Locale.isRTL()?-163:160;this.element.closest(".datagrid-filter-wrapper").length&&(d=Locale.isRTL()?-179:176),this.trigger.popover({content:this.calendar,popover:!0,trigger:"immediate",placement:"offset",offset:{top:23,left:d},tooltipElement:"#calendar-popup"}).on("hide.datepicker",function(){b.closeCalendar()}).on("open.datepicker",function(){b.days.find(".is-selected").attr("tabindex",0).focus()}),setTimeout(function(){Locale.isRTL()&&Locale.flipIconsHorizontally()},0),this.handleKeys(a("#calendar-popup")),a(".calendar-footer a",this.calendar).button();var e=Locale.parseDate(this.element.val(),this.pattern);this.currentDate=e||new Date,this.currentMonth=this.currentDate.getMonth(),this.currentYear=this.currentDate.getFullYear(),this.currentDay=this.currentDate.getDate(),this.settings.showTime&&setTimeout(function(){var c=a(".timepicker",this.calendar);b.timepickerControl=c.data("timepicker"),b.time=b.getTimeString(e,b.show24Hours),b.timepickerInput.css({margin:"10px 0 25px"}).find(".timepicker").val(b.time),b.timepickerControl.toggleTimePopup(),setTimeout(function(){var d=a("#timepicker-popup").css({border:0,"box-shadow":"none",width:""}),e=c.offset();if(e.top-=d.parent().is("body")?0:d.height()/2-2,e.left-=(d.width()-c.width())/2-30,d.css(e),b.timepickerInput.css({visibility:"hidden"}),a(".arrow, .modal-buttonset",d).hide(),a(".time-parts",d).css({padding:0}),b.isOpen()){var f=d.find("input.dropdown");f.on("keydown.datepicker",function(a){var c=a.keyCode||a.charCode||0;return 27===c||9===c&&this===f.last().get(0)?(b.calendar.find(".is-selected").focus(),!1):32===c?!1:void 0}),b.changeEventOrder(f,"keydown.timepicker",0),b.timepickerControl.element.on("change.datepicker",function(){var c,e;b.timepickerControl.settings.roundToInterval=b.settings.roundToInterval,b.timepickerControl.roundMinutes(),c=b.timepickerControl.getTimeFromField(),e={"#timepicker-hours":c.hours,"#timepicker-period":c.period},b.getBoolean(b.settings.roundToInterval)&&(e["#timepicker-minutes"]=c.minutes),a.each(e,function(b,c){a(b,d).val(c).triggerHandler("updated")})}),b.timepickerControl.element.trigger("change.datepicker")}},1)},1),setTimeout(function(){var c,d,e,f=b.getClosestParent(b.element.closest(".field"),"fixed"),g=b.getClosestParent(b.element.closest(".field"),"absolute"),h=b.trigger[0].getBoundingClientRect(),i=b.getAbsoluteOffset(b.popup[0],a("body")[0]),j={top:parseInt(b.popup.css("top"),10),left:parseInt(b.popup.css("left"),10)},k=b.popup.find(".arrow"),l=k[0].getBoundingClientRect(),m=50+l.height,n=a(".page-container.scrollable").scrollTop();(g[0]&&!g.is(".page-container")||f[0]||j.top<0||j.left<0)&&(k.show(),j.top<0||j.left<0?(j.top<0&&(c=5,b.popup.css({top:c+"px"})),j.left<0&&(d=h.left-b.popup.outerWidth()-20,b.popup.css({left:d+"px"}))):((i.top<0||i.top+b.popup.outerHeight()>window.innerHeight)&&(c=i.top-b.popup.outerHeight()+n-2*m,(j.top<0||i.top>0)&&c>0?e="show":(c=(window.innerHeight-b.popup.outerHeight())/2,e="hide"),g[0]&&b.popup.is(".bottom")&&b.popup.removeClass("bottom").addClass("top"),b.popup.css({top:c+"px"}),k[e]()),(i.left<0||i.left+b.popup.outerWidth()>window.innerWidth)&&(j.left<0||i.left>0&&i.left-b.popup.outerWidth()>m?(d=i.left+b.popup.outerWidth()+m,e="show"):(d=(window.innerWidth-b.popup.outerWidth())/2,e="hide"),g[0]&&b.popup.is(".left, .right")&&(b.popup.is(".left")?b.popup.removeClass("left").addClass("right"):b.popup.removeClass("right").addClass("left")),b.popup.css({left:d+"px"}),k[e]())))},1),this.todayDate=new Date,this.todayMonth=this.todayDate.getMonth(),this.todayYear=this.todayDate.getFullYear(),this.todayDay=this.todayDate.getDate(),this.showMonth(this.currentMonth,this.currentYear),this.popup=a("#calendar-popup"),this.popup.attr("role","dialog"),this.originalDate=this.element.val(),this.days.off("click.datepicker").on("click.datepicker","td",function(){var c=a(this);if(c.hasClass("is-disabled"))c.attr("tabindex",0).focus();else{b.days.find(".is-selected").removeClass("is-selected").removeAttr("aria-selected");var d=a(this),e=parseInt(b.header.find(".year").text()),f=parseInt(b.header.find(".month").attr("data-month")),g=parseInt(d.addClass("is-selected").attr("aria-selected","true").text());d.hasClass("prev-month")?0===f?(f=11,e--):f--:d.hasClass("next-month")&&(11===f?(f=0,e++):f++),b.currentDate=new Date(e,f,g),b.insertDate(b.currentDate),b.closeCalendar(),b.element.focus()}}),this.footer.off("click.datepicker").on("click.datepicker","button",function(c){var d=a(this);d.hasClass("cancel")&&(b.element.val(""),b.currentDate=null,b.closeCalendar()),d.hasClass("is-today")&&(b.insertDate(new Date,!0),b.closeCalendar()),b.element.focus(),c.preventDefault()}),this.header.off("click.datepicker").on("click.datepicker","button",function(){b.showMonth(b.currentMonth+(a(this).hasClass("next")?1:-1),b.currentYear)}),setTimeout(function(){b.setFocusAfterOpen()},200)}},close:function(){return this.closeCalendar()},closeCalendar:function(){this.settings.showTime&&this.timepickerControl&&this.timepickerControl.isOpen()&&this.timepickerControl.closeTimePopup(),this.popup&&this.popup.length&&this.popup.hide().remove(),this.element.removeClass("is-active"),this.element.trigger("listclosed")},getClosestParent:function(b,c){var d=b.parents().filter(function(){return a(this).css("position")===c}).slice(0,1);return d},getAbsoluteOffset:function(a,b){for(var c=0,d=0;a&&a!==b&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,d+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{top:d,left:c}},checkDates:function(a,b,c){var d,e,f,g=this,h=new Date(a,b,c),i=new Date(this.settings.disable.minDate).setHours(0,0,0,0),j=new Date(this.settings.disable.maxDate).setHours(0,0,0,0);if(-1!==this.settings.disable.dayOfWeek.indexOf(h.getDay()))return!0;if(h=h.setHours(0,0,0,0),i>=h||h>=j)return!0;for(this.settings.disable.dates.length&&"string"==typeof this.settings.disable.dates&&(this.settings.disable.dates=[this.settings.disable.dates]),e=0,f=this.settings.disable.dates.length;f>e;e++)if(d=new Date(g.settings.disable.dates[e]),h===d.setHours(0,0,0,0))return!0;return!1},setDisable:function(a,b,c,d){var e=this.checkDates(b,c,d);a.removeClass("is-disabled").removeAttr("aria-disabled"),(e&&!this.settings.disable.isEnable||!e&&this.settings.disable.isEnable)&&a.addClass("is-disabled").attr("aria-disabled","true").removeClass("is-selected").removeAttr("aria-selected")},setFocusAfterOpen:function(){this.calendar&&this.calendar.find(".is-selected").attr("tabindex",0).focus()},showMonth:function(b,c){var d=this,e=this.currentDate.getDate()?this.currentDate:(new Date).setHours(0,0,0,0);c.toString().length<4&&(c=(new Date).getFullYear()),12===b&&(c++,this.currentMonth=b=0,this.currentYear=c,this.header.find(".year").text(" "+c)),0>b&&(c--,this.currentMonth=b=11,this.currentYear=c,this.header.find(".year").text(" "+c));var f=Locale.calendar().days.narrow||Locale.calendar().days.narrow||Locale.calendar().days.abbreviated,g=Locale.calendar().months.wide[b];this.currentMonth=b,this.currentYear=c,this.dayNames.find("th").each(function(b){a(this).text(f[b])}),this.header.find(".month").attr("data-month",b).text(g),this.header.find(".year").text(" "+c);var h,i,j,k=new Date(c,b,1).getDay(),l=new Date(c,b+0,0).getDate(),m=new Date(c,b+1,0).getDate(),n=1,o=1;this.days.find("td").each(function(f){var g=a(this).removeClass("alternate prev-month next-month is-selected is-today");if(g.removeAttr("aria-selected"),k>f&&(j=l-k+1+f,i=0===b?11:b-1,h=0===b?c-1:c,d.setDisable(g,h,i,j),g.addClass("alternate prev-month").html('<span aria-hidden="true">'+j+"</span>")),f>=k&&m>=n){g.html('<span aria-hidden="true">'+n+"</span>");var p=e.getHours(),q=e.getMinutes();return new Date(c,b,n).setHours(p,q,0,0)===e.setHours(p,q,0,0)&&g.addClass("is-selected").attr("aria-selected","true"),n===d.todayDay&&d.currentMonth===d.todayMonth&&d.currentYear===d.todayYear&&g.addClass("is-today"),g.attr("aria-label",Locale.formatDate(new Date(d.currentYear,d.currentMonth,n),{date:"full"})),d.setDisable(g,c,b,n),g.attr("role","link"),void n++}n>=m+1&&(j=o,i=11===b?0:b+1,h=11===b?c+1:c,d.setDisable(g,h,i,j),g.addClass("alternate next-month").html('<span aria-hidden="true">'+o+"</span>"),o++)});var p=this.days.find("tr").eq(5);7===p.find("td.alternate").length?p.hide():p.show()},insertDate:function(b,c){var d=this.element;if((this.currentMonth!==b.getMonth()||this.currentYear!==b.getFullYear())&&this.showMonth(b.getMonth(),b.getFullYear()),this.isOpen()){var e=this.days.find("td:not(.alternate)").filter(function(){return a(this).text().toLowerCase()===b.getDate().toString()});e.hasClass("is-disabled")?e.attr({tabindex:0}).focus():(this.settings.showTime&&(c?(this.time=this.getTimeString(b,this.show24Hours),this.timepickerInput.find(".timepicker").val(this.time).trigger("change"),this.settings.roundToInterval&&(a("#timepicker-minutes").val(""),b=this.setTime(b))):b=this.setTime(b)),d.val(Locale.formatDate(b,{pattern:this.pattern})).trigger("change"),this.days.find(".is-selected").removeClass("is-selected").removeAttr("aria-selected").removeAttr("tabindex"),e.addClass("is-selected").attr({"aria-selected":!0,tabindex:0}).focus())}},getBoolean:function(a){var b=+a;return isNaN(b)?!!String(a).toLowerCase().replace(!1,""):!!b},setValue:function(a){this.currentDate=a,this.element.val(Locale.formatDate(a,{pattern:this.pattern}))},setTime:function(b){var c=a("#timepicker-hours").val(),d=a("#timepicker-minutes").val(),e=a("#timepicker-period"),f=a(".timepicker.is-active");if(!d&&f.length){var g=new Date(b),h=f.val().match(/(\d+)(?::(\d\d))?\s*(p?)/);g.setHours(parseInt(h[1])+(h[3]?12:0)),g.setMinutes(parseInt(h[2])||0),d=g.getMinutes()}return c=e.length&&"PM"===e.val()&&12>c?parseInt(c,10)+12:c,c=e.length&&"AM"===e.val()&&12===parseInt(c,10)?0:c,b.setHours(c,d,0),b},getTimeString:function(a,b){var c=function(a){return(10>a?"0":"")+a},d=a||new Date,e=d.getHours(),f=(e%12||12)+":"+c(d.getMinutes())+" "+(12>e?"AM":"PM"),g=e+":"+c(d.getMinutes());return b?g:f},changeEventOrder:function(b,c,d){a.each(c.split(" "),function(c,e){b.each(function(){var b=a._data(this,"events")[e.split(".")[0]];d=Math.min(d,b.length-1),b.splice(d,0,b.pop())})})}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},window.Formatters={Text:function(a,b,c){var d=null===c||void 0===c||""===c?"":c.toString();return d},Ellipsis:function(a,b,c,d){var e=null===c||void 0===c||""===c?"":c.toString();return d.textOverflow="ellipsis",e},Password:function(a,b,c){var d=null===c||void 0===c||""===c?"":c.toString();return d.replace(/./g,"*")},Readonly:function(a,b,c){return'<span class="is-readonly">'+(null===c||void 0===c?"":c)+"</span>"},Date:function(b,c,d,e){var f=null===d||void 0===d?"":d;if(!d)return"";if("string"==typeof d){var g=Locale.parseDate(d,"string"==typeof e.dateFormat?{pattern:e.dateFormat}:e.dateFormat);f=g?Locale.formatDate(g,"string"==typeof e.dateFormat?{pattern:e.dateFormat}:e.dateFormat):Locale.formatDate(d,"string"==typeof e.dateFormat?{pattern:e.dateFormat}:e.dateFormat)}else f=Locale.formatDate(d,"string"==typeof e.dateFormat?{pattern:e.dateFormat}:e.dateFormat);return e.editor?'<span class="trigger">'+f+"</span>"+a.createIcon({icon:"calendar",classes:["icon-calendar"]}):f},Autocomplete:function(a,b,c){var d=null===c||void 0===c?"":c;return d},Lookup:function(b,c,d,e,f){var g=null===d||void 0===d?"":d;return e.editor?(e.editorOptions&&"function"==typeof e.editorOptions.field&&(g=e.editorOptions.field(f,null,null)),'<span class="trigger">'+g+"</span>"+a.createIcon({icon:"search-list",classes:["icon-search-list"]})):g},Decimal:function(a,b,c,d){var e;return e=c,void 0!==typeof Locale&&(e=Locale.formatNumber(c,d.numberFormat?d.numberFormat:null)),e=null===e||void 0===e?"":e},Integer:function(a,b,c,d){var e;return e=c,void 0!==typeof Locale&&(e=Locale.formatNumber(c,d.numberFormat?d.numberFormat:{style:"integer"})),e=null===e||void 0===e?"":e},Hyperlink:function(a,b,c,d,e){var f=d.href?d.href:"#";if(d.href&&"function"==typeof d.href){if(f=d.href(a,b,e,d),null==f)return d.text?d.text:c}else f=f.replace("{{value}}",c);var g=d.text?d.text:c;return g?'<a href="'+f+'" tabindex="-1" role="presentation" class="hyperlink">'+g+"</a>":""},Template:function(a,b,c,d,e){var f=d.template,g="";if(G&&e&&f){var h=G.compile("{{#dataset}}"+f+"{{/dataset}}");g=h.render({dataset:e})}return g},Drilldown:function(){var b=Locale.translate("Drilldown");return void 0===b&&(b=""),'<button type="button" class="btn-icon small datagrid-drilldown">'+a.createIcon({icon:"drilldown"})+"<span>"+b+"</span></button>"},Checkbox:function(a,b,c,d){var e;return e=d.isChecked?d.isChecked(c):void 0==c?!1:1==c,'<div class="datagrid-checkbox-wrapper"><span role="checkbox" aria-label="'+d.name+'" class="datagrid-checkbox '+(e?"is-checked":"")+'" aria-checked="'+e+'"></span></div>'},SelectionCheckbox:function(a,b,c,d){var e=void 0==c?!1:1==c;return'<div class="datagrid-checkbox-wrapper"><span role="checkbox" aria-label="'+d.name+'" class="datagrid-checkbox datagrid-selection-checkbox'+(e?"is-checked":"")+'" aria-checked="'+e+'"></span></div>'},Actions:function(b,c,d,e){return'<button type="button" class="btn-actions" aria-haspopup="true" aria-expanded="false" aria-owns="'+e.menuId+'"><span class="audible">'+e.title+"</span>"+a.createIcon({icon:"more"})+"</button>"},Textarea:function(a,b,c){var d=null===c||void 0===c?"":c;return'<span class="datagrid-textarea">'+d+"</span>"},Expander:function(a,b,c){var d='<button type="button" class="btn-icon datagrid-expand-btn" tabindex="-1"><span class="icon plus-minus"></span><span class="audible">'+Locale.translate("ExpandCollapse")+"</span></button>"+(c?"<span> "+c+"</span>":"");return d},Tree:function(a,b,c,d,e){var f=e.expanded,g='<button type="button" class="btn-icon datagrid-expand-btn'+(f?" is-expanded":"")+'" tabindex="-1"'+(e.depth?' style="margin-left: '+(e.depth?30*(e.depth-1)+"px":"")+'"':"")+'><span class="icon plus-minus'+(f?" active":"")+'"></span><span class="audible">'+Locale.translate("ExpandCollapse")+"</span></button>"+(c?"<span> "+c+"</span>":""),h='<span class="datagrid-tree-node"'+(e.depth?' style="margin-left: '+(e.depth?30*(e.depth-1)+"px":"")+'"':"")+"> "+c+"</span>";return e[d.children?d.children:"children"]?g:h},ClassRange:function(a,b,c,d){var e=d.ranges,f="",g="";if(!e)return{};for(var h=0;h<e.length;h++)c>=e[h].min&&c<=e[h].max&&(f=e[h].classes,g=e[h].text?e[h].text:f.split(" ")[0]),c===e[h].value&&(f=e[h].classes,g=e[h].text?e[h].text:c);return{classes:f,text:g}},Badge:function(a,b,c,d){var e=Formatters.ClassRange(a,b,c,d);return'<span class="badge '+e.classes+'">'+c+' <span class="audible">'+e.text+"</span></span>"},Tag:function(a,b,c,d){var e=Formatters.ClassRange(a,b,c,d);return'<span class="tag '+e.classes+'">'+c+"</span>"},Alert:function(b,c,d,e){var f=Formatters.ClassRange(b,c,d,e),g=a.createIcon({icon:f.classes,classes:["icon","datagrid-alert-icon","icon-"+f.classes]});return g+'<span class="datagrid-alert-text">'+("value"===f.text?d:f.text)+"</span>"},Image:function(a,b,c,d){return'<img class="datagrid-img" src="'+c+'" alt= "'+(d.alt?d.alt:Locale.translate("Image"))+'"'+(d.dimensions?' style="height:'+d.dimensions.height+";width:"+d.dimensions.height+'"':"")+"/>"},Color:function(a,b,c,d){var e=Formatters.ClassRange(a,b,c,d),f=null===c||void 0===c||""===c?"":c.toString();return'<span class="'+e.classes+'">'+f+"</span>"},Button:function(b,c,d,e){var f=e.text?e.text:null===d||void 0===d||""===d?"":d.toString(),g='<button type="button" class="'+(e.icon?"btn-icon":"btn")+"  row-btn "+(e.cssClass?e.cssClass:"")+'">';return e.icon&&(g+=a.createIcon({icon:e.icon,file:e.iconFile})),g+="<span>"+f+"</span></button>"},Dropdown:function(b,c,d,e){var f,g,h,i,j=d;if(e.options&&void 0!==d)for(f=e.caseInsensitive&&"string"==typeof d?d.toLowerCase():d,g=0;g<e.options.length;g++)if(h=e.options[g],i=e.caseInsensitive&&"string"==typeof h.value?h.value.toLowerCase():h.value,i===f){j=h.label;break}return'<span class="trigger">'+j+"</span>"+a.createIcon({icon:"dropdown"})},Favorite:function(b,c,d,e){var f;return f=e.isChecked?e.isChecked(d):void 0==d?!1:1==d,f?'<span class="audible">'+Locale.translate("Favorite")+'</span><span class="icon-favorite">'+a.createIcon({icon:"star-filled"})+"</span>":""},Status:function(b,c,d,e,f){return f.rowStatus?a.createIcon({icon:f.rowStatus.icon,classes:["icon","icon-"+f.rowStatus.icon,"datagrid-alert-icon"]})+'<span class="audible">'+f.rowStatus.text+"</span>":"<span>&nbsp;</span>"}},window.Editors={Input:function(b,c,d,e,f,g,h,i){this.name="input",this.originalValue=d,this.init=function(){if(this.input=a('<input type="'+(f.inputType?f.inputType:"text")+'"/>').appendTo(e),f.align&&this.input.addClass("l-"+f.align+"-text"),f.maxLength&&this.input.attr("maxlength",f.maxLength),f.mask&&"function"==typeof f.mask){var g=f.mask(b,c,d,f,i);this.input.mask({pattern:g,mode:f.maskMode})}else f.mask&&this.input.mask({pattern:f.mask,mode:f.maskMode})},this.val=function(a){return a&&this.input.val(a),this.input.val()},this.focus=function(){this.input.focus().select()},this.destroy=function(){var a=this;setTimeout(function(){a.input.remove()},0)},this.init()},Textarea:function(b,c,d,e,f){this.name="textarea",this.originalValue=d,this.init=function(){this.input=a('<textarea class="textarea"></textarea>').appendTo(e),f.maxLength&&this.input.attr("maxlength",f.maxLength)},this.val=function(a){return a&&this.input.focus().val(a),this.input.val()},this.focus=function(){this.input.focus()},this.destroy=function(){var a=this;setTimeout(function(){a.input.remove()},0)},this.init()},Checkbox:function(b,c,d,e,f,g,h){this.name="checkbox",this.originalValue=d,this.init=function(){this.input=a('<input type="checkbox" class="checkboxn"/>').appendTo(e),this.input.after('<label class="checkbox-label">&nbsp;</label>'),f.align&&this.input.addClass("l-"+f.align+"-text")},this.val=function(a){var b;return void 0===a?this.input.prop("checked"):(b=f.isChecked?f.isChecked(a):a,("click"===g.type||"keydown"===g.type&&32===g.keyCode)&&(b=!b,h.setNextActiveCell(g)),void this.input.prop("checked",b))},this.focus=function(){this.input.trigger("focusout")},this.destroy=function(){var a=this;setTimeout(function(){a.input.next(".checkbox-label").remove(),a.input.remove()},0)},this.init()},Dropdown:function(b,c,d,e,f,g,h){this.name="dropdown",this.originalValue=d,this.useValue=!0,this.cell=h.activeCell,this.init=function(){if(this.input=a('<select class="dropdown"></select>').appendTo(e),this.select=this.input,f.options)for(var b,c,g,h=f.caseInsensitive&&"string"==typeof d?d.toLowerCase():d,i=0;i<f.options.length;i++)b=a("<option></<option>"),c=f.options[i],g=f.caseInsensitive&&"string"==typeof c.value?c.value.toLowerCase():c.value,(c.selected||h===g)&&b.attr("selected","true"),b.attr("value",c.value).attr("id",c.id).attr("data-type",typeof c.value),b.text(c.label),this.input.append(b);var j=f.editorOptions;(!j||j&&!j.cssClass)&&(j=a.extend(f.editorOptions,{cssClass:"is-editing"})),this.input.dropdown(j),this.input=this.input.parent().find("div.dropdown")},this.val=function(b){var c=this;if(void 0!==b){var d=f.caseInsensitive&&"string"==typeof b?b.toLowerCase():b;this.input.val(b),this.select.find("option").each(function(){var b=a(this),e=b.attr("value"),g=b.attr("data-type"),h=e;"number"===g?h=parseFloat(e):"boolean"===g?h="true"===e:"string"===g&&f.caseInsensitive&&(h=e.toLowerCase()),h===d&&(b.attr("selected","true"),c.input.val(b.text()))})}var e=this.select.find(":selected"),g=e.attr("value"),h=e.attr("data-type");return"number"===h?g=parseFloat(g):"boolean"===h&&(g="true"===g),void 0===g&&(g=e.text()),g},this.focus=function(){var a=this;this.select.trigger("openlist"),this.select.on("listclosed",function(){h.activeCell.cell===a.cell.cell&&h.activeCell.row===a.cell.row?(a.input.trigger("focusout"),e.parent().trigger("focus")):h.commitCellEdit(a.input),h.setNextActiveCell(g)})},this.destroy=function(){},this.init()},Date:function(b,c,d,e,f,g,h){this.name="date",this.originalValue=d,this.init=function(){this.input=a('<input class="datepicker"/>').appendTo(e),this.input.datepicker(f.editorOptions?f.editoroptions:{dateFormat:f.dateFormat})},this.val=function(a){return a&&this.input.val(a),this.input.val()},this.focus=function(){var a=this;this.input.select().focus(),"click"===g.type&&(this.input.parent().find(".icon").trigger("click"),this.input.closest("td").addClass("is-focused")),this.input.on("listclosed",function(){a.input.closest("td").removeClass("is-focused"),setTimeout(function(){a.input.trigger("focusout"),e.parent().focus(),h.setNextActiveCell(g)},1)})},this.destroy=function(){var a=this;setTimeout(function(){a.input.remove()},0)},this.init()},Lookup:function(b,c,d,e,f,g,h){this.name="lookup",this.originalValue=d,this.init=function(){this.input=a('<input class="lookup" data-init="false" />').appendTo(e),f.maxLength&&this.input.attr("maxlength",f.maxLength),this.input.lookup(f.editorOptions)},this.val=function(a){return a?this.input.val(a):this.input.val()},this.focus=function(){var b=this,c=b.input.data("lookup"),d=b.input.closest("td");"keydown"===g.type&&(b.input.select().focus(),d.on("keydown.editorlookup",function(a){40===a.keyCode&&h.quickEditMode&&(a.preventDefault(),a.stopPropagation())})),"click"===g.type&&(a(g.target).is("svg")?c.openDialog(g):(b.input.select().focus(),d.on("touchcancel.editorlookup touchend.editorlookup",".trigger",function(){c.openDialog()}))),b.input.on("change",function(){setTimeout(function(){e.parent().focus(),h.setNextActiveCell(g),h.quickEditMode=!1},1)})},this.destroy=function(){var a=this,b=this.input.closest("td");setTimeout(function(){b.off("keydown.editorlookup").find(".trigger").off("touchcancel.editorlookup touchend.editorlookup"),a.input.remove()},0)},this.init()},Autocomplete:function(b,c,d,e,f,g,h){this.name="autocomplete",this.originalValue=d,this.init=function(){this.input=a('<input class="autocomplete datagrid-autocomplete" data-autocomplete="source" />').appendTo(e),f.editorOptions||(f.editorOptions={}),f.editorOptions.width=e.parent().width(),f.editorOptions.offset={},f.editorOptions.offset.left=-20,f.editorOptions.offset.top=11,f.maxLength&&this.input.attr("maxlength",f.maxLength),this.input.autocomplete(f.editorOptions)},this.val=function(a){return a?this.input.val(a):this.input.val()},this.focus=function(){h.quickEditMode=!0,this.input.select().focus()},this.destroy=function(){var a=this;setTimeout(function(){h.quickEditMode=!1,a.input.remove()},0)},this.init()}},a.fn.datagrid=function(b){function c(b){this.element=a(b),this.init()}var d="datagrid",e={actionableMode:!1,cellNavigation:!0,rowNavigation:!0,alternateRowShading:!1,columns:[],dataset:[],columnReorder:!1,saveColumns:!0,editable:!1,isList:!1,menuId:null,rowHeight:"normal",selectable:!1,clickToSelect:!0,toolbar:!1,paging:!1,pagesize:25,pagesizes:[10,25,50,75],indeterminate:!1,source:null,filterable:!1,resultsText:null},f=a.extend({},e,b);return c.prototype={init:function(){var b=this;this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isFirefoxMac=-1!==navigator.platform.indexOf("Mac")&&-1!==navigator.userAgent.indexOf(") Gecko"),this.isIe=a("html").is(".ie"),this.isIe9=a("html").is(".ie9"),this.settings=f,this.initSettings(),this.originalColumns=this.settings.columns,this.appendToolbar(),this.restoreColumns(),this.render(),this.initFixedHeader(),this.createResizeHandle(),this.handlePaging(),this.initTableWidth(),this.handleEvents(),this.handleKeys(),setTimeout(function(){b.element.trigger("rendered",[b.element,b.headerRow,b.pagerBar])},0)},initSettings:function(){"table"!==this.settings.dataset&&this.element.wrap('<div class="datagrid-wrapper" />'),this.sortColumn={sortField:null,sortAsc:!0},this.gridCount=a(".datagrid").length+1,this.lastSelectedRow=0,this.contextualToolbar=this.element.closest(".datagrid-wrapper").prev(".contextual-toolbar"),this.contextualToolbar.addClass("datagrid-contextual-toolbar")},initFromTable:function(){"table"===this.settings.dataset&&this.element.remove()},initTableWidth:function(){if(this.element.parents().hasClass("modal")){var b=a(".modal .modal-content"),c=this.table.width()+parseInt(b.css("padding-left"),10)+parseInt(b.css("padding-right"),10)+parseInt(b.css("margin-left"),10)+parseInt(b.css("margin-right"),10);this.element.css("max-width",c),a(".modal").find(".modal-body").css("overflow-x","hidden")}"normal"!==f.rowHeight&&this.element.find("table").addClass(f.rowHeight+"-rowheight")},render:function(){var b=this;if("table"===this.settings.dataset){b.table=a(this.element).addClass("datagrid").attr("role",this.settings.treeGrid?"treegrid":"grid");var c=a(this.element).closest(".datagrid-wrapper");0===c.length&&this.element.wrap('<div class="datagrid-wrapper"><div class="datagrid-container"></div></div>'),b.settings.dataset=b.htmlToDataset(),b.container=this.element.closest(".datagrid-wrapper")}else b.table=a("<table></table>").addClass("datagrid").attr("role",this.settings.treeGrid?"treegrid":"grid"),b.container=b.element.addClass("datagrid-container");this.settings.treeGrid&&!this.settings.editable&&b.table.attr("aria-readonly","true"),a(this.element).closest(".datagrid-wrapper").addClass(this.settings.isList?" is-gridlist":""),b.table.addClass(this.settings.isList?" is-gridlist":""),b.table.empty(),b.renderRows(),b.element.append(b.table),
b.renderHeader(),b.wrapper=b.element.closest(".datagrid-wrapper"),b.settings.buttonSelector=".btn, .btn-secondary, .btn-primary, .btn-modal-primary, .btn-tertiary, .btn-icon, .btn-actions, .btn-menu, .btn-split",a(b.settings.buttonSelector,b.table).button()},htmlToDataset:function(){var b=a(this.element).find("tbody tr"),c=this,d=c.settings.columns.length>0,e=[];if(!d){var f=a(this.element).find("thead th"),g=c.element.find("tbody tr:first()");f.each(function(b,d){var e={},f=a(d),h="column"+b;e.id=f.text().toLowerCase(),e.name=f.text(),e.field=h;var i=g.find("td").eq(b).find("a");i.length>0&&(e.formatter=Formatters.Hyperlink,e.href=i.attr("href")),c.settings.columns.push(e)})}return b.each(function(){var b=a(this).find("td"),f={};b.each(function(b,e){var g=a(e),h="column"+b;f[h]=c.settings.columns[b].formatter?g.text():g.html(),d&&(c.settings.columns[b].field=h)}),e.push(f)}),e},addRow:function(a,b){var c,d,e=this,f=!1,g=0,h=0;b&&"top"!==b||(b="top",f=!0),a.rowStatus={icon:"new",text:"New",tooltip:"New"},"string"==typeof b?e.settings.dataset[f?"unshift":"push"](a):e.settings.dataset.splice(b,0,a),e.renderRows(),e.syncSelectedUI(),e.updateSelected(),setTimeout(function(){g=f?g:e.settings.dataset.length-1,e.setActiveCell(g,h),d=e.tableBody.find("tr").eq(g),c={row:g,cell:h,target:d,value:a,oldValue:[]},e.pagerRefresh(b),e.element.triggerHandler("addrow",c)},10)},pagerRefresh:function(a){if(this.pager){var b=this.pager.activePage;"string"==typeof a?b="top"===a?1:this.pager._pageCount:"number"==typeof a&&(b=Math.floor(a/this.pager.settings.pagesize+1)),this.pager.pagingInfo=this.pager.pagingInfo||{},this.pager.pagingInfo.activePage=b,this.renderPager(this.pager.pagingInfo)}},initFixedHeader:function(){var a=this;a.element.hasClass("datagrid-contained")&&(this.fixHeader(),this.syncFixedHeader())},fixHeader:function(){var b=this;if(!this.wrapper.prev().is(".datagrid-clone")){this.clone=a('<table class="datagrid datagrid-clone" role="presentation" aria-hidden="true"></table>').append(this.headerRow.clone()).append("<tbody></tbody>"),this.clone.insertBefore(this.element.closest(".datagrid-wrapper")),this.clone.wrap('<div class="datagrid-scrollable-header"></div>'),this.fixedHeader=!0,this.headerRow.addClass("audible"),this.rowHeight();var c=this.wrapper.parent().next(),d=this.wrapper.parent().prev(),e=(0===c.length?0:c.outerHeight())+(0===d.length?0:d.outerHeight()),f="calc(100% - "+e+"px)",g=this.wrapper.parent(".contained"),h=g.prop("style")&&g.prop("style")[a.camelCase("height")];h?f=g.css("height"):g.css("height",f),this.wrapper.find(".datagrid-container").css({height:"100%",overflow:"auto"});var i=this.settings.paging?0===c.length?80:48:0;i+=0===c.length?0:parseInt(c.outerHeight()),this.wrapper.parent().is(".pane")&&(i=146),h&&(i=18),this.wrapper.css("height","calc(100% - "+i+"px)"),this.container.on("scroll.datagrid",function(){b.clone.parent().scrollLeft(a(this).scrollLeft())}),this.handleEvents()}},unFixHeader:function(){this.fixedHeader=!1,this.wrapper.prev().is(".datagrid-scrollable-header")&&(this.wrapper.prev().remove(),this.headerRow.removeClass("audible"),this.wrapper.css({height:"",overflow:""}),this.wrapper.find(".datagrid-container").css({height:"",overflow:""}),this.container.off("scroll.datagrid"))},syncFixedHeader:function(){if(this.fixedHeader){var b=this;b.headerRow.find("th").each(function(c){var d=b.table.closest(".datagrid-container").get(0),e=d.offsetWidth-d.clientWidth,f=a(this),g=f.width();g+=f.is(":last-child")?e:0,f.width(g),b.clone.find("th").eq(c).width(g)}),b.clone.width(b.table.width())}},removeRow:function(a,b){var c=this.tableBody.find("tr").eq(a),d=this.settings.dataset[a];this.unselectRow(a,b),this.settings.dataset.splice(a,1),this.renderRows(),this.element.trigger("rowremove",{row:a,cell:null,target:c,value:[],oldValue:d})},removeSelected:function(){for(var a=this,b=this.selectedRows(),c=b.length-1;c>=0;c--)a.removeRow(b[c].idx,!0),this.updateSelected();this.pagerRefresh(),this.syncSelectedUI()},updateDataset:function(a,b){this.loadData(a,b)},loadData:function(a,b){this.settings.dataset=a,this.pager&&(this.pager.settings.dataset=a),b||(b={}),b.activePage||(b.activePage=1,b.pagesize=this.settings.pagesize,b.total=-1,b.type="initial"),this.renderRows(),this.renderPager(b),b&&b.preserveSelected?(this.updateSelected(),this.syncSelectedUI()):this.unSelectAllRows()},uniqueId:function(a){var b=window.location.pathname.split("/").pop().replace(".html","")+"-"+(this.element.attr("id")?this.element.attr("id"):"datagrid")+"-"+this.gridCount+a;return b},visibleColumns:function(){for(var a=[],b=0;b<this.settings.columns.length;b++){var c=f.columns[b];c.hidden||a.push(c)}return a},getColumnGroup:function(a){for(var b=0,c=this.settings.columnGroups,d=0;d<c.length;d++)if(b+=c[d].colspan,b>=a)return this.uniqueId("-header-group-"+d)},headerText:function(a){var b=a.name?a.name:"";return b||"drilldown"!==a.id?b:(b=Locale.translate("Drilldown"),'<span class="audible">'+b+"</span>")},renderHeader:function(){var b,c=this,d="",e=this.settings.columnGroups;if(e){var g=0;d+='<tr role="row" class="datagrid-header-groups">';for(var h=0;h<e.length;h++)g+=parseInt(e[h].colspan),b=c.uniqueId("-header-group-"+h),d+='<th colspan="'+e[h].colspan+'" id="'+b+'"><div class="datagrid-column-wrapper "><span class="datagrid-header-text">'+e[h].name+"</span></div></th>";g<this.visibleColumns().length&&(d+='<th colspan="'+(this.visibleColumns().length-g)+'"></th>'),d+="</tr><tr>"}else d+='<tr role="row">';for(var i=0;i<this.settings.columns.length;i++){var j=f.columns[i],k=c.uniqueId("-header-"+i),l=void 0===j.sortable?!0:j.sortable,m=void 0===j.resizable?!0:j.resizable,n="selectionCheckbox"===j.id,o="center"===j.align?" l-"+j.align+"-text":"";d+='<th scope="col" role="columnheader" class="'+(l?"is-sortable":"")+(m?" is-resizable":"")+(j.hidden?" is-hidden":"")+(j.filterType?" is-filterable":"")+(o?o:"")+'" id="'+k+'" data-column-id="'+j.id+'"'+(j.field?' data-field="'+j.field+'"':"")+(j.headerTooltip?'title="'+j.headerTooltip+'"':"")+(e?' headers="'+c.getColumnGroup(i)+'"':"")+(j.width?' style="width:'+("number"==typeof j.width?j.width+"px":j.width)+'"':"")+">",d+='<div class="'+(n?"datagrid-checkbox-wrapper ":"datagrid-column-wrapper")+(void 0===j.align||j.filterType?"":" l-"+j.align+"-text")+'"><span class="datagrid-header-text'+(j.required?" required":"")+'">'+c.headerText(f.columns[i])+"</span>",n&&(d+='<span aria-checked="false" class="datagrid-checkbox" aria-label="Selection" role="checkbox"></span>'),l&&(d+='<div class="sort-indicator"><span class="sort-asc">'+a.createIcon({icon:"dropdown"})+'</span><span class="sort-desc">'+a.createIcon({icon:"dropdown"})+"</div>"),d+="</div></th>"}d+="</tr>",void 0===c.headerRow?(c.headerRow=a("<thead>"+d+"</thead>"),c.table.prepend(c.headerRow)):(c.headerRow.empty(),c.headerRow.append(d)),c.table.find("th[title]").tooltip(),c.setColumnWidths(),c.settings.columnReorder&&c.createDraggableColumns(),this.renderFilterRow()},filterRowRendered:!1,renderFilterRow:function(){var a=this;if(this.settings.filterable){this.headerRow.find(".datagrid-filter-wrapper").remove();for(var b=0;b<this.settings.columns.length;b++)if(this.settings.columns[b].filterType){var c=this.settings.columns[b],d=a.uniqueId("-header-"+b),e=this.headerRow.find("#"+d),f=a.uniqueId("-header-filter-"+b),g='<div class="datagrid-filter-wrapper">'+this.renderFilterButton(c.filterType,c.filterDisabled)+'<label class="audible" for="'+f+'">'+c.name+"</label>";switch(c.filterType){case"checkbox":break;case"date":g+="<input "+(c.filterDisabled?" disabled":"")+' type="text" class="datepicker" id="'+f+'"/>';break;case"decimal":g+="<input "+(c.filterDisabled?" disabled":"")+' type="text" id="'+f+'"/ data-mask-mode="number" data-mask="'+(c.mask?c.mask:"####.00")+'">';break;case"contents":case"select":if(g+="<select "+(c.filterDisabled?" disabled":"")+("select"===c.filterType?' class="dropdown"':' multiple class="multiselect"')+'id="'+f+'">',c.options){"select"===c.filterType&&(g+="<option>&nbsp;</option>");for(var h=0;h<c.options.length;h++){var i=c.options[h],j=c.caseInsensitive&&"string"==typeof i.value?i.value.toLowerCase():i.value;g+='<option value = "'+j+'">'+i.label+"</option>"}}g+="</select>";break;default:g+="<input"+(c.filterDisabled?" disabled":"")+' type="text" id="'+f+'"/>'}g+="</div>",e.find(".datagrid-column-wrapper").after(g),e.find(".datepicker").datepicker(c.editorOptions?c.editoroptions:{dateFormat:c.dateFormat}),e.find(".dropdown").dropdown(c.editorOptions),e.find(".multiselect").multiselect(c.editorOptions),e.find("[data-mask]").mask()}this.headerRow.addClass("is-filterable"),this.headerRow.find(".btn-filter").popupmenu({}).on("selected.datagrid",function(){a.applyFilter()}),this.headerRow.on("keydown.datagrid",".datagrid-filter-wrapper input",function(b){b.stopPropagation(),13===b.which&&a.applyFilter()}).on("change.datagrid",".datagrid-filter-wrapper input",function(){a.applyFilter()}),this.headerRow.find(".dropdown, .multiselect").on("selected.datagrid",function(){a.applyFilter()}),a.filterRowRendered=!0}},renderFilterItem:function(b,c,d){var e=a.createIcon({classes:"icon icon-filter",icon:"filter-"+b});return"<li "+(d?'class="is-checked"':"")+'><a href="#">'+e+"<span>"+c+"</span></a></li>"},renderFilterButton:function(b,c){var d='<button type="button" class="btn-menu btn-filter" data-init="false" '+(c?" disabled":"")+' type="button"><span class="audible">Filter</span>'+a.createIcon({icon:"dropdown",classes:"icon-dropdown"})+'</button><ul class="popupmenu has-icons is-translatable is-selectable">';return"contents"===b||"select"===b?"":("text"===b&&(d+=this.renderFilterItem("contains","Contains",!0)),"checkbox"===b&&(d+=this.renderFilterItem("selected-notselected","EitherSelectedOrNotSelected",!0),d+=this.renderFilterItem("selected","Selected"),d+=this.renderFilterItem("not-selected","NotSelected")),"checkbox"!==b&&(d+=this.renderFilterItem("equals","Equals","integer"===b||"date"===b?!0:!1)+this.renderFilterItem("does-not-equal","DoesNotEqual"),d+=this.renderFilterItem("is-empty","IsEmpty")+this.renderFilterItem("is-not-empty","IsNotEmpty")),("integer"===b||"date"===b||"decimal"===b)&&(d+=this.renderFilterItem("less-than","LessThan"),d+=this.renderFilterItem("less-equals","LessOrEquals"),d+=this.renderFilterItem("greater-than","GreaterThan"),d+=this.renderFilterItem("greater-equals","GreaterOrEquals")),"text"===b&&(d+=this.renderFilterItem("end-with","EndWith"),d+=this.renderFilterItem("does-not-end-with","DoesNotEndWith"),d+=this.renderFilterItem("start-with","StartWith"),d+=this.renderFilterItem("does-not-start-with","DoesNotStartWith")),d+="</ul>")},toggleFilterRow:function(){this.settings.filterable?(this.headerRow.removeClass("is-filterable"),this.headerRow.find(".is-filterable").removeClass("is-filterable"),this.headerRow.find(".datagrid-filter-wrapper").hide(),this.settings.filterable=!1):(this.settings.filterable=!0,this.filterRowRendered||this.renderFilterRow(),this.headerRow.addClass("is-filterable"),this.headerRow.find(".is-filterable").addClass("is-filterable"),this.headerRow.find(".datagrid-filter-wrapper").show())},applyFilter:function(a){var b=this;this.filteredDataset=null,a||(a=this.filterConditions());for(var c=function(c){for(var d=!0,e=0;e<a.length;e++){var f=b.columnById(a[e].columnId)[0].field,g=b.fieldValue(c,f).toString().toLowerCase(),h=g.toString(),i=a[e].value.toString().toLowerCase();switch("number"==typeof c[a[e].columnId]&&(g=c[a[e].columnId],i=parseFloat(a[e].value)),c[a[e].columnId]instanceof Date&&(g=c[a[e].columnId].getTime(),i=Locale.parseDate(a[e].value,a[e].format).getTime()),a[e].operator){case"equals":if(a[e].value instanceof Array){d=!1;for(var j=0;j<a[e].value.length;j++){var k=a[e].value[j].indexOf(c[a[e].columnId])>=0&&""!==c[a[e].columnId].toString();k&&(d=!0)}}else d=g===i&&""!==g;break;case"does-not-equal":d=g!==i&&""!==g;break;case"contains":d=h.indexOf(i)>-1&&""!==g.toString();break;case"end-with":d=h.lastIndexOf(i)===h.length-i.toString().length&&""!==h;break;case"start-with":d=0===h.indexOf(i)&&""!==h;break;case"does-not-end-with":d=!(h.lastIndexOf(i)===h.length-i.toString().length&&""!==h);break;case"does-not-start-with":d=!(0===h.indexOf(i)&&""!==h);break;case"is-empty":d=""===g;break;case"is-not-empty":d=""!==g;break;case"less-than":d=i>g&&""!==g;break;case"less-equals":d=i>=g&&""!==g;break;case"greater-than":d=g>i&&""!==g;break;case"greater-equals":d=i>=g&&""!==g;break;case"selected":d=("1"===h||"true"===h||g===!0||1===g)&&""!==h;break;case"not-selected":d=("0"===h||"false"===h||g===!1||0===g)&&""!==h;break;case"selected-notselected":d=!0}if(!d)return!1}return d},d=0;d<this.settings.dataset.length;d++){var e=!c(this.settings.dataset[d]);this.settings.dataset[d].isFiltered=e}this.renderRows(),this.resetPager("filtered")},clearFilter:function(){this.renderFilterRow(),this.applyFilter()},filterConditions:function(){var b=this;return this.filterExpr=[],this.headerRow.find("th").each(function(){var c,d=a(this),e=d.find(".btn-filter"),f=d.find("input, select"),g=f.is("select"),h=e.find(".icon-dropdown:first");if((e.length||g)&&(c=g?"equals":h.getIconName().replace("filter-",""),"selected-notselected"!==c&&!(""===f.val()&&-1===["is-not-empty","is-empty","selected","not-selected"].indexOf(c)||f.val()instanceof Array&&0===f.val().length))){var i={columnId:d.attr("data-column-id"),operator:c,value:f.val()?f.val():"",ignorecase:"yes"};if(f.data("datepicker")){var j=f.data("datepicker").settings.dateFormat;"locale"===j&&(j=Locale.calendar().dateFormat["short"]),i.format=j}b.filterExpr.push(i)}}),b.filterExpr},createDraggableColumns:function(){var b=this,c=b.headerNodes();c.prepend('<span class="is-draggable-target"></span><span class="handle">&#8286;</span>'),c.last().append('<span class="is-draggable-target last"></span>'),b.element.addClass("has-draggable-columns"),b.element.on("scroll.datagrid",function(){b.adjustDraggablePosition()}),a(".handle",c).each(function(){var d=a(this),e=d.parent();d.on("mousedown.datagrid",function(d){d.preventDefault(),e.drag({clone:!0,cloneAppentTo:c.first().parent().parent()}).on("dragstart.datagrid",function(c,d,e){var f;e.removeAttr("id").addClass("is-dragging-clone").css({left:d.left,top:d.top}),a(".is-draggable-target",e).remove(),b.setDraggableColumnTargets(),f=b.targetColumn(d),b.draggableStatus.startIndex=f}).on("drag.datagrid",function(d,e){var f,g,h,i,j=b.targetColumn(e);if(a(".is-draggable-target",c).removeClass("is-over"),-1!==j)for(f=0,g=b.draggableColumnTargets.length;g>f;f++)i=b.draggableColumnTargets[f],h=f+1,i.index===j&&i.index!==b.draggableStatus.startIndex&&(i.index>b.draggableStatus.startIndex&&g>h&&(i=b.draggableColumnTargets[h]),i.el.addClass("is-over"))}).on("dragend.datagrid",function(d,f){var g,h,i,j,k=b.targetColumn(f),l=e.data("drag"),m=[];if(l&&l.destroy&&l.destroy(),b.draggableStatus.endIndex=k,a(".is-draggable-target",c).removeClass("is-over"),-1!==b.draggableStatus.endIndex&&b.draggableStatus.startIndex!==b.draggableStatus.endIndex){for(g=0,h=b.settings.columns.length;h>g;g++)b.settings.columns[g].hidden||m.push(g);i=m[b.draggableStatus.startIndex]||0,j=m[b.draggableStatus.endIndex]||0,b.arrayIndexMove(b.settings.columns,i,j),b.updateColumns(b.settings.columns)}})})})},adjustDraggablePosition:function(b){var c=this,d=function(b){a(".is-draggable-target, .handle",b).css("left",b.position().left),a(".is-draggable-target.last",b).css("left",b.position().left+b.outerWidth())},e=function(){c.headerNodes().not(".is-hidden").each(function(){d(a(this))})};b?d(b):e()},setDraggableColumnTargets:function(){var b,c,d,e=this,f=e.headerNodes().not(".is-hidden");e.draggableColumnTargets=[],e.draggableStatus={},a(".is-draggable-target",f).each(function(g){var h=a(this).is(".last")?g-1:g;b=f.eq(h),c=b.position(),d=20,e.draggableColumnTargets.push({el:a(this),index:h,pos:c,width:b.outerWidth(),height:b.outerHeight(),dropArea:{x1:c.left-d,x2:c.left+b.outerWidth()+d,y1:c.top-d,y2:c.top+b.outerHeight()+d}})})},targetColumn:function(a){var b,c,d,e=this,f=-1;for(c=0,d=e.draggableColumnTargets.length-1;d>c;c++)b=e.draggableColumnTargets[c],a.left>b.dropArea.x1&&a.left<b.dropArea.x2&&a.top>b.dropArea.y1&&a.top<b.dropArea.y2&&(f=b.index);return f},arrayIndexMove:function(a,b,c){a.splice(c,0,a.splice(b,1)[0])},fieldValue:function(b,c){if(!c||!b)return"";if(c.indexOf(".")>-1)return c.split(".").reduce(function(a,b){return a?a[b]:""},b);var d=b[c],e=d||0===d||d===!1?d:"";return e=a.escapeHTML(e)},renderRows:function(){var b,c="",d=this,e=d.pager?d.pager.activePage:1,f=d.settings.pagesize,g=d.settings.dataset,h=d.table.find("tbody");for(0===h.length&&(d.tableBody=a("<tbody></tbody>"),d.table.append(d.tableBody)),d.tableHeight=d.tableBody.height(),d.tableBody.css({height:d.tableHeight,display:"block"}),d.tableBody.empty(),d.recordCount=0,d.filteredCount=0,b=0;b<g.length;b++){if(this.settings.paging&&!this.settings.source){if(1===e&&b-this.filteredCount>=f){this.recordCount++;continue}if(e>1&&!(b-this.filteredCount>=f*(e-1)&&b-this.filteredCount<f*e)){this.recordCount++;continue}}g[b].isFiltered?this.filteredCount++:(this.recordCount++,c+=d.rowHtml(g[b]))}d.tableBody.append(c),d.tableBody.css({height:"",display:""}),d.setupTooltips(),d.tableBody.find(".dropdown").dropdown(),setTimeout(function(){d.settings.source||d.displayCounts(),d.activeCell={node:d.cellNode(0,0).attr("tabindex","0"),isFocused:!1,cell:0,row:0}},100)},recordCount:0,rowHtml:function(a,b){var c=this.recordCount%2===0,d=this,e=d.pager?d.pager.activePage:1,f=d.settings.pagesize,g="";g='<tr role="row" aria-rowindex="'+(this.recordCount+(d.settings.source?(e-1)*f:0))+'"'+(d.settings.treeGrid&&a.children?' aria-expanded="'+(a.expanded?'true"':'false"'):"")+(d.settings.treeGrid?' aria-level= "'+a.depth+'"':"")+' class="datagrid-row'+(" normal"!==d.settings.rowHeight?" "+d.settings.rowHeight+"-rowheight":"")+(b?" is-hidden":"")+(d.settings.alternateRowShading&&!c?" alt-shading":"")+(d.settings.cellNavigation?"":" is-clickable")+(d.settings.treeGrid?a.children?" datagrid-tree-parent":a.depth>1?" datagrid-tree-child":"":"")+'">';for(var h=0;h<d.settings.columns.length;h++){var i=d.settings.columns[h],j="",k=i.formatter?i.formatter:d.defaultFormatter,l="";if(l="string"==typeof k?window.Formatters[k](this.recordCount,h,d.fieldValue(a,d.settings.columns[h].field),d.settings.columns[h],a,d).toString():k(this.recordCount,h,d.fieldValue(a,d.settings.columns[h].field),d.settings.columns[h],a,d).toString(),0===l.indexOf('<span class="is-readonly">')&&(i.readonly=!0),(l.indexOf("datagrid-checkbox")>-1||l.indexOf("btn-actions")>-1)&&(j+=" l-center-text"),l.indexOf("trigger")>-1&&(j+=" datagrid-trigger-cell"),i.expanded&&(d.treeExpansionField=i.expanded),i.align&&(j+=" l-"+i.align+"-text"),"ellipsis"===i.textOverflow&&(j+=" text-ellipsis"),j+=i.readonly?" is-readonly":"",j+=i.hidden?" is-hidden":"",i.isEditable&&!i.readonly){var m=i.isEditable(this.recordCount-1,h,d.fieldValue(a,d.settings.columns[h].field),i,a);m||(j+=" is-readonly")}var n=i.readonly||void 0===i.editor?'aria-readonly="true"':"";if(i.isReadonly&&!i.readonly){var o=i.isReadonly(this.recordCount,h,d.fieldValue(a,d.settings.columns[h].field),i,a);o&&(j+=" is-cell-readonly",n='aria-readonly="true"')}var p=d.fieldValue(a,d.settings.columns[h].field);if(i.cssClass&&"function"==typeof i.cssClass&&(j+=i.cssClass(this.recordCount,h,p,i,a)),j+=i.focusable?" is-focusable":"",g+='<td role="gridcell" '+n+' aria-colindex="'+(h+1)+'"  aria-describedby="'+d.uniqueId("-header-"+h)+'"'+(j?' class="'+j+'"':"")+'data-idx="'+h+'"'+(i.tooltip?' title="'+i.tooltip.replace("{{value}}",p)+'"':"")+("rowStatus"===i.id&&a.rowStatus&&a.rowStatus.tooltip?' title="'+a.rowStatus.tooltip+'"':"")+(d.settings.columnGroups?'headers = "'+d.uniqueId("-header-"+h)+" "+d.getColumnGroup(h)+'"':"")+'><div class="datagrid-cell-wrapper">',i.contentVisible){var q=i.contentVisible(this.recordCount,h,p,i,a);q||(l="")}g+=l+"</div></td>"}if(g+="</tr>",d.settings.rowTemplate){var r=d.settings.rowTemplate,s=a,t="";if(G&&s){var u=G.compile("{{#dataset}}"+r+"{{/dataset}}");t=u.render({dataset:s})}g+='<tr class="datagrid-expandable-row"><td colspan="'+this.visibleColumns().length+'"><div class="datagrid-row-detail"><div class="datagrid-row-detail-padding">'+t+"</div></div></td></tr>"}if(a.children)for(var v=0;v<a.children.length;v++)this.recordCount++,g+=d.rowHtml(a.children[v],!a[d.treeExpansionField]);return g},setupTooltips:function(){this.tableBody.find("td[title]").tooltip({placement:"left",offset:{left:-5,top:0}}),this.table.find("td.text-ellipsis").tooltip({content:function(){var b=a(this),c=b.text(),d=b.children(".datagrid-cell-wrapper");if(b[0]&&d[0]&&d[0].offsetWidth<d[0].scrollWidth){var e=d.width();return a(this).data("tooltip").settings.maxWidth=e,c}return""}})},setColumnWidths:function(){for(var a,b,c=0,d=this,e=0;e<d.settings.columns.length;e++){var f=d.settings.columns[e],g=d.headerNodes().eq(e);if(!f.hidden){f.width&&(a=!0),"string"==typeof f.width&&-1===f.width.indexOf("px")&&(b=!0);var h=parseInt(f.width)||g.outerWidth();c+=h,a&&h&&g.css("width",h),b&&f.width&&g.css("width",parseInt(f.width)+"%"),d.adjustDraggablePosition(g)}}a&&this.table.css("width",c),b&&this.table.css("width","100%"),this.element.is(":visible")||this.element.closest(".tab-container").one("afteractivated",function(){d.setColumnWidths()})},headerNodes:function(){return this.headerRow.find("tr:not(.datagrid-header-groups) th")},cloneHeaderNodes:function(){return this.clone?this.clone.find("thead").find("tr:not(.datagrid-header-groups) th"):[]},firstRowNodes:function(){return this.tableBody.find("tr:first td")},updateRow:function(a,b){for(var c=b?b:this.settings.dataset[a],d=0;d<this.settings.columns.length;d++){var e=this.settings.columns[d];e.hidden||e.id&&["selectionCheckbox","expander"].indexOf(e.id)>-1||this.updateCellNode(a,d,this.fieldValue(c,e.field),!0)}},updateColumns:function(a,b){this.settings.columns=a,b&&(this.settings.columnGroups=b),this.renderRows(),this.renderHeader(),this.setColumnWidths(),this.resetPager("updatecolumns"),this.element.trigger("columnchange",[{type:"updatecolumns",columns:this.settings.columns}]),this.saveColumns()},saveColumns:function(){this.settings.saveColumns&&localStorage&&(localStorage[this.uniqueId("columns")]=JSON.stringify(this.settings.columns))},restoreColumns:function(b){if(localStorage&&this.settings.saveColumns){if(b)return void this.updateColumns(b);var c=localStorage[this.uniqueId("columns")];if(!b&&c){c=JSON.parse(c),this.originalColumns=this.settings.columns;for(var d=0;d<c.length;d++){var e,f=this.columnById(c[d].id);f&&(f=f[0],e=c[d].hidden,a.extend(c[d],f),void 0!==e&&(c[d].hidden=e))}return void(this.settings.columns=c)}}},resetColumns:function(){localStorage.clear(),localStorage[this.uniqueId("columns")]="",this.originalColumns&&this.updateColumns(this.originalColumns)},hideColumn:function(a){var b=this.columnIdxById(a);this.settings.columns[b].hidden=!0,this.headerRow.find("th").eq(b).addClass("is-hidden"),this.tableBody.find("td:nth-child("+(b+1)+")").addClass("is-hidden"),this.element.trigger("columnchange",[{type:"hidecolumn",index:b,columns:this.settings.columns}]),this.saveColumns()},showColumn:function(a){var b=this.columnIdxById(a);this.settings.columns[b].hidden=!1,this.headerRow.find("th").eq(b).removeClass("is-hidden"),this.tableBody.find("td:nth-child("+(b+1)+")").removeClass("is-hidden"),this.element.trigger("columnchange",[{type:"showcolumn",index:b,columns:this.settings.columns}]),this.saveColumns()},exportToExcel:function(b,c){var d=this,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:Panes></x:Panes><x:DisplayGridlines></x:DisplayGridlines></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table border="1px">{table}</table></body></html>',f=function(b){return a("tr, th, td, div, span",b).each(function(){var b=this,c=a(this);if(c.is(".is-hidden"))return void c.remove();for(a(".is-hidden, .is-draggable-target, .handle, .sort-indicator",b).remove();b.attributes.length>0;)b.removeAttribute(b.attributes[0].name)}),b},g=function(a){return window.btoa?"data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(a))):"data:application/vnd.ms-excel;,"+unescape(encodeURIComponent(a))},h=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})},i=f(d.table.clone()),j={worksheet:c||"Worksheet",table:i.html()};if(b=(b||d.element.closest(".datagrid-container").attr("id")||"datagrid")+".xls",this.isIe){if(this.isIe9){var k=window.open();k.document.write("sep=,\r\n"+h(e,j)),k.document.close(),k.document.execCommand("SaveAs",!0,b),k.close()}else if(window.navigator.msSaveBlob){var l=new Blob([h(e,j)],{type:"application/csv;charset=utf-8;"});navigator.msSaveBlob(l,b)}}else{var m=document.createElement("a");m.href=g(h(e,j)),m.download=b,document.body.appendChild(m),m.click(),document.body.removeChild(m)}},personalizeColumns:function(){var b=this,c='<div class="listview-search alternate-bg"><label class="audible" for="gridfilter">Search</label><input class="searchfield" placeholder="'+Locale.translate("SearchColumnName")+'" name="searchfield" id="gridfilter"></div>';c+='<div class="listview alternate-bg" id="search-listview"><ul>';for(var d=0;d<this.settings.columns.length;d++){var e=this.settings.columns[d];e.name&&(c+='<li><a href="#" target="_self" tabindex="-1"> <label class="inline"><input tabindex="-1" '+(e.hideable===!1?"disabled":"")+' type="checkbox" class="checkbox" '+(e.hidden?"":" checked")+' data-column-id="'+(e.id||d)+'"><span class="label-text">'+e.name+"</span></label></a></li>")}c+="</ul></div>",a("body").modal({title:Locale.translate("PersonalizeColumns"),content:c,cssClass:"full-width datagrid-columns-dialog",buttons:[{text:Locale.translate("Close"),click:function(b,c){c.close(),a("body").off("open.datagrid")}}]}).on("beforeopen.datagrid",function(){b.isColumnsChanged=!1}).on("open.datagrid",function(a,c){c.element.find(".searchfield").searchfield({clearable:!0}),c.element.find(".listview").listview({searchable:!0,selectOnFocus:!1}),c.element.on("selected",function(a,c){var d=c.elem.find(".checkbox"),e=d.attr("data-column-id"),f=d.prop("checked");c.elem.removeClass("is-selected"),d.is(":disabled")||(b.isColumnsChanged=!0,f?(b.hideColumn(e),d.prop("checked",!1)):(b.showColumn(e),d.prop("checked",!0)))}).on("close.datagrid",function(){b.isColumnsChanged&&b.updateColumnsAndTableWidth(),b.isColumnsChanged=!1})})},updateColumnsAndTableWidth:function(){var b=this;b.table.css({width:""}),b.headerNodes().not(".is-hidden").each(function(){var c=a(this);b.setColumnWidth(c.attr("data-column-id"),c.width())})},setColumnWidth:function(b,c,d){var e=this,f=0,g=parseFloat(c);if(g&&!(50>c)){e.table.css("width",e.element.width()),d&&e.fixedHeader&&e.clone.css("width",e.element.width()),"number"!=typeof c&&(c=g/100*e.element.width()),e.headerNodes().not(".is-hidden").each(function(){var d=a(this);d.attr("data-column-id")===b?(d.css("width",c),f+=c):f+=d.outerWidth(),e.adjustDraggablePosition(d)});var h=this.columnById(b);h[0]&&h[0].width&&(h[0].width=c),e.fixedHeader&&e.headerNodes().each(function(b){var c=e.cloneHeaderNodes().eq(b);c.css("width",a(this).outerWidth()),e.adjustDraggablePosition(c)}),e.table.css("width",f),e.fixedHeader&&e.clone.css("width",f)}},getChildOffset:function(a){var b=a.offset(),c=a.parent().offset();return{top:b.top-c.top,left:b.left-c.left}},createResizeHandle:function(){var b=this;this.resizeHandle=a('<div class="resize-handle" aria-hidden="true"></div>'),this.settings.columnGroups&&this.resizeHandle.css("height","80px"),this.settings.filterable&&this.resizeHandle.css("height","62px"),this.table.before(this.resizeHandle),this.resizeHandle.drag({axis:"x",containment:"parent"}).on("drag.datagrid",function(a,c){if(b.currentHeader){var d=b.currentHeader.attr("data-column-id"),e="static"!==b.element.parent().css("position")?b.getChildOffset(b.currentHeader):b.currentHeader.offset();b.dragging=!0,b.setColumnWidth(d,c.left-e.left-6+b.element.scrollLeft()),b.syncFixedHeader()}}).on("dragend.datagrid",function(){b.dragging=!1})},displayCounts:function(a){var b=this,c=b.tableBody.find("tr:visible").length;null===b.settings.source&&(c=b.recordCount),a&&-1!==a&&(c=a);var d="("+c+" "+Locale.translate("Results")+")";b.settings.resultsText&&"function"==typeof b.settings.resultsText&&(d=b.settings.resultsText(b,c)),b.toolbar&&(b.toolbar.find(".datagrid-result-count").html(d),b.toolbar.attr("aria-label",b.toolbar.find(".title").text()),b.toolbar.find(".datagrid-row-count").text(c)),b.element.closest(".modal").find(".datagrid-result-count").html(d),b.contextualToolbar&&b.contextualToolbar.find(".selection-count").text(b._selectedRows.length+" "+Locale.translate("Selected"))},triggerRowEvent:function(b,c,d){var e=this,f=a(c.target).closest("td").index(),g=a(c.target).closest("tr").index(),h=e.settings.dataset[g];return a(c.target).is("a")&&(d=!1),d&&(c.stopPropagation(),c.preventDefault()),e.element.trigger(b,[{row:g,cell:f,item:h,originalEvent:c}]),!1},cellNode:function(b,c){var d=this.tableBody.find('tr[role="row"]').eq(b);return b instanceof jQuery&&(d=b),-1===c?a():d.find('td[role="gridcell"]:not(.is-hidden)').eq(c)},handleEvents:function(){function b(a){return!!a.closest(".datagrid, .datagrid-container").length}function c(c){var d=a(c.target);f.isScrolling=!1,j&&b(d)&&(c.preventDefault(),j=!1,f.isScrolling=!0)}function d(b){j=!1,i={x:b.originalEvent.touches[0].pageX,y:b.originalEvent.touches[0].pageY},a(document).on("touchmove.datagrid",function(a){var b={x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY};(b.x>=i.x+k||b.x<=i.x-k||b.y>=i.y+k||b.y<=i.y-k)&&(j=!0)})}function e(b){return a(document).off("touchmove.datagrid"),j?(b.preventDefault(),!1):void c(b)}var f=this,g="multiple"===this.settings.selectable;f.table.on("focus.datagrid","tbody > tr",function(){!f.settings.cellNavigation&&f.settings.rowNavigation&&a(this).addClass("is-active-row")}).on("blur.datagrid","tbody > tr",function(){a("tbody > tr",f.table).removeClass("is-active-row")}),this.element.add(this.clone).off("click.datagrid").on("click.datagrid","th.is-sortable",function(b){a(b.target).parent().is(".datagrid-filter-wrapper")||f.setSortColumn(a(this).attr("data-column-id"))}),this.table.off("mouseup.datagrid touchstart.datagrid").on("mouseup.datagrid touchstart.datagrid","a",function(a){a.preventDefault()}),this.table.off("mouseup.datagrid touchstart.datagrid").on("mouseup.datagrid touchstart.datagrid","td",function(b){function c(){!("mouseup"===b.type&&0!==b.button||d.hasClass("is-focusable")&&!a(b.target).is(f.settings.buttonSelector)||!d.hasClass("is-cell-readonly")&&!j.click(b,[{row:i,cell:g,item:k,originalEvent:b}]))}var d=a(this).closest("td"),e=a(this).find("button"),g=d.index(),h=a(this).closest("tr"),i=f.visualRowIndex(h),j=f.columnSettings(g),k=f.settings.dataset[f.dataRowIndex(h)];if(j.click&&"function"==typeof j.click&&c(),j.menuId&&(e.popupmenu({menuId:j.menuId,trigger:"immediate"}),j.selected&&e.on("selected.datagrid",j.selected)),e.is(".datagrid-expand-btn")){var l=h.index()+1;f.toggleRowDetail(l),f.toggleChildren(l)}f.isCellEditable(i,g)&&setTimeout(function(){f.isContainTextfield(d)&&f.notContainTextfield(d)&&(f.quickEditMode=!0)},0)});var h=this.table.find("tbody");h.off("touchcancel.datagrid touchend.datagrid").on("touchcancel.datagrid touchend.datagrid","td",function(b){a("input, button, a",this).length||b.preventDefault(),b.stopPropagation(),a(this).trigger("click")}).off("click.datagrid").on("click.datagrid","td",function(b){var c=a(b.target);if(1!==c.closest(".datagrid-row-detail").length&&(f.triggerRowEvent("click",b,!0),
f.setActiveCell(c.closest("td")),!(c.is(".datagrid-expand-btn")||c.is(".datagrid-cell-wrapper")&&c.find(".datagrid-expand-btn").length))){var d=f.settings.clickToSelect?!0:a(c).is(".datagrid-selection-checkbox")||1===a(c).find(".datagrid-selection-checkbox").length;d&&g&&b.shiftKey?(f.selectRowsBetweenIndexes([f.lastSelectedRow,c.closest("tr").index()]),b.preventDefault()):d&&f.toggleRowSelection(c.closest("tr")),f.makeCellEditable(f.activeCell.row,f.activeCell.cell,b)}}),h.off("dblclick.datagrid").on("dblclick.datagrid","tr",function(a){f.triggerRowEvent("dblclick",a,!0)}),h.off("contextmenu.datagrid").on("contextmenu.datagrid","tr",function(b){return f.isSubscribedTo(b,"contextmenu")?(f.triggerRowEvent("contextmenu",b,f.settings.menuId?!0:!1),b.preventDefault(),f.settings.menuId&&a(b.currentTarget).popupmenu({menuId:f.settings.menuId,eventObj:b,trigger:"immediate"}),!1):void 0}),this.headerRow.add(this.clone?this.clone.find("thead"):[]).off("mouseenter.datagrid").on("mouseenter.datagrid","th",function(){f.draggableStatus||f.adjustDraggablePosition()}).off("mousemove.datagrid touchstart.datagrid touchmove.datagrid").on("mousemove.datagrid touchstart.datagrid touchmove.datagrid","th",function(b){if(!f.dragging&&(f.currentHeader=a(b.target).closest("th"),f.currentHeader.hasClass("is-resizable"))){var c=f.currentHeader.closest(".datagrid-clone").length,d=f.currentHeader.closest(".header-detail"),e=d.length?parseInt(d.css("margin-left"),10):0,g=parseInt(f.currentHeader.position().left)-(e||0),h=g+f.currentHeader.outerWidth(),i=b.pageX-g>h-b.pageX,j=0;j=i?h-6:g-6,0!==f.currentHeader.index()||i||(j="-999"),i||(f.currentHeader=f.currentHeader.prev()),f.currentHeader.hasClass("is-resizable")&&(f.resizeHandle.css("left",j+"px"),f.resizeHandle.css("top",c?"-40px":"auto"))}}),this.headerRow.off("click.datagrid").on("click.datagrid","th .datagrid-checkbox",function(){var b=a(this);b.hasClass("is-checked")?(b.removeClass("is-checked").attr("aria-checked","true"),f.unSelectAllRows()):(b.addClass("is-checked").attr("aria-checked","true"),f.selectAllRows())}),h.off("focusout.datagrid").on("focusout.datagrid","td input, td textarea, div.dropdown",function(){a("#calendar-popup, .autocomplete.popupmenu.is-open").is(":visible")||a(".lookup-modal.is-visible").length||f.editor&&f.editor.input&&f.commitCellEdit(f.editor.input)});var i,j=!1,k=10;a(document).on("touchstart.datagrid",d).on("touchend.datagrid touchcancel.datagrid",e).on("click.datagrid",c)},isSubscribedTo:function(b,c){var d=this;for(var e in a._data(d.element[0]).events)if(e===c)return!0;return!1},appendToolbar:function(){var b,c,d="",e=this;if(f.toolbar){if(1===this.element.parent().parent().find(".toolbar:not(.contextual-toolbar)").length)b=this.element.parent().parent().find(".toolbar:not(.contextual-toolbar)");else{b=a('<div class="toolbar" role="toolbar"></div>'),f.toolbar.title&&(d=a('<div class="title">'+f.toolbar.title+"  </div>")),d||(d=b.find(".title")),b.append(d),f.toolbar.results&&d.append('<span class="datagrid-result-count"></span>');var g=a('<div class="buttonset"></div>').appendTo(b);if(f.toolbar.keywordFilter){var h=a('<label class="audible" for="gridfilter">'+Locale.translate("Keyword")+"</label>"),i=a('<input class="searchfield" name="searchfield" placeholder="'+Locale.translate("Keyword")+'" id="gridfilter">');g.append(h),f.toolbar.collapsibleFilter||i.attr("data-options","{ collapsible: false }"),g.append(i)}f.toolbar.dateFilter&&g.append('<button class="btn" type="button">'+a.createIcon({icon:"calendar"})+"<span>"+Locale.translate("Date")+"</span></button>"),f.toolbar.actions&&(c=a('<div class="more"></div>').insertAfter(g),c.append('<button class="btn-actions" title="More" type="button">'+a.createIcon({icon:"more"})+'<span class="audible">Grid Features</span></button>'),b.addClass("has-more-button"));var j=a('<ul class="popupmenu"></ul>');f.toolbar.personalize&&j.append('<li><a href="#" data-option="personalize-columns">'+Locale.translate("PersonalizeColumns")+"</a></li>"),f.toolbar.exportToExcel&&j.append('<li><a href="#" data-option="export-to-excel">'+Locale.translate("ExportToExcel")+"</a></li>"),f.toolbar.advancedFilter&&j.append('<li><a href="#">'+Locale.translate("AdvancedFilter")+"</a></li>"),f.toolbar.views&&j.append('<li><a href="#">'+Locale.translate("SaveCurrentView")+'</a></li> <li class="separator"></li> <li class="heading">'+Locale.translate("SavedViews")+'</li><li><a href="#">View One</a></li>'),f.toolbar.rowHeight&&j.append('<li class="separator single-selectable-section"></li><li class="heading">'+Locale.translate("RowHeight")+'</li><li class="is-selectable'+("short"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-short">'+Locale.translate("Short")+'</a></li><li class="is-selectable'+("medium"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-medium">'+Locale.translate("Medium")+'</a></li><li class="is-selectable'+("normal"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-normal">'+Locale.translate("Normal")+"</a></li>"),f.toolbar.filterRow&&j.append('<li class="separator"></li><li class="heading">'+Locale.translate("Filter")+'</li><li class="'+(f.filterable?"is-checked ":"")+'is-toggleable"><a data-option="show-filter-row">'+Locale.translate("ShowFilterRow")+'</a></li><li class="is-indented"><a data-option="run-filter">'+Locale.translate("RunFilter")+'</a></li><li class="is-indented"><a data-option="clear-filter">'+Locale.translate("ClearFilter")+"</a></li>"),f.toolbar.actions&&c.append(j),this.element.parent(".datagrid-wrapper").parent().prepend(b)}if(b.find(".btn-actions").popupmenu().on("selected",function(a,b){var c=b.attr("data-option");("row-short"===c||"row-medium"===c||"row-normal"===c)&&e.rowHeight(c.substr(4)),"personalize-columns"===c&&e.personalizeColumns(),"export-to-excel"===c&&e.exportToExcel(),"show-filter-row"===c&&e.toggleFilterRow(),"run-filter"===c&&e.applyFilter(),"clear-filter"===c&&e.clearFilter()}),!b.data("toolbar")){var k=a.fn.parseOptions(b);f.toolbar.fullWidth&&(k.rightAligned=!0),b.toolbar(k)}b.find(".searchfield").off("keypress.datagrid").on("keypress.datagrid",function(b){(13===b.keyCode||"change"===b.type)&&e.keywordSearch(a(this).val())}),this.toolbar=b}},rowHeight:function(a){return a&&(f.rowHeight=a),this.table.removeClass("short-rowheight medium-rowheight normal-rowheight").addClass(f.rowHeight+"-rowheight"),this.clone&&this.clone.removeClass("short-rowheight medium-rowheight normal-rowheight").addClass(f.rowHeight+"-rowheight"),f.rowHeight},keywordSearch:function(b){return this.tableBody.find('tr[role="row"]').removeClass("is-filtered").show(),this.filterExpr=[],this.tableBody.find(".datagrid-expandable-row").each(function(){var b=a(this);b.prev().find(".datagrid-expand-btn").removeClass("is-expanded"),b.prev().find(".plus-minus").removeClass("active"),b.removeClass("is-expanded").css("display",""),b.find(".datagrid-row-detail").css("height","")}),this.tableBody.find(".search-mode").each(function(){var b=a(this),c=b.text();b.text(c.replace("<i>","").replace("</i>",""))}),b&&0!==b.length?(b=b.toLowerCase(),this.filterExpr.push({column:"all",operator:"contains",value:b,ignorecase:"yes"}),this.highlightSearchRows(b),this.displayCounts(),void(this.pager&&this.pager.setActivePage(1,!0))):(this.displayCounts(),void(this.pager&&this.resetPager("sorted")))},highlightSearchRows:function(b){this.tableBody.find("tr").each(function(){var c=!1,d=a(this);d.find("td").each(function(){var d=a(this),e=d.text().toLowerCase();e.indexOf(b)>-1&&(c=!0,d.find("*").each(function(){if(this.innerHTML===this.textContent){var c=this.textContent,d=a(this),e=new RegExp("("+b+")","i");d.addClass("search-mode").html(c.replace(e,"<i>$1</i>"))}}))}),c?c&&d.is(".datagrid-expandable-row")&&(d.prev().show(),d.prev().find(".datagrid-expand-btn").addClass("is-expanded"),d.prev().find(".plus-minus").addClass("active"),d.addClass("is-expanded").css("display","table-row"),d.find(".datagrid-row-detail").css("height","auto")):d.addClass("is-filtered").hide()})},_selectedRows:[],selectAllRows:function(){for(var a=[],b=0;b<this.settings.dataset.length;b++)a.push(b);this.dontSyncUi=!0,this.selectedRows(a,!0,!0),this.dontSyncUi=!1,this.syncSelectedUI(),this.element.trigger("selected",[this._selectedRows])},unSelectAllRows:function(){this.dontSyncUi=!0,this.selectedRows([],!0,!0),this.dontSyncUi=!1,this.syncSelectedUI(),this.element.trigger("selected",[this._selectedRows])},selectRow:function(a,b){var c,d,e=null;if(void 0!==a&&-1!==a&&this.settings.selectable&&(c=this.visualRowNode(a),d=this.dataRowIndex(c),isNaN(d)&&(d=a),c)){if(this.isTouch&&this.isScrolling)return void c.removeClass("is-active-row").find("td:not(.is-editing)").css({"background-color":"transparent"});if("single"===this.settings.selectable&&this._selectedRows.length>0&&this.unselectRow(this._selectedRows[0].idx),!c.hasClass("is-selected")){e=this.cellNode(c,this.columnIdxById("selectionCheckbox"));var f=this.settings.dataset[d];this.pager&&this.settings.source&&(f=this.settings.dataset[c.index()]),this._selectedRows.push({idx:d,data:f,elem:c}),this.lastSelectedRow=a,c.addClass("is-selected").attr("aria-selected","true"),c.find("td").attr("aria-selected","true"),e.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked").attr("aria-checked","true")}this.syncSelectedUI(),b||this.element.trigger("selected",[this._selectedRows])}},dontSyncUi:!1,selectRowsBetweenIndexes:function(a){a.sort(function(a,b){return a-b});for(var b=a[0];b<=a[1];b++)this.selectRow(b)},syncSelectedUI:function(){var a=this.headerRow.find(".datagrid-checkbox"),b=this;this._selectedRows.length>0&&a.addClass("is-checked is-partial"),this._selectedRows.length===this.settings.dataset.length&&a.addClass("is-checked").removeClass("is-partial"),0===this._selectedRows.length&&a.removeClass("is-checked").removeClass("is-partial"),1!==b.contextualToolbar.length||b.dontSyncUi||(0===b._selectedRows.length&&b.contextualToolbar.animateClosed(),b._selectedRows.length>0&&0===b.contextualToolbar.height()&&b.contextualToolbar.css("display","block").animateOpen())},toggleRowSelection:function(a){var b="number"==typeof a?this.tableBody.find('tr[role="row"]').eq(a):a,c="single"===this.settings.selectable,d="number"==typeof a?a:this.dataRowIndex(b);if(!(this.settings.selectable===!1||this.editor&&b.hasClass("is-selected")))return c&&b.hasClass("is-selected")?(this.unselectRow(d),this._selectedRows=[],this.displayCounts(),this._selectedRows):(b.hasClass("is-selected")?this.unselectRow(d):this.selectRow(d),this.displayCounts(),this._selectedRows)},unselectRow:function(a,b,c){var d,e=this.visualRowNode(a),f=null;if(e&&void 0!==a){f=this.cellNode(e,this.columnIdxById("selectionCheckbox")),d=void 0;for(var g=0;g<this._selectedRows.length;g++)this._selectedRows[g].idx===a&&(d=g);void 0!==d&&this._selectedRows.splice(d,1),e.removeClass("is-selected").removeAttr("aria-selected"),e.find("td").removeAttr("aria-selected"),f.find(".datagrid-checkbox").removeClass("is-checked").attr("aria-checked","false"),b||this.syncSelectedUI(),c||this.element.trigger("selected",[this._selectedRows])}},selectedRows:function(a,b,c){var d=-1,e="single"===this.settings.selectable,f="multiple"===this.settings.selectable;if(!a)return this._selectedRows;if(0!==a.length||0!==this._selectedRows.length){if(e&&(this._selectedRows[0]&&this.unselectRow(this._selectedRows[0].idx,b,c),d="[object Array]"===Object.prototype.toString.call(a)?a[0]:a.index(),this.selectRow(d,c)),f)if("[object Array]"===Object.prototype.toString.call(a)){for(var g=0;g<a.length;g++)this.selectRow(a[g],c);if(0===a.length){for(var h=0;h<this.settings.dataset.length;h++)this.unselectRow(h,b,c);this._selectedRows=[]}}else this.selectRow(a.index(),c);return this.displayCounts(),this._selectedRows}},rowStatus:function(a,b,c){var d;return b?void(this.settings.dataset[a]&&(this.settings.dataset[a].rowStatus={},d=this.settings.dataset[a].rowStatus,d.icon=b,b=b.charAt(0).toUpperCase()+b.slice(1),b=b.replace("-progress","Progress"),d.text=Locale.translate(b),c=c?c.charAt(0).toUpperCase()+c.slice(1):d.text,d.tooltip=c,this.updateRow(a))):(delete this.settings.dataset[a].rowStatus,void this.updateRow(a))},columnById:function(b){return a.grep(this.settings.columns,function(a){return a.id===b})},columnIdxById:function(a){for(var b=this.settings.columns,c=-1,d=0;d<b.length;d++)b[d].id===a&&(c=d);return c},activeCell:{node:null,cell:null,row:null},handleKeys:function(){var b=this,c="multiple"===b.settings.selectable,d=a("th .datagrid-checkbox",b.headerRow);b.table.on("keydown.datagrid","th",function(d){var e,f,g=d.which||d.keyCode||d.charCode||0,h=a(this),i=h.siblings(":visible").addBack().index(h),j=b.visibleColumns().length-1;a(d.target).closest(".popupmenu").length>0||((13===g||32===g)&&(e=c&&0===i?a(".datagrid-checkbox",h):h,e.trigger("click.datagrid").focus(),32===g&&d.preventDefault()),-1!==[35,36,37,39].indexOf(g)&&(f=i,f=/35|36/i.test(g)||(d.ctrlKey||d.metaKey)&&/37|39/i.test(g)?Locale.isRTL()?36===g||(d.ctrlKey||d.metaKey)&&37===g?j:0:35===g||(d.ctrlKey||d.metaKey)&&39===g?j:0:Locale.isRTL()?39===g?i>0?i-1:i:j>i?i+1:j:37===g?i>0?i-1:i:j>i?i+1:j,h.removeAttr("tabindex").removeClass("is-active"),a("th:not(.is-hidden)",this.header).eq(f).attr("tabindex","0").addClass("is-active").focus(),d.preventDefault()),40===g&&(h.removeAttr("tabindex"),b.setActiveCell(0,i),d.preventDefault()))}),b.table.on("focus.datagrid","th",function(){var c=a(this);b.fixedHeader&&b.clone.find("thead th").eq(c.index()).addClass("is-focused")}),b.table.on("blur.datagrid","th",function(){var c=a(this);b.fixedHeader&&b.clone.find("thead th").eq(c.index()).removeClass("is-focused")}),b.table.on("keydown.datagrid","td, input",function(a){var c=a.which||a.keyCode||a.charCode||0,d=!1;return 113===c&&(b.settings.actionableMode=b.settings.actionableMode?!1:!0,d=!0),d?(a.preventDefault(),a.stopPropagation(),!1):void 0}),b.table.on("keydown.datagrid","td",function(e){var f,g,h=e.which||e.keyCode||e.charCode||0,i=!1,j=Locale.isRTL(),k=b.activeCell.node,l=b.activeCell.row,m=b.activeCell.cell,n=b.columnSettings(m),o=b.settings.dataset[b.dataRowIndex(l)],p=b.visibleColumns(),q=!!a(".datagrid-selection-checkbox",k).length;if(g=p.length-1,f=k.closest("tbody").find("tr:last").index(),-1!==[9,37,39].indexOf(h)){if(9===h&&!b.settings.actionableMode)return;9!==h&&e.altKey?(m=37===h&&!j||39===h&&j?0:g,b.setActiveCell(l,m)):b.quickEditMode&&9!==h||(!j&&(37===h||9===h&&e.shiftKey)||j&&(39===h||9===h)?m--:m=m+1>g?g:m+1,b.setActiveCell(l,m),b.quickEditMode=!1,i=!0)}if(38!==h||b.quickEditMode||(e.altKey?b.setActiveCell(0,m):(0===l&&(k.removeAttr("tabindex"),a("th:not(.is-hidden)",this.header).eq(m).attr("tabindex","0").focus()),b.setActiveCell(l-1,m),i=!0)),40!==h||b.quickEditMode||(e.altKey?b.setActiveCell(f,m):(b.setActiveCell(l+1>f?f:l+1,m),i=!0)),32===h&&e.ctrlKey&&k){var r="";l=k.closest("tr"),l.children().each(function(){var b=a(this);r+=b.text()+" "}),a("body").toast({title:"",audibleOnly:!0,message:r}),i=!0}if(36===h&&b.setActiveCell(l,0),35===h&&b.setActiveCell(l,g),32===h&&(!b.settings.editable||q)){if(e.preventDefault(),l=k.closest("tr"),1===a(e.target).closest(".datagrid-row-detail").length)return;var s=a(e.target).find(".datagrid-expand-btn");if(s&&s.length)return s.trigger("mouseup.datagrid"),void e.preventDefault();c&&e.shiftKey?b.selectRowsBetweenIndexes([b.lastSelectedRow,l.index()]):b.toggleRowSelection(l)}if(b.settings.editable&&32===h&&(b.editor||b.makeCellEditable(l,m,e)),13===h&&n.click&&"function"==typeof n.click&&k.hasClass("is-focusable")&&a(e.target).is(b.settings.buttonSelector)&&(k.hasClass("is-cell-readonly")||n.click(e,[{row:l,cell:m,item:o,originalEvent:e}])),b.settings.editable&&13===h){if(a(e.target).is("textarea")&&e.shiftKey)return;b.editor?(b.quickEditMode=!1,b.commitCellEdit(b.editor.input),b.setNextActiveCell(e)):(b.makeCellEditable(l,m,e),b.isContainTextfield(k)&&b.notContainTextfield(k)&&(b.quickEditMode=!0)),i=!0}return-1!==[9,13,32,35,36,37,38,39,40,113].indexOf(h)||e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||!b.settings.editable||b.editor||b.makeCellEditable(l,m,e),c&&!b.editor&&(e.ctrlKey||e.metaKey)&&65===h&&(!d.hasClass("is-checked")||d.hasClass("is-partial")?(d.removeClass("is-partial").addClass("is-checked").attr("aria-checked","true"),b.selectAllRows()):(d.removeClass("is-checked").attr("aria-checked","true"),b.unSelectedRows([])),i=!0),i?(e.preventDefault(),e.stopPropagation(),!1):void 0})},isContainTextfield:function(b){var c,d=["image","button","submit","reset","checkbox","radio"],e="textarea, input",f=d.length;for(e+=f?":not(":"",c=0;f>c;c++)e+="[type="+d[c]+"],";return e=f?e.slice(0,-1)+")":"",!!a(e,b).length},notContainTextfield:function(b){var c=".dropdown, .datepicker";return!a(c,b).length},editor:null,isCellEditable:function(a,b){if(!this.settings.editable)return!1;var c=this.columnSettings(b);if(c.readonly)return!1;var d=this.activeCell.node.find(".datagrid-cell-wrapper"),e=d.text()?d.text():this.fieldValue(this.settings.dataset[a],c.field);if(c.isEditable){var f=c.isEditable(a,b,e,c,this.settings.dataset[a]);if(!f)return!1}return c.editor?!0:!1},makeCellEditable:function(a,b,c){if(this.isCellEditable(a,b)){var d=this.columnSettings(b);if(!d.editor)return void(32===c.keyCode&&this.toggleRowSelection(this.activeCell.node.closest("tr")));this.setActiveCell(a,b);var e=this.dataRowIndex(this.visualRowNode(a)),f=this.activeCell.node.find(".datagrid-cell-wrapper"),g=f.parent("td"),h=f.text()?f.text():this.fieldValue(this.settings.dataset[e],d.field);if(g.hasClass("is-editing"))return f.find("input").focus(),!1;g.addClass("is-editing"),f.empty(),this.editor=new d.editor(e,b,h,f,d,c,this,this.settings.dataset[e]),this.editor.useValue&&(h=this.fieldValue(this.settings.dataset[e],d.field)),this.editor.val(h),this.editor.focus(),this.element.triggerHandler("entereditmode")}},commitCellEdit:function(b){var c,d;this.editor&&(c=this.editor.val(),c=a.escapeHTML(c),d=b.closest("td").removeClass("is-editing"),this.editor.destroy(),this.editor=null,this.updateCellNode(this.dataRowIndex(d.parent()),d.index(),c),this.element.triggerHandler("exiteditmode"))},columnSettings:function(a){var b=this.tableBody.find("tr:first").find("td:not(.is-hidden)").eq(a),c=f.columns[parseInt(b.attr("data-idx"))];return c},coerceValue:function(a,b,c){var d;return c.serialize?d=c.serialize(a):d},updateCell:function(a,b,c){var d=this.columnSettings(b);void 0===c&&(c=this.fieldValue(this.settings.dataset[a],d.field)),this.updateCellNode(a,b,c,!0)},updateCellNode:function(b,c,d,e){var g,h,i=this.visualRowNode(b),j=i.find("td").eq(c),k=this.settings.columns[c],l="",m=k.formatter?k.formatter:this.defaultFormatter,n=k.field?this.settings.dataset[b][k.field]:"";e?g=d:(g=this.coerceValue(d,n,k,b,c),void 0===g&&(g=d)),j.data("tooltip")&&j.data("tooltip").destroy();var o=this.settings.dataset[b];if("rowStatus"===k.id&&o.rowStatus&&o.rowStatus.tooltip&&(j.attr("title",o.rowStatus.tooltip),j.tooltip({placement:"right",isErrorColor:"error"===o.rowStatus.icon})),g=a.unescapeHTML(g),k.field&&g!==n)if(k.field.indexOf(".")>-1){var p=k.field.split(".");2===p.length&&(this.settings.dataset[b][p[0]][p[1]]=g),3===p.length&&(this.settings.dataset[b][p[0]][p[1]][p[2]]=g)}else this.settings.dataset[b][k.field]=g;if(h=a.escapeHTML(g),l="string"==typeof m?window.Formatters[m](b,c,h,k,f.dataset[b]).toString():m(b,c,h,k,f.dataset[b]).toString(),k.contentVisible){var q=k.contentVisible(b,c,h,k,f.dataset[b]);q||(l="")}j.find(".datagrid-cell-wrapper").html(l),g===n||e||this.element.trigger("cellchange",{row:b,cell:c,target:j,value:g,oldValue:n,column:k})},visualRowIndex:function(a){var b=a.attr("aria-rowindex")-1;return this.pager&&(b-=(this.pager.activePage-1)*this.settings.pagesize),b},visualRowNode:function(a){var b=this.tableBody.find('tr[role="row"]').eq(a);return this.pager&&(a-=(this.pager.activePage-1)*this.settings.pagesize,b=this.tableBody.find('tr[role="row"]').eq(a)),b},dataRowIndex:function(a){var b=a.attr("aria-rowindex")-1;return b},setActiveCell:function(b,c){var d=this,e=d.activeCell;if(b instanceof jQuery&&(c=b.siblings(":visible").addBack().index(b),b=this.visualRowIndex(b.parent())),!(0>b||0>c)){e.node&&1===e.node.length&&d.activeCell.node.removeAttr("tabindex"),d.activeCell.node=d.cellNode(b,c).attr("tabindex","0"),d.activeCell.node&&1===e.node.length?(d.activeCell.row=b,d.activeCell.cell=c):d.activeCell=e,a("input, button:not(.datagrid-expand-btn)",d.activeCell.node).length||d.activeCell.node.focus(),d.activeCell.node.hasClass("is-focusable")&&d.activeCell.node.find("button").focus();var f=d.headerNodes().not(".is-hidden");f.removeClass("is-active"),f.eq(c).addClass("is-active"),this.activeCell.isFocused=!0,d.element.trigger("activecellchange",[{node:this.activeCell.node,row:this.activeCell.row,cell:this.activeCell.cell}])}},setNextActiveCell:function(b){if("keydown"===b.type)if(this.settings.actionableMode){var c=a.Event("keydown.datagrid");c.keyCode=40,this.activeCell.node.trigger(c)}else this.setActiveCell(this.activeCell.row,this.activeCell.cell)},toggleChildren:function(b){var c=this.table.find("tr").eq(b),d=c.find(".datagrid-expand-btn"),e=c.attr("aria-level"),f=c.nextAll(),g=d.hasClass("is-expanded");if(c.hasClass("datagrid-tree-parent")){g?d.removeClass("is-expanded").find(".plus-minus").removeClass("active"):d.addClass("is-expanded").find(".plus-minus").addClass("active");var h=!1;f.each(function(){var b=a(this);return b.hasClass("datagrid-tree-parent")&&b.attr("aria-level")>e?(h=0===b.find(".datagrid-expand-btn.is-expanded").length,void(g?b.addClass("is-hidden"):b.removeClass("is-hidden"))):h?void b.addClass("is-hidden"):(b.attr("aria-level")>e&&(g?b.addClass("is-hidden"):b.removeClass("is-hidden")),b.attr("aria-level")===e?!1:void 0)})}},toggleRowDetail:function(a){var b=this,c=this.table.find("tr").eq(a),d=this.table.find("tr").eq(a+1),e=c.find(".datagrid-expand-btn"),f=d.find(".datagrid-row-detail"),g=b.dataRowIndex(c),h=b.settings.dataset[g];c.hasClass("datagrid-tree-parent")||(d.hasClass("is-expanded")?(d.removeClass("is-expanded"),e.removeClass("is-expanded").find(".plus-minus").removeClass("active"),f.animateClosed().on("animateclosedcomplete",function(){d.css("display","none"),b.element.trigger("collapserow",[{grid:b,row:g,detail:f,item:h}])})):(d.addClass("is-expanded"),e.addClass("is-expanded").find(".plus-minus").addClass("active"),d.css("display","table-row"),d.find(".constrained-width").css("max-width",this.element.outerWidth()),f.animateOpen(),b.element.trigger("expandrow",[{grid:b,row:g,detail:f,item:h}])))},setSortColumn:function(a,b){var c;void 0!==b?this.sortColumn.sortAsc=b:(this.sortColumn.sortAsc=this.sortColumn.sortId===a?!this.sortColumn.sortAsc:!0,b=this.sortColumn.sortAsc),this.sortColumn.sortId=a,this.sortColumn.sortField=this.columnById(a)[0]?this.columnById(a)[0].field:a,this.setSortIndicator(a,b),c=this.sortFunction(this.sortColumn.sortField,b),f.dataset.sort(c);var d=this.activeCell.isFocused;this.tableBody.addClass("is-loading"),this.renderRows(),this.updateSelected(),this.syncSelectedUI(),d&&1===this.activeCell.node.length&&this.setActiveCell(this.activeCell.row,this.activeCell.cell),this.syncFixedHeader(),this.resetPager("sorted"),this.tableBody.removeClass("is-loading"),this.element.trigger("sorted",[this.sortColumn])},setSortIndicator:function(a,b){this.headerRow.find(".is-sorted-asc, .is-sorted-desc").removeClass("is-sorted-asc is-sorted-desc").attr("aria-sort","none"),this.headerRow.find('[data-column-id="'+a+'"]').addClass(b?"is-sorted-asc":"is-sorted-desc").attr("aria-sort",b?"ascending":"descending"),this.fixedHeader&&this.clone&&(this.clone.find(".is-sorted-asc, .is-sorted-desc").removeClass("is-sorted-asc is-sorted-desc").attr("aria-sort","none"),this.clone.find('[data-column-id="'+a+'"]').addClass(b?"is-sorted-asc":"is-sorted-desc").attr("aria-sort",b?"ascending":"descending"))},sortFunction:function(a,b){var c,d=this,e=function(a){if(a=void 0===a||null===a?"":a,"string"==typeof a){a=a.toUpperCase();var b=/^\d+$/.test(a);b&&!isNaN(parseFloat(a))&&(a=parseFloat(a))}return a};return c=function(b){return e(d.fieldValue(b,a))},b=b?1:-1,function(a,d){return a=c(a),d=c(d),typeof a!=typeof d&&(a=a.toString().toLowerCase(),d=d.toString().toLowerCase()),b*((a>d)-(d>a))}},updateSelected:function(){var b=this;a('tr[role="row"]',b.tableBody).each(function(){var c=a(this),d=b.dataRowIndex(c),e=b.cellNode(c,b.columnIdxById("selectionCheckbox"));a.each(b._selectedRows,function(a,f){return b.isEquals(f.data,b.settings.dataset[d])?(f.idx=d,f.elem=c,e.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked").attr("aria-checked","true"),c.addClass("is-selected").attr("aria-selected","true").find("td").attr("aria-selected","true"),!1):void 0})})},isEquals:function(b,c){function d(b,c){return JSON.stringify(b)===JSON.stringify(a.extend(!0,{},b,c))}return d(b,c)&&d(c,b)},defaultFormatter:function(a,b,c){return null===c||void 0===c||""===c?"":c.toString()},handlePaging:function(){var a=this;if(this.settings.paging){var b=this.tableBody.addClass("paginated");b.pager({dataset:this.settings.dataset,source:this.settings.source,pagesize:this.settings.pagesize,indeterminate:this.settings.indeterminate,rowTemplate:this.settings.rowTemplate,pagesizes:this.settings.pagesizes}),this.pager=b.data("pager"),b.on("afterpaging",function(b,c){a.displayCounts(c.total),a.updateSelected(),a.syncSelectedUI(),a.filterExpr&&a.filterExpr[0]&&"all"===a.filterExpr[0].column&&a.highlightSearchRows(a.filterExpr[0].value)})}},renderPager:function(a){this.pager&&(a&&(this.pager.activePage=a.activePage),a&&this.pager.updatePagingInfo(a),this.pager.renderBar(),this.pager.renderPages("sorted"===a.type?!1:!0,"initial"),this.updateSelected(),this.syncSelectedUI())},resetPager:function(a){this.pager&&(this.pager.pagingInfo||(this.pager.pagingInfo={}),this.pager.pagingInfo.type=a,this.pager.pagingInfo.activePage=1,this.renderPager(this.pager.pagingInfo,a))},destroy:function(){this.element.off().empty().removeClass("datagrid-container").unwrap(),this.element.prev(".toolbar").remove(),this.element.prev(".datagrid-scrollable-header").prev(".toolbar").remove(),this.element.prev(".datagrid-scrollable-header").remove(),this.element.next(".pager-toolbar").remove(),a.removeData(this.element[0],d),a(document).off("touchstart.datagrid touchend.datagrid touchcancel.datagrid click.datagrid touchmove.datagrid")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.dropdown=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="dropdown",e={closeOnSelect:!0,cssClass:null,maxSelected:void 0,moveSelectedToTop:!1,multiple:!1,noSearch:!1,source:void 0,empty:!1,delay:300},f=a.extend({},e,b);return c.prototype={init:function(){function b(a){var b=a.element.prop("disabled"),c=a.element.prop("readonly");return b?a.disable():c?a.readonly():a.enable()}var c=this.element.attr("id");this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),void 0===c&&(c=this.element.uniqueId("dropdown"),this.element.attr("id",c),this.element.parent().find("label").first().attr("for",c));var d=this.element.is(".dropdown-xs")?"dropdown input-xs":this.element.is(".dropdown-sm")?"dropdown input-sm":this.element.is(".dropdown-lg")?"dropdown input-lg":"dropdown";this.isHidden="none"===this.element.css("display"),this.element.hide();var e=this.isInlineLabel?this.inlineLabel:this.element;this.wrapper=e.next(".dropdown-wrapper"),this.wrapper.length||(this.wrapper=a('<div class="dropdown-wrapper"></div>').insertAfter(e)),this.label=a('label[for="'+c+'"]'),this.pseudoElem=a("div#"+c+"-shdo"),this.pseudoElem.length||(this.pseudoElem=a('<div class="'+d+'">').attr({role:"combobox","aria-autocomplete":"list","aria-controls":"dropdown-list","aria-readonly":"true","aria-expanded":"false","aria-label":this.label.text()})),this.pseudoElem.append(a("<span></span>")),b(this),this.wrapper.append(this.pseudoElem,this.trigger),this.icon=this.wrapper.find(".icon"),this.icon.length||(this.icon=a.createIconElement("dropdown"),this.wrapper.append(this.icon)),this.element.prop("multiple")&&!this.settings.multiple&&(this.settings.multiple=!0),this.element.attr("data-source")&&"source"!==this.element.attr("data-source")&&(this.settings.source=this.element.attr("data-source")),this.element.attr("data-maxselected")&&!isNaN(this.element.attr("data-maxselected"))&&(this.settings.maxSelected=parseInt(this.element.attr("data-maxselected"),10)),this.element.attr("data-move-selected")&&!this.settings.moveSelectedToTop&&(this.settings.moveSelectedToTop="true"===this.element.attr("data-move-selected")),this.element.attr("data-close-on-select")&&!this.settings.closeOnSelect&&(this.settings.closeOnSelect="true"===this.element.attr("data-close-on-select")),this.element.attr("data-no-search")&&!this.settings.noSearch&&(this.settings.noSearch="true"===this.element.attr("data-no-search"));for(var f,g=["-xs","-sm","-md","-lg"],h=this.element.attr("class"),i=0;i<g.length;i++)f=g[i],h.match(f)&&this.pseudoElem.addClass("dropdown"+f);return this.updateList(),this.setValue(),this.setInitial(),this.setWidth(),this.element.triggerHandler("rendered"),this.handleEvents()},inputTimer:function(){if(this.inputTimeout)return!1;var a=this;return this.inputTimeout=setTimeout(function(){clearTimeout(a.inputTimeout),a.inputTimeout=null},100),!0},setWidth:function(){var a=this.element[0].style;a.width&&this.pseudoElem.width(a.width),"absolute"===a.position&&this.pseudoElem.css({position:"absolute",left:a.left,top:a.top,bottom:a.bottom,right:a.right})},updateList:function(){function b(b,d){d.attr("data-val",b.val()),b.attr("class")&&d.addClass(b.attr("class")),b.attr("disabled")&&d.addClass("is-disabled"),b.attr("data-attr")&&d.attr("data-attr",b.attr("data-attr")),b.attr("title")&&a.fn.tooltip&&d.attr("title",b.attr("title")).tooltip(),c.badges=!1,b.attr("data-badge")&&(c.badges=!0,d.append('<span class="badge '+(b.attr("data-badge-color")?b.attr("data-badge-color"):"azure07")+'">'+b.attr("data-badge")+"</span>"))}var c=this,d=c.list&&c.list.is(":visible"),e=0;if(d)c.listUl.empty();else{c.list=a('<div class="dropdown-list" id="dropdown-list" role="application">'),c.listUl=a('<ul role="listbox"></ul>').appendTo(c.list);var f=c.isMobile();c.list.prepend('<span class="trigger">'+a.createIcon(f?{icon:"close",classes:["close"]}:"dropdown")+'<span class="audible">'+Locale.translate(f?"Close":"Collapse")+"</span></span>")}if(c.settings.multiple&&c.list.addClass("multiple").attr("aria-multiselectable","true"),c.settings.moveSelectedToTop){var g=c.element.find("option:selected");g.length>0&&c.listUl.append(a('<li role="presentation" class="group-label" focusable="false"></li>').text(Locale.translate("Selected")+" "+(c.isInlineLabel?c.inlineLabelText.text():this.label.text()))),g.each(function(d){var f=a(this),g=a('<li role="presentation" class="dropdown-option is-selected" tabindex="-1"><a role="option" href="#" id="list-option'+d+'" >'+f.html()+"</a></li>");b(f,g),c.listUl.append(g),e++}),g.length>0&&!c.element.find("optgroup").length&&c.listUl.append(a('<li role="presentation" class="group-label"></li>').text("All "+(c.isInlineLabel?c.inlineLabelText.text():this.label.text())))}c.element.find("option").each(function(d){var f,g=d+e,h=a(this);if(h.is(":first-child")&&h.parent().is("optgroup")){var i=a('<li role="presentation" class="group-label" focusable="false"></li>').text(h.parent().attr("label"));c.listUl.append(i)}c.settings.moveSelectedToTop&&h.is(":selected")||(f=a('<li role="presentation" class="dropdown-option" tabindex="-1"><a role="option" href="#" id="list-option'+g+'">'+h.html()+"</a></li>"),c.listUl.append(f),h.is(":selected")&&f.addClass("is-selected").attr({tabindex:"0"}),b(h,f))}),c.list[c.isMobile()?"addClass":"removeClass"]("mobile"),
c.list[c.isFullScreen()?"addClass":"removeClass"]("full-screen"),d||(this.searchInput=a('<input type="text" class="dropdown-search" role="combobox" aria-expanded="true" id="dropdown-search" aria-autocomplete="list">'),this.list.prepend(this.searchInput),this.searchInput.before('<label for="dropdown-search" class="audible">Search</label>'))},setValue:function(){var a=this.element.find("option:selected"),b=this.getOptionText(a);return this.settings.empty&&0===a.length?void this.pseudoElem.find("span").text(""):(this.pseudoElem.find("span").text(b),this.element.attr("maxlength")&&this.pseudoElem.find("span").text(b.substr(0,this.element.attr("maxlength"))),this.previousActiveDescendant=a.first().val(),void this.setBadge(a))},copyClass:function(a,b,c){a.hasClass(c)&&b.addClass(c)},setInitial:function(){this.element.is(":disabled")&&this.disable(),this.element.is("[readonly]")&&this.readonly(),this.isHidden&&(this.pseudoElem.hide().prev("label").hide(),this.pseudoElem.next("svg").hide()),this.element.attr("placeholder")&&(this.pseudoElem.attr("placeholder",this.element.attr("placeholder")),this.element.removeAttr("placeholder"))},handleEvents:function(){var b=this;this.pseudoElem.on("keydown.dropdown",function(c){b.ignoreKeys(a(this),c),b.handleKeyDown(a(this),c)}).on("keypress.dropdown",function(c){b.ignoreKeys(a(this),c),b.handleAutoComplete(c)}).on("click.dropdown",function(a){a.stopPropagation()}).on("mouseup.dropdown",function(a){2!==a.button&&b.toggleList()}).on("touchend.dropdown touchcancel.dropdown",function(a){a.stopPropagation(),b.toggleList(),a.preventDefault()}),b.element.on("activated.dropdown",function(){b.label.trigger("click")}).on("updated.dropdown",function(a){a.stopPropagation(),b.updated()}).on("openlist.dropdown",function(){b.toggleList()}),b.element.closest("form").on("reset.dropdown",function(){setTimeout(function(){b.element.triggerHandle("updated")},1)}),this.label.onTouchClick().on("click",function(){b.pseudoElem.focus()})},ignoreKeys:function(a,b){var c=b.which;if(b.altKey&&(38===c||40===c))return b.stopPropagation(),b.preventDefault(),!1;if(8===c&&a.hasClass("dropdown"))return b.stopPropagation(),b.preventDefault(),!1;if(!a.is(":disabled")&&!a.hasClass("is-readonly"))return!0},handleSearchEvents:function(){var b,c=this;this.settings.noSearch&&this.searchInput.prop("readonly",!0),this.searchKeyMode=!1,this.searchInput.on("keydown.dropdown",function(d){var e=a(this);c.ignoreKeys(e,d)&&c.handleKeyDown(e,d)&&(c.settings.noSearch!==!1||c.settings.source||(clearTimeout(b),b=setTimeout(function(){""===e.val()?c.resetList():c.filterList(e.val().toLowerCase())},100)))}).on("keypress.dropdown",function(a){c.isFiltering=!0,c.handleAutoComplete(a)})},filterList:function(b){var c=this,d=!1;b||(b=""),this.list.addClass("search-mode"),this.list.find(".icon").attr("class","icon search").changeIcon("search"),this.listUl.find("li").hide(),this.searchInput.removeAttr("aria-activedescendant"),this.unhighlightOptions(),a.each(this.element[0].options,function(){var e=a(this),f=e.text(),g=c.listUl.find('li[data-val="'+e.val()+'"]'),h=!1;if(f&&-1!==f.toString().toUpperCase().indexOf(b.toUpperCase())&&(h=!0),h){d||(c.highlightOption(g),d=!0);var i=new RegExp("("+b+")","i");f=g.text().replace(i,"<i>$1</i>"),g.show().children("a").html(f)}}),b="",c.list.hasClass("is-ontop")&&c.list.css({top:c.pseudoElem.offset().top-c.list.height()+c.pseudoElem.outerHeight()-2})},resetList:function(){function b(a){return a[0]?a[0].textContent||a[0].innerText:""}var c="icon"+(this.isMobile()?" close":""),d=a.getBaseURL(this.isMobile()?"close":"dropdown");this.list.removeClass("search-mode"),this.list.find(".icon").attr("class",c).changeIcon(d);var e=this.listUl.find("li");e.removeAttr("style").each(function(){var c=a(this).children("a");c.text(b(c))}),this.list.hasClass("is-ontop")&&this.list.css({top:this.pseudoElem.offset().top-this.list.height()+this.pseudoElem.outerHeight()-2}),this.settings.multiple&&this.updateList()},selectBlank:function(){var b=this.element.find("option").filter(function(){return!this.value||0===a.trim(this.value).length});b.length>0&&(b[0].selected=!0,this.element.triggerHandler("updated").triggerHandler("change"))},handleKeyDown:function(b,c){var d,e=this.element[0].selectedIndex,f=this.element[0].options,g=c.which,h=this,i="li:visible:not(.separator):not(.group-label):not(.is-disabled)";if(!h.isOpen()&&(38===g||40===g||32===g))return void h.toggleList();switch(h.isOpen()&&(f=this.listUl.find(i),e=-1,a(f).each(function(b){a(this).is(".is-focused")&&(e=b)})),g){case 37:case 8:case 46:if(!h.isOpen())return h.selectBlank(),c.stopPropagation(),c.preventDefault(),!1;break;case 9:return h.isOpen()&&(h.closeList(!1),this.activate()),!0;case 27:if(h.isOpen())return h.closeList(!0),h.activate(),c.stopPropagation(),!1;break;case 32:case 13:if(h.isOpen()){if(32===g&&h.searchKeyMode===!0)break;c.preventDefault(),h.selectOption(a(f[e])),h.settings.closeOnSelect&&(h.closeList(!1),h.activate())}return c.stopPropagation(),!1;case 38:if(c.shiftKey)return;return this.searchKeyMode=!1,e>0&&(d=a(f[e-1]),this.highlightOption(d),d.parent().find(".is-focused").removeClass("is-focused"),d.addClass("is-focused")),c.stopPropagation(),c.preventDefault(),!1;case 40:if(c.shiftKey)return;return this.searchKeyMode=!1,e<f.length-1&&(d=a(f[e+1]),this.highlightOption(d),d.parent().find(".is-focused").removeClass("is-focused"),d.addClass("is-focused")),c.stopPropagation(),c.preventDefault(),!1;case 35:this.searchKeyMode=!1;var j=a(f[f.length-1]);return this.highlightOption(j),c.stopPropagation(),!1;case 36:this.searchKeyMode=!1;var k=a(f[0]);return this.highlightOption(k),c.stopPropagation(),!1}return h.isOpen()&&h.isControl(g)&&8!==g?!1:(h.initialFilter=!1,h.isOpen()||h.isControl(g)||this.settings.source||(h.initialFilter=!0,h.isFiltering=!0,h.filterTerm=a.actualChar(c),h.searchInput.val(a.actualChar(c)),h.toggleList()),this.searchKeyMode=!0,h.searchInput.attr("aria-activedescendant",""),!0)},timer:null,filterTerm:"",handleAutoComplete:function(b){var c=this;clearTimeout(this.timer),c.settings.source&&(c.initialFilter=!0,c.filterTerm+=a.actualChar(b),this.timer=setTimeout(function(){c.isOpen()?c.callSource(function(){c.filterList(c.searchInput.val().toLowerCase())}):(c.searchInput.val(c.filterTerm),c.toggleList())},c.settings.delay))},isControl:function(a){var b=a>7&&48>a||a>90&&94>a||a>111&&146>a;return b},activate:function(b){function c(){d.isMobile()||(e[0].setSelectionRange?e[0].setSelectionRange(0,e[0].value.length):"INPUT"===e[0].tagName&&e[0].select())}var d=this,e=this.pseudoElem;b&&(e=this.searchInput),(!b||!e.hasClass("is-readonly")&&e.prop("readonly")!==!0)&&(c(),document.activeElement!==e[0]&&a(document.activeElement).is("body")&&e[0].focus())},getOptionText:function(b){var c="";return b||(b=this.element.find("option:selected")),b.each(function(){c.length>0&&(c+=", "),c+=a(this).text()}),c},open:function(){var a=this;this.inputTimer()&&(this.element.is(":disabled")||this.pseudoElem.hasClass("is-disabled")||this.pseudoElem.hasClass("is-readonly")||a.callSource(function(){a.updateList(),a.openList()})||(a.updateList(),this.openList()))},openList:function(){function b(b){var c=a(b.target),d=c.closest("li.dropdown-option");d.length&&(c=d),b.preventDefault(),b.stopPropagation();var e=c.attr("data-val"),f=j.element.find('option[value="'+e+'"]');return(0===f.length||f.length>1)&&(f=j.element.find("option").filter(function(){return a(this).text()===e})),f.is(":disabled")?!1:(j.selectOption(f),j.settings.closeOnSelect&&j.closeList(),j.isMobile()?!0:(j.activate(!j.settings.closeOnSelect),!0))}function c(a){return a.closest(".dropdown, .multiselect").length>0||a.closest(".dropdown-list").length>0||j.touchmove===!0}function d(b){k||c(a(b.target))||j.closeList()}function e(b){var d=a(b.target);return k||c(d)&&!d.is(".icon")?(b.preventDefault(),void(k=!1)):void j.closeList()}function f(b){k=!1,h={x:b.originalEvent.touches[0].pageX,y:b.originalEvent.touches[0].pageY},a(document).on("touchmove.dropdown",function(a){var b={x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY};(b.x>=h.x+l||b.x<=h.x-l||b.y>=h.y+l||b.y<=h.y-l)&&(k=!0)})}function g(b){return a(document).off("touchmove.dropdown"),b.preventDefault(),k?!1:void e(b)}var h,i=this.list.find(this.previousActiveDescendant?'.dropdown-option[data-val="'+this.previousActiveDescendant+'"]':".is-selected"),j=this,k=!1,l=10;i.length>0&&(i=i.eq(0)),a("head").triggerHandler("disable-zoom");var m=1===this.element.closest(".field-short").length;if(this.pseudoElem.attr("aria-expanded","true").addClass("is-open"),this.pseudoElem.attr("aria-label",this.label.text()),this.searchInput.attr("aria-activedescendant",i.children("a").attr("id")),a("select").each(function(){var b=a(this).data();b.dropdown&&b.dropdown.closeList()}),this.list.appendTo("body").show(),this.isInGrid=1===this.pseudoElem.closest(".datagrid-row").length,this.isInGrid){var n=this.pseudoElem.closest(".datagrid-row").attr("class").replace("datagrid-row  ","");this.list.addClass("datagrid-dropdown-list "+n)}1===this.pseudoElem.closest(".datagrid-filter-wrapper").length&&this.list.addClass("datagrid-filter-dropdown");var o=this.settings.cssClass;o&&"string"==typeof o&&this.list.addClass(o),this.position(),this.initialFilter?(setTimeout(function(){j.searchInput.val(j.filterTerm),j.filterList(j.searchInput.val())},0),this.initialFilter=!1):this.searchInput.val(this.pseudoElem.text());var p=this.settings.multiple;this.highlightOption(i,p),this.settings.multiple&&this.listUl.find(".is-selected").length>0&&(this.highlightOption(this.listUl.find(".dropdown-option").eq(0)),setTimeout(function(){j.listUl.scrollTop(0)},0)),this.settings.multiple||this.searchInput.val(i.find("a").text()),this.handleSearchEvents(),this.activate(!0),this.element.trigger("listopened"),this.isMobile()&&j.searchInput.on("keypress.dropdown",function(a){13===a.which&&j.closeList()}),j.list.removeClass("dropdown-tall").addClass(m?"dropdown-short":"").onTouchClick("list","li").on("click.list","li",b).on("mouseenter.list","li",function(){var b=a(this);b.is(".separator, .group-label")}),setTimeout(function(){j.list.addClass("is-closable")},100),a(document).on("touchstart.dropdown",f).on("touchend.dropdown touchcancel.dropdown",g).on("click.dropdown",e);var q=j.element.closest(".scrollable").length?j.element.closest(".scrollable"):a(document);q=j.element.closest(".scrollable-y").length?j.element.closest(".scrollable-y"):q,q.on("scroll.dropdown",d),void 0===window.orientation&&a("body").on("resize.dropdown",function(){j.closeList()}),a("head").triggerHandler("enable-zoom")},position:function(){var b=!1,c=!1,d=this.pseudoElem.offset().top,e=this.pseudoElem.offset().left-a(window).scrollLeft();this.isFullScreen()&&(d=0),this.list.css({top:d,left:e}),this.pseudoElem.parentsUntil("body").each(function(){return"fixed"!==a(this).css("position")||a(this).is(".modal")?void 0:void(b=!0)}),b&&this.list.css("position","fixed"),"absolute"===this.pseudoElem.parent(".field").css("position")&&(c=!0,this.list.css({top:this.pseudoElem.parent(".field").offset().top+this.pseudoElem.prev("label").height(),left:this.pseudoElem.parent(".field").offset().left})),this.list.removeClass("is-ontop");var f=d,g=a(window).height()-d-this.pseudoElem.outerHeight();if(f>g&&d-a(window).scrollTop()+this.list.outerHeight()>a(window).height()&&(this.list.css({top:d-this.list.outerHeight()+this.pseudoElem.outerHeight()}),this.list.addClass("is-ontop"),this.listUl.prependTo(this.list)),this.list.offset().top<0){var h=this.list.outerHeight(),i=-1*this.list.offset().top;this.list.css("top",0),this.list.height(h-i-5)}if(this.list.offset().top-a(window).scrollTop()+this.list.outerHeight()>a(window).height()){var j=a(window).height()-this.list.offset().top-5;this.list.height(j)}if(this.list.find("input").outerWidth(this.pseudoElem.outerWidth()-2),this.list.width()>this.pseudoElem.outerWidth()&&!this.isInGrid){this.list.css("width",""),this.list.css({width:this.list.outerWidth()+35}),this.list.find("input").css({width:this.list.outerWidth()+35});var k=a(window).width()-parseInt(this.list.css("left"),10);this.list.width()>k&&this.list.width(k-20)}else this.list.width(this.pseudoElem.outerWidth()-2),this.isInGrid&&this.list.width(this.pseudoElem.outerWidth())},close:function(){return this.closeList()},closeList:function(){this.list&&this.list.is(":visible")&&this.isListClosable()&&this.inputTimer()&&(this.touchmove&&(this.touchmove=!1),this.filterTerm="",this.searchInput.off("keydown.dropdown keypress.dropdown keypress.dropdown"),this.list.hide().remove(),this.list.off("click.list touchmove.list touchend.list touchcancel.list mousewheel.list mouseenter.list"),this.listUl.find("li").show(),this.pseudoElem.removeClass("is-open").attr("aria-expanded","false"),this.searchInput.removeAttr("aria-activedescendant"),a(document).off("click.dropdown scroll.dropdown touchmove.dropdown touchend.dropdown touchcancel.dropdown"),a(window).off("resize.dropdown"),this.element.trigger("listclosed"),this.activate())},scrollToOption:function(a){var b=this;a&&0!==a.length&&(b.listUl.scrollTop(0),b.listUl.scrollTop(a.offset().top-b.listUl.offset().top-b.listUl.scrollTop()-40))},handleBlur:function(){var a=this;return this.isOpen()&&(this.timer=setTimeout(function(){a.closeList()},40)),!0},isOpen:function(){return this.list.is(":visible")},toggleList:function(){return this.isOpen()?void this.closeList():void this.open()},highlightOption:function(a,b){if(!a)return a;0===a.length&&(a=this.list.find(".dropdown-option").eq(0));var c=this.element.find('option[value="'+a.attr("data-val")+'"]');c.hasClass(".is-disabled")||c.is(":disabled")||this.isOpen()&&(this.list.find(".is-focused").removeClass("is-focused").attr({tabindex:"-1"}),a.addClass("is-focused").attr({tabindex:"0"}),this.searchInput.attr("aria-activedescendant",a.children("a").attr("id")),b&&b!==!1&&void 0!==b||this.scrollToOption(a))},unhighlightOptions:function(a,b){a&&a.length||(a=this.list.find(".is-selected")),a.removeClass("is-focused").attr({tabindex:"-1"}),this.searchInput.removeAttr("aria-activedescendant"),b&&b!==!1&&void 0!==b||this.scrollToOption(a.first())},selectOption:function(b,c){if(!b)return b;var d;if(b.is("li")&&(d=b,b=this.element.find('option[value="'+b.attr("data-val")+'"]'),0===b.length&&(b=this.element.find("option").filter(function(){return a(this).text()===d.attr("data-val")}))),d||(d=this.listUl.find('li[data-val="'+b.val()+'"]')),!b.hasClass(".is-disabled")&&!b.is(":disabled")&&(this.settings.multiple||b.index()!==this.element[0].selectedIndex)){var e=b.val(),f=this.element.val(),g=this.pseudoElem.text(),h="",i="",j=!0;if(this.settings.multiple){if(f||(f=[]),-1!==a.inArray(e,f))f=a.grep(f,function(a){return a!==e}),d.removeClass("is-selected"),this.previousActiveDescendant=void 0,j=!1;else{if(!isNaN(this.settings.maxSelected)&&this.element.find("option:selected").length>=this.settings.maxSelected)return;f="string"==typeof f?[f]:f,f.push(e),d.addClass("is-selected"),this.previousActiveDescendant=b.val()}var k=this.element.find("option").filter(function(){return-1!==a.inArray(a(this)[0].value,f)});h=this.getOptionText(k)}else f=e,this.listUl.find("li.is-selected").removeClass("is-selected"),d.addClass("is-selected"),this.previousActiveDescendant=b.val(),h=b.text();this.element.find("option").each(function(){return this.value===e?(this.selected=!0,!1):void 0}),h!==g&&(this.pseudoElem.find("span").text(h),this.searchInput.val(h),this.element.attr("maxlength")&&(i=h.substr(0,this.element.attr("maxlength")),this.pseudoElem.find("span").text(i),this.searchInput.val(i)),c||this.element.val(f).trigger("change").triggerHandler("selected",[b,j]),this.settings.multiple&&(this.list.hasClass("search-mode")&&this.resetList(),this.activate(!0)),this.setBadge(b))}},setBadge:function(a){if(this.badges){var b=this.element.parent().find(".badge");0===b.length&&(this.element.parent().find(".dropdown-wrapper").append('<span class="badge">1</span>'),b=this.element.parent().find(".badge")),b.attr("class","badge "+(a.attr("data-badge-color")?a.attr("data-badge-color"):"azure07")).text(a.attr("data-badge"))}},callSource:function(b){var c=this,d="";if(this.settings.source){d=c.searchInput.val(),this.isFiltering||(d=""),this.isFiltering=!1;var e=typeof this.settings.source,f=function(a){function e(a){var b="string"==typeof a;null!==a&&void 0!==a&&(f+="<option"+(void 0===a.id?"":' id="'+a.id.replace('"',"'")+'"')+(void 0!==a.value?' value="'+a.value.replace('"',"'")+'"':b?' value="'+a.replace('"',"'")+'"':"")+(a.value===g||a.selected?" is-selected ":"")+">"+(void 0!==a.label?a.label:void 0!==a.value?a.value:b?a:"")+"</option>")}var f="",g=c.element.val();c.element.empty();for(var h=0;h<a.length;h++){var i;if(a[h].group){i=a[h].options,f+='<optgroup label="'+a[h].group+'">';for(var j=0;j<i.length;j++)e(i[j]);f+="</optgroup>"}else e(a[h])}c.element.append(f),c.updateList(),c.pseudoElem.removeClass("is-busy"),c.element.trigger("requestend",[d,a]),b()};if(c.pseudoElem.addClass("is-busy"),c.element.trigger("requeststart"),"function"===e)this.settings.source(f,d);else if("object"===e){var g=a.isArray(this.settings.source)?this.settings.source:[this.settings.source];f(g)}else{var h=this.settings.source.toString(),i=a.getJSON(h);i.done(function(a){f(a)}).fail(function(){f([])})}return!0}return!1},setCode:function(b){var c=this,d=function(){var d=null;c.element.find("option").each(function(){this.value===b&&(d=a(this))}),c.selectOption(d,!0)};c.callSource(d)||d()},isMobile:function(){return a("html").is(".ios, .android")},isFullScreen:function(){return this.isMobile()&&a(window).width()<767},isListClosable:function(){return this.list.hasClass("is-closable")},disable:function(){this.element.prop("disabled",!0).prop("readonly",!1),this.pseudoElem.is(a(document.activeElement))&&this.pseudoElem.blur(),this.pseudoElem.addClass("is-disabled").removeClass("is-readonly").attr("tabindex","-1").prop("readonly",!1).prop("disabled",!0),this.closeList()},enable:function(){this.element.prop("disabled",!1).prop("readonly",!1),this.pseudoElem.prop("disabled",!1).prop("readonly",!1).attr("tabindex","0").removeClass("is-disabled").removeClass("is-readonly")},readonly:function(){this.element.prop("disabled",!1).prop("readonly",!0),this.pseudoElem.removeClass("is-disabled").addClass("is-readonly").attr("tabindex","0").prop("disabled",!1).prop("readonly",!0),this.closeList()},updated:function(){return this.closeList(),this.settings.multiple&&this.settings.multiple===!0?this.element.prop("multiple",!0):this.element.prop("multiple",!1),this.element.prop("readonly")===!0?this.readonly():this.pseudoElem.removeClass("is-readonly"),this.pseudoElem[this.element.prop("disabled")?"addClass":"removeClass"]("is-disabled"),this.updateList(),this.setValue(),this.element.trigger("has-updated"),this},destroy:function(){a.removeData(this.element[0],d),this.closeList(),this.label.remove(),this.pseudoElem.off().remove(),this.icon.remove(),this.wrapper.remove(),this.element.removeAttr("style")}},this.each(function(){var b=a.data(this,d);b?(b.settings=a.extend({},f,b.settings),b.updated()):b=a.data(this,d,new c(this,f))})},a.fn.drag=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="drag",e={axis:null,clone:!1,cloneAppentTo:null,containment:!1,obstacle:!1},f=a.extend({},e,b);return c.prototype={init:function(){this.handleEvents()},handleEvents:function(){var b=this;b.offset=null,b.element.attr("draggable",!1),"onpointerdown"in window||"onmspointerdown"in window||b.element.on("touchstart.draggable gesturestart.draggable",function(c){var d=a(this).position(),e=c.originalEvent;b.offset={x:e.changedTouches[0].pageX-d.left,y:e.changedTouches[0].pageY-d.top},b.originalPos=d,b.element.addClass("is-dragging"),b.element.trigger("dragstart",d)}).on("touchmove.draggable gesturechange.draggable",function(a){a.preventDefault();var c=a.originalEvent;c.targetTouches.length>1||b.move(c.changedTouches[0].pageX-b.offset.x,c.changedTouches[0].pageY-b.offset.y)}).on("touchend.draggable gestureend.draggable touchcancel.draggable",function(a){a.preventDefault();var c=a.originalEvent.changedTouches[0];b.finish(c.pageX-b.offset.x,c.pageY-b.offset.y)}),b.element.on("mousedown.draggable",function(c){c.preventDefault();var d=b.element.position();b.offset={x:c.pageX-d.left,y:c.pageY-d.top},b.originalPos=d,a("body").addClass("disable-select"),a(document).on("mousemove.draggable",function(a){a.preventDefault(),b.move(a.pageX-b.offset.x,a.pageY-b.offset.y)}),a(document).on("mouseup.draggable",function(a){a.preventDefault(),b.finish(a.pageX-b.offset.x,a.pageY-b.offset.y)}),b.element.on("mouseup.draggable",function(a){a.preventDefault(),b.finish(a.pageX-b.offset.x,a.pageY-b.offset.y)}),!b.clone&&f.clone&&(b.clone=b.element.clone(!0),"parent"===f.cloneAppentTo&&(f.cloneAppentTo=b.element.parent()),b.clone.appendTo(f.cloneAppentTo||"body")),b.element.addClass("is-dragging"),b.element.trigger("dragstart",[d,b.clone])})},finish:function(b,c){var d={top:c,left:b};this.element.off("mouseup.draggable"),a(document).off("mousemove.draggable mouseup.draggable"),this.element.trigger("dragend",d),this.element.removeClass("is-dragging"),this.clone&&("x"===f.axis&&delete d.top,"y"===f.axis&&delete d.left,this.clone.remove(),this.clone=null),this.obstacle&&(this.obstacle=null),a("body").removeClass("disable-select")},move:function(b,c){var d,e,g=this,h={left:b,top:c};if("x"===f.axis&&delete h.top,"y"===f.axis&&delete h.left,f.containment&&(this.container="parent"===f.containment?this.element.parent():"window"===f.containment?a(window):"container"===f.containment?this.element.closest(".page-container"):a(document),d=this.container.width()-this.element.outerWidth(),e=this.container.height()-this.element.outerHeight(),h.top>e&&(h.top=e),h.left>d&&(h.left=d),h.top<0&&(h.top=0),h.left<0&&(h.left=0),"container"===f.containment&&h.left<=1&&(h.left=1)),f.obstacle){var i=this.clone?this.clone.offset():this.element.offset(),j=this.clone?this.clone.outerWidth():this.element.outerWidth(),k=h.left>i.left;this.obstacle||(this.obstacle=a(f.obstacle).not(this.element),this.constraints={top:this.obstacle.offset().top,left:this.obstacle.offset().left,bottom:this.obstacle.offset().top+this.obstacle.outerHeight(),right:this.obstacle.offset().left+this.obstacle.outerWidth()}),!k&&g.originalPos.left>this.constraints.left&&h.left<=this.constraints.right&&(h.left=this.constraints.right),k&&g.originalPos.left+j<=this.constraints.left&&h.left+j>=this.constraints.left&&(h.left=this.constraints.left-this.obstacle.outerWidth())}this.clone?this.clone.css(h):this.element.css(h),this.element.trigger("drag",h)},destroy:function(){a.removeData(this.element[0],d),this.element.off("touchstart.draggable MSPointerDown.draggable pointerdown.draggable touchmove.draggable touchend.draggable touchcancel.draggable mousedown.draggable")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.editor=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.isMac=a("html").is(".is-mac"),this.isFirefox=a("html").is(".is-firefox"),this.init()}var d="editor",e={buttons:{editor:["header1","header2","separator","bold","italic","underline","separator","justifyLeft","justifyCenter","justifyRight","separator","quote","orderedlist","unorderedlist","separator","anchor","separator","image","separator","source"],source:["bold","italic","underline","separator","anchor","separator","quote","separator","visual"]},delay:200,firstHeader:"h3",secondHeader:"h4",placeholder:null,anchor:{url:"http://www.example.com","class":"hyperlink",target:"New window"},image:{url:"http://lorempixel.com/output/cats-q-c-300-200-3.jpg"}},f=a.extend({},e,b);return c.prototype={init:function(){return this.isFirefox=a("html").is(".is-firefox"),this.parentElements=["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],this.id=a(".editor-toolbar").length+1,this.element.parent(".field").addClass("editor-container"),f.anchor.defaultUrl=f.anchor.url,f.anchor.defaultClass=f.anchor["class"],f.anchor.defaultTargetText=f.anchor.target,f.anchor.targets={"Same window":"","New window":"_blank"},a.each(f.anchor.targets,function(a,b){f.anchor.defaultTargetText.toLowerCase()===a.toLowerCase()&&(f.anchor.target=b,f.anchor.defaultTarget=b)}),f.anchor.defaultTarget||(f.anchor.target&&a.trim(f.anchor.target).length?f.anchor.defaultTarget=f.anchor.target:(f.anchor.defaultTargetText="Same window",f.anchor.defaultTarget=f.anchor.targets[f.anchor.defaultTargetText])),this.setup()},setup:function(){this.isActive=!0,this.modals={},this.initElements().bindSelect().bindPaste().setPlaceholders().bindWindowActions().setupKeyboardEvents().onPasteTriggered()},initElements:function(){var a,b=this.element;return b.attr({contentEditable:!0,"aria-multiline":!0,role:"textbox"}),b.attr("data-editor",!0),this.bindParagraphCreation(a).bindTab(a),this.initToolbar().bindButtons().bindModals().bindAnchorPreview(),this.initTextarea(),this},sourceViewActive:function(){return this.element.hasClass("source-view-active")},setPlaceholders:function(){var a=this;return a.element.on("blur.editor",function(){a.togglePlaceHolder()}).on("keypress",function(){a.togglePlaceHolder()}),a.togglePlaceHolder(),this},togglePlaceHolder:function(){var a=this.element;""===a.text().trim()?a.addClass("editor-placeholder"):a.removeClass("editor-placeholder")},getCurrentElement:function(){return this.sourceViewActive()?this.textarea:this.element},bindParagraphCreation:function(){var a=this,b=a.getCurrentElement();return b.on("keyup.editor",function(b){var c,d=a.getSelectionStart();d&&d.getAttribute("data-editor")&&0===d.children.length&&document.execCommand("formatBlock",!1,"p"),13===b.which&&(d=a.getSelectionStart(),c=d.tagName.toLowerCase(),"li"===c||a.isListItemChild(d)||(b.shiftKey||document.execCommand("formatBlock",!1,"p"),"a"===c&&document.execCommand("unlink",!1,null)))}),this},bindTab:function(){var a=this,b=a.getCurrentElement();return b.on("keydown.editor",function(b){if(9===b.which){var c=a.getSelectionStart().tagName.toLowerCase();"pre"===c&&(b.preventDefault(),document.execCommand("insertHtml",null,"    ")),"li"===c&&(b.shiftKey?document.execCommand("outdent",b):document.execCommand("indent",b))}}),this},getPasteEvent:function(){var a=document.createElement("input"),b="onpaste";return a.setAttribute(b,""),("function"==typeof a[b]?"paste":"input")+".editor"},initToolbar:function(){return this.toolbar?this:(this.toolbar=this.createToolbar(),this.toolbarActions=this.toolbar,this.toolbar.toolbar(),this)},createToolbar:function(){var b=a('<div class="toolbar editor-toolbar formatter-toolbar"></div>').attr("id","editor-toolbar-"+this.id);return this.toolbarButtons(b),b.insertBefore(this.sourceViewActive()?this.element.prev():this.element),b.find("button").tooltip(),b},toolbarButtons:function(b){var c,d,e=this.sourceViewActive()?f.buttons.source:f.buttons.editor,g=b.find(".buttonset");for(g.length||(g=a('<div class="buttonset"></div>').appendTo(b)),c=0;c<e.length;c+=1)d=this.buttonTemplate(e[c]),d&&g.append(d)},switchToolbars:function(){this.destroyToolbar(),this.setupTextareaEvents().initToolbar().bindButtons().bindModals().bindAnchorPreview(),this.bindSelect().bindPaste().setupKeyboardEvents(),this.toolbar.find("button").button()},initTextarea:function(){var a=this;return this.textarea?this:(this.textarea=this.createTextarea(),this.textarea.text(this.element.html().toString()),this.element.on("input.editor keyup.editor",function(){a.textarea.val(a.element.html().toString())}),this.setupTextareaEvents(),this.textarea)},createTextarea:function(){this.sourceView=a("<div></div>").attr({"class":"editor-source editable hidden",id:"editor-source-"+this.id}).insertBefore(this.element),a("<ul></ul>").addClass("line-numbers").appendTo(this.sourceView);var b=a('<div class="text-container"></div>').appendTo(this.sourceView),c="source-textarea-"+(a('[id^="source-textarea-"]').length+1),d=this.element.prev(".label").addClass("audible").text()+" - HTML Source View";a('<label class="audible" for="'+c+'">'+d+"</label>").appendTo(b);var e=a('<textarea id="'+c+'" class="editable"></textarea>').appendTo(b);return e},triggerClick:function(b,c){a('button[data-action="'+c+'"]',this.toolbar).trigger("click.editor")},setupKeyboardEvents:function(){var b=this,c=this.getCurrentElement(),d={b:66,e:69,h:72,i:73,l:76,bl:55,n:56,q:81,r:82,u:85,h3:51,h4:52,sv:192};return c.on("keydown.editor",function(a){switch(a=a?a:window.event,d.charCode=a.which?a.which:a.keyCode?a.keyCode:!1,a.ctrlKey&&d.charCode){case d.h3:b.triggerClick(a,"append-"+f.firstHeader);break;case d.h4:b.triggerClick(a,"append-"+f.secondHeader);break;case d.b:b.triggerClick(a,"bold"),a.preventDefault();break;case d.e:b.triggerClick(a,"justifyCenter");break;case d.h:b.triggerClick(a,"anchor"),a.preventDefault();break;case d.i:b.triggerClick(a,a.shiftKey?"image":"italic"),a.shiftKey||a.preventDefault();break;case d.bl:a.shiftKey&&b.triggerClick(a,"insertunorderedlist"),a.preventDefault();break;case d.l:a.shiftKey||b.triggerClick(a,"justifyLeft"),a.preventDefault();break;case d.n:a.shiftKey&&b.triggerClick(a,"insertorderedlist");break;case d.q:b.triggerClick(a,"append-blockquote");break;case d.r:b.triggerClick(a,"justifyRight");break;case d.u:b.triggerClick(a,"underline"),a.preventDefault();break;case d.sv:b.triggerClick(a,c===b.element?"source":"visual")}}),b.element.on("mousedown.editor","a",function(c){var d=a(this).attr("href");!b.isFirefox&&(b.isMac&&c.metaKey||!b.isMac&&c.ctrlKey)&&(window.open(d,"_blank"),c.preventDefault())}),b},setupTextareaEvents:function(){var a=this;return this.textarea.on("input.editor keyup.editor",function(){a.sourceView.hasClass("hidden")||a.adjustSourceLineNumbers()}).on("focus.editor",function(){a.sourceView.addClass("is-focused")}).on("blur.editor",function(b){a.sourceView.removeClass("is-focused"),a.element.empty().html(a.textarea.val()),a.element.data("validate")&&a.element.data("validate").validate(a.element,!0,b)}),this},adjustSourceLineNumbers:function(){var a=this.textarea.parent(),b=parseInt(this.textarea.css("line-height")),c=this.textarea.innerHeight()-this.textarea.height();this.textarea.css("height","");var d=this.textarea[0].scrollHeight,e=Math.floor((d-c)/b),f=this.sourceView.find(".line-numbers"),g=0;if(!this.lineNumbers||e!==this.lineNumbers){if(this.lineNumbers)if(this.lineNumbers<e)for(;g<e-this.lineNumbers;)f.append('<li role="presentation"><span>'+(f.find("li").length+g+1)+"</span></li>"),g++;else this.lineNumbers>e&&(g=this.lineNumbers-e,f.find("li").slice(-g).remove());else for(this.lineNumbers=e;g<this.lineNumbers;)f.append('<li role="presentation"><span>'+(g+1)+"</span></li>"),g++;this.lineNumbers=e,a.css("width","calc(100% - "+(f.outerWidth()+1)+"px)")}this.textarea.css("height",f[0].scrollHeight+"px")},wrapTextInTags:function(b,c,d){var e,g;switch(d){case"bold":e=["<b>","</b>"];break;case"italic":e=["<i>","</i>"];break;case"underline":e=["<u>","</u>"];break;case"strikethrough":e=["<strike>","</strike>"];break;case"append-blockquote":e=["<blockquote>","</blockquote>"];break;default:e=["",""]}if("anchor"===d){var h=a('<a href="'+b+'">'+c+"</a>");f.anchor["class"]&&a.trim(f.anchor["class"]).length&&h.addClass(f.anchor["class"]),f.anchor.target&&a.trim(f.anchor.target).length&&h.attr("target",f.anchor.target),g=h[0].outerHTML}else g=e[0]+b+c+e[1];return g},insertTextAreaContent:function(b,c){var d,e,f,g,h=this.textarea[0],i=h.value;b=b?b:"",document.selection&&"TEXTAREA"===h.tagName?(a(h).focus(),d=document.selection.createRange(),d.text=this.wrapTextInTags(b,d.text,c),a(h).focus()):h.selectionStart||"0"===h.selectionStart?(e=h.selectionStart,f=h.selectionEnd,g=h.scrollTop,d=this.wrapTextInTags(b,i.substring(e,f),c),h.value=i.substring(0,e)+d+i.substring(f,i.length),a(h).focus(),h.selectionStart=e+d.length,h.selectionEnd=e+d.length,h.scrollTop=g):(h.value+=this.wrapTextInTags(b,h.value,c),
a(h).focus(),h.value=h.value)},buttonTemplate:function(a){var b=this.getButtonLabels(f.buttonLabels),c={bold:'<button type="button" class="btn" title="'+Locale.translate("ToggleBold")+'" data-action="bold" data-element="b">'+b.bold+"</button>",italic:'<button type="button" class="btn" title="'+Locale.translate("ToggleItalic")+'" data-action="italic" data-element="i">'+b.italic+"</button>",underline:'<button type="button" class="btn underline" title="'+Locale.translate("ToggleUnderline")+'" data-action="underline" data-element="u">'+b.underline+"</button>",strikethrough:'<button type="button" class="btn" title="'+Locale.translate("StrikeThrough")+'" data-action="strikethrough" data-element="strike"><strike>A</strike></button>',superscript:'<button type="button" class="btn" title="'+Locale.translate("Superscript")+'" data-action="superscript" data-element="sup">'+b.superscript+"</button>",subscript:'<button type="button" class="btn" title="'+Locale.translate("Subscript")+'" data-action="subscript" data-element="sub">'+b.subscript+"</button>",separator:'<div class="separator"></div>',anchor:'<button type="button" class="btn" title="'+Locale.translate("InsertAnchor")+'" data-action="anchor" data-modal="editor-modal-url" data-element="a">'+b.anchor+"</button>",image:'<button type="button" class="btn" title="'+Locale.translate("InsertImage")+'" data-action="image" data-modal="editor-modal-image" data-element="img">'+b.image+"</button>",header1:'<button type="button" class="btn" title="'+Locale.translate("ToggleH3")+'" data-action="append-'+f.firstHeader+'" data-element="'+f.firstHeader+'">'+b.header1+"</button>",header2:'<button type="button" class="btn" title="'+Locale.translate("ToggleH4")+'" data-action="append-'+f.secondHeader+'" data-element="'+f.secondHeader+'">'+b.header2+"</button>",quote:'<button type="button" class="btn" title="'+Locale.translate("Blockquote")+'" data-action="append-blockquote" data-element="blockquote">'+b.quote+"</button>",orderedlist:'<button type="button" class="btn" title="'+Locale.translate("OrderedList")+'" data-action="insertorderedlist" data-element="ol">'+b.orderedlist+"</button>",unorderedlist:'<button type="button" class="btn" title="'+Locale.translate("UnorderedList")+'" data-action="insertunorderedlist" data-element="ul">'+b.unorderedlist+"</button>",justifyLeft:'<button type="button" class="btn" title="'+Locale.translate("JustifyLeft")+'" data-action="justifyLeft" >'+b.justifyLeft+"</button>",justifyCenter:'<button type="button" class="btn" title="'+Locale.translate("JustifyCenter")+'" data-action="justifyCenter">'+b.justifyCenter+"</button>",justifyRight:'<button type="button" class="btn" title="'+Locale.translate("JustifyRight")+'" data-action="justifyRight" >'+b.justifyRight+"</button>",source:'<button type="button" class="btn" title="'+Locale.translate("ViewSource")+'" data-action="source" >'+b.source+"</button>",visual:'<button type="button" class="btn" title="'+Locale.translate("ViewVisual")+'" data-action="visual" >'+b.visual+"</button>"};return c[a]||!1},getIcon:function(b,c,d){return'<span class="audible">'+Locale.translate(b)+"</span>"+a.createIcon({classes:d?d:"",icon:c})},getButtonLabels:function(a){var b,c,d={bold:this.getIcon("Bold","bold"),italic:this.getIcon("Italic","italic"),underline:this.getIcon("Underline","underline"),superscript:'<span aria-hidden="true"><b>x<sup>1</sup></b></span>',subscript:'<span aria-hidden="true"><b>x<sub>1</sub></b></span>',anchor:this.getIcon("InsertAnchor","link"),image:this.getIcon("InsertImage","insert-image"),header1:this.getIcon("ToggleH3","h3"),header2:this.getIcon("ToggleH4","h4"),quote:this.getIcon("Blockquote","quote"),orderedlist:this.getIcon("OrderedList","number-list"),unorderedlist:this.getIcon("UnorderedList","bullet-list"),pre:'<span aria-hidden="true"><b>0101</b></span>',indent:'<span aria-hidden="true"><b>&rarr;</b></span>',outdent:'<span aria-hidden="true"><b>&larr;</b></span>',justifyLeft:this.getIcon("JustifyLeft","left-text-align"),justifyCenter:this.getIcon("JustifyCenter","center-text"),justifyRight:this.getIcon("JustifyRight","right-text-align"),source:this.getIcon("ViewSource","html","html-icon"),visual:this.getIcon("ViewSource","visual","visual-icon")};if("object"==typeof a&&(b=a),"object"==typeof b)for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},activateButton:function(a){this.toolbar.find('[data-element="'+a+'"]').addClass("is-active")},bindButtons:function(){var b=this;return this.toolbar.on("touchstart.editor click.editor","button",function(c){var d=a(this),e=d.attr("data-action");if(!d.is(".btn-actions"))return c.preventDefault(),b.getCurrentElement().focus(),void 0===b.selection&&b.checkSelection(),b.sourceViewActive()||d.toggleClass("is-active"),e&&b.execAction(e,c),!1}),this},bindModals:function(){var b=this;return b.modals={url:b.createURLModal(),image:b.createImageModal()},a('[name="em-target"]').dropdown(),a("#editor-modal-url, #editor-modal-image").modal().on("beforeopen",function(){return b.savedSelection=b.saveSelection(),"editor-modal-url"!==a(this).attr("id")||b.selectionRange,void 0}).off("open").on("open",function(){var b=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),c=a(this).attr("id"),d=a("input:first",this),e=a(".modal-buttonset .btn-modal-primary",this);a('[name="em-url"]').val(f.anchor.url),a('[name="em-class"]').val(f.anchor["class"]),a('[name="em-target"]').val(f.anchor.target).trigger("updated"),setTimeout(function(){b&&"editor-modal-image"===c?e.focus():d.focus().select()},10)}).off("close").on("close",function(c,d){if(b.restoreSelection(b.savedSelection),!d)if("editor-modal-url"===a(this).attr("id")){var e=a(b.findElementInSelection("a",b.element[0]));e.length?b.updateCurrentLink(e):b.createLink(a('[name="em-url"]',this))}else b.insertImage(a("#image").val())}),this},createURLModal:function(){var b="",c=!0,d=a("#editor-modal-url");return d.length>0?d:(a.each(f.anchor.targets,function(a,d){b+='<option value="'+d+'">'+a+"</option>",f.anchor.defaultTargetText.toLowerCase()===a.toLowerCase()&&(c=!1)}),c&&(b+='<option value="'+f.anchor.target+'">'+f.anchor.target+"</option>"),a('<div class="modal editor-modal-url" id="editor-modal-url"></div>').html('<div class="modal-content"><div class="modal-header"><h1 class="modal-title">Insert Url</h1></div><div class="modal-body"><div class="field"><label for="em-url">URL</label><input id="em-url" name="em-url" type="text" value="'+f.anchor.url+'"></div><div class="field"><label for="em-class">Css Class</label><input id="em-class" name="em-class" type="text" value="'+f.anchor["class"]+'"></div><div class="field"><label for="em-target" class="label">Target</label><select id="em-target" name="em-target" class="dropdown">'+b+'</select></div><div class="modal-buttonset"><button type="button" class="btn-modal btn-cancel">Cancel</button><button type="button" class="btn-modal-primary">Insert</button></div></div></div>').appendTo("body"))},createImageModal:function(){var b=a("#editor-modal-image");return b.length>0?b:a('<div class="modal editor-modal-image" id="editor-modal-image"></div>').html('<div class="modal-content"><div class="modal-header"><h1 class="modal-title">Insert Image</h1></div><div class="modal-body"><div class="field"><label for="image">URL</label><input id="image" name="image" type="text" value="'+f.image.url+'"></div><div class="modal-buttonset"><button type="button" class="btn-modal btn-cancel">Cancel</button><button type="button" class="btn-modal-primary">Insert</button></div></div></div>').appendTo("body")},bindAnchorPreview:function(){this.element.find("a").tooltip({content:function(){return a(this).attr("href")}})},updateCurrentLink:function(b){var c=a('[name="em-url"]').val(),d=a('[name="em-class"]').val(),e=a('[name="em-target"]').val();b.attr("href",c&&a.trim(c).length?c:f.anchor.defaultUrl),b.attr("class",d&&a.trim(d).length?d:f.anchor.defaultClass),e&&a.trim(e).length?b.attr("target",e):b.removeAttr("target")},createLink:function(b){var c;if(this.restoreSelection(this.savedSelection),b.val(this.fixLinkFormat(b.val())),f.anchor.url=b.val(),f.anchor["class"]=a('[name="em-class"]').val(),f.anchor.target=a('[name="em-target"]').val(),c=a('<a href="'+b.val()+'">'+b.val()+"</a>"),f.anchor["class"]&&a.trim(f.anchor["class"]).length&&c.addClass(f.anchor["class"]),f.anchor.target&&a.trim(f.anchor.target).length&&c.attr("target",f.anchor.target),this.sourceViewActive())this.insertTextAreaContent(b.val(),"anchor");else{var d,e;if(this.selection.isCollapsed){var g=this;document.execCommand("insertHtml",null,c[0].outerHTML),setTimeout(function(){g.getCurrentElement().focus()},1)}else if(window.getSelection&&(d=window.getSelection(),d.getRangeAt&&d.rangeCount)){e=d.getRangeAt(0),c.html(e+""),e.deleteContents();var h=document.createElement("div");h.innerHTML=c[0].outerHTML;for(var i,j,k=document.createDocumentFragment();i=h.firstChild;)j=k.appendChild(i);e.insertNode(k),j&&(e=e.cloneRange(),e.setStartAfter(j),e.collapse(!0),d.removeAllRanges(),d.addRange(e))}this.bindAnchorPreview()}},fixLinkFormat:function(a){var b=/^https?:\/\//;return a.match(b)?a:"http://"+a},bindSelect:function(){var a=this,b="";this.selectionHandler=function(){clearTimeout(b),b=setTimeout(function(){a.checkSelection()},f.delay)};var c=a.getCurrentElement();return c.off("mouseup.editor keyup.editor").on("mouseup.editor keyup.editor",this.selectionHandler),this},checkSelection:function(){var a,b;return void 0===this.selection&&this.sourceViewActive()?(a=this.textarea.val().substring(this.textarea[0].selectionStart,this.textarea[0].selectionEnd).toString().trim(),void this.hideToolbarActions()):(a=window.getSelection(),b=this.getSelectionElement(),b?this.checkSelectionElement(a,b):this.hideToolbarActions(),this)},getSelectionElement:function(){var a,b,c,d,e=window.getSelection(),f=function(a){var b=a;try{for(;!b.getAttribute("data-editor");)b=b.parentNode}catch(c){return!1}return b};try{a=e.getRangeAt(0),b=a.commonAncestorContainer,c=b.parentNode,d=b.getAttribute("data-editor")?b:f(c)}catch(g){d=f(c)}return d},checkSelectionElement:function(a,b){var c=this.sourceViewActive()?this.sourceView[0]:this.element[0];return this.selection=a,this.selectionRange=this.selection.getRangeAt(0),c===b?void this.setToolbarButtonStates():void this.hideToolbarActions()},setToolbarButtonStates:function(){var a=this.toolbarActions.find("button");return a.removeClass("is-active"),this.checkActiveButtons(),this},checkActiveButtons:function(){this.checkButtonState("bold"),this.checkButtonState("italic"),this.checkButtonState("underline");for(var a=this,b=this.getSelectedParentElement();void 0!==b.tagName&&-1===this.parentElements.indexOf(b.tagName.toLowerCase)&&(this.activateButton(b.tagName.toLowerCase()),!a.element.is(b));)b=b.parentNode},checkButtonState:function(a){document.queryCommandState&&(document.queryCommandState(a)?this.toolbar.find('[data-action="'+a+'"]').addClass("is-active"):this.toolbar.find('[data-action="'+a+'"]').removeClass("is-active"))},rangeSelectsSingleNode:function(a){var b=a.startContainer;return b===a.endContainer&&b.hasChildNodes()&&a.endOffset===a.startOffset+1},getSelectedParentElement:function(){var a=null,b=this.selectionRange;return a=this.rangeSelectsSingleNode(b)?b.startContainer.childNodes[b.startOffset]:3===b.startContainer.nodeType?b.startContainer.parentNode:b.startContainer},hideToolbarActions:function(){void 0!==this.toolbar&&this.toolbar.removeClass("is-active")},bindPaste:function(){var a=this;a.pasteEvent||(a.pasteEvent=a.getPasteEvent()),this.pasteWrapper=function(b){var c,d,e=b.originalEvent.clipboardData&&b.originalEvent.clipboardData.getData?b.originalEvent.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):!1,f="";if(a.sourceViewActive())return this;if(e&&!b.defaultPrevented){for(b.preventDefault(),c=e.split(/[\r\n]/g),d=0;d<c.length;d+=1)""!==c[d]&&(f+=navigator.userAgent.match(/firefox/i)&&0===d?a.htmlEntities(c[d]):/\.(gif|jpg|jpeg|tiff|png)$/i.test(c[d])?'<img src="'+a.htmlEntities(c[d])+'" />':"<p>"+a.htmlEntities(c[d])+"</p>");if(document.queryCommandSupported("insertText"))return document.execCommand("insertHTML",!1,f),!1;a.pasteHtmlAtCaret(f)}};var b=a.getCurrentElement();return b.on(a.pasteEvent,a.pasteWrapper),this},pasteHtmlAtCaret:function(a){var b,c;if(window.getSelection){if(b=window.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=document.createElement("div");a=a.replace("<p>","").replace("</p>",""),d.innerHTML=a;for(var e,f,g=document.createDocumentFragment();e=d.firstChild;)f=g.appendChild(e);c.insertNode(g),f&&(c=c.cloneRange(),c.setStartAfter(f),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(a)},htmlEntities:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},bindWindowActions:function(){var b=this,c=this.element.closest(".editor-container"),d=b.getCurrentElement();b.element.on("mousedown.editor",function(){b.mousedown=!0}).on("focus.editor",function(){b.isFirefox&&!b.mousedown&&b.element===d&&b.setFocus()}).on("DOMNodeInserted",function(b){var c=a(b.target),d=a("<b>helper</b>");"IMG"===b.target.tagName?c.removeAttr("id style srcset"):"SPAN"===b.target.tagName&&(c.before(d),d.after(c.contents()),d.add(c).remove())}),c.on("focus.editor",".editor, .editor-source",function(){var b=a(this);c.addClass("is-active"),setTimeout(function(){b.hasClass("error")&&(c.parent().find(".editor-toolbar").addClass("error"),c.parent().find(".editor-source").addClass("error"))},100)}).on("blur.editor",".editor, .editor-source",function(){c.removeClass("is-active"),c.parent().find(".editor-toolbar").removeClass("error"),c.parent().find(".editor-source").removeClass("error")});var e=this.element.prevAll(".label");return e.css("cursor","default").on("click.editor",function(){d.focus()}),d.attr("aria-label",e.text()),this},restoreSelection:function(a){var b,c,d=window.getSelection();if(a||(a=this.savedSelection),a)for(d.removeAllRanges(),b=0,c=a.length;c>b;b+=1)d.addRange(a[b])},saveSelection:function(){var a,b,c,d=window.getSelection();if(d.getRangeAt&&d.rangeCount){for(c=[],a=0,b=d.rangeCount;b>a;a+=1)c.push(d.getRangeAt(a));return c}return null},getSelectionStart:function(){var a=document.getSelection().anchorNode,b=a&&3===a.nodeType?a.parentNode:a;return b},getrange:function(){return window.getSelection().getRangeAt(0)},findElementInSelection:function(a,b){var c,d,e,f,g,h=this.getrange();if(h){for(g=h.commonAncestorContainer||h.parentElement(),e=g;e!==b;e=e.parentNode)if(e.tagName&&e.tagName.toLowerCase()===a)return e;if(!h.collapsed&&(void 0===h.text||h.text)&&g.getElementsByTagName)for(e=g.getElementsByTagName(a),f=document.createRange?document.createRange():document.body.createTextRange(),c=0,d=e.length;d>c;c++)if(document.createRange){if(f.selectNodeContents(e[c]),h.compareBoundaryPoints(Range.END_TO_START,f)<0&&h.compareBoundaryPoints(Range.START_TO_END,f)>0)return e[c]}else if(f.moveToElementText(e[c]),h.compareEndPoints("StartToEnd",f)<0&&h.compareEndPoints("EndToStart",f)>0)return e[c]}},restoreLinkSelection:function(){var b=a(this.findElementInSelection("a",this.element[0]));f.anchor.url=f.anchor.defaultUrl,f.anchor["class"]=f.anchor.defaultClass,f.anchor.target=f.anchor.defaultTarget,b.length&&(f.anchor.url=b.attr("href"),f.anchor["class"]=b.attr("class"),f.anchor.target=b.attr("target"))},execAction:function(a){var b=this.getCurrentElement();if(b===this.element)a.indexOf("append-")>-1?(this.execFormatBlock(a.replace("append-","")),this.setToolbarButtonStates()):"anchor"===a?(this.restoreLinkSelection(),this.modals.url.data("modal").open()):"image"===a?this.modals.image.data("modal").open():"source"===a||"visual"===a?this.toggleSource():document.execCommand(a,!1,null);else switch(a){case"visual":this.toggleSource();break;case"anchor":this.modals.url.data("modal").open();break;default:this.insertTextAreaContent(null,a)}},insertImage:function(a){document.execCommand("insertImage",!1,a)},toggleSource:function(){if(this.sourceViewActive())this.element.empty().html(this.textarea.val()),this.element.removeClass("source-view-active hidden"),this.sourceView.addClass("hidden").removeClass("is-focused"),this.element.trigger("focus.editor");else{var a=this.element.html().toString().trim().replace(/\s+/g," ").replace(/<br( \/)?>/g,"<br>\n").replace(/<\/p> /g,"</p>\n\n").replace(/<\/blockquote>( )?/g,"</blockquote>\n\n");this.textarea.val(a).focus(),this.element.addClass("source-view-active hidden"),this.sourceView.removeClass("hidden"),this.adjustSourceLineNumbers(),this.textarea.focus()}this.switchToolbars()},execFormatBlock:function(a){var b=this.getSelectionData(this.selection.anchorNode);if("blockquote"===a&&b.el&&"blockquote"===b.el.parentNode.tagName.toLowerCase())return document.execCommand("outdent",!1,null);if(b.tagName===a&&(a="p"),this.isIE="Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),this.isIE){if("blockquote"===a)return document.execCommand("indent",!1,a);a="<"+a+">"}return document.execCommand("formatBlock",!1,a)},getSelectionData:function(a){var b;for(a&&a.tagName&&(b=a.tagName.toLowerCase());a&&-1===this.parentElements.indexOf(b);)a=a.parentNode,a&&a.tagName&&(b=a.tagName.toLowerCase());return{el:a,tagName:b}},isListItemChild:function(a){for(var b=a.parentNode,c=b.tagName.toLowerCase();-1===this.parentElements.indexOf(c)&&"div"!==c;){if("li"===c)return!0;if(b=b.parentNode,!b||!b.tagName)return!1;c=b.tagName.toLowerCase()}return!1},destroyToolbar:function(){var b=this.getCurrentElement(),c=this.toolbar.data("toolbar");c&&c.destroy();var d=this.toolbar.find("button");d.each(function(){var b=a(this).data("tooltip");b&&"function"==typeof b.destroy&&b.destroy()}),this.toolbar.off("click.editor mousedown.editor"),this.toolbar.remove(),this.toolbar=void 0,this.element.off("mouseup.editor keyup.editor focus.editor blur.editor "+this.pasteEvent),this.textarea.off("mouseup.editor keyup.editor focus.editor blur.editor "+this.pasteEvent),b.off("keydown.editor"),this.element.prev(".label").off("click.editor"),a(window).off("resize.editor"),a.each(this.modals,function(a,b){b.off("beforeclose close open")}),this.modals={},this.element.trigger("destroy.toolbar.editor")},updated:function(){return this},disable:function(){this.element.addClass("is-disabled").attr("contenteditable","false"),this.element.parent(".field").addClass("is-disabled")},enable:function(){this.element.removeClass("is-disabled is-readonly").attr("contenteditable","true"),this.element.parent(".field").removeClass("is-disabled is-readonly")},readonly:function(){this.element.removeClass("is-readonly").attr("contenteditable","false"),this.element.parent(".field").addClass("is-readonly")},setFocus:function(){var b=this,c="<"===a.trim(b.element.html()).slice(0,1)?a(":first-child",b.element)[0]:b.element[0];window.setTimeout(function(){var a,b;window.getSelection&&document.createRange?(b=document.createRange(),b.selectNodeContents(c),b.collapse(!0),a=window.getSelection(),a.removeAllRanges(),a.addRange(b)):document.body.createTextRange&&(b=document.body.createTextRange(),b.moveToElementText(c),b.collapse(!0),b.select())},1)},onPasteTriggered:function(){!this.isFirefox&&document.addEventListener&&document.addEventListener("paste",function(a){if("undefined"!=typeof a.clipboardData){var b=a.clipboardData.items[0];if(0===b.type.indexOf("image")){var c=b.getAsFile(),d=new FileReader;d.onload=function(a){var b=a.target.result;document.execCommand("insertImage",!1,b)},d.readAsDataURL(c)}}},!1)},destroy:function(){a("html").off("mouseup.editor"),this.destroyToolbar(),this.sourceView.remove(),1===a('[data-editor="true"]').length&&a("#editor-modal-url, #editor-modal-image").remove(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})};var F={addGlobalResize:function(){return a(window).on("resize",function(){a("body").triggerHandler("resize",[window])}),this},set:function(){this.makeSohoObject().addBrowserClasses().addPolyfills().addGlobalResize()},addPolyfills:function(){var b=a("html");return(b.hasClass("ie")||b.hasClass("edge"))&&this.polyfillSVG(),this},polyfillSVG:function(){function a(a){a.onreadystatechange=function(){if(4===a.readyState){var c=a._cachedDocument;c||(c=a._cachedDocument=document.implementation.createHTMLDocument(""),c.body.innerHTML=a.responseText,a._cachedTarget={}),a._embeds.splice(0).map(function(d){var e=a._cachedTarget[d.id];e||(e=a._cachedTarget[d.id]=c.getElementById(d.id)),b(d.svg,e)})}},a.onreadystatechange()}function b(a,b){if(b){var c=document.createDocumentFragment(),d=!a.getAttribute("viewBox")&&b.getAttribute("viewBox");d&&a.setAttribute("viewBox",d);for(var e=b.cloneNode(!0);e.childNodes.length;)c.appendChild(e.firstChild);a.appendChild(c)}}function c(){for(var e=0;e<j.length;){var f=j[e],g=f.parentNode;if(g&&/svg/i.test(g.nodeName)){var k=f.getAttribute("xlink:href");if(d){var l=k.substr(k.indexOf("#")+6);g.removeChild(f),g.setAttribute("data-icon",l);var m=k.split("#"),n=m.shift(),o=m.join("#");if(n.length){var p=h[n];p||(p=h[n]=new XMLHttpRequest,p.open("GET",n),p.send(),p._embeds=[]),p._embeds.push({svg:g,id:o}),a(p)}else b(g,document.getElementById(o))}}else++e}i(c,67)}var d,e=/\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/,f=/\bAppleWebKit\/(\d+)\b/,g=/\bEdge\/12\.(\d+)\b/;d=e.test(navigator.userAgent)||(navigator.userAgent.match(g)||[])[1]<10547||(navigator.userAgent.match(f)||[])[1]<537;var h={},i=window.requestAnimationFrame||setTimeout,j=document.getElementsByTagName("use");d&&c()},addBrowserClasses:function(){var b=navigator.userAgent||navigator.vendor||window.opera,c=a("html");if(-1!==b.indexOf("Safari")&&-1===b.indexOf("Chrome")&&-1===b.indexOf("Android")&&c.addClass("is-safari"),-1!==b.indexOf("Mac OS X")&&c.addClass("is-mac"),b.indexOf("Firefox")>0&&c.addClass("is-firefox"),b.match(/Edge\//)&&c.addClass("ie ie-edge"),b.match(/Trident/)&&c.addClass("ie"),(navigator.appVersion.indexOf("MSIE 8.0")>-1||b.indexOf("MSIE 8.0")>-1||8===document.documentMode)&&c.addClass("ie8"),navigator.appVersion.indexOf("MSIE 9.0")>-1&&c.addClass("ie9"),navigator.appVersion.indexOf("MSIE 10.0")>-1?c.addClass("ie10"):b.match(/Trident\/7\./)&&c.addClass("ie11"),/iPhone|iPod|iPad/.test(b)){c.addClass("ios");for(var d=["iPod","iPad","iPhone"],e=0;e<d.length;e++)new RegExp(d[e]).test(b)&&c.addClass(d[e].toLowerCase())}return/Android/.test(b)&&c.addClass("android"),this},makeSohoObject:function(){window.Soho=window.Soho||{},window.Soho.base||a.detectBaseTag(),void 0===window.Soho.svgPath&&(window.Soho.svgPath="/svg/");var b=a("[data-svg-path]").attr("data-svg-path");return b&&(window.Soho.svgPath=b),this}};F.set(),a.fn.expandablearea=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="expandablearea",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.setup().build().handleEvents()},setup:function(){var b;return this.id=b=this.element.attr("id"),b&&void 0!==b||(this.id=b="expandable-area-"+a("body").find(".expandable-area").index(this.element)),this.header=this.element.children(".expandable-header"),this.footer=this.element.children(".expandable-footer"),this.content=this.element.children(".expandable-pane"),this},build:function(){var b=this,c=this.element.hasClass("is-expanded");return this.header.attr({"aria-expanded":""+c,"aria-controls":this.id+"-content",id:this.id+"-header"}),this.content.attr({id:this.id+"-content"}),this.footer.length||(this.footer=a('<div class="expandable-footer"></div>').appendTo(this.element)),this.expander=this.footer.find(".expandable-expander"),this.expander.length||(this.expander=a('<a href="#" target="_self" class="expandable-expander hyperlink"><span data-translated="true">'+Locale.translate("ShowMore")+"</span></a>").prependTo(this.footer)),this.expander.attr("href","#").hideFocus(),c&&(this.content.addClass("no-transition"),this.element.one("afterexpand.expandable-area",function(){b.content.removeClass("no-transition")}),this.open()),c||(this.content.addClass("no-transition"),this.element.one("aftercollapse.expandable-area",function(){b.content.removeClass("no-transition")}),this.close()),this},isDisabled:function(){return this.element.hasClass("is-disabled")},handleEvents:function(){var a=this;return this.expander.onTouchClick("expandablearea").on("click.expandablearea",function(b){a.isDisabled()||(b.preventDefault(),a.toggleExpanded())}),this.header.on("keydown.expandablearea",function(b){a.handleKeys(b)}).on("focus.expandablearea",function(b){a.handleFocus(b)}).on("blur.expandablearea",function(b){a.handleBlur(b)}),this},handleKeys:function(a){if(!this.isDisabled()){var b=a.which;return 13===b||32===b?(a.preventDefault(),this.toggleExpanded(),!1):void 0}},handleFocus:function(){this.isDisabled()||this.header.addClass("is-focused")},handleBlur:function(){this.isDisabled()||this.header.removeClass("is-focused")},toggleExpanded:function(){this.element.is(".is-expanded")?this.close():this.open()},open:function(){var a=this,b=this.element.triggerHandler("beforeexpand",[this.element]);b!==!1&&(this.element.addClass("is-expanded"),this.header.attr("aria-expanded","true"),this.expander.addClass("active"),this.element.triggerHandler("expand",[this.element]),this.expander.find('span[data-translated="true"]').text(Locale.translate("ShowLess")?Locale.translate("ShowLess"):"Show Less"),this.content.css("display","block").one("animateopencomplete",function(){a.element.triggerHandler("afterexpand",[a.element])}).animateOpen())},close:function(){var a=this,b=this.element.triggerHandler("beforecollapse",[this.element]);b!==!1&&(this.expander.removeClass("active"),this.element.triggerHandler("collapse",[this.element]),this.expander.find('span[data-translated="true"]').text(Locale.translate("ShowMore")?Locale.translate("ShowMore"):"Show More"),this.content.one("animateclosedcomplete",function(){a.element.removeClass("is-expanded"),a.header.attr("aria-expanded","false"),a.element.triggerHandler("aftercollapse",[a.element]),a.content.css("display","none")}).animateClosed())},disable:function(){this.element.addClass("is-disabled")},enable:function(){this.element.removeClass("is-disabled")},destroy:function(){this.header.children("a").offTouchClick("expandablearea").off(),this.header.off(),this.header.removeAttr("aria-controls").removeAttr("aria-expanded").removeAttr("id"),this.content.removeAttr("id").removeClass("no-transition"),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.disable=function(){return a.each(this.data(),function(a,b){b instanceof jQuery||b.disable&&b.disable()}),this.prop("disabled",!0),this},a.fn.enable=function(){return a.each(this.data(),function(a,b){b instanceof jQuery||b.enable&&b.enable()}),this.prop("disabled",!1),this},a.fn.readonly=function(){return a.each(this.data(),function(a,b){b instanceof jQuery||b.readonly&&b.readonly()}),this.prop("readonly",!0),this},a.fn.trackdirty=function(){return this.each(function(){function b(a){switch(a.attr("type")){case"checkbox":case"radio":return a.prop("checked");default:return a.val()}}var c=a(this);c.data("original",b(c)).on("change.dirty",function(){var c=a(this),d=c,e=c.closest(".field"),f="";if("true"===c.attr("data-trackdirty"))return c.addClass("dirty"),("checkbox"===c.attr("type")||"radio"===c.attr("type"))&&(f+=" dirty-"+c.attr("type")+(c.is(":checked")?" is-checked":"")),c.is("select")&&(f+=" is-select",d=a('.dropdown-wrapper input[type="text"]',e)),d.prev().is(".icon-dirty")||(d.before('<span class="icon-dirty'+f+'"></span>'),a("label:visible",e).append('<span class="audible msg-dirty">'+Locale.translate("MsgDirty")+"</span>")),b(c)===c.data("original")?(c.removeClass("dirty"),a(".icon-dirty, .msg-dirty",e).remove(),void c.trigger("pristine")):void c.trigger("dirty")})}),this},a(function(){var b,c,d=a(".label-text"),e=d.closest("label, .label");e.each(function(){c=a("input, textarea, select",this),b=c.attr("class"),a(this).addClass(function(){return"inline"+(b?" inline-"+(-1===b.indexOf(" ")?b:b.substr(0,b.indexOf(" "))):"")})})}),a(function(){a("input:radio").on("click.radios",function(){this.focus()})}),a.fn.fileupload=function(){"use strict";function b(b){this.element=a(b),this.init()}var c="fileupload";return b.prototype={init:function(){this.build()},build:function(){var b=this.element;this.fileInput=b.find("input"),b.parent(".field").addClass("field-fileupload");var c=b.find("input").attr("name"),d=b.find("input").attr("class"),e=Locale.translate("FileUpload"),f=a('<label for="'+c+'-filename">'+b.text()+' <span class="audible">'+e+"</span></label>"),g=a('<input id="'+c+'-filename" class="'+d+'" type="text">'),h='<span class="trigger" tabindex="-1">'+a.createIcon("folder")+"</span>";b.before(f,g),this.fileInput.after(h),this.textInput=b.parent().find('[type="text"]'),this.textInput.on("keypress.fileupload",function(a){13===a.which&&b.find("input").trigger("click")}),this.fileInput.is(":disabled")&&this.textInput.prop("disabled",!0),this.fileInput.attr("readonly")&&(this.textInput.prop("disabled",!1),this.textInput.attr("readonly","readonly"),this.fileInput.attr("disabled","disabled")),this.fileInput.attr("tabindex","-1").on("change.fileupload",function(){var c=a(this);b.prev("input").val(c.val())})},destroy:function(){a.removeData(this.element[0],c)},disable:function(){this.textInput.prop("disabled",!0),this.fileInput.prop("disabled",!0)},enable:function(){this.textInput.prop("disabled",!1).prop("readonly",!1),this.fileInput.removeAttr("disabled")},readonly:function(){this.textInput.prop("readonly",!0),this.fileInput.prop("disabled",!0)}},this.each(function(){var d=a.data(this,c);d||(d=a.data(this,c,new b(this)))})},a.fn.fileuploadadvanced=function(b){"use strict";function c(b){this.element=a(b),this.settings=f,this.init()}var d="fileuploadadvanced",e={isStandalone:!0,standaloneClass:"standalone",allowedTypes:"*",maxFilesInProcess:99999,maxFileSize:-1,fileName:"myfile",textDropArea:"Drag and Drop File to Upload",textBtnCancel:"Cancel uploading this file",textBtnCloseError:"Close this error",textBtnRemove:"Remove from server this file",errorAllowedTypes:"<em>"+Locale.translate("Error")+"</em>: "+Locale.translate("ErrorAllowedTypes"),errorMaxFileSize:"<em>"+Locale.translate("Error")+"</em>: "+Locale.translate("ErrorMaxFileSize"),errorMaxFilesInProcess:"<em>"+Locale.translate("Error")+"</em>: "+Locale.translate("ErrorMaxFilesInProcess")},f=a.extend({},e,b);return c.prototype={init:function(){this.build(),this.handleEvents()},build:function(){var b=this.settings,c=b.isStandalone?b.standaloneClass:"";this.element.append('<div class="fileupload-wrapper '+c+'"><div class="container drop-area">'+a.createIcon("upload-adv")+"<p>"+b.textDropArea+"</p></div></div>"),this.dropArea=a(".drop-area",this.element)},handleEvents:function(){var b=this,c=this.settings;b.dropArea.on("dragenter.fileuploadadvanced",function(c){b.element.triggerHandler("filesdragenter"),c.stopPropagation(),c.preventDefault(),a(this).addClass("hover")}).on("dragover.fileuploadadvanced",function(a){a.stopPropagation(),a.preventDefault()}).on("drop.fileuploadadvanced",function(d){var e=d.originalEvent.dataTransfer.files;return d.preventDefault(),b.element.triggerHandler("filesdroped",[e]),a(this).removeClass("hover"),a("span.msg",this.element).closest(".error").remove(),e.length+a(".progress",this.element).length>c.maxFilesInProcess?void b.showError(c.errorMaxFilesInProcess):void b.handleFileUpload(e)}),a(document).on("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced",function(a){
a.stopPropagation(),a.preventDefault(),"dragover"===a.type&&b.dropArea.removeClass("hover")})},handleFileUpload:function(a){for(var b=this.settings.fileName.replace("[]",""),c=0,d=a.length;d>c;c++)if(this.isFileTypeAllowed(a[c].name))if(-1!==f.maxFileSize&&a[c].size>f.maxFileSize)this.showError(f.errorMaxFileSize,a[c]);else{this.element.triggerHandler("beforecreatestatus",[a[c]]);var e=new FormData;e.append(b+"[]",a[c]);var g=this.createStatus(a[c]);this.element.triggerHandler("aftercreatestatus",[a[c]]),this.sendFileToServer(e,g)}else this.showError(f.errorAllowedTypes,a[c])},createStatus:function(b){var c=this,d=this.settings,e=a('<div class="container"><div class="file-row"><span class="status-icon"><button type="button" class="btn-icon action">'+a.createIcon({icon:"close",classes:["icon-close"]})+"<span>"+d.textBtnCancel+'</span></button></span><span class="description">'+b.name+'</span><div class="l-pull-right"><span class="size">'+c.formatFileSize(b.size)+'</span></div></div><div class="progress-row"><span class="progress"><span class="progress-bar" data-value="0"></span></span></div></div>'),f=a(".action",e).button(),g=a(".l-pull-right",e),h=a(".progress-bar",e).progress({animationLength:10});c.dropArea.after(e);var i=function(a){c.element.triggerHandler("fileprogress",[{file:b,progress:a}]),h.attr("data-value",a).triggerHandler("updated")},j=function(a){f.on("click.fileuploadadvanced",function(){c.element.triggerHandler("fileaborted",[b]),a.abort(),e.remove()})},k=function(i){e.addClass("completed"),f.after(a.createIcon("check")),g.append('<button type="button" class="btn-icon action">'+a.createIcon({classes:["icon-close"],icon:"close"})+"<span>"+d.textBtnRemove+"</span></button>"),a(".action",g).button().on("click.fileuploadadvanced",function(){e.remove(),i.remove()}),f.add(h.closest(".progress-row")).remove(),c.element.triggerHandler("filecompleteuploading",[b])};return{file:b,container:e,setProgress:i,setAbort:j,setCompleted:k}},sendFileToServer:function(b,c){var d={abort:function(){}},e={remove:function(){}},f=0,g=parseFloat(c.file.size),h=new a.fn.timer(function(){c.setCompleted(e)},g);a(h.event).on("update",function(a,b){f=Math.ceil(b.counter/g*100),c.setProgress(f)}),c.setAbort(d)},sendFileToServer2:function(b,c){this.element.triggerHandler("beforeuploading",[b]);var d="http://myserver.com/upload/upload.php",e=a.ajax({xhr:function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(a){var b=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(b=Math.ceil(d/e*100)),c.setProgress(b)},!1),b},url:d,type:"POST",contentType:!1,processData:!1,cache:!1,data:b,success:function(a){c.setCompleted(a)}});c.setAbort(e)},showError:function(b,c){var d;d=a(b===this.settings.errorMaxFilesInProcess?'<div class="container error"><div class="file-row"><span class="status-icon"><button type="button" class="btn-icon action">'+a.createIcon({classes:["icon-close"],icon:"close"})+"<span>"+f.textBtnCloseError+'</span></button></span><span class="msg">'+b+"</span></div></div>":'<div class="container error"><div class="file-row"><span class="status-icon"><button type="button" class="btn-icon action">'+a.createIcon({classes:["icon-close"],icon:"close"})+"<span>"+f.textBtnCloseError+'</span></button></span><span class="description">'+c.name+'</span><div class="l-pull-right"><span class="size">'+this.formatFileSize(c.size)+'</span></div></div><div class="msg"><p>'+b+"</p></div></div>"),a(".action",d).button().on("click.fileuploadadvanced",function(){d.remove()}),this.dropArea.after(d)},isFileTypeAllowed:function(b){var c=this.settings.allowedTypes.toLowerCase().split(/[\s|]+/g),d=b.split(".").pop().toLowerCase();return"*"!==this.settings.allowedTypes&&a.inArray(d,c)<0?!1:!0},formatFileSize:function(a){var b={GB:1e9,MB:1e6,KB:1e3};return"number"!=typeof a?"":a>=b.GB?(a/b.GB).toFixed(2)+" GB":a>=b.MB?(a/b.MB).toFixed(2)+" MB":(a/b.KB).toFixed(2)+" KB"},destroy:function(){this.dropArea.off("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced"),a(document).off("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced"),a(".action",this.element).off("click.fileuploadadvanced"),a(".fileupload-wrapper",this.element).remove(),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.header=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="header",e={demoOptions:!0,useBackButton:!0,useBreadcrumb:!1,usePopupmenu:!1,tabs:null,wizardTicks:null,useAlternate:!1,addScrollClass:!1},f=a.extend({},e,b);return c.prototype={init:function(){this.setup().build().handleEvents(),this.settings.demoOptions&&this.initPageChanger()},setup:function(){return this.settings.demoOptions=this.element.attr("data-demo-options")?"true"===this.element.attr("data-demo-options"):this.settings.demoOptions,this.settings.useBackButton=this.element.attr("data-use-backbutton")?"true"===this.element.attr("data-use-backbutton"):this.settings.useBackButton,this.settings.useBreadcrumb=this.element.attr("data-use-breadcrumb")?"true"===this.element.attr("data-use-breadcrumb"):this.settings.useBreadcrumb,this.settings.useAlternate=this.element.attr("data-use-alternate")?"true"===this.element.attr("data-use-alternate"):this.settings.useAlternate,this.settings.tabs=a.isArray(this.settings.tabs)?this.settings.tabs:null,this.settings.wizardTicks=a.isArray(this.settings.wizardTicks)?this.settings.wizardTicks:null,this.titleText=this.element.find(".title > h1"),this.levelsDeep=[],this.levelsDeep.push(""+this.titleText.text()),this},build:function(){if(this.toolbarElem=this.element.find(".toolbar"),!this.toolbarElem.data("toolbar")){var b=a.fn.parseOptions(this.toolbarElem);this.toolbarElem.toolbar(b)}if(this.toolbar=this.toolbarElem.data("toolbar"),this.titleButton=this.element.find(".title > .application-menu-trigger"),this.hasTitleButton=this.titleButton.length>0,this.hasTitleButton){this.toolbarElem.addClass("has-title-button");var c=a("#application-menu").data("application-menu");c||a("#application-menu").applicationmenu({triggers:[this.titleButton]})}if(this.settings.tabs&&this.settings.tabs.length&&this.buildTabs(),this.settings.wizardTicks&&this.settings.wizardTicks.length&&this.buildWizard(),this.settings.usePopupmenu&&this.buildPopupmenu(),this.settings.addScrollClass){var d=a(this.element),e=a(this.element).next(".scrollable"),f=1===e.length?e:a(window),g=this.settings.scrollThreshold?this.settings.scrollThreshold:15;f.on("scroll.header",function(){this.scrollTop>g?d.addClass("is-scrolled-down"):d.removeClass("is-scrolled-down")}),f.scrollTop()>g&&d.addClass("is-scrolled-down")}return this},buildTitleButton:function(){this.levelsDeep.length>1&&!this.hasTitleButton&&!this.titleButton.length&&(this.titleButton=a('<button class="btn-icon back-button" type="button"></button>'),this.titleButton.html('<span class="audible">'+Locale.translate("Drillup")+'</span><span class="icon app-header go-back"><span class="one"></span><span class="two"></span><span class="three"></span></span>'),this.titleButton.prependTo(this.element.find(".title")),this.toolbar.element.triggerHandler("updated")),this.titleButton.find(".icon.app-header").addClass("go-back")},buildBreadcrumb:function(){var b=this,c="has-breadcrumb";this.settings.useAlternate&&(c="has-alternate-breadcrumb"),this.element.addClass(c),this.breadcrumb=this.element.find(".breadcrumb"),this.breadcrumb.length||(this.breadcrumb=a('<nav class="breadcrumb" role="navigation" style="display: none;"></nav>').appendTo(this.element),this.breadcrumb.on("click","a",function(a){b.handleBreadcrumbClick(a)})),this.breadcrumb[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),this.adjustBreadcrumb()},adjustBreadcrumb:function(){var b=this.levelsDeep[this.levelsDeep.length-1];this.breadcrumb.empty();var c=a('<ol aria-label="breadcrumb"></ol>').appendTo(this.breadcrumb);a.each(this.levelsDeep,function(d,e){var f="";b===e&&(f=" current"),c.append(a('<li><a href="#" class="hyperlink'+f+'">'+e+"</a></li>"))})},buildTabs:function(){if(this.tabsContainer=this.element.find(".tab-container"),!this.tabsContainer.length){this.tabsContainer=a('<div class="tab-container"></div>').appendTo(this.element);var b=a('<ul class="tab-list" role="tablist"></ul>').appendTo(this.tabsContainer);a('<li class="tab"><a href="#header-tabs-home" role="tab">SoHo Xi Controls | Patterns</a></li>').appendTo(b),a('<li class="tab"><a href="#header-tabs-level-1" role="tab">Level 1 Detail</a></li>').appendTo(b),a('<li class="tab"><a href="#header-tabs-level-2" role="tab">Level 2 Detail</a></li>').appendTo(b)}this.element.addClass(this.settings.useAlternate?"has-alternate-tabs":"has-tabs"),this.tabsContainer[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),a("#header-tabs-level-1").removeAttr("style"),a("#header-tabs-level-2").removeAttr("style"),this.tabsContainer.tabs({containerElement:"#maincontent"})},buildWizard:function(){if(this.element.addClass("has-wizard"),this.wizard=this.element.find(".wizard"),!this.wizard.length){this.wizard=a('<div class="wizard"></div>').appendTo(this.element);var b=a('<div class="wizard-header"></div>').appendTo(this.wizard),c=a('<div class="bar"></div>').appendTo(b);a('<div class="completed-range"></div>').appendTo(c),a('<a href="#" class="tick current"><span class="label">Context Apps</span></a>').appendTo(c),a('<a href="#" class="tick"><span class="label">Utility Apps</span></a>').appendTo(c),a('<a href="#" class="tick"><span class="label">Inbound Configuration</span></a>').appendTo(c),a('<a href="#" class="tick"><span class="label">OID Mapping</span></a>').appendTo(c)}this.wizard[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),this.wizard.wizard()},buildPopupmenu:function(){var b=this.toolbarElem.children(".title");if(this.titlePopup=b.find(".btn-menu"),!this.titlePopup.length){var c=b.find("h1");c.wrap('<button id="header-menu" type="button" class="btn-menu"></button>'),this.titlePopup=c.parent(".btn-menu")}this.titlePopupMenu=this.titlePopup.next(".popupmenu"),this.titlePopupMenu.length||(this.titlePopupMenu=a('<ul class="popupmenu is-selectable has-icons"></ul>').insertAfter(this.titlePopup),a('<li class="is-checked"><a href="#">Page One Title</a></li><li><a href="#">Page Two Title</a></li><li><a href="#">Page Three Title</a></li><li class="is-disabled"><a href="#">Page Four Title</a></li><li><a href="#">Page Five Title</a></li>').appendTo(this.titlePopupMenu)),this.titlePopupMenu.addClass("is-selectable"),this.titlePopup.children("h1").text(this.titlePopupMenu.children().first().text()),this.titlePopup.button().popupmenu(),this.toolbarElem.triggerHandler("updated")},handleEvents:function(){var b=this;return this.element.on("updated.header",function(){b.updated()}).on("reset.header",function(){b.reset()}).on("drilldown.header",function(a,c){b.drilldown(c)}).on("drillup.header",function(a,c){b.drillup(c)}),this.titleButton.bindFirst("click.header",function(a){b.levelsDeep.length>1&&(a.stopImmediatePropagation(),b.drillup(),a.returnValue=!1)}),this.settings.usePopupmenu&&this.titlePopup.on("selected.header",function(b,c){a(this).children("h1").text(c.text())}),this},handleBreadcrumbClick:function(b){var c,d=a(b.target).parent(),e=this.breadcrumb.find("li"),f=e.index(d);if(!d.hasClass("current")){if(0===f)return this.reset();if(f<e.length-1)for(c=e.length-1-f;c>0;)this.drillup(),c-=1}},initPageChanger:function(){this.element.find(".page-changer").on("selected.header",function(b,c){if(c.attr("data-theme")){var d=c.attr("data-theme");return void a("body").trigger("changetheme",[d])}if(c.attr("data-lang"))return void Locale.set(c.attr("data-lang"));var e=c.attr("data-rgbcolor");a("body").trigger("personalizecolors",[e])})},drilldown:function(a){this.element.addClass("is-drilldown"),this.levelsDeep.push(a.toString()),this.titleText.text(this.levelsDeep[this.levelsDeep.length-1]),this.settings.useBackButton&&this.buildTitleButton(),this.settings.useBreadcrumb&&(this.breadcrumb&&this.breadcrumb.length?this.adjustBreadcrumb():(this.buildBreadcrumb(),this.breadcrumb.css({display:"block",height:"auto"})))},drillup:function(a){var b;return this.element.removeClass("is-drilldown"),this.levelsDeep.length>1&&(this.levelsDeep.pop(),b=this.levelsDeep[this.levelsDeep.length-1]),void 0!==a&&(b=a),this.levelsDeep.length>1?(this.settings.useBreadcrumb&&this.adjustBreadcrumb(),void this.titleText.text(b)):(b=this.levelsDeep[0],this.settings.useBackButton&&this.removeButton(),this.settings.useBreadcrumb&&this.removeBreadcrumb(),this.settings.usePopupmenu&&this.removePopupmenu(),this.titleText.text(b),void this.element.trigger("drillTop"))},reset:function(){for(;this.levelsDeep.length>1;)this.levelsDeep.pop();return this.titleText.text(this.levelsDeep[0]),this.removeBreadcrumb(),this.removeTabs(),this.removeWizard(),this.removePopupmenu(),this.removeButton(),this.element.trigger("afterreset"),this},removeButton:function(){return this.hasTitleButton?void this.titleButton.find(".icon.app-header").removeClass("go-back"):void(this.titleButton&&this.titleButton.length&&(this.titleButton.remove(),this.titleButton=a(),this.toolbar.element.triggerHandler("updated")))},removeBreadcrumb:function(){function b(){c&&(clearTimeout(c),c=null),d.element.off(e+".breadcrumb-header"),d.breadcrumb.off().remove(),d.breadcrumb=a()}if(this.breadcrumb&&this.breadcrumb.length){var c,d=this,e=a.fn.transitionEndName();d.element.removeClass("has-breadcrumb").removeClass("has-alternate-breadcrumb"),this.breadcrumb.is(":not(:hidden)")?(this.element.one(e+".breadcrumb-header",b),c=setTimeout(b,300)):b()}},removeTabs:function(){function b(){c&&(clearTimeout(c),c=null),d.element.off(e+".tabs-header"),d.tabsContainer.data("tabs").destroy(),d.tabsContainer.remove(),d.tabsContainer=null,a("#header-tabs-level-1").css("display","none"),a("#header-tabs-level-2").css("display","none")}if(this.tabsContainer&&this.tabsContainer.length){var c,d=this,e=a.fn.transitionEndName();this.element.removeClass("has-tabs").removeClass("has-alternate-tabs"),this.tabsContainer.is(":not(:hidden)")?(this.element.one(e+".tabs-header",b),c=setTimeout(b,300)):b()}},removeWizard:function(){function b(){c&&(clearTimeout(c),c=null),d.element.off(e+".wizard-header"),d.wizard.data("wizard").destroy(),d.wizard.remove(),d.wizard=null}if(this.wizard&&this.wizard.length){var c,d=this,e=a.fn.transitionEndName();this.element.removeClass("has-wizard"),this.wizard.is(":not(:hidden)")?(this.element.one(e+".wizard-header",b),c=setTimeout(b,300)):b()}},removePopupmenu:function(){var a=this;this.titlePopup&&this.titlePopup.length&&(this.titlePopup.data("popupmenu").destroy(),this.titlePopup.data("button").destroy(),this.titlePopupMenu.remove(),this.titlePopup.children("h1").detach().insertBefore(a.titlePopup),this.titlePopup.remove(),this.titlePopup=void 0,this.titlePopupMenu=void 0,this.toolbarElem.triggerHandler("updated"))},unbind:function(){return this.titleButton.off("click.header"),this.element.off("drilldown.header drillup.header"),this},updated:function(){this.reset().unbind().init()},destroy:function(){this.unbind(),this.hasTitleButton&&this.toolbarElem.removeClass("has-title-button"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.hierarchy=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="hierarchy",e={legend:[],legendKey:"",dataset:[],newData:[],templateId:"",mobileView:!1,mouseEnterTarget:"",rightClickTarget:"",leafHeight:null,leafWidth:null,beforeExpand:null},f=a.extend({},e,b),g=["azure08","turquoise02","amethyst06","slate06","amber06","emerald07","ruby06"],h={container:"container",chart:"content",toplevel:"top-level",sublevel:"sub-level",noSublevel:"no-sublevel",sublist:"sublist",button:"btn-expand",leaf:"leaf",inner:"inner",multiRoot:"multi-root",root:"root",back:"back",activeBranch:"active-branch",branchExpanded:"branch-expanded",branchCollapsed:"branch-collapsed",collapsedLeaf:"collapsed-leaf",expanded:"expanded",collapsed:"collapsed",close:"close",open:"open",shadow:"shadow",line:"line",selected:"selected",show:"show",hide:"hidden"};return c.prototype={init:function(){var b=a(this.element).parent().width()<610;if(this.mobileView=b?!0:!1,this.handleEvents(),f.dataset)if(f.dataset[0].children.length>0){var c=void 0===f.dataset[0]?f.dataset:f.dataset[0];c.isRootNode=!0,c.isExpanded=!0,this.render(c)}else a(this.element).append("<p style='padding:10px;'>No data available</p>");if(null!==f.leafHeight&&null!==f.leafWidth){var d="body .hierarchy .leaf,body .hierarchy .sublevel .leaf,body .hierarchy .container .root.leaf { width: "+f.leafWidth+"px;  height: "+f.leafHeight+"px;  }";a("<style type='text/css' id='hierarchyLeafStyles'>"+d+"</style>").appendTo("body")}},handleEvents:function(){var b=this;b.element.onTouchClick("hierarchy","."+h.button).on("click.hierarchy","."+h.button,function(c){f.newData.length>0&&(f.newData=[]);var d=a(this).closest("."+h.leaf).attr("id"),e=b.data(d,f.dataset,f.newData),g={branch:a(this).closest("li"),leaf:a(this).closest("."+h.leaf),button:a(this)};e.isExpanded?b.collapse(c,e,g):b.expand(c,e,g)}),b.element.onTouchClick("click","."+h.back).on("click","."+h.back,function(){var c=a(this).parent().find("."+h.leaf).attr("id"),d=b.data(c,f.dataset,f.newData),e={branch:a(this).closest("li"),leaf:a(this).closest("."+h.leaf),button:a(this)};b.collapse(event,d,e)}),b.element.on("keypress","."+h.leaf,function(c){var d=a(this).attr("id"),e=b.data(d,f.dataset,f.newData);13===c.which&&(e.isExpanded?b.collapse(c,e):b.expand(c,e))}),b.element.on("mousedown","."+h.leaf,function(b){var c=a(this).data(),d={target:b.target,pageX:b.pageX,pageY:b.pageY};a(".is-"+h.selected).removeClass("is-"+h.selected),a("#"+c.id).addClass("is-"+h.selected),a(this).trigger("selected",c,d)});var c=""===f.rightClickTarget?"."+h.leaf:f.rightClickTarget;b.element.on("mousedown",c,function(b){var c=a(this).data(),d={target:b.target,pageX:b.pageX,pageY:b.pageY};1===b.which&&a(this).trigger("click"),3===b.which&&a(this).trigger("rightClick",[c,d])});var d=""===f.mouseEnterTarget?"."+h.leaf:f.mouseEnterTarget;b.element.on("mouseenter",d,function(b){var c=a(this).data(),d={target:b.target,pageX:b.pageX,pageY:b.pageY};3!==b.which&&a(this).trigger("mouseEnter",[c,d])}),b.element.on("dblclick","."+h.leaf,function(b){var c=a(this).data(),d={target:b.target,clientX:b.clientX,clientY:b.clientY};a(this).trigger("doubleClick",c,d)})},data:function(b,c,d,e){function g(a,b,c){if(void 0===b.length)i(a,b,c);else for(var d=0,e=b.length;e>d;d++){var f=b[d];i(a,f,c)}}function i(a,c,d){for(var f in c)"id"===f&&b===c.id&&(c.isLoaded||c.isRootNode||(e.updateDisplay?c.displayClass=h.hide+" "+h.collapsed:j(c,e)),l.push(c));c.children&&g(a,c.children,d)}function j(a,b){b.insert&&(delete a.isLeaf,delete a.displayClass,a.displayClass=h.expanded,a.isExpanded=!0),a.children=0!==d.length&&b.insert?[d]:d}void 0===e&&(e={});var k=c.isRootNode?c:c[0],l=[];return f.newData.length>0&&(f.newData=[]),void 0!==d&&g(this,k,d),0!==l.length&&a("#"+l[0].id).data(l[0]),l[0]},add:function(b,c,d){var e=this,g=void 0!==c.id?c.id:b,i=a("#"+g),j=i.parent().hasClass("leaf-container")?i.parent().parent():i.parent(),k={},l=j.parent().attr("class")!==h.sublevel,m=1===j.children("."+h.sublist).length;if(l?m?k.element=j.children("."+h.sublist):(k.el=j.append("<ul class='"+h.sublist+"'></ul>"),k.element=a(k.el).find("."+h.sublist)):(k.el=j.children("ul"),k.element=a(k.el)),!c.isRootNode){for(var n=0,o=d.length;o>n;n++)f.newData.push(d[n]);e.createLeaf(d,k.element)}},expand:function(a,b,c){var d=this,e=c.leaf,g=e.next().not("."+h.line);g.animateOpen(),d.element.trigger(h.expanded,[b,f.dataset]),e.hasClass("root")&&(g=g.next("ul"),g.animateOpen()),b.isExpanded=!0,d.setNodeData(b),e.parent().removeClass(h.branchCollapsed).addClass(h.branchExpanded),d.setButtonState(e,b)},collapse:function(a,b,c){var d=this,e=c.leaf,g=e.next().not("."+h.line);g.animateClosed().on("animateclosedcomplete",function(){d.element.trigger(h.collapsed,[b,f.dataset])}),e.hasClass("root")&&(g=g.next("ul"),g.animateClosed()),b.isExpanded=!1,d.setNodeData(b),e.parent().removeClass(h.branchExpanded).addClass(h.branchCollapsed),d.setButtonState(e,b)},render:function(b){function c(a,b,c){if(null!==b&&void 0!==b)for(var e=0,f=b.length;f>e;e++){var g=b[e];d(a,g,c)}}function d(a,b,d){for(var e in b)if("children"===e){var f=b.id,g=b,h=b.children;return null!==h&&void 0!==h&&h.length>0&&a.add(f,g,h),c(a,h,d)}}var e=f.legend,g=b.children,i=this.checkChildren(g,"top-level"),j=this.checkChildren(g,"sub-level"),k=[],l={legend:"<legend><ul></ul></legend>",chart:"<ul class='"+h.container+"'><li class='"+h.chart+"'></li></ul>",toplevel:"<ul class='"+h.toplevel+"'></ul>",sublevel:"<ul class='"+h.sublevel+"'></ul>"},m=this.element.append(l.chart),n=a("."+h.chart,m);if(0!==e.length){this.element.prepend(l.legend);var o=a("legend",m);this.createLegend(o)}if(this.setColor(b),this.displayButton(b),b.isMultiRoot){var p="<div class='"+h.leaf+" "+h.multiRoot+"'><div class='"+h.inner+"'><h2>"+b.multiRootText+"</h2></div></div>";k.push(p),a(k[0]).addClass(h.root).appendTo(n)}else{var q=G.compile("{{#dataset}}"+a("#"+f.templateId).html()+"{{/dataset}}"),r=q.render({dataset:b});k.push(r),a(k[0]).addClass(h.root).appendTo(n),this.setNodeData(b)}if(i||a("<div class='"+h.line+"'></div>").insertAfter("."+h.root),g.length>0)for(var s=0,t=g.length;t>s;s++){var u=b.children[s].children;if(this.isLeaf(g[s])?this.createLeaf(b.children[s],a(l.toplevel)):this.createLeaf(b.children[s],a(l.sublevel)),void 0!==u&&null!==u){var v=b.children[s].children,w=this;c(w,v,b)}}j||a("."+h.topLevel).addClass(h.noSublevel);var x=this.element.find("."+h.container).outerWidth(),y=a(window).width(),z=(x-y)/2;this.element.scrollLeft(z)},checkChildren:function(a,b){for(var c=0,d=a.length;d--;)"top-level"===b&&a[d].isLeaf&&(c+=1),"subLevel"===b&&a[d].children&&(c+=1);return c>0},createLegend:function(a){for(var b=4,c=0,d=0,e=f.legend.length;e>d;d++){var h=f.legend[d].label,i=g[d];d-1%b+1===b&&(a.append("<ul></ul>"),c++),a.children("ul").eq(c).append("<li><span>"+h+"</span><span class='key "+i+"'></span></li>")}},createLeaf:function(b,c){function d(b,d){e.setColor(b),e.displayButton(b);var g=G.compile("{{#dataset}}"+a("#"+f.templateId).html()+"{{/dataset}}"),i=g.render({dataset:b}),l=b.isExpanded||void 0===b.isExpanded?"expand":"collapse",m=1===k.length?k:c,n="";m.children("li").children(".ln").removeClass("last-line"),n+=d?"<span class='ln last-line'></span>":"<span class='ln'></span>";var o=a(i);e.setButtonState(o,b),j!==h.sublevel&&j!==h.toplevel&&a(o).append("<span class='horizontal-line'></span>");var p=b.isExpanded||void 0===b.isExpanded?h.branchExpanded:h.branchCollapsed;if(b.isLeaf&&(p=""),m.append("<li class="+p+">"+n+a(o)[0].outerHTML+"</li>"),e.setNodeData(b),b.children){var q="";b.isLoaded=!0,b.displayClass===h.expanded||b.isExpanded?(b.isExpanded=!0,a("#"+b.id).data(b)):b.isExpanded=!1;for(var r=0,s=b.children.length;s>r;r++){e.setColor(b.children[r]),e.displayButton(b.children[r]);var t=g.render({dataset:b.children[r]}),u=a(t);a(u).append("<span class='horizontal-line'></span>"),q+=r===b.children.length-1?"<li><span class='ln last-line'></span>"+a(u)[0].outerHTML+"</li>":"<li><span class='ln'></span>"+a(u)[0].outerHTML+"</li>"}m=a("#"+b.id).parent(),m.append("<ul>"+q+"</ul>");for(var v=b.children.length;v--;)e.setNodeData(b.children[v]);b.isExpanded||b.isLeaf||e.animateExpandCollapse(a("#"+b.id).parent(),l)}}var e=this,g=e.element.attr("class"),i=a("."+g+" ."+h.chart,e.container),j=c.attr("class"),k=void 0!==j?a("."+j):c;if(k.length<1&&(j===h.toplevel?c.insertAfter("."+h.root):c.appendTo(i)),b.length)for(var l=0,m=b.length;m>l;l++){var n=l===b.length-1;d(b[l],n)}else d(b,!0)},setColor:function(a){for(var b=0,c=f.legend.length;c>b;b++){if(a[f.legendKey]===f.legend[b].value){a.colorClass=g[b];break}""===a[f.legendKey]&&(a.colorClass="default-color")}if(a.children&&!a.isRootNode)for(var d=0,e=a.children.length;e>d;d++)for(var h=0,i=f.legend.length;i>h;h++)a.children[d][f.legendKey]===f.legend[h].value&&(a.children[d].colorClass=g[h])},setNodeData:function(b){var c=a("#"+b.id).data(b);c.data=b},isLeaf:function(a){return void 0===a.children?(a.isLeaf=!0,a.isLeaf):f.beforeExpand?a.isLeaf:a.children&&a.children.length>0?!1:!0},setButtonState:function(a,b){var c=a.find("."+h.button);c.find("svg.icon").changeIcon(b.isExpanded||void 0===b.isExpanded?"caret-up":"caret-up"),void 0===b.isExpanded&&c.button()},displayButton:function(a){a.displayClass=a.isLeaf?h.hide:h.show,a.isRootNode&&(a.displayClass=h.hide),a.displayClass+=a.isExpanded?" "+h.expanded:" "+h.collapsed,void 0===a.isExpanded&&(a.isLeaf||!a.children||a.isRootNode||(a.displayClass=h.expanded))}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.highlight=function(a){function b(a,c){var d,e,f,g,h,i=0;if(3===a.nodeType)d=a.data.toUpperCase().indexOf(c),d-=a.data.substr(0,d).toUpperCase().length-a.data.substr(0,d).length,d>=0&&(e=document.createElement("mark"),e.className="highlight",f=a.splitText(d),h=f.splitText(c.length),g=f.cloneNode(!0),e.appendChild(g),f.parentNode.replaceChild(e,f),i=1);else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=b(a.childNodes[j],c);return i}return this.length&&a&&a.length?this.each(function(){b(this,a.toUpperCase())}):this},a.fn.unhighlight=function(){return this.find("mark.highlight").each(function(){var a=this.parentNode;a.replaceChild(this.firstChild,this),a.normalize()}).end()},a.fn.homepage=function(b){function c(b){this.element=a(b),this.init()}var d="homepage",e={gutterSize:20,widgetWidth:360,widgetHeight:370,animate:!0,timeout:100,columns:3,easing:"blockslide"},f=a.extend({},e,b);return c.prototype={init:function(){this.settings=f,this.isTransitionsSupports=this.supportsTransitions(),this.attachEvents(),this.resize(this,!1)},initColumns:function(a){a=a||0,this.rowsAndCols[a]=[];for(var b=0,c=this.settings.columns;c>b;b++)this.rowsAndCols[a][b]=!0},initRowsAndCols:function(){this.rowsAndCols=[],this.initColumns()},getAvailability:function(a){var b,c,d,e,f,g,h=this,i=h.rowsAndCols.length,j={},k=!1;for(b=0,e=i;e>b&&!k;b++)for(c=0,g=!0,f=h.rowsAndCols[b].length;f>c&&!k;c++)if(h.rowsAndCols[b][c]&&a.w+c<=f){if(a.w>1&&f>c+1)for(d=0;d<a.w;d++)if(!h.rowsAndCols[b][c+d]){g=!1;break}if(a.h>1&&i>b+1)for(d=0;d<a.h;d++)if(!h.rowsAndCols[b+d][c]){g=!1;break}g&&(j.row=b,j.col=c,k=!0)}return Object.getOwnPropertyNames(j).length||(h.initColumns(i),j.row=i,j.col=0),j},fitBlock:function(a,b,c){var d,e,f,g,h=this,i=!0;if(c.x=b,c.y=a,1===c.w&&1===c.h)h.rowsAndCols[a][b]=!1;else if(1!==c.w)for(d=a,f=c.h+a;f>d;d++)for(e=b,g=c.w+b;g>e;e++)h.rowsAndCols[d]||h.initColumns(d),h.rowsAndCols[d][e]=!1;else for(d=a,f=c.h+a;f>d;d++)for(e=b,g=c.h+b;g>e;e++)h.rowsAndCols[d]||h.initColumns(d),h.rowsAndCols[d][b]=!1;for(d=0,f=h.rowsAndCols[a].length;f>d;d++)h.rowsAndCols[a][d]&&(i=!1);i&&(h.rowsAndCols[a+1]||h.initColumns(a+1))},setBlocks:function(){var b=this;b.blocks=[],b.element.find(".card, .widget").each(function(){var c=a(this),d=c.hasClass("double-height")?2:1,e=c.hasClass("quad-width")?4:c.hasClass("triple-width")?3:c.hasClass("double-width")?2:1;b.blocks.push({w:e,h:d,elem:c,text:c.text()})});for(var c=0,d=0,e=0,f=b.blocks.length;f>c;c++)b.settings.columns>1&&(b.blocks[c].w>=b.settings.columns&&c&&b.arrayIndexMove(b.blocks,c,d),e+=b.blocks[c].w,e>=b.settings.columns&&(e=0,d=b.blocks[d].w>=b.settings.columns?d+1:c))},arrayIndexMove:function(a,b,c){a.splice(c,0,a.splice(b,1)[0])},attachEvents:function(){var b,c=this;a(window).on("resize.homepage",function(){clearTimeout(b),b=setTimeout(function(){c.resize(c,c.settings.animate)},100)}),a(".application-menu").on("applicationmenuopen.homepage applicationmenuclose.homepage",function(){c.resize(c,c.settings.animate)})},resize:function(a,b){var c=4*a.settings.widgetWidth+3*a.settings.gutterSize,d=3*a.settings.widgetWidth+2*a.settings.gutterSize,e=2*a.settings.widgetWidth+a.settings.gutterSize,f=a.settings.widgetWidth,g=c,h=a.element.outerWidth(),i=h>=c,j=h>=d&&c>=h,k=h>=e&&d>=h,l=e>=h,m=this.element.attr("data-columns");this.settings.columns=parseInt(m||this.settings.columns),i&&4===a.settings.columns&&(a.settings.columns=4,g=c),(j||i&&3===a.settings.columns)&&(a.settings.columns=3,g=d),k&&(a.settings.columns=2,g=e),l&&(a.settings.columns=1,g=f),a.element.find("> .content").css("margin-left","-"+g/2+"px"),this.setBlocks(),this.initRowsAndCols();for(var n=0,o=a.blocks.length;o>n;n++){var p,q,r,s,t=a.blocks[n];t.elem.removeClass("to-single to-double to-triple"),t.w>a.settings.columns&&(t.w=a.settings.columns,1===a.settings.columns?t.elem.addClass("to-single"):2===a.settings.columns?t.elem.addClass("to-double"):3===a.settings.columns&&t.elem.addClass("to-triple")),s=a.getAvailability(t);var u=a.settings.widgetWidth+a.settings.gutterSize,v=u*a.settings.columns;if(p=Locale.isRTL()?v-(u*t.w+u*s.col):u*s.col,q=(a.settings.widgetHeight+a.settings.gutterSize)*s.row,r={left:p,top:q},b){var w=a.settings.easing,x=[.09,.11,.24,.91];"blockslide"===w?a.isTransitionsSupports?(a.applyCubicBezier(t.elem,x),t.elem.css(r)):t.elem.animate(r,a.settings.timeout):t.elem.animate(r,a.settings.timeout,w)}else t.elem.css(r);a.fitBlock(s.row,s.col,t)}},applyCubicBezier:function(a,b){a.css({"-webkit-transition":"all .3s cubic-bezier("+b+")","-moz-transition":"all .3s cubic-bezier("+b+")","-ms-transition":"all .3s cubic-bezier("+b+")","-o-transition":"all .3s cubic-bezier("+b+")",transition:"all .3s cubic-bezier("+b+")"})},supportsTransitions:function(){var a=document.createElement("p").style,b="transition";if("string"==typeof a[b])return!0;var c=["Moz","webkit","Webkit","Khtml","O","ms"];b=b.charAt(0).toUpperCase()+b.substr(1);for(var d=0,e=c.length;e>d;d++)if("string"==typeof a[c[d]+b])return!0;return!1},detachEvents:function(){a(window).off("resize.homepage"),a(".application-menu").off("applicationmenuopen.homepage applicationmenuclose.homepage")},destroy:function(){this.detachEvents(),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.icon=function(b){"use strict";function c(b,c){this.settings=a.extend({},c),this.element=a(b),this.init()}var d="icon",e={use:"user-profile",iconFileLocation:null,focusable:!1},f=a.extend({},e,b);return c.prototype={init:function(){return this.getExistingUseTag(),this.render().handleEvents()},render:function(){var a=this;if(this.element.addClass("icon"),!this.element.is("svg"))return this;var b=this.element[0].getElementsByTagName("use")[0];return b?(b.getAttribute("xlink:href")!==a.getBasedUseTag()&&setTimeout(function(){b.setAttribute("xlink:href",a.getBasedUseTag())},0),this):this},getBasedUseTag:function(){return a.getBaseURL((this.settings.iconFileLocation||"")+"#icon-"+this.settings.use)},getExistingUseTag:function(){if(this.element.is("svg")){var a=this.element.children("use");if(!a.length)return this;var b=a.attr("xlink:href");return b.indexOf("#")>0&&(this.settings.iconFileLocation=b.substring(0,b.indexOf("#")),b=b.substring(b.indexOf("#"),b.length)),this.settings.use=b.replace("#icon-",""),this}},handleEvents:function(){var a=this;return this.element.on("updated."+d,function(){a.updated()}),this},updated:function(){return this.teardown().init()},teardown:function(){return this.element.off("updated."+d),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var b=a.data(this,d);b||(b=a.data(this,d,new c(this,f)))})},function(){"use strict";function b(b){var c=a(".svg-icons > .svg-icons").length>0;b.file&&b.file.indexOf("/","")-1&&(b.file=window.Soho.svgPath+b.file);

var d={file:c?"":window.Soho.svgPath+"icons.svg",icon:"user-profile",classes:["icon"]};return b=b||a.extend({},d),"string"==typeof b&&(b=a.extend({},d,{icon:b.replace("icon-","")})),b.classes||(b.classes=[].concat(d.classes)),b.file||(b.file=d.file),"string"==typeof b.classes&&(b.classes=b.classes.split(" ")),-1===b.classes.indexOf("icon")&&b.classes.push("icon"),b}a.createIcon=function(a){return a=b(a),['<svg class="'+a.classes.join(" ")+'" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="'+a.file+"#icon-"+a.icon+'"></use></svg>'].join("")},a.createIconElement=function(b){return a(a.createIcon(b))},a.createIconPath=function(c){return c=b(c),c.file+a.getBaseURL("#icon-"+c.icon.replace("icon-",""))},a.fn.changeIcon=function(b,c){var d=a(this),e=d.find("use");if(1===e.length)e.attr("xlink:href",a.createIconPath({icon:b,file:c}));else{var f=a.createIcon({classes:d.attr("class"),icon:b});d.after(f),d.remove()}d.attr("data-icon",b)},a.fn.getIconName=function(){var b=a(this),c=b.find("use");return 1===c.length?c.attr("xlink:href").substr(c.attr("xlink:href").indexOf("#icon-")+6):b.attr("data-icon")}}(),a.fn.lookup=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="lookup",e={click:null,field:"id",title:null,buttons:[],options:null,beforeShow:null,modalContent:null,editable:!0,typeahead:!1,autoApply:!0,validator:null},f=a.extend({},e,b),g="lookup-datagrid";return c.prototype={init:function(){this.settings=f,this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=!!this.inlineLabelText.length,this.build(),this.handleEvents(),this.grid=null,this.selectedRows=null},build:function(){var b=this.element,c=this.element.is(".input-xs")?"lookup-wrapper xs":this.element.is(".input-sm")?"lookup-wrapper sm":this.element.is(".input-lg")?"lookup-wrapper lg":"lookup-wrapper";this.element.is(".has-actions")&&(c+=" has-actions-wrapper"),this.icon=a('<span class="trigger" tabindex="-1"></span>').append(a.createIcon("search-list")),this.isInlineLabel?this.inlineLabel.addClass(c):(this.container=a('<span class="'+c+'"></span>'),b.wrap(this.container)),b.after(this.icon),b.attr("data-mask")&&b.mask(),this.element.is(":disabled")&&this.disable(),this.settings.editable||this.element.attr("readonly","true").addClass("is-not-editable"),this.addAria()},addAria:function(){var b=this;setTimeout(function(){b.label=b.isInlineLabel?b.inlineLabelText:a('label[for="'+b.element.attr("id")+'"]'),b.label&&b.label.append('<span class="audible">'+Locale.translate("UseEnter")+"</span>")},500)},handleEvents:function(){var b=this;this.icon.on("click.lookup",function(a){b.openDialog(a)}),this.element.on("keyup.lookup",function(c){a("#autocomplete-list").length>0||40===c.which&&b.openDialog(c)})},openDialog:function(a){var b=this,c=b.element.triggerHandler("beforeopen");if(c!==!1&&!(b.isDisabled()||b.isReadonly()&&!b.element.hasClass("is-not-editable"))){if(b.settings.click)return void b.settings.click(a,this);if(this.settings.beforeShow){var d=function(a){a&&b.createGrid(a),b.createModal(),b.element.trigger("open",[b.modal,b.grid]),b.settings.validator&&b.settings.validator(b.element,b.modal,b.grid)};return void this.settings.beforeShow(this,d)}this.settings.options&&(b.createModal(),b.element.trigger("open",[b.modal,b.grid]),b.modal.element.find(".btn-actions").removeClass("is-selected"),b.element.trigger("afteropen",[b.modal,b.grid]),b.settings.validator&&b.settings.validator(b.element,b.modal,b.grid))}},createModal:function(){var b=this,c='<div id="'+g+'"></div>',d=a('label[for="'+b.element.attr("id")+'"]'),e=b.isInlineLabel?b.inlineLabelText:d.length?d.clone().find("span").remove().end().text():"";this.settings.title&&(e=this.settings.title);var f=this.settings.modalContent;f&&f instanceof jQuery&&(c=f,f.show()),!f||f instanceof jQuery||(c=f);var h=this.settings.buttons;(this.settings.options&&"multiple"===this.settings.options.selectable&&0===h.length||!b.settings.autoApply&&0===h.length)&&(h=[{text:Locale.translate("Cancel"),click:function(a,c){b.element.focus(),c.close()}},{text:Locale.translate("Apply"),click:function(a,c){var d=b.grid.selectedRows();c.close(),b.insertRows(d)},isDefault:!0}]),this.settings.options&&"single"===this.settings.options.selectable&&0===h.length&&b.settings.autoApply&&(h=[{text:Locale.translate("Cancel"),click:function(a,c){b.element.focus(),c.close()}}]),a("body").modal({title:e,content:c,buttons:h,cssClass:"lookup-modal"}).off("open").on("open",function(){b.createGrid(),b.element.trigger("afteropen",[b.modal,b.grid])}).off("close").on("close",function(){b.element.focus()}),b.modal=a("body").data("modal"),this.settings.title||b.modal.element.find(".modal-title").append(' <span class="datagrid-result-count">(N Results)</span>'),setTimeout(function(){a(".modal.is-visible .searchfield").on("keypress.lookup",function(a){return 13===a.keyCode?!1:void 0})},300)},createGrid:function(a){var b,c=this;a?(b=a,g=a.attr("id"),c.settings.options=a.data("datagrid").settings):b=c.modal.element.find("#"+g),c.settings.options&&("single"===c.settings.options.selectable&&c.settings.autoApply&&(c.settings.options.cellNavigation=!1,b.find("tr").addClass("is-clickable")),c.settings.options.isList=!0,b.data("datagrid")||b.datagrid(c.settings.options)),c.grid=b.data("datagrid"),!this.settings.title&&c.modal&&c.modal.element.find(".title").html("&nbsp;"),b.off("selected.lookup");var d=c.element.val();d&&c.selectGridRows(d),this.settings.options&&b.on("selected.lookup",function(a,b){b&&0!==b.length&&(c.settings.validator&&c.settings.validator(c.element,c.modal,c.grid),"single"===c.settings.options.selectable&&c.settings.autoApply&&setTimeout(function(){c.insertRows(),c.modal.close()},100))}),b.css("max-width","")},selectGridRows:function(a){var b=this,c=a;if(a)if(c.indexOf(",")>1)for(var d=c.split(","),e=0;e<d.length;e++)b.selectRowByValue(b.settings.field,d[e]);else b.selectRowByValue(b.settings.field,c)},selectRowByValue:function(a,b){if(this.settings.options){for(var c=this,d=this.settings.options.dataset,e=[],f=0;f<d.length;f++)"function"!=typeof c.settings.match?d[f][a]==b&&e.push(f):c.settings.match(b,d[f],c.element,c.grid)&&e.push(f);this.grid&&this.grid.selectedRows(e)}},insertRows:function(){var a=this,b="";a.selectedRows=a.grid.selectedRows();for(var c=0;c<a.selectedRows.length;c++){var d="";d="function"==typeof a.settings.field?a.settings.field(a.selectedRows[c].data,a.element,a.grid):a.selectedRows[c].data[a.settings.field],b+=(0!==c?",":"")+d}a.element.val(b).trigger("change",[a.selectedRows]),a.element.focus()},enable:function(){this.element.prop("disabled",!1).prop("readonly",!1),this.element.parent().removeClass("is-disabled")},disable:function(){this.element.prop("disabled",!0),this.element.parent().addClass("is-disabled")},readonly:function(){this.element.prop("readonly",!0)},isDisabled:function(){return this.element.prop("disabled")},isReadonly:function(){return this.element.prop("readonly")},destroy:function(){a.removeData(this.element[0],d),this.element.off("click.dropdown keypress.dropdown"),this.icon.remove(),this.element.unwrap(),this.label&&null!=this.label&&this.label.find(".audible").remove()}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.destroy=function(){return j(a(this),"destroy")},a.fn.closeChildren=function(){return j(a(this),"close")},a.fn.lightbox=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="lightbox",e={image:"",loop:!0,cache:!0},f=a.extend({},e,b);return c.prototype={init:function(){return this.build().handleEvents()},build:function(){return this},handleEvents:function(){var b=this;return this.element.onTouchClick(d).on("click."+d,function(){b.showImage()}),a(window).on("resize."+d,function(){b.resize()}),this},showImage:function(){var b=this;(this.settings.image||this.settings.image.length)&&(b.loadImage(b.settings.image),a("body").modal({title:"",content:a("#lightbox-full"),buttons:[],id:"lightbox-modal",frameHeight:0}).on("open",function(){a(".overlay").css("opacity",".7")}).on("afterclose",function(){var b=a(this);a("#lightbox-modal").remove(),a(".overlay").remove(),b.data("modal").destroy(),b.off("open").off("afterclose")}),b.lightBox=a("#lightbox-modal"),b.lightBox.addClass("lightbox-modal").find(".modal-buttonset, .modal-header").remove(),setTimeout(function(){var c=a("body").data("modal");b.busyindicator=a(".modal-body-wrapper").addClass("busy").busyindicator(),c.extraHeight=0,a(window).off("resize.modal-"+c.id),a(".overlay").onTouchClick(d).on("click."+d,function(){c.close()})},100),b.addButtons())},addButtons:function(){var b=this,c=a('<button class="btn-icon" type="button">'+a.createIcon({classes:["close"],icon:"close"})+'<span class="audible">'+Locale.translate("Close")+"</span></button>");this.previousButton=a('<button class="btn-previous" type="button">'+a.createIcon("left-arrow")+'<span class="audible">'+Locale.translate("Previous")+"</span></button>"),this.nextButton=a('<button class="btn-next" type="button">'+a.createIcon("right-arrow")+'<span class="audible">'+Locale.translate("Next")+"</span></button>"),this.lightBox.css("overflow","visible").find(".modal-content").before(c,this.previousButton,this.nextButton),c.onTouchClick(d).on("click."+d,function(){a("body").data("modal").close()}),this.previousButton.onTouchClick(d).on("click."+d,function(){b.loadSiblingImage("previous")}),this.nextButton.onTouchClick(d).on("click."+d,function(){b.loadSiblingImage("next")}),b.currentElement=b.element,b.refreshButtons()},loadImage:function(b){var c=this,d=a("#lightbox-full"),e=new Image;c.loadingInProcess||(c.loadingInProcess=!0,this.settings.cache||(b+="?t="+Math.random()+(new Date).getTime()),e.src=b,e.id="lightbox-full",setTimeout(function(){c.busyindicator.scrollTop(0).css({"max-height":c.getCalcHeight(),overflow:"hidden"}).trigger("start")},110),d.length?(d.css("opacity","0"),setTimeout(function(){d.attr("src",b).css("opacity","1")},300)):(e.style.display="none",document.body.appendChild(e)),e.onload=function(){c.resize(),setTimeout(function(){c.busyindicator.css({overflow:""}).trigger("complete"),c.loadingInProcess=!1},120)})},getCalcHeight:function(){return.9*a(window).height()-100},resize:function(){var b=a(".modal-body").height(),c=this.getCalcHeight();a(".modal-body-wrapper").css("max-height",b>c?c:"")},refreshButtons:function(){if(!this.settings.loop){var a=this.currentElement.next(),b=this.currentElement.prev();this.nextButton[a&&a.length?"show":"hide"](),this.previousButton[b&&b.length?"show":"hide"]()}},loadSiblingImage:function(b){if(!this.loadingInProcess){var c,d,e=this,f=a(".lightbox"),g=0;f.each(function(a){return this===e.currentElement[0]?(g=a,!1):void 0}),c=f.eq("next"===b?g<f.length-1?g+1:0:g>0?g-1:f.length-1),d=c&&c.length?c.data("lightbox").settings:"",d&&d.image&&d.image.length&&(this.loadImage(d.image),this.currentElement=c),this.refreshButtons()}},updated:function(){return this.teardown().init()},teardown:function(){return this.element.off("updated."+d).offTouchClick().off("click."+d),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.listview=function(b){function c(b){this.settings=a.extend({},g),this.element=a(b),this.init()}var d="listview",f={dataset:[],template:null,description:null,paging:!1,pagesize:10,searchable:!1,selectable:"single",selectOnFocus:!0,source:null},g=a.extend({},f,b);return c.prototype={init:function(){this.setup(),this.refresh(),this.selectedItems=[],this.lastSelectedRow=0,this.isSelectedAll=!1,this.sortInit("listview","click.listview","data-sortlist"),this.handleEvents(),this.handleResize()},setup:function(){var a=this,b=this.element.closest(".card, .widget"),c=this.element.attr("data-selectable"),d=this.element.attr("data-select-onfocus");if(c&&c.length&&(this.settings.selectable=c),d&&d.length&&(this.settings.selectOnFocus=JSON.parse(d)),a.actionButton=b.find(".btn-actions"),a.actionButton.length>0&&(a.actionButton.data("popupmenu")||a.actionButton.popupmenu()),this.element.attr({tabindex:"-1"}),this.element.parent(".card-content, .widget-content").css("overflow","hidden"),this.element.attr({role:"listbox","aria-label":this.settings.description||b.find(".card-title, .widget-title").text()}),this.settings.searchable&&(this.searchfield=this.element.parent().find(".searchfield, .autocomplete"),!this.searchfield.length,this.listfilter=new e({filterMode:"contains"})),this.settings.dataset&&"string"==typeof this.settings.dataset){var f=window[this.settings.dataset];f&&f.length&&(this.settings.dataset=f)}},getTotals:function(a){var b,c={count:a.length};if(a[0]){for(b in a[0])c[b]=0;for(var d=0;d<a.length;d++)for(b in a[d])c[b]+=parseFloat(a[d][b]);return c}},render:function(b,c){var d=this,e={};if("object"==typeof G&&b&&this.settings.template){this.settings.template.indexOf("{{#totals}}")>-1&&(e=this.getTotals(b));var f=G.compile(this.settings.template),g=f.render({dataset:b,totals:e});this.element.html(g)}this.settings.paging&&(this.element.pager({pagesize:d.settings.pagesize,source:d.settings.source}),this.renderPager(c)),a("ul",this.element).attr({role:"presentation"});var h=this.element.find("li, tbody > tr").first(),i=this.element.find("li, tr"),j="multiple"===this.settings.selectable;h.attr("tabindex",0),i.each(function(b){var c=a(this);if(c.attr("role","option"),j){d.element.addClass("is-muliselect");var e=d.element.prevAll(".toolbar");e.length&&e.data("toolbar")&&e.data("toolbar").toggleMoreMenu()}c.attr({"aria-posinset":b+1,"aria-setsize":i.length}),c.hasClass("is-disabled")&&c.attr("aria-disabled","true")}),this.element.children().initialize(),this.element.trigger("rendered",[b]),this.element.off("updated").on("updated",function(){d.refresh()})},renderPager:function(a){var b=this.element.data("pager");b&&this.settings.pager&&(a&&b.updatePagingInfo(a),b.renderBar())},refresh:function(){this.loadData(),this.list&&this.render(this.list.data)},loadData:function(b,c){function d(a,c){b=a,this.render(b,c)}var e=!1;if(b=b||this.settings.dataset,c=c||{},b){var f=this,g=this.settings.source;if("string"!=typeof b||0!==b.indexOf("http")&&0!==b.indexOf("/")||(g=b,e=!0),!this.settings.paging&&g||e)switch(typeof g){case"function":return g(c,d);case"string":return void((0===g.indexOf("http")||0===g.indexOf("/"))&&a.ajax({url:g,async:!1,dataType:"json",success:function(a){return b=f.settings.dataset=a,f.render(b,c)}}));default:return b=this.settings.dataset=g,this.render(g,c)}this.render(b,c)}},toggleAll:function(){this[this.isSelectedAll?"unselectRowsBetweenIndexes":"selectRowsBetweenIndexes"]([0,a("li, tbody tr",this.element).length-1]),this.isSelectedAll=!this.isSelectedAll},selectRowsBetweenIndexes:function(b){this.clearSelection(),b.sort(function(a,b){return a-b});for(var c=b[0];c<=b[1];c++){var d=a("li, tbody tr",this.element).eq(c);d.is(".is-disabled, .is-selected")||this.select(d)}},unselectRowsBetweenIndexes:function(b){b.sort(function(a,b){return a-b});for(var c=b[0];c<=b[1];c++){var d=a("li, tbody tr",this.element).eq(c);!d.is(".is-disabled")&&d.is(".is-selected")&&this.select(d)}},clearSelection:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},handleEvents:function(){var b=this,c=!1,d=!1,e="multiple"===b.settings.selectable;if(this.element.on("focus.listview","li, tbody tr",function(){var e=a(this);if(e.is(":first-child")&&e.hasClass("is-disabled")){var f=a.Event("keydown.listview");f.keyCode=40,c=!0,e.trigger(f)}c||e.hasClass("is-disabled")||!b.settings.selectOnFocus||"multiple"===b.settings.selectable||(b.select(e),c=!0,d=!0)}),this.element.on("keydown.listview","li, tr",function(c){var d=a(this),f=d.parent(),g=c.keyCode||c.charCode||0,h=c.metaKey;if(0!==d.index()||38!==c.keyCode){if((40===g||38===g)&&!h){var i=40===c.keyCode?d.nextAll(":not(.is-disabled):visible:first"):d.prevAll(":not(.is-disabled):visible:first");(a(c.target).is(d)||c.shiftKey)&&b.focus(i),c.preventDefault(),c.stopPropagation()}if(35===g||40===g&&h){var j=f.children().last();return b.focus(j),c.stopPropagation(),!1}if(36===g||38===g&&h){var k=f.children().first();return b.focus(k),c.stopPropagation(),!1}32===g&&a(c.target).is(d)&&(e&&c.shiftKey?b.selectRowsBetweenIndexes([b.lastSelectedRow,d.index()]):b.select(d),c.preventDefault()),e&&(c.ctrlKey||c.metaKey)&&65===g&&(b.toggleAll(),b.focus(d),c.preventDefault())}}),this.settings.selectable){this.element.addClass("is-selectable");var f=a(".list-detail-back-button").find(".app-header"),g=a(this.element).closest(".list-detail, .builder");f.parent().onTouchClick("listview").on("click.listview",function(a){return f.hasClass("go-back")&&(f.removeClass("go-back"),g.removeClass("show-detail")),a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault(),!1}),this.element.onTouchClick("listview","li, tr, input, select, label, button").on("click.listview","li, tr",function(h){var i=a(this);d||i.hasClass("is-disabled")||(c=!0,e&&h.shiftKey?(b.selectRowsBetweenIndexes([b.lastSelectedRow,i.index()]),h.preventDefault()):b.select(i),i.focus()),g.length>0&&a(window).outerWidth()<767&&!i.hasClass("is-disabled")&&(g.toggleClass("show-detail"),f.toggleClass("go-back")),d=!1})}"multiple"===this.settings.selectable&&this.element.on("change.selectable-listview",".listview-checkbox input",function(b){a(this).parent().trigger("click"),b.stopPropagation()}),this.settings.searchable&&this.searchfield.on("contents-checked.searchable-listview",function(c){b.handleSearch(c,a(this))}),this.element.data("pager")&&this.element.on("afterpaging.listview",function(){b.element.scrollTop(0)}),a(window).on("resize.listview",function(){b.handleResize()}),b.element.prev(".listview-header").onTouchClick().on("click",function(){var c=a(this).find(".plus-minus");c.hasClass("active")?(c.removeClass("active"),b.element.animateClosed()):(c.addClass("active"),b.element.animateOpen())})},handleResize:function(){var b=a("li .listview-heading, tr .listview-heading",this.element);b.eq(1).width()&&b.eq(0).width(b.eq(1).width()),this.setChildIconsValign(),this.element.data("pager")&&this.element.data("pager").renderBar()},handleSearch:function(b,c){var d,e=this.element.find("li, tbody > tr"),f=c.val();this.resetSearch(e),f&&f.length&&(d=this.listfilter.filter(e,f)),d&&(d.length||f)&&(e.not(d).addClass("hidden"),e.filter(d).each(function(b){var c=a(this);c.attr("tabindex",0===b?"0":"-1"),c.highlight(f)}),this.renderPager())},resetSearch:function(b){b.removeClass("hidden").each(function(){a(this).unhighlight()})},setChildIconsValign:function(){a("li > .icon, li > button",this.element).each(function(){var b=a(this),c=b.is("button")?42:22,d=b.closest("li"),e=parseInt(d.css("padding-top"),10)+parseInt(d.css("padding-bottom"),10),f=d.outerHeight()-e;b.css({top:(f-c)/2+"px"})})},focus:function(a){a.is(":hidden")||a.is(".is-disabled")||(a.removeAttr("tabindex"),a.attr("tabindex",0).focus(),this.settings.selectOnFocus&&"multiple"!==this.settings.selectable&&this.select(a))},remove:function(b){"number"==typeof b&&(b=a(this.element.children()[0]).children().eq(b)),b.is(".is-selected")&&this.select(b),b.remove()},clear:function(){var b=a(this.element.children()[0]);b.empty()},removeAllSelected:function(){var b=this;a.each(this.selectedItems,function(a,c){b.remove(c)})},clearAllSelected:function(){var b=this;a.each(this.selectedItems,function(a,c){b.select(c)})},sortInit:function(b,c,d){d&&""!==a.trim(d)&&a("["+d+"]").each(function(){var e=a(this),f=a.fn.parseOptions(e,d);e.on(c,function(c){a(f.list).data(b).setSortColumn(f),c.preventDefault()})})},setSortColumn:function(a){var b,c=a.orderBy||this.list.sort.field,d=a.order;(this.list.data||c)&&(d=d?"desc"===d:this.list.sort&&this.list.sort[c]&&this.list.sort[c].reverse?!1:!0,(a.reloadApi||a.reloadApiNoSort)&&this.loadData(),a.reloadApiNoSort&&(c=this.list.sort.field,d=this.list.sort[c].reverse),b=this.sortFunction(c,d),this.list.data.sort(b),this.render(this.list.data),this.list.sort={field:c},this.list.sort[c]={reverse:d},this.element.trigger("sorted",[this.element,this.list.sort]))},sortFunction:function(a,b,c){var d;return c||(c=function(a){return a=void 0===a||null===a?"":a,"string"==typeof a&&(a=a.toUpperCase(),isNaN(parseFloat(a))||(a=parseFloat(a))),a}),d=c?function(b){return c(b[a])}:function(b){return b[a]},b=b?-1:1,function(a,c){return a=d(a),c=d(c),b*((a>c)-(c>a))}},unselect:function(b){"number"==typeof b&&(b=a(this.element.children()[0]).children().eq(b)),b.is(".is-selected")&&this.select(b)},select:function(b){var c=this,d=!1;if(c.selectedItems=[],"number"==typeof b&&(b=a(this.element.children()[0]).children().eq(b)),d=b.hasClass("is-selected"),b.parent().children().removeAttr("tabindex"),b.attr("tabindex",0),this.settings.selectable!==!1&&"false"!==this.settings.selectable){"multiple"!==this.settings.selectable&&(b.parent().children().removeAttr("aria-selected"),b.parent().find(".is-selected").removeClass("is-selected"),c.selectedItems[0]=a(this)),d?(c.selectedItems=[],b.removeClass("is-selected")):this.settings.selectable&&(b.addClass("is-selected"),c.lastSelectedRow=b.index()),b.parent().find(".is-selected").each(function(b){c.selectedItems[b]=a(this)}),b.attr("aria-selected",!d),this.element.trigger("selected",{selectedItems:this.selectedItems,elem:b});var e,f,g=this.element.closest(".card, .widget");if(g.length||(g=this.element.parent()),e=g.find(".listview-toolbar, .contextual-toolbar"),f=e.data("toolbar"),c.selectedItems.length>0){f&&f.toggleMoreMenu(),e.one("animateopencomplete",function(){c.element.addClass("is-toolbar-open"),e.trigger("recalculateButtons").removeClass("is-hidden")}).css("display","block"),e.animateOpen({distance:40});var h=e.find(".title, .selection-count");h&&h.length||(h=a('<div class="title selection-count"></div>'),e.prepend(h)),h.text(c.selectedItems.length+" "+Locale.translate("Selected"))}else e.addClass("is-hidden").one("animateclosedcomplete",function(b){b.stopPropagation(),a(this).css("display","none")}).animateClosed()}},updated:function(){return this.refresh(),this},teardown:function(){return this.element.off("focus.listview click.listview touchend.listview keydown.listview change.selectable-listview afterpaging.listview").empty(),this},destroy:function(){this.teardown(),this.element.removeData(d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,g))})},a.fn.pager=function(b){function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="pager",e={type:"list",position:"bottom",activePage:1,source:null,pagesize:15,pagesizes:[15,25,50,75],indeterminate:!1},f=a.extend({},e,b);return c.prototype={init:function(){this.setup(),this.buttonExpr="li:not(.pager-prev):not(.pager-next):not(.pager-first):not(.pager-last)",this.createPagerBar(),this.setActivePage(this.settings.activePage),this.renderBar(),this.renderPages(!1,"initial"),this.handleEvents()},setup:function(){if(-1===a.inArray(this.settings.pagesize,this.settings.pagesizes)){var b=function(a,b){return a-b};this.settings.pagesizes.push(this.settings.pagesize),this.settings.pagesizes=this.settings.pagesizes.sort(b)}this.element.is("tbody")&&(this.isTable=!0,this.settings.type="table",this.mainContainer=this.element.closest(".datagrid-wrapper"));var c=this.element.closest(".card, .widget");return c.length&&(this.isList=!0,this.settings.type="list",this.mainContainer=c),this},createPagerBar:function(){if(this.pagerBar=this.element.prev(".pager-toolbar"),0===this.pagerBar.length){this.pagerBar=a('<ul class="pager-toolbar"></ul>');var b='<li class="pager-prev"><a href="#" rel="prev" title="PreviousPage">'+a.createIcon({icon:"previous-page"})+'<span class="audible">'+Locale.translate("PreviousPage")+'</span></a></li><li class="pager-next"><a href="#" rel="next" title="NextPage">'+a.createIcon({icon:"next-page"})+'<span class="audible">'+Locale.translate("NextPage")+"</span></a></li>";"table"===this.settings.type&&(b='<li class="pager-first"><a href="#" title="FirstPage">'+a.createIcon({icon:"first-page"})+'<span class="audible">'+Locale.translate("FirstPage")+"</span></a></li>"+b+'<li class="pager-last"><a href="#" title="LastPage">'+a.createIcon({icon:"last-page"})+'<span class="audible">'+Locale.translate("LastPage")+"</span></a></li>"),this.pagerBar.html(b),this.pagerBar.children("li").children("a").button()}if(this.isTable?this.mainContainer.after(this.pagerBar):"bottom"===this.settings.position?this.element.after(this.pagerBar):this.element.before(this.pagerBar),"list"===this.settings.type){var c=this,d=["widget","card"];d.forEach(function(b){var d=c.element.closest("."+b+"-content");if(d.length){var e=d.next("."+b+"-footer");e.length||(e=a('<div class="'+b+'-footer"></div>').insertAfter(d)),c.pagerBar.appendTo(e)}})}this.pagerBar.find("a").tooltip()},handleEvents:function(){var b=this;b.element.on("afterpaging.pager",function(){var c=a("li[tabindex]:visible, td[tabindex]:visible",b.element);c.length||a("li:visible:first, td:visible:first",b.element).attr("tabindex","0"),a("li a",this.pagerBar).each(function(){var b=a(this),c=b.closest("li");b.is("[disabled]")||c.attr("tabindex","0").on("focus.pager",function(){a("a",this).focus()})})}),a(window).on("resize.pager",function(){b.renderBar()}),this.pagerBar.onTouchClick("pager","a").on("click.pager","a",function(c){var d=a(this).parent();return c.preventDefault(),d.is(".pager-prev")?(b.setActivePage(b.activePage-1,!1,"prev"),!1):d.is(".pager-next")?(b.setActivePage(b.activePage+1,!1,"next"),!1):d.is(".pager-first")?(b.setActivePage(1,!1,"first"),!1):d.is(".pager-last")?(b.setActivePage(b.pageCount(),!1,"last"),!1):(b.setActivePage(a(this).parent().index()+("table"===b.settings.type?-1:0),!1,"page"),!1)}).on("focus.pager","a",function(){var b=a(this).parent("li");b.addClass("is-focused")}).on("blur.pager","a",function(){var b=a(this).parent("li");b.removeClass("is-focused")}),this.pagerBar.on("keydown.pager","a",function(b){b=b||window.event;var c=b.which||b.keyCode||b.charCode||!1,d=a(this).parent(),e=37===c||9===c&&b.shiftKey?d.prev():39===c?d.next():a();(9===c&&b.shiftKey&&d.prev().is(".pager-prev, .pager-first, .pager-count")||9===c&&b.shiftKey&&d.is(".pager-prev, .pager-first"))&&(d.removeAttr("tabindex"),setTimeout(function(){d.attr("tabindex","0")},0)),e=a("a",e).length?e:a(":text",e),e.length&&!e.is("[disabled]")&&e.focus()})},setActivePage:function(a,b,c){var d=this.pagerBar.find(this.buttonExpr);return(!this.activePage||isNaN(this.activePage))&&(this.activePage=this.settings.activePage),0===a||a>this.pageCount()?this.activePage:void 0===a?this.activePage:a!==this.activePage||b?(this.activePage=a,this.settings.source||(d.filter(".selected").removeClass("selected").removeAttr("aria-selected").find("a").removeAttr("aria-disabled").find(".audible").html(Locale.translate("Page")),d.eq(a-1).addClass("selected").attr("aria-selected",!0).find("a").attr("aria-disabled",!0).find(".audible").html(Locale.translate("PageOn"))),this.renderBar(),this.renderPages(!1,c),a):this.activePage},_pageCount:0,pageCount:function(b){var c=this;if(void 0===b&&this.settings.indeterminate&&(this._pageCount=this.settings.pagesize),void 0===b&&!this.settings.source)return this._pageCount;if(void 0!==b&&(this._pageCount=b),!this.isTable){var d,e,f,g,h;for(this.pagerBar.find(this.buttonExpr).remove(),d=b;d>0;d--)d===(this.activePage||1)?(e='class="selected"',f=Locale.translate("PageOn"),g='aria-selected="true"',h='aria-disabled="true"'):(e="",f=Locale.translate("Page"),g="",h=""),a("<li "+e+g+'><a href="#" '+h+'><span class="audible">'+f+" </span>"+d+"</a></li>").insertAfter(this.pagerBar.find(".pager-prev"))}if(this.isTable&&!this.settings.indeterminate&&0===this.pagerBar.find(".pager-count").length){var i=Locale.translate("PageOf");i=i=i.replace("{0}",'<input name="pager-pageno" value="'+this.activePage+'">'),i=i.replace("{1}",'<span class="pager-total-pages">'+(b||1)+"</span>"),a('<li class="pager-count"><label>'+i+" </label>").insertAfter(this.pagerBar.find(".pager-prev"));var j=null;this.pagerBar.find(".pager-count input").on("focus",function(){j=a(this).val()}).on("blur",function(){j!==a(this).val()&&c.setActivePage(parseInt(a(this).val()),!1,"page")}).on("keydown",function(b){13===b.which&&c.setActivePage(parseInt(a(this).val()),!1,"page")})}if(this.isTable&&0===this.pagerBar.find(".btn-menu").length){var k=a('<li class="pager-pagesize"><button type="button" class="btn-menu"> <span>'+Locale.translate("RecordsPerPage").replace("{0}",this.settings.pagesize)+"</span> "+a.createIcon({icon:"dropdown"})+" </button></li>");a(k).insertAfter(this.pagerBar.find(".pager-last"));for(var l=a('<ul class="popupmenu has-icons"></ul>'),m=0;m<c.settings.pagesizes.length;m++){var n=c.settings.pagesizes[m];l.append("<li "+(n===c.settings.pagesize?' class="is-checked"':"")+'><a href="#">'+n+"</a></li>")}k.find("button").after(l),this.pagerBar.find(".btn-menu").popupmenu().on("selected.pager",function(a,b){var d=b;d.closest(".popupmenu").find(".is-checked").removeClass("is-checked"),d.parent("li").addClass("is-checked"),c.settings.pagesize=parseInt(d.text()),c.setActivePage(1,!0,"first")}),a('[href="#25"]').parent().addClass("is-checked")}var o=(""+this._pageCount).replace(/\d/g,"#");return this.pagerBar.find(".pager-count input").attr("data-mask",o).mask(),this._pageCount=this._pageCount||1,this._pageCount},getPageableElements:function(){var a=this.element.children().not(".datagrid-expandable-row");return a.is("ul")&&(a=a.children()),a},renderBar:function(){var b,c,d=this.pagerBar,e=this.element.parent().width()/d.find("li:first").width(),f=Math.floor(e-3);if(this.element.attr("data-pagesize")&&(this.settings.pagesize=this.element.attr("data-pagesize")),!this.settings.source){var g=this.getPageableElements().not(".is-filtered").length;if(c=Math.ceil(g/this.settings.pagesize),this.isTable){var h=function(a){return!a.isFiltered},i=this.settings.dataset.filter(h).length;c=Math.ceil(i/this.settings.pagesize)}this.pageCount(c)}var j=d.find(".pager-prev a"),k=d.find(".pager-next a"),l=d.find(".pager-first a"),m=d.find(".pager-last a"),n=j.add(l).add(".pager-prev").add(".pager-first"),o=k.add(m).add(".pager-next").add(".pager-last");if(n.add(o).removeAttr("disabled tabIndex"),1===this.activePage&&(n.attr({disabled:"disabled",tabIndex:-1}),o.attr({tabIndex:0})),this.activePage===this.pageCount()&&(o.attr({disabled:"disabled",tabIndex:-1}),n.attr({tabIndex:0})),!this.settings.source){if(b=d.find(this.buttonExpr),b.show(),b.length<f)return;b.each(function(){var b=a(this);d.find(".pager-next").offset().top-d.offset().top>1&&!b.is(".selected")&&a(this).hide()})}},pagerInfo:{},setDatagrid:function(){this.datagrid=this.mainContainer?this.mainContainer.children(".datagrid-container").data("datagrid"):null},renders:0,renderPages:function(b,c){var d,e=this,f={activePage:e.activePage,pagesize:e.settings.pagesize,type:c,total:-1};e.renders++,setTimeout(function(){var c=e.element.triggerHandler("beforepaging",f);if(c!==!1){if(e.settings.source&&!b){var g;e.isTable?e.setDatagrid():e.datagrid=e.element.data("listview"),g=function(a,b){b.preserveSelected=!0,e.datagrid.loadData(a,b,!0),e.updatePagingInfo(b),setTimeout(function(){e.element.trigger("afterpaging",b)},1)},e.datagrid.sortColumn&&e.datagrid.sortColumn.sortId&&(f.sortAsc=e.datagrid.sortColumn.sortAsc,f.sortField=e.datagrid.sortColumn.sortField,f.sortId=e.datagrid.sortColumn.sortId),e.datagrid.filterExpr&&(f.filterExpr=e.datagrid.filterExpr),e.settings.source(f,g)}e.element.trigger("paging",f);var h=e.getPageableElements();if(e.settings.source)h.show();else{var i=e.settings.pagesize;e.updatePagingInfo(f),e.setDatagrid(),e.datagrid&&e.datagrid.renderRows(),h.hide(),e.element.children().filter(".datagrid-expandable-row.is-expanded").removeClass("is-expanded").hide(),
e.element.children().find(".datagrid-expand-btn").each(function(){a(this).removeClass(".is-expanded"),a(this).find(".plus-minus").removeClass("active")}),d=1===e.activePage?':not(".is-filtered"):lt('+i+")":':not(".is-filtered"):lt('+e.activePage*i+"):gt("+((e.activePage-1)*i-1)+")",h.filter(d).show()}e.settings.source||e.element.trigger("afterpaging",f)}},0)},updatePagingInfo:function(a){this.settings.pagesize=a.pagesize||this.settings.pagesize,this.isTable&&this.datagrid&&(this.datagrid.settings.pagesize=this.settings.pagesize),this.pagerBar.find(".btn-menu span").text(Locale.translate("RecordsPerPage").replace("{0}",this.settings.pagesize)),this.settings.source&&(this._pageCount=Math.ceil(a.total/this.settings.pagesize),this.activePage=a.activePage,this.setActivePage(this.activePage,!1,"pageinfo")),this.pagerBar.find(".pager-count input").val(this.activePage),"0"!==this._pageCount&&this.pagerBar.find(".pager-total-pages").text(this._pageCount),a.firstPage&&(this.pagerBar.find(".pager-first a").attr({disabled:"disabled",tabIndex:-1}),this.pagerBar.find(".pager-prev a").attr({disabled:"disabled",tabIndex:-1})),a.lastPage&&(this.pagerBar.find(".pager-next a").attr({disabled:"disabled",tabIndex:-1}),this.pagerBar.find(".pager-last a").attr({disabled:"disabled",tabIndex:-1}))},destroy:function(){a.removeData(this.element[0],d)}},this.each(function(){var b=a.data(this,d);b||(b=a.data(this,d,new c(this,f)))})},a.fn.personalize=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="personalize",e={startingColor:""},f=a.extend({},e,b);return c.prototype={init:function(){return this.setColorScheme(this.settings.startingColor,!0),this.handleEvents()},handleEvents:function(){var a=this;return this.element.on("updated."+d,function(){a.updated()}).on("personalizecolors."+d,function(b,c,d){a.setColorScheme(c,d)}).on("changetheme."+d,function(b,c){a.setNewTheme(c)}),this},validateHex:function(a){return a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),"#"+a},setColorScheme:function(a,b){function c(a,c,e){function f(a){b&&g[a+"Class"]("no-transition")}var g=d.element.find(a);d.element.is(a)&&g.add(d.element),f("add"),g.css(c,e),g.height(),f("remove")}if(a&&""!==a&&(a=this.validateHex(a)),a)for(var d=this,e={header:""!==a?a:"",subheader:""!==a?this.getLuminousColorShade(a,.2):""},f=[[".header.is-personalizable","background-color",e.header],[".subheader.is-personalizable","background-color",e.subheader],[".builder-header.is-personalizable","background-color",e.subheader]],g=0;g<f.length;g++)c.apply(null,f[g])},getLuminousColorShade:function(a,b){a=this.validateHex(a).substr(1),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e},availableThemes:["grey-theme","dark-theme","high-contrast-theme"],setNewTheme:function(b){if(-1!==this.availableThemes.indexOf(b)){var c=a("#stylesheet, #sohoxi-stylesheet"),d=c.attr("href"),e=a("<div />").css({background:"rgba(0, 0, 0, 1)",display:"block",height:"100%",left:0,position:"fixed","text-align":"center",top:0,width:"100%","z-index":"999"});a("body").append(e),c.attr("href",d.substring(0,d.lastIndexOf("/"))+"/"+b+(d.indexOf(".min")>-1?".min":"")+".css"),e.fadeOut("slow",function(){e.remove()})}},updated:function(){return this.teardown().init()},teardown:function(){return this.element.off("updated."+d),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.popdown=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="popdown",e={},f=a.extend({},e,b);return c.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){function b(b){return b?("string"==typeof b&&(b.match("#")&&0===b.indexOf("#")||(b="#"+b),b=a(b)),b.length?(c.popdown=b,!0):!1):!1}var c=this;this.popdown=a(),this.trigger=this.element,this.trigger.is(".dropdown, .multiselect")&&(this.trigger=a("#"+this.element.attr("id")+"-shdo"));var d=b(this.trigger.attr("data-popdown"));return d||b(this.trigger.next(".popdown")),this.id=this.popdown.attr("id"),this.id||(this.id="popdown-"+a("body").find(".popdown").index(this.popdown),this.popdown.attr("id",this.id)),this},build:function(){this.popdown.addClass("popdown").removeClass("hidden");var b=this.popdown.children(".popdown-contents");b.length||this.popdown.children().wrap('<div class="popdown-contents"></div>'),this.arrow=a('<div class="arrow"></div>').prependTo(this.popdown),this.place();var c=this.trigger.attr("aria-expanded");return c&&void 0!==c||this.trigger.attr("aria-expanded",""),"true"===c&&this.open(),this.trigger.attr("aria-controls",this.id),this},handleEvents:function(){var a=this;return this.trigger.onTouchClick("popdown").on("click.popdown",function(){a.toggle()}).on("updated.popdown",function(){a.updated()}),this},isOpen:function(){return"true"===this.trigger.attr("aria-expanded")},open:function(){if(!this.isAnimating){var b=this,c=!1;this.isAnimating=!0,this.trigger.attr("aria-expanded","true"),this.position(),this.popdown.addClass("visible"),setTimeout(function(){b.popdown.one("focusin.popdown",function(){c||(c=!0,a(document).on("focusin.popdown",function(c){var d=c.target;a.contains(b.popdown[0],d)||b.close()}))}),a(window).on("resize.popdown",function(){a(document.activeElement).closest(".popdown").length||b.close()}),a(document).on("click.popdown",function(c){var d=a(c.target);d.is(".popdown")||d.closest(".popdown").length||b.close()}),b.isAnimating=!1},400)}},close:function(){if(!this.isAnimating){var b=this;this.isAnimating=!0,this.trigger.attr("aria-expanded","false"),this.popdown.removeClass("visible"),this.popdown.off("focusin.popdown"),a(window).off("resize.popdown"),a(document).off("click.popdown focusin.popdown"),setTimeout(function(){b.popdown.css("display","none"),b.isAnimating=!1},400)}},toggle:function(){return this.isOpen()?void this.close():void this.open()},place:function(){this.scrollparent=a("body"),this.popdown.detach().appendTo(this.scrollparent)},position:function(){var b={offset:{left:0,top:0},scrollDistance:{left:0,top:0}},c=window.innerHeight+a(document).scrollTop(),d=window.innerWidth-2+a(document).scrollLeft();this.popdown.removeAttr("style"),this.arrow.removeAttr("style"),this.scrollparent.length&&(b.offset=this.scrollparent.offset(),b.scrollDistance.top=this.scrollparent.scrollTop(),b.scrollDistance.left=this.scrollparent.scrollLeft(),c-=b.offset.top+b.scrollDistance.top,d-=b.offset.left+b.scrollDistance.left);var e,f=!1,g=!1,h=this.trigger,i=h.offset(),j=11,k=0,l=0;this.popdown.addClass("bottom").css({left:i.left,top:i.top+h.outerHeight(!0)+j}),this.arrow.css({left:h.outerWidth(!0)/2,top:0-j}),e=this.popdown.offset(),e.left<0&&(f=!0,k=0-e.left);var m=e.left+this.popdown.outerWidth(!0);if(m>d&&(f=!0,k=m-d+(Locale.isRTL()?20:0)),f){this.popdown.css({left:e.left+-1*k});var n=this.popdown[0].getBoundingClientRect(),o=h[0].getBoundingClientRect(),p=n.right-o.right+10;this.arrow.css({left:"auto",right:p+"px"}),e=this.popdown.offset()}e.top<0&&(g=!0,l=0-e.top);var q=e.top+this.popdown.outerHeight(!0);q>c&&(g=!0,l=q-c),g&&(this.arrow.css("display","none"),this.popdown.css({top:e.top+-1*l}),this.arrow.css({top:parseInt(this.arrow.css("top"))- -1*l}),e=this.popdown.offset()),(e.top<0||e.top+this.popdown.outerHeight(!0)>c)&&(this.popdown.css({top:0}),e=this.popdown.offset(),q=e.top+this.popdown.outerHeight(!0),this.popdown.css({height:parseInt(this.popdown.css("height"))-(q-c)}))},updated:function(){return this},teardown:function(){return this.isOpen()&&this.close(),this.trigger.offTouchClick("popdown").off("updated.popdown click.popdown").removeAttr("aria-controls").removeAttr("aria-expanded"),this.originalParent&&this.originalParent.length&&this.popdown.detach().appendTo(this.originalParent),this.arrow.remove(),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.popupmenu=function(b){function c(b){this.settings=a.extend({},f),this.element=a(b),this.isOldIe=a("html").is(".ie11, .ie10, .ie9"),this.init()}var d="popupmenu",e={menu:null,trigger:"click",autoFocus:!0,mouseFocus:!0,attachToBody:!1,beforeOpen:null,ariaListbox:!1,useCoordsForClick:!1,eventObj:void 0},f=a.extend({},e,b);return c.prototype={init:function(){this.setup(),this.addMarkup(),this.handleEvents(),this.iconFilteringSetup(),this.fixSvg()},isRTL:function(){return"rtl"===a("html").attr("dir")},fixSvg:function(){var b=this,c=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);c&&setTimeout(function(){b.menu.find("svg.icon").each(function(){var b=a("use",this);b.attr("xlink:href",b.attr("xlink:href"))})},0)},setup:function(){this.element.attr("data-popupmenu")&&!this.settings.menu&&(this.settings.menu=this.element.attr("data-popupmenu").replace(/#/g,"")),this.settings.menuId&&(this.settings.menu=this.settings.menuId,this.settings.menuId=void 0),this.id||(this.id=(parseInt(a(".popupmenu-wrapper").length,10)+1).toString())},addMarkup:function(){function b(){var b=a(this).css("overflow");return"auto"!==b&&"visible"!==b&&"scroll"!==b}var c;switch(typeof this.settings.menu){case"string":c=this.settings.menu,this.menu=a("#"+this.settings.menu);break;case"object":this.menu=null===this.settings.menu?this.element.next(".popupmenu"):a(this.settings.menu),c=this.menu.attr("id"),c&&""!==c||(this.menu.attr("id","popupmenu-"+this.id),c=this.menu.attr("id"))}if(!this.menu.parent().is(".popupmenu-wrapper")){if(0===this.menu.length)return!1;this.settings.attachToBody&&this.menu.parent().not("body").length>0&&(this.originalParent=this.menu.parent(),this.menu.detach().appendTo("body")),this.menu.addClass("popupmenu").data("trigger",this.element).attr("role",this.settings.ariaListbox?"listbox":"menu").wrap('<div class="popupmenu-wrapper"></div>'),this.wrapper=this.menu.parent(".popupmenu-wrapper"),this.menu.parent(".popupmenu-wrapper").attr("role","application").attr("aria-hidden","true"),0===this.wrapper.parents().filter(b).length?this.wrapper.css("position","absolute"):this.wrapper.css("position","fixed"),this.menu.find(".popupmenu").each(function(b,c){var d=a(c);d.parent().hasClass("wrapper")||d.wrap('<div class="wrapper"></div>')});var d=this.element.parent().attr("class");if(this.element.hasClass("btn-menu")||this.element.hasClass("btn-actions")||"colorpicker-menu"===this.settings.menu||this.element.closest(".toolbar").length>0||this.element.closest(".masthead").length>0||this.element.is(".searchfield-category-button")||d&&d.indexOf("more")>=0&&this.element.is(":not(.tab-more)")||d&&d.indexOf("btn-group")>=0){var e=a('<div class="arrow"></div>'),f=this.menu.parent(".popupmenu-wrapper");f.addClass("bottom").append(e)}this.element.closest(".field-short").length&&this.menu.addClass("popupmenu-short"),void 0!==d&&this.element.closest(".masthead").not(".search-results .masthead").length>0&&this.menu.parent(".popupmenu-wrapper").addClass("alternate"),this.element.attr("aria-haspopup",!0),this.element.attr("aria-controls",c),this.markupItems()}},markupItems:function(){this.menu.find("li").attr("role","presentation"),this.menu.find(".popupmenu").parent().parent().addClass("submenu"),this.menu.find(".submenu").children("a").each(function(b,c){var d=a(c);if(0===d.find("span").length){var e=a(d).text();d.html("<span>"+e+"</span>")}0===d.find("svg.arrow").length&&d.append(a.createIconElement({classes:["arrow","icon-dropdown"],icon:"dropdown"})),d.attr("aria-haspopup","true")});var b=this.menu.find("a"),c=this.menu.hasClass("is-translatable");b.attr("tabindex","-1").attr("role",this.settings.ariaListbox?"option":"menuitem"),b.each(function(){var b=a(this);if(c){var d=a("span",b);d.text(Locale.translate(d.text())||d.text())}b.parent().hasClass("is-checked")&&b.attr({role:"menuitemcheckbox","aria-checked":"true"}),b.parent().hasClass("is-not-checked")&&b.attr({role:"menuitemcheckbox","aria-checked":"false"})}),this.menu.find("li.is-disabled a, li.disabled a").attr("tabindex","-1").attr("disabled","disabled")},handleEvents:function(){var b=this;if(("click"===this.settings.trigger||"toggle"===this.settings.trigger)&&this.element.onTouchClick("popupmenu").on("click.popupmenu",function(a){b.element.is(":disabled")||(b.element.closest(".listview").length>0&&(a.stopPropagation(),a.preventDefault()),b.menu.hasClass("is-open")?b.close():b.open(a))}).on("updated.popupmenu",function(a){a.stopPropagation(),b.updated()}),"rightClick"===this.settings.trigger){this.menu.parent().on("contextmenu.popupmenu",function(a){return a.preventDefault(),a.stopPropagation(),!1}),this.element.on("contextmenu.popupmenu",function(a){return a.preventDefault(),!1}).on("mousedown.popupmenu",function(a){(2===a.button||0===a.button&&a.ctrlKey)&&(b.open(a),a.stopPropagation()),a.preventDefault()});var c="popupmenu-f10-label";0===a("#"+c).length&&this.element.after('<span style="display:none;" id="'+c+'">'+Locale.translate("PressShiftF10")+"</span>"),this.element.attr("aria-describedby",c)}"immediate"===this.settings.trigger&&this.open(this.settings.eventObj),this.element.on("keydown.popupmenu",function(a){a.shiftKey&&121===a.which&&b.open(a,!0)})},handleKeys:function(){var b=this;this.menu.onTouchClick("popupmenu","a").on("click.popupmenu","a",function(c){var d=a(this),e=d.attr("href"),f=[d];if(d.attr("disabled")||d.parent().is(".submenu")||d.parent().is(".is-disabled"))return void c.preventDefault();if(!(d.find("input[checkbox]").length>0||(b.element.hasClass("btn-filter")&&(b.iconFilteringUpdate(d),c.preventDefault()),(b.isInSelectableSection(d)||b.menu.hasClass("is-selectable")||b.menu.hasClass("is-multiselectable"))&&(f=b.select(d)),d.parent().hasClass("is-toggleable")&&d.parent().toggleClass("is-checked"),b.element.trigger("selected",f),b.menu.hasClass("is-multiselectable")||b.isInMultiselectSection(d)||(b.close(),b.element.is(".autocomplete"))))){if(e&&"#"!==e.charAt(0))return"_blank"===d.attr("target")?window.open(e,"_blank"):window.location.href=e,!0;c.preventDefault(),c.stopPropagation()}});var c="li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)";this.settings.mouseFocus&&this.menu.on("mouseenter.popupmenu","li",function(){b.highlight(a(this).children("a"))}),a(document).off("keydown.popupmenu."+this.id).on("keydown.popupmenu."+this.id,function(d){var e,f=d.which;if(27===f&&(d.stopPropagation(),b.close(!0)),9===f&&(d.stopPropagation(),b.close(!0)),32===f){d.stopPropagation();var g=a(d.target),h=g.find("input:checkbox");if(h.length)return void h.trigger("click");var i=a();if(g.is(".tab")||g.parent().is(".tab")||g.is(".tab-more"))return void d.preventDefault();if(g.is("li")&&(i=g.children("a")),g.is("a")&&(i=g),i.length)return void i.trigger("click")}e=b.menu.find(":focus");var j="colorpicker-menu"===b.settings.menu,k=b.element.is(".autocomplete");if(37!==f||k||(d.stopPropagation(),d.preventDefault(),e.closest(".popupmenu")[0]!==b.menu[0]&&e.closest(".popupmenu").length>0&&(e.closest(".popupmenu").removeClass("is-open").parent().parent().removeClass("is-submenu-open"),b.highlight(e.closest(".popupmenu").parent().prev("a")))),!j&&38===f||j&&37===f){if(d.stopPropagation(),d.preventDefault(),0===e.parent().prevAll(c).length)return void b.highlight(0===e.length?b.menu.children(c).last().find("a"):e.closest(".popupmenu").children(c).last().find("a"));b.highlight(e.parent().prevAll(c).first().find("a"))}if(j&&38===f&&(d.stopPropagation(),d.preventDefault(),e.parent().prevAll(c).length>0&&b.highlight(a(e.parent().prevAll(c)[9]).find("a"))),39!==f||k||(d.stopPropagation(),d.preventDefault(),e.parent().hasClass("submenu")&&(b.showSubmenu(e.parent()),b.highlight(e.parent().find(".popupmenu a:first")))),!j&&40===f||j&&39===f&&!k){if(d.stopPropagation(),d.preventDefault(),0===e.parent().nextAll(c).length)return void b.highlight(0===e.length?b.menu.children(c).first().find("a"):e.closest(".popupmenu").children(c).first().find("a"));b.highlight(e.parent().nextAll(c).first().find("a"))}j&&40===f&&(d.stopPropagation(),d.preventDefault(),e.parent().nextAll(c).length>0&&b.highlight(a(e.parent().nextAll(c)[9]).find("a")))})},iconFilteringSetup:function(b){if(this.element.hasClass("btn-filter")){var c=this.element.find("svg.icon-dropdown"),d=b||a("li:first a",this.menu),e=d.find("span").text();1===c.length&&this.element.append(a.createIconElement({classes:"icon-dropdown",icon:"dropdown"})),c.first().changeIcon(d.find("svg").getIconName()),this.element.find(".audible").text(e)}},iconFilteringUpdate:function(b){if(this.element.hasClass("btn-filter")){var c=b||a("li:first a",this.menu),d=c.find("span").text();this.element.find(".audible").text(d),this.element.find("svg:not(.ripple-effect):first").changeIcon(c.find("svg").getIconName())}},position:function(b){function c(a){return"x"===a||"y"===a?a:"x"}function d(a,b){return b=c(b),E=!0,B[b]}function e(a){return"x"===a?"left":"top"}function f(a,b){b=c(b);var d=e(b),f=a.offset();return f[d]}function g(a){var b=["keydown","keypress"];return void 0===a||null===a||b.indexOf(a.type)>-1}function h(b,c){var e=v.settings.eventObj;return e&&e.clientX&&e.clientY?d(e,c):"click"===b.type&&v.settings.useCoordsForClick===!0?d(b,c):f(a(b.target),c)}function i(a){return g(b)?f(w,a):h(b,a)}function j(){return w.is(".btn-menu, .btn-actions, .searchfield-category-button, .trigger")}function k(){j()&&y.find(".arrow").css({display:"none"})}function l(a){var b={x:"",y:".autocomplete, .btn-menu, .btn-actions, .searchfield-category-button, .trigger"},c={x:function(){return!1},y:function(){return w.closest(".tab").length||w.closest(".tab-more").length||w.closest(".colorpicker-container").length}};return w.is(b[a])||c[a]()}function m(a,b){var c=w.offset(),d=w.outerWidth(),e=w.outerHeight();if("x"===a){var f=c.left,g=c.left+d;f>A-g&&(b=c.left-C.width,D=!0)}if("y"===a){var h=c.top,i=c.top+e;h>z-i&&(b=c.top-C.height,D=!0)}return b}function n(a){var b={x:".btn-actions",y:""};return w.is(b[a])}function o(a,b){a=c(a);var d="x"===a?"Width":"Height";return l(a)&&(b+=w["outer"+d]()),n(a)&&(b-=C[d.toLowerCase()]),"x"===a&&(w.is(".btn-actions")&&(b+=x?-w.outerWidth():w.outerWidth()),w.is(".btn-filter")&&(b+=x?10:-10)),"y"===a&&(w.is(".btn-actions")&&(b+=5),(w.is(".btn-filter, .searchfield-category-button")||w.closest(".colorpicker-container").length)&&(b+=10)),b}function p(a){a=c(a);var b=e(a);return F.length?G[b]:0}function q(a){return a?(u=-1*t,t+=u,void(C.height=C.height-u)):(u=t+C.height-z,void(C.height=C.height-u))}function r(a){u=-1*s,a||(s+=u),C.width=C.width-u}var s,t,u,v=this,w=this.element,x=this.isRTL(),y=this.menu.parent(".popupmenu-wrapper"),z=a(window).height(),A=a(window).width(),B={x:b&&b.clientX?b.clientX:window.event.clientX,y:b&&b.clientY?b.clientY:window.event.clientY},C={width:this.menu.outerWidth(),height:this.menu.outerHeight()},D=!1,E=!1;switch(w.is("svg, .icon")&&w.closest(".tab").length&&(w=w.closest(".tab")),this.settings.trigger){case"rightClick":s=d(b,"x"),t=d(b,"y");break;default:s=i("x"),t=i("y")}y.find(".arrow").removeAttr("style"),s=o("x",s),t=o("y",t);var F=y.closest(".modal"),G=F.offset();t=m("y",t),this.isOldIe?(s+=p("x"),t+=p("y")):(s-=p("x"),t-=p("y")),y.css({left:s,top:t}),s=y.offset().left,t=y.offset().top;var H=a(window).height()+a(document).scrollTop(),I=a(window).width()+a(document).scrollLeft();t+C.height>H&&(E?(u=t+C.height-H,t-=u,k(),t-a(document).scrollTop()<0&&q(!0)):q()),t-a(document).scrollTop()<0&&q(!0),s+C.width>I&&(u=s+C.width-I,s-=u,s-a(document).scrollLeft()<0&&r(!0),k()),s-a(document).scrollLeft()<0&&(u=-1*s,s+=u,k()),s-=p("x"),t-=p("y"),t-a(document).scrollTop()<0&&q(!0),y.css({top:t,left:s}),this.menu.css({height:C.height,width:C.width}),D&&y.removeClass("bottom").addClass("top"),this.element.is(".btn-filter, .searchfield-category-button")&&y.find(".arrow").css({right:x?"20px":"auto",left:x?"auto":"20px"})},open:function(b,c){var d=this,e=this.element.triggerHandler("beforeopen",[this.menu]);if(e!==!1){if(this.settings.beforeOpen&&!c){var g=function(a){d.menu.empty().append(a),d.markupItems(),d.open(b,!0)};return"string"==typeof f.beforeOpen?void window[f.beforeOpen](g):void f.beforeOpen(g)}a(".popupmenu").not(this.menu).removeClass("is-open"),this.element.addClass("is-open"),this.menu.addClass("is-open").attr("aria-hidden","false"),d.position(b),this.element.closest(".header").length>0&&this.menu.parent().css("z-index","9001"),setTimeout(function(){a(document).on("touchend.popupmenu."+this.id+" click.popupmenu."+this.id,function(b){2!==b.button&&(a(b.target).is(d.element)||0===a(b.target).closest(".popupmenu").length&&d.close())}),void 0===window.orientation&&a(window).on("resize.popupmenu",function(){d.close()}),a(window).on("scroll.popupmenu",function(){d.close()}),a(".scrollable").on("scroll.popupmenu",function(){d.close()}),d.element.trigger("open",[d.menu]),"rightClick"===d.settings.trigger&&d.element.on("click.popupmenu touchend.popupmenu",function(){d.close()})},300),a("iframe").each(function(){var b=a(this);b.ready(function(){try{b.contents().find("body").on("click.popupmenu",function(){d.close()})}catch(a){}})}),this.handleKeys();var h,i,j,k=0;d.menu.find(".popupmenu").removeClass("is-open"),d.menu.on("mouseenter.popupmenu touchstart.popupmenu",".submenu",function(b){var c=a(this);h=b.pageX,clearTimeout(j),j=setTimeout(function(){d.showSubmenu(c)},300),a(document).on("mousemove.popupmenu."+this.id,function(a){k=a.pageX})}).on("mouseleave.popupmenu",".submenu",function(){a(document).off("mousemove.popupmenu."+this.id),i=a(this).find("ul");var b=parseInt(i.parent(".wrapper").css("left"))<0,c=3.5>k-h;b&&(c=k-h>=0),c&&(i.removeClass("is-open").removeAttr("style"),i.parent(".wrapper").removeAttr("style"),i.parent().parent().removeClass("is-submenu-open"),d.element.removeClass("is-open")),clearTimeout(j)}),d.settings.autoFocus&&setTimeout(function(){var a=":not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)",b=d.menu.children(a).find(".is-selected").children("a");b.length||(b=d.menu.children(a).first().children("a")),d.highlight(b),d.element.trigger("afteropen",[d.menu])},1)}},showSubmenu:function(b){var c=b.children(".wrapper").filter(":first");if(0===c.length){var d=b.children("ul").filter(":first");d.wrap('<div class="wrapper"></div>'),c=d.parent()}var e=c.children(".popupmenu"),f=b.parents(".popupmenu-wrapper:first").offset().top;b.parent().find(".popupmenu").removeClass("is-open").removeAttr("style"),c.css({left:b.position().left+b.outerWidth(),top:parseInt(b.position().top)-5+"px"}).children(".popupmenu").addClass("is-open");var g=e.outerWidth();if(c.offset().left+g>a(window).width()+a(document).scrollLeft()&&(c.css("left",-9999),g=e.outerWidth(),c.css("left",b.position().left-g),c.offset().left<0&&(c.css("left",b.position().left-g+Math.abs(c.offset().left)+40),g=e.outerWidth()),c.offset().left+g>a(window).width()+a(document).scrollLeft())){var h=c.offset().left+g-(a(window).width()+a(document).scrollLeft());g-=h,e.width(g)}var i=e.outerHeight();if(c.offset().top+i>a(window).height()+a(document).scrollTop()){var j=c.offset().top+i,k=j-(a(window).height()+a(document).scrollTop());if(c.css("top",c.position().top-k),c.offset().top+i>a(window).height()+a(document).scrollTop()&&c.css("top",a(window).height()+a(document).scrollTop()-i-f),c.offset().top-a(document).scrollTop()<0&&(c.css("top",0),c.css("top",-1*c.offset().top),i=e.outerHeight()),c.offset().top+i>a(window).height()+a(document).scrollTop()){var l=c.offset().top+i-(a(window).height()+a(document).scrollTop());i=i-l-32,e.height(i)}}b.parent().find(".is-submenu-open").removeClass("is-submenu-open"),b.addClass("is-submenu-open")},highlight:function(a){if(!a||!a.length)return!1;var b=a.parent();b.parent().children("li").removeClass("is-focused"),b.addClass("is-focused"),a.focus(),b.closest(".header").scrollTop(0)},select:function(a){var b=this.menu.is(".is-selectable"),c=this.menu.is(".is-multiselectable"),d=this.isInSingleSelectSection(a),e=this.isInMultiselectSection(a),f=a.parent(),g=[a,"selected"];if(b||c||d||e)return b||d?(f.prevUntil(".heading, .separator").add(f.nextUntil(".heading, .separator")).removeClass("is-checked"),f.addClass("is-checked"),g):c||e?f.hasClass("is-checked")?(g[1]="deselected",f.removeClass("is-checked"),g):(f.addClass("is-checked"),g):void 0},getSelected:function(){return this.menu.is(".is-selectable, .is-multiselectable")?this.menu.children(".is-checked").children("a"):a()},isInSelectableSection:function(a){var b=a.parent().prevAll().filter(".separator").first();return b.hasClass("multi-selectable-section")||b.hasClass("single-selectable-section")},isInSingleSelectSection:function(a){return a.parent().prevAll().filter(".separator").first().hasClass("single-selectable-section")},isInMultiselectSection:function(a){return a.parent().prevAll().filter(".separator").first().hasClass("multi-selectable-section")},detach:function(){a(document).off("click.popupmenu touchend.popupmenu keydown.popupmenu"),a(window).off("scroll.popupmenu resize.popupmenu"),a(".scrollable").off("scroll.popupmenu"),this.menu.off("click.popupmenu touchend.popupmenu touchcancel.popupmenu"),"rightClick"===this.settings.trigger&&this.element.off("click.popupmenu touchend.popupmenu"),a("iframe").each(function(){var b=a(this);try{b.contents().find("body").off("click.popupmenu touchend.popupmenu touchcancel.popupmenu")}catch(c){}})},close:function(b,c){b&&void 0!==b||(b=!1),this.menu.removeClass("is-open").attr("aria-hidden","true").css({height:"",width:""}),this.menu.parent(".popupmenu-wrapper").css({left:"-999px",height:"",width:""}),this.menu.find(".submenu").off("mouseenter mouseleave").removeClass("is-submenu-open"),this.menu.find(".popupmenu").css({left:"",top:"",height:"",width:""}),this.menu.find(".is-focused").removeClass("is-focused"),a(document).off("keydown.popupmenu."+this.id+" click.popupmenu."+this.id+" mousemove.popupmenu."+this.id),this.menu.off("click.popupmenu touchend.popupmenu touchcancel.popupmenu mouseenter.popupmenu mouseleave.popupmenu"),this.element.removeClass("is-open").triggerHandler("close",[b]),this.detach(),"immediate"===this.settings.trigger&&this.destroy(),c||a(document.activeElement).is("body")&&this.element.focus()},teardown:function(){function b(a){a.parent().is(".popupmenu-wrapper")&&a.unwrap()}var c=this.menu.parent(".popupmenu-wrapper");return this.menu.parent().off("contextmenu.popupmenu"),this.element.hasClass("btn-actions")&&this.menu.parent().removeClass("bottom").find(".arrow").remove(),this.originalParent&&this.menu.detach().appendTo(this.originalParent),this.menu.find(".submenu").children("a").each(function(b,c){var d=a(c).find("span").text();a(c).find("span, svg").remove(),a(c).text(d)}),b(this.menu),this.menu.find(".popupmenu").each(function(){b(a(this))}),a.removeData(this.menu[0],"trigger"),c.remove(),this.detach(),this.element.removeAttr("aria-controls").removeAttr("aria-haspopup").off("touchend.popupmenu touchcancel.popupmenu click.popupmenu keypress.popupmenu contextmenu.popupmenu mousedown.popupmenu"),this},updated:function(){this.teardown().init()},destroy:function(){this.teardown(),this.menu.trigger("destroy"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?("function"==typeof e[b]&&e[b](),e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.progress=function(b){function c(b){this.element=a(b),this.settings=f,this.init()}var d="progress",e={animationLength:1e3},f=a.extend({},e,b);return c.prototype={init:function(){var a=this;a.update(),this.element.off("updated.progress").on("updated.progress",function(b){b.stopPropagation(),a.update()})},updateAria:function(a){this.element.attr({role:"progressbar","aria-valuenow":a,"aria-maxvalue":"100"});var b=this.element.parent();b.data("tooltip")?b.data("tooltip").content=a+"%":b.attr("title",a+"%").tooltip()},update:function(a){var b=this.element.attr("data-value");a&&(b=a),this.element.css("width",b+"%"),this.updateAria(b)},destroy:function(){a.removeData(this.element[0],d),this.element.off("updated.progress")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.mask=function(b){function c(b){this.settings=a.extend({},h),this.element=a(b),this.init()}var d="mask",e={pattern:"",placeholder:"_",definitions:{"#":/[0-9]/,0:/[0-9]/,x:/[\u00C0-\u017Fa-zA-Z]/,"*":/[\u00C0-\u017Fa-zA-Z0-9]/,"~":/[-0-9]/,a:/[APap]/,m:/[Mm]/},groupComplete:!1,mode:void 0,mustComplete:!1,negative:!1,number:!1,processOnInitialize:!0,thousandsSeparator:!1,showSymbol:void 0},f=["group","number","date","time"],g=["currency","percent"],h=a.extend({},e,b);return c.prototype={init:function(){var b=this;b.buffer="",b.env={pasteEvent:b.getPasteEvent(),ua:navigator.userAgent,iPhone:/iphone/i.test(this.ua)},this.element.addClass("is-mask");var c=this.element.attr("data-mask")||!1;c&&(this.settings.pattern=c);var d=this.element.attr("data-mask-mode")||!1;d&&(this.settings.mode=d),this.settings.mode&&-1===a.inArray(this.settings.mode,f)&&(this.settings.mode="group");var e=this.element.attr("data-thousands")||!1;e&&(this.settings.thousandsSeparator="true"===e),this.settings.thousandsSeparator=-1!==this.settings.pattern.indexOf(",")||this.settings.thousandsSeparator,this.settings.negative="number"===this.settings.mode&&-1!==this.settings.pattern.indexOf("-");var h=this.element.attr("data-must-complete")||!1;h&&(this.settings.mustComplete=h);var i,j=this.settings.showSymbol;if(j===!0&&(j="currency"),j&&void 0!==j&&-1!==g.indexOf(j)&&"number"===this.settings.mode){switch(j){case"currency":i=Locale.currentLocale.data?Locale.currentLocale.data.currencySign:"$";break;case"percent":i="%"}a('<span class="audible '+j+'"></span>').text(" "+i).appendTo(b.element.prev("label")),this.element.parent(".field").attr("data-currency-symbol",""+i).addClass(j)}var k="addClass";"number"!==b.settings.mode&&(b.maskParts=b.getPatternParts(),k="removeClass"),this.element[k]("is-number-mask");var l=b.element.attr("data-group-complete");if(l&&(this.settings.groupComplete=!0),"time"===this.settings.mode&&(this.settings.groupComplete=!0),b.element.on("keypress.mask "+b.env.pasteEvent,function(a){return b.element.prop("readonly")?(a.preventDefault(),!1):void b.handleKeyEvents(b,a)}),b.element.on("focus.mask",function(a){return b.element.prop("disabled")||b.element.prop("readonly")?(a.preventDefault(),!1):void(b.initValue=b.element.val())}),b.element.on("updated.mask",function(a){b.evaluateCurrentContents(void 0,a)}),b.element.on("blur.mask",function(a){if(b.element.prop("readonly"))return a.preventDefault(),!1;var c=b.element.val();b.settings.mustComplete&&b.checkCompletion(),c&&b.initValue!==c&&b.element.trigger("change"),b.initValue=null}),this.element.is(":hidden")||!this.settings.processOnInitialize)return this;var m=b.element.val();return m.length>0&&(b.element.val(""),b.processStringAgainstMask(m)),this},getPasteEvent:function(){var a=document.createElement("input"),b="onpaste";return a.setAttribute(b,""),("function"==typeof a[b]?"paste":"input")+".mask"},killEvent:function(a){return a&&(a.returnValue=!1,a.preventDefault&&a.preventDefault()),!1},caret:function(a,b){var c,d=this;return 0===d.element.val().length||d.element.is(":hidden")?{begin:0,end:0}:"number"==typeof a?(b="number"==typeof b?b:a,d.element.each(function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())})):(d.element[0].setSelectionRange?(a=d.element[0].selectionStart,b=d.element[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),
b=a+c.text.length),{begin:a,end:b})},moveCursor:function(a,b){var c=this,d=c.caret();switch(a=c.evaluateDirecton(a),b=b||1,a){case"next":c.caret(d.begin+b);break;case"prev":c.caret(d.begin-b)}},evaluateDirecton:function(b){if(!b)return"current";var c=["current","next","prev"],d=a.inArray(b,c);return c[d]},checkCompletion:function(){var a=this.element.val().length,b=this.settings.pattern.length;b!==a&&this.element.val("")},evaluateCurrentContents:function(b,c){(null===b||void 0===b)&&(b=this.element.val()),c||(c=a.Event()),this.element.val(""),document.activeElement===c.target&&this.caret(0),this.processStringAgainstMask(b,c)},handleKeyEvents:function(b,c){var d=c||window.event,e=d.originalEvent.type,f=c.which,g=a.actualChar(c);if(b.initValue||(b.initValue=b.element.val()),"keypress"===e){if(d.ctrlKey||d.metaKey||32>f)return;d.altKey&&b.killEvent(c),"number"===b.settings.mode?b.processNumberMask(g,d):b.processMask(g,d)}"paste"===e&&b.handlePaste(d)},handleBackspace:function(a){var b=this.element.val();if(0<b.length){var c=this.caret(),d=c.end-c.begin,e=d>0?c.begin:c.begin-1,f=b.slice(e,c.end);b=this.deleteAtIndex(b,f,e),this.evaluateCurrentContents(b,a),this.caret(e)}return this.killEvent(a)},handleEscape:function(a){var b=this;return b.element.val(b.initValue),b.caret(0,b.initValue.length),b.initValue=null,b.killEvent(a)},handleTab:function(a){return this.evaluateCurrentContents(void 0,a)},handlePaste:function(a){var b=a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData?a.originalEvent.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):!1;if(b){var c=2*this.settings.pattern.length>b.length?b.length:2*this.settings.pattern.length,d=b.substring(0,c);this.processStringAgainstMask(d,a)}this.element.trigger("afterpaste.mask"),this.killEvent(a)},isCharacterLiteral:function(b){return-1===a.inArray(b,Object.keys(this.settings.definitions))},isCharacterDecimal:function(a){return"."===a},insertAtIndex:function(a,b,c){return a.substring(0,c)+b+a.substring(c)},replaceAtIndex:function(a,b,c){return a.substr(0,c)+b+a.substr(c+b.length)},deleteAtIndex:function(a,b,c){return a.substr(0,c)+a.substr(c+b.length)},resetStorage:function(){this.originalPos=null,this.currentMaskBeginIndex=null,this.buffer=""},writeInput:function(){var a=this.element.val(),b=this.originalPos,c=this.buffer.length,d=""+this.settings.pattern,e=d.length;a=this.insertAtIndex(a,this.buffer,b.begin);var f=a.substring(b.begin+c,b.end+c);if(a=a.replace(f,""),a=a.substring(0,e),this.settings.negative&&-1===a.indexOf("-")&&(d=d.substring(1),e=d.length,a=a.substring(0,e)),"number"===this.settings.mode){a=this.replaceAllButFirst(/-/g,a,""),a=this.replaceAllButFirst(/\./g,a,"");var g=a.replace(/^0+(?!\.|$)/,""),h=a.length-g.length;a=g;var i=a,j=d.replace(/,/g,"").split("."),k=j[0].length+(j[1]?j[1].length:0);if(a=a.replace(/(\.|,)/g,""),-1!==d.indexOf("."))if(-1!==i.indexOf(".")){var l=i.split(".");a.length>k&&(a=a.substring(0,k)),a=l[1].length<=j[1].length?l[0].length>=j[0].length?this.insertAtIndex(a,".",j[0].length):this.insertAtIndex(a,".",i.replace(/,/g,"").indexOf(".")):this.insertAtIndex(a,".",a.length-j[1].length)}else a.length>k&&(a=a.substring(0,k)),a.length>j[0].length&&(a=this.insertAtIndex(a,".",j[0].length));else a.length>k&&(a=a.substring(0,k));if(this.settings.thousandsSeparator){var m=a.length-a.replace(/\./g,"").length>0,n=m?a.split("."):[a],o=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");n[0]=o,a=n[1]&&""!==n[1]?n.join("."):n[0]+(m?".":"");var p=i.substring(0,b.end!==b.begin?b.end:b.begin),q=p.length,r=q-p.replace(/,/g,"").length,s=a.substring(0,q),t=s.length,u=t-s.replace(/,/g,"").length;r>u&&(b.begin=b.begin-h-(r-u)),u>r&&(b.begin=b.begin-h+(u-r));for(var v=/(\.|,)/,w=a.substring(b.begin,b.begin+1);b.begin<a.length&&v.test(w);)b.begin=b.begin+1,w=a.substring(b.begin,b.begin+1)}}this.element.val(a);var x=b.begin+c,y=x>=e?e:x;this.caret(y),this.element.trigger("write.mask")},processNumberMask:function(a,b){var c,d,e=this,f=e.element.val(),g=e.settings.pattern.replace(/#/g,""),h=e.settings.pattern.length-g.length;if(e.originalPos=e.caret(),e.currentMaskBeginIndex=e.currentMaskBeginIndex||e.originalPos.begin,e.currentMaskBeginIndex>=e.settings.pattern.length)return e.resetStorage(),e.killEvent(b);var i=f.substring(0,e.originalPos.begin),j=i.length!==i.replace(/\./g,"").length,k=f.replace(/\./g,""),l=f.length!==k.length,m=i.length-i.replace(/,/g,"").length,n=i.length-m;if(d=e.getCharacter("current",n),j){var o=e.settings.pattern.split(".")[1],p=i.split(".")[1],q=e.originalPos.begin-1-i.indexOf(".");d=o.charAt(q);var r=f.substring(e.originalPos.begin,e.originalPos.end);return r.length<f.length&&p.length>=o.length?(e.resetStorage(),e.killEvent(b)):(c=e.testCharAgainstRegex(a,d))?(e.buffer+=a,e.writeInput(),e.resetStorage(),e.killEvent(b)):(e.resetStorage(),e.killEvent(b))}var s=e.settings.pattern.length!==e.settings.pattern.replace(/\./g,"").length;if(e.isCharacterDecimal(a)){if(!s)return e.resetStorage(),e.killEvent(b);if(l){var t=f.substring(e.originalPos.begin,e.originalPos.end),u=t.length!==t.replace(/\./g,"").length;return u&&(t.length===f.length&&(e.buffer+="0"),e.buffer+=a,e.writeInput()),e.resetStorage(),e.killEvent(b)}return(0===f.length||0===e.originalPos.begin)&&(e.buffer+="0"),e.buffer+=a,e.writeInput(),e.resetStorage(),e.killEvent(b)}if(e.isCharacterDecimal(d))return l||(e.buffer+=d),d=e.getCharacter("next",n),c=e.testCharAgainstRegex(a,d),c&&(e.buffer+=a),e.writeInput(),e.resetStorage(),e.killEvent(b);if("-"===a)return!e.settings.negative||e.originalPos.begin>0?(e.resetStorage(),e.killEvent(b)):(e.buffer+=a,e.writeInput(),e.resetStorage(),e.killEvent(b));var v=f.split("."),w=v[0].replace(/,/g,""),x=w.replace(/-/g,""),y=x.length;return c=e.testCharAgainstRegex(a,d),c||e.settings.negative&&e.testCharAgainstRegex(a,"~")?y>=h?(e.buffer+=!l&&s?"."+a:a,e.writeInput(),e.resetStorage(),e.killEvent(b)):(e.buffer+=a,e.writeInput(),e.resetStorage(),e.killEvent(b)):(e.resetStorage(),e.killEvent(b))},getPatternParts:function(){var b,c=this,d=Object.keys(this.settings.definitions),e=[],f=[],g=!1,h=0,i="";a.each(d,function(a,b){i+=b}),i="["+i+"]+",b=new RegExp(i,"g"),e=c.settings.pattern.match(b)||[],e[0]&&c.settings.pattern.substring(0,1)!==e[0].substring(0,1)&&(f.push(c.settings.pattern.substring(0,c.settings.pattern.indexOf(e[0]))),g=!0);for(var j=f&&f[0]?c.settings.pattern.indexOf(f[0])+f[0].length:0;h<e.length;){var k=j+e[h].length,l=c.settings.pattern.substring(k,c.settings.pattern.length),m=c.settings.pattern.length-l.length,n=m+(e[h+1]?l.indexOf(e[h+1]):l.length),o=c.settings.pattern.substring(k,n);""!==o&&f.push(o),j=n,h++}for(var p="",q=0;q<f.length;q++)p+=f[q];for(var r=c.removeDuplicates(p),s="",t=0;t<e.length;t++)s+=e[t];var u=c.removeDuplicates(s);return{editable:e,literal:f,allLiterals:p,allEditables:s,containedLiterals:r,containedEditables:u,startsWithLiteral:g}},analyzeInput:function(b){var c=this,d=void 0!==b?b:c.element.val(),e=!1,f=c.maskParts.editable,g=c.maskParts.literal,h=f.length+g.length,i=[],j=[],k="",l="",m="",n=0,o=0,p="",q="",r=0,s=0,t=0,u=0,v=0;for(c.maskParts.startsWithLiteral&&(e=!0),u;h>u;u++)if(e){for(k=d.substring(r,d.length),o=r+k.length,q="",v=0;v<k.length;v++)if(-1===a.inArray(k[v],c.maskParts.containedLiterals)){o=r+v;break}q=d.substring(r,o),q.length>0&&j.push(q),m+=q,r+=q.length,e=!1,t++}else{for(k=d.substring(r,d.length),n=r+k.length,p="",v=0;v<k.length;v++)if(-1!==a.inArray(k[v],c.maskParts.containedLiterals)){n=r+v;break}p=d.substring(r,n),p.length>0&&i.push(p),l+=p,r+=p.length,e=!0,s++}return 0===i.length&&i.push(""),{editables:i,allEditables:l,literals:j,allLiterals:m}},buildPatternFromParts:function(){var a=this.getPatternParts(),b="",c=0,d=0;for(a.startsWithLiteral&&(b+=a.literal[0],c++),a.literal===a.editable;d<a.editable.length;)b+=a.editable[d],a.literal[c]&&(b+=a.literal[c]),d++,c++;return b},removeDuplicates:function(b){for(var c=[],d=0;d<b.length;d++)-1===a.inArray(b[d],c)&&c.push(b[d]);return c},processMask:function(b,c){var d,e=this,f=e.maskParts.editable,g=e.maskParts.literal,h=0;e.originalPos=e.caret(),e.currentMaskBeginIndex=e.currentMaskBeginIndex||e.originalPos.begin;var i=e.element.val().substring(0,e.originalPos.begin),j=e.analyzeInput(i);if(e.originalPos.begin===e.originalPos.end&&j.allEditables.length>=e.maskParts.allEditables.length)return e.resetStorage(),e.killEvent(c);for(var k=0;k<e.maskParts.containedEditables.length&&!(d=e.testCharAgainstRegex(b,e.maskParts.containedEditables[k]));k++);if(!d&&-1===a.inArray(b,e.maskParts.containedLiterals))return e.resetStorage(),e.killEvent(c);h=0,e.maskParts.startsWithLiteral&&(h+=1);var l=j.editables.length-1>0?j.editables.length-1:0;if(j.editables[l].length>f[l].length)return e.resetStorage(),e.killEvent(c);var m=void 0!==g[l+h]&&-1!==a.inArray(b,e.maskParts.containedLiterals)&&!j.literals[l+h];if(m&&!e.settings.groupComplete&&j.editables[l].length>0)return e.checkSectionForLiterals(c,b,g[l+h]),e.writeInput(),e.resetStorage(),e.killEvent(c);if(m&&e.settings.groupComplete&&j.editables[l].length===f[l].length)return e.checkSectionForLiterals(c,b,g[l+h]),e.writeInput(),e.resetStorage(),e.killEvent(c);if(h>0&&0===l&&!j.literals[0]&&(e.buffer+=g[0],-1!==a.inArray(b,e.maskParts.containedLiterals)))return e.writeInput(),e.resetStorage(),e.killEvent(c);var n,o,p,q=j.editables[l]||"";return q.length<f[l].length?(o=f[l].substring(j.editables[l].length,j.editables[l].length+1),j.literals[l+h]&&g[l+h]!==j.literals[l+h]&&(n=e.element.val(),p=n.substring(e.originalPos.begin,n.length),i=i.substring(0,i.length-j.literals[l+h].length),e.caret(e.originalPos.begin-j.literals[l+h].length),e.originalPos=e.caret(),e.element.val(i+p),e.buffer+=g[l+h],o=f[l+1].substring(0,1)),d=e.testCharAgainstRegex(b,o),-1===a.inArray(b,e.maskParts.containedLiterals)&&d&&(e.buffer+=b,e.writeInput())):q.length===f[l].length&&(f[l+1]&&g[l+h]?(j.literals[l+h]&&g[l+h]!==j.literals[l+h]&&(n=e.element.val(),p=n.substring(e.originalPos.begin,n.length),i=i.substring(0,i.length-j.literals[l+h].length),e.caret(e.originalPos.begin-j.literals[l+h].length),e.originalPos=e.caret(),e.element.val(i+p),e.buffer+=g[l+h]),j.literals[l+h]||(e.buffer+=g[l+h]),o=f[l+1].substring(0,1),d=e.testCharAgainstRegex(b,o),-1===a.inArray(b,e.maskParts.containedLiterals)&&d&&(e.buffer+=b)):(n=e.element.val(),p=n.substring(e.originalPos.begin,n.length),p.length>0&&e.element.val(n.substring(0,e.originalPos.begin))),e.buffer.length>0&&e.writeInput()),e.resetStorage(),e.killEvent(c)},checkSectionForLiterals:function(a,b,c){for(var d=0;d<c.length;d++)if(b===c[d]){this.buffer+=c;break}},processStringAgainstMask:function(a,b){if(this.element.is(":hidden"))return this;switch(this.settings.mode){case"number":var c=/[^0-9.-]/g;this.settings.negative||(c=/[^0-9.]/g),a=a.replace(c,""),this.originalPos||(this.originalPos=this.caret()),this.buffer=a,this.writeInput(),this.resetStorage();break;default:for(var d=a.split(""),e=0;e<d.length;e++){var f=this.getCharacter();this.processMask(d[e],f,b)}}return this},testCharAgainstRegex:function(a,b){var c=this.settings.definitions[b];return c?c.test(a):!1},replaceAllButFirst:function(a,b,c){c||(c="");var d=0;return b=b.replace(a,function(a){return d>0?c:a})},getCharacter:function(a,b){var c="number"===this.settings.mode?this.settings.pattern.replace(/,/g,""):this.settings.pattern,d=b?b:this.caret().begin;switch(a=this.evaluateDirecton(a)){case"next":return c.substring(d+1,d+2);case"prev":return c.substring(d-1,d);default:return c.substring(d,d+1)}},updated:function(){return this.teardown().init()},teardown:function(){return this.settings.showCurrency&&(this.element.parent(".field").removeClass("currency").attr("data-currency-symbol",""),this.element.prev("label").find(".currency").remove()),this.element.off("keydown.mask keypress.mask keyup.mask focus.mask blur.mask "+this.env.pasteEvent),this.element.removeClass("is-mask").removeClass("is-number-mask"),this},destroy:function(){return this.teardown(),a.removeData(this.element[0],d),this}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,h))})},a.fn.multiselect=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="multiselect",e={maxSelected:void 0,source:void 0},f=a.extend({},e,b);return c.prototype={init:function(){this.build()},build:function(){var a={closeOnSelect:!1,empty:!0,moveSelectedToTop:!0,multiple:!0};return this.settings.source&&(a.source=this.settings.source),this.settings.maxSelected&&(a.maxSelected=this.settings.maxSelected),this.element.dropdown(a),this.dropdown=this.element.data("dropdown"),this},enable:function(){this.dropdown.enable()},disable:function(){this.dropdown.disable()},destroy:function(){this.dropdown.destroy(),this.element.off(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?e.settings=a.extend({},e.settings,b):e=a.data(this,d,new c(this,f))})},a.fn.message=function(b){function c(b){this.element=a(b),this.init()}var d={title:"Message Title",isError:!1,message:"Message Summary",width:"auto",buttons:null,cssClass:null,returnFocus:null},e=a.extend({},d,b);return c.prototype={init:function(){var b,c=this;this.message=a('<div class="modal message"></div>'),this.messageContent=a('<div class="modal-content"></div>'),this.title=a('<h1 class="modal-title" id="message-title">'+e.title+"</h1>").appendTo(this.messageContent).wrap('<div class="modal-header"></div>'),this.content=a('<div class="modal-body"><p class="message" id="message-text">'+e.message+"</p></div>").appendTo(this.messageContent),this.element.is("body")||(b=this.element,this.content.empty().append(b.show())),this.message.append(this.messageContent).appendTo("body"),this.message.modal({trigger:"immediate",buttons:e.buttons,resizable:e.resizable,close:e.close,isAlert:!0}),"auto"!==e.width&&this.content.closest(".modal").css({"max-width":"none",width:e.width}),e.cssClass&&this.message.addClass(e.cssClass),this.message.on("beforeclose.message",function(){var a=c.element.triggerHandler("beforeclose");return a}).on("beforeopen.message",function(){var a=c.element.triggerHandler("beforeopen");return a}).on("open.message",function(){c.element.trigger("open")}).on("afterclose.message",function(){c.destroy(),e.returnFocus&&e.returnFocus.focus(),a(document).off("keypress.message keydown.message")}),a(document).on("keypress.message keydown.message",function(a){var b=a.which||a.keyCode;27===b&&setTimeout(function(){var a=c.message.data("modal");void 0!==a&&a.close()},0)}),e.isError?this.title.addClass("is-error").prepend(a.createIconElement("error")):this.title.removeClass("is-error").find("svg").remove()},destroy:function(){var a=this.message.data("modal");void 0!==a&&a.destroy(),this.message.off("beforeclose.message beforeopen.message open.message afterclose.message").remove()}},this.each(function(){new c(this,e)})},a.fn.modal=function(b){function c(b){this.settings=a.extend({},f),this.element=a(b),this.init(),this.reStructure()}var d="modal",e={trigger:"click",buttons:null,isAlert:!1,content:null,cssClass:null,autoFocus:!0,id:null,frameHeight:180},f=a.extend({},e,b);return c.prototype={init:function(){var b=this;return this.id=parseInt(a(".modal").length,10)+1,this.trigger=a('button[data-modal="'+this.element.attr("id")+'"]'),this.overlay=a('<div class="overlay"></div>'),this.oldActive=this.trigger,"click"===this.settings.trigger&&this.trigger.on("click.modal",function(){b.open()}),"immediate"===this.settings.trigger&&setTimeout(function(){b.open()},1),b.isCancelled=!1,this.settings.content?(this.settings.trigger=this.settings.content instanceof jQuery?this.settings.trigger:"immediate",this.appendContent(),void setTimeout(function(){b.open()},1)):(b.addButtons(this.settings.buttons),void this.element.css({display:"none"}).appendTo("body"))},appendContent:function(){var b=!1;this.element=a('<div class="modal"><div class="modal-content"><div class="modal-header"><h1 class="modal-title">'+this.settings.title+'</h1></div><div class="modal-body-wrapper"><div class="modal-body"></div></div></div></div>'),this.settings.id&&this.element.attr("id",this.settings.id),a(this.settings.content).is(".modal")?this.element=a(this.settings.content):this.settings.content&&this.settings.content.length>0&&(this.settings.content instanceof jQuery&&this.settings.content.parent().is(".modal-body")?(b=!0,this.element=this.settings.content.closest(".modal")):this.element.find(".modal-body").append(this.settings.content),this.settings.content instanceof jQuery&&this.settings.content.show()),b||this.element.appendTo("body"),this.settings.cssClass&&this.element.addClass(this.settings.cssClass),this.settings.title&&this.element.find(".modal-title").text(this.settings.title),b||this.addButtons(this.settings.buttons)},reStructure:function(){var b=a(".modal-body",this.element),c=a("hr:first-child",b),d=a(".modal-buttonset",this.element);b&&b.length&&!b.parent().hasClass("modal-body-wrapper")&&b.wrap('<div class="modal-body-wrapper"></div>'),c&&c.length&&!c.parent().hasClass("modal-content")&&c.insertAfter(this.element.find(".modal-header")),d&&d.length&&!d.parent().hasClass("modal-content")&&d.insertAfter(this.element.find(".modal-body-wrapper"))},disableSubmit:function(){var b=this.element,c=b.find("[data-validate]"),d=b.find(".modal-buttonset button");if(c.length>0){var e=!0;c.each(function(){var b=a(this);b.val()||(e=!1),e&&d.filter(".btn-modal-primary").not(".no-validation").removeAttr("disabled")}),e||d.filter(".btn-modal-primary").is(":disabled")||d.filter(".btn-modal-primary").not(".no-validation").attr("disabled","true")}},addButtons:function(b){var c,d=this,e=this.element.find(".modal-body"),f=e.parent(),g=100,h=!1;if(this.modalButtons=b,!b){var i=this.element.find(".modal-buttonset button");return g=100/i.length,i.css("width",g+"%").button(),void i.not("[data-ng-click], [ng-click], [onclick], :submit").on("click.modal",function(b){a(b.target).is(".btn-cancel")&&(d.isCancelled=!0),d.close()})}if(this.element.is(".contextual-action-panel")){if(h=!0,c=this.element.find(".buttonset"),!c.length){var j=this.element.find(".toolbar");j.length||a('<div class="toolbar"></div>').appendTo(this.element.find(".modal-header")),c=a('<div class="buttonset"></div>').appendTo(this.element.find(".toolbar"))}}else c=this.element.find(".modal-buttonset"),c.length||(c=a('<div class="modal-buttonset"></div>').insertAfter(f));g=100/b.length,b&&c.empty(),a.each(b,function(b,e){var f=a('<button type="button"></button>');f.text(e.text),"separator"===e.cssClass&&(f=a('<div class="separator"></div>')),e.cssClass?f.attr("class",e.cssClass):f.addClass(e.isDefault?"btn-modal-primary":"btn-modal"),void 0===e.validate||e.validate||f.addClass("no-validation");for(var i={},j=["id","name","text"],k=0;k<j.length;k++)e[j[k]]&&("text"===j[k]&&(i.placeholder=e[j[k]]),i[j[k]]=e[j[k]]);if("input"===e.type){var l=a('<label class="audible" for="filter">'+e.text+"</label>"),m=a('<input class="searchfield">').attr(i);return void c.append(l,m)}e.icon&&"#"===e.icon.charAt(0)&&(f.html("<span>"+f.text()+"</span>"),a.createIconElement({classes:["#icon-close"===e.icon?"icon-close":""],icon:e.icon.substr("#icon-".length)}).prependTo(f)),e.id&&f.attr("id",e.id),f.on("click.modal",function(a){return e.click?void e.click.apply(d.element[0],[a,d]):void d.close()}),h||f.css("width",g+"%"),f.button(),c.append(f)})},sizeInner:function(){var b;b=this.element.find(".detailed-message");var c=a(window).height()-b.offset().top-150;b.css({"max-height":c,overflow:"auto",width:b.width()})},open:function(){function b(){var a=d.element.find(":focusable").not(".modal-header .searchfield").first();if(d.keepFocus(),d.element.trigger("open",[d]),0===a.length&&(a=d.element.find(".btn-modal-primary")),1===a.length&&a.is(".btn-modal")&&(a=d.element.find(".btn-modal-primary")),1===a.length&&a.is("button")&&!a.is(":disabled")&&a.addClass("hide-focus"),d.settings.autoFocus){var b,c;return a.is(".tab:not(.is-selected) a")&&(c=a.closest(".tab-container"),b=c.find(".is-selected"),b.length)?(a=b,void c.data("tabs").select(b.children("a").attr("href"))):void a.focus()}}var c,d=this,e=!0;if(this.trigger&&0!==this.trigger.length||(this.oldActive=a(":focus")),e=this.element.triggerHandler("beforeopen"),d.isCancelled=!1,e===!1)return!1;if(this.element.after(this.overlay),c=d.element.find(".detailed-message"),1===c.length&&(a(window).on("resize.modal-"+this.id,function(){d.sizeInner()}),d.sizeInner()),a(".modal").each(function(b){var c=a(this);c.css("z-index",(1020+(b+1)).toString()),c.data("modal")&&c.data("modal").overlay&&c.data("modal").overlay.css("z-index",(1020+b).toString())}),a("body > *").not(this.element).not(".modal, .overlay").attr("aria-hidden","true"),this.settings.isAlert)this.element.attr("aria-labeledby","message-title"),this.element.attr("aria-describedby","message-text");else{var f=this.element.find("h1:first"),g=f.attr("id");g||(g=(this.element.attr("id")?this.element.attr("id"):"h1")+"-title",f.attr("id",g));var h=this.element.find(".modal-body"),i=(this.element.attr("id")?this.element.attr("id"):"message")+"-text";this.element.attr("aria-labeledby",g),this.element.find(".toolbar .title").length?(this.element.find(".toolbar .title").attr("id",i),this.element.attr("aria-describedby",i)):(h.attr("id",i),this.element.attr("aria-describedby",i))}this.mainContent=a("body").children(".scrollable-container"),this.mainContent.length||(this.mainContent=a("body")),this.mainContent.addClass("no-scroll"),a(window).on("resize.modal-"+this.id,function(){d.resize()}),this.element.css({display:""}),setTimeout(function(){void 0!==d.element.css("margin")&&d.resize(),d.resize(),d.element.addClass("is-visible").attr("role",d.settings.isAlert?"alertdialog":"dialog"),d.element.attr("aria-hidden","false"),d.overlay.attr("aria-hidden","false"),d.element.attr("aria-modal","true")},1),a("body").addClass("modal-engaged"),a(this.element).on("keypress.modal",function(b){var c=a(b.target);c.is(".searchfield")||c.is("textarea")||c.is(":button")||c.is(".dropdown")||c.closest(".tab-list").length||13===b.which&&d.isOnTop()&&(b.stopPropagation(),b.preventDefault(),d.element.find(".btn-modal-primary:enabled").trigger("click"))}),a(".skip-link").on("focus.modal",function(a){a.preventDefault(),d.getTabbableElements().first.focus()});var j=d.element.find(".paginated");j.on("afterpaging",function(){d.resize()}),setTimeout(function(){d.disableSubmit()},10);var k=this.element.find("[data-validate]");k.removeClass("disable-validation"),setTimeout(function(){b(),a("html").is(".ie")||d.element.addClass("no-filter")},200),setTimeout(function(){d.element.trigger("afteropen")},300)},resize:function(){var b=a(".modal-body",this.element).height(),c=.9*a(window).height()-this.settings.frameHeight;a(".modal-body-wrapper",this.element).css("max-height",b>c?c:"")},isOpen:function(){return this.element.is(".is-visible")},isOnTop:function(){var b=0,c=this.element;return a(".modal.is-visible").each(function(){b<a(this).css("z-index")&&(b=a(this).css("z-index"))}),b===c.css("z-index")},getTabbableElements:function(){var b=a(this.element).find("a[href], area[href], input:not([disabled]),select:not([disabled]), textarea:not([disabled]),button:not([disabled]), iframe, object, embed, *[tabindex],*[contenteditable]").filter(":visible");return{first:b[0],last:b[b.length-1]}},keepFocus:function(){var b,c=this;a(c.element).on("keypress.modal keydown.modal",function(a){var d=a.which||a.keyCode;27===d&&setTimeout(function(){c.close()},0),9===d&&(b=c.getTabbableElements(),a.target!==b.last||a.shiftKey?a.target===b.first&&a.shiftKey&&(a.preventDefault(),b.last.focus()):(a.preventDefault(),b.first.focus()),c.element.find("#message-title").removeAttr("tabindex"))})},close:function(b){if(!this.isOpen())return!0;var c=this.element.triggerHandler("beforeclose"),d=this,e=this.element.find("[data-validate]");return e.addClass("disable-validation"),c===!1?!1:(this.mainContent&&this.mainContent.removeClass("no-scroll"),a(window).off("resize.modal-"+this.id),this.element.off("keypress.modal keydown.modal"),this.element.css("visibility","visible"),this.element.removeClass("is-visible no-filter"),this.overlay.attr("aria-hidden","true"),this.element.attr("aria-hidden","true"),a('.modal[aria-hidden="false"]').length<1&&(a("body").removeClass("modal-engaged"),a("body > *").not(this.element).removeAttr("aria-hidden"),a(".overlay").remove()),d.element.trigger("close",d.isCancelled),this.oldActive&&a(this.oldActive).is("button:visible")?(this.oldActive.focus(),this.oldActive=null):this.trigger.parents(".toolbar, .formatter-toolbar").length<1&&this.trigger.focus(),a("#validation-errors, #tooltip, #validation-tooltip").addClass("is-hidden"),a(".skip-link").off("focus.modal"),void setTimeout(function(){d.overlay.remove(),d.element.css({display:"none"}).trigger("afterclose"),("immediate"===d.settings.trigger||b)&&d.destroy()},300))},destroy:function(){function b(){c.modalButtons&&c.element.find("button").off("click.modal"),1===c.element.find(".detailed-message").length&&a(window).off("resize.modal-"+this.id),"click"===c.settings.trigger&&c.trigger.off("click.modal"),c.element.remove(),a.removeData(c.element[0],"modal")}var c=this,d=this.element.trigger("beforedestroy");if(d){if(!this.isOpen())return void b();this.element.one("afterclose.modal",function(){b()}),this.close(!0)}}},this.each(function(){var e=a.data(this,d),g=a(this);return g.is(".modal")||(e=g.closest(".modal").data(d)),e?("function"==typeof e[b]&&e[b](),e.settings=a.extend({},e.settings,b),void("immediate"===f.trigger&&e.open())):void(e=a.data(this,d,new c(this,f)))})},a.fn.modalsearch=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="modalsearch",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.setup().build().handleEvents()},setup:function(){return this},build:function(){return this.element.modal({autoFocus:!1}),this.modal=this.element.data("modal"),this.overlay=this.modal.overlay,this.searchInput=this.modal.element.find("#big-search-field"),this.searchResults=this.modal.element.find(".search-all"),this.modal.element.add(this.overlay).addClass("modal-search"),this.searchResults.empty().append(a('<p class="search-result none">'+Locale.translate("NoResults")+"</p>")),this},handleEvents:function(){var b=this;return a(window).off("resize.modal-"+this.modal.id),a(document).on("keydown.modalsearch",function(a){var c=a.which;27===c&&b.modal.isOpen()&&b.modal.close()}),this.searchInput.on("keydown.modalsearch",function(a){var c=a.which;13===c&&b.handleAjax()}),this.modal.element.on("requestend.modalsearch",function(a,c,d){b.renderSearchResults(a,c,d)}).on("open.modalsearch",function(){b.searchInput.focus()}),this.modal.element.find(".close").on("click.modalsearch",function(){b.modal.close()}),this},handleAjax:function(){var b=this,c=this.searchInput.attr("data-source")||void 0,d=this.searchInput.val();if(!c||void 0===c)return!1;c=c.toString();var e=function(a,c){b.element.removeClass("is-busy"),b.element.trigger("requestend",[a,c])};b.element.addClass("busy").trigger("requeststart",[d]);var f=a.get(c+d);f.done(function(a){e(d,a)}).fail(function(){e(d,[])})},renderSearchResults:function(a,b,c){this.searchResults.empty().append(c)},destroy:function(){a(document).off("keydown.modalsearch"),this.modal.element.off("requestend.modalsearch open.modalsearch"),this.searchInput.off("keydown.modalsearch"),this.element.data("modal").destroy(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?e.settings=a.extend({},e.settings,b):e=a.data(this,d,new c(this,f))})},a.fn.rating=function(b){function c(b){this.element=a(b),this.init()}var d="rating",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.handleEvents(),this.allInputs=this.element.find("input"),this.readonly()},handleEvents:function(){var b=this;a("input",b.element).each(function(c){a(this).on("change",function(){b.element.hasClass("is-readonly")||b.val(c+1)})})},val:function(b){var c,d,e=this;if(!b)return this.currentValue;for(this.currentValue=parseFloat(b,10),d=Math.round(this.currentValue),c=0;c<this.allInputs.length;c++){var f=a(this.allInputs[c]),g=f.parent().is(".inline")?"svg":"label";b>c?f.addClass("is-filled").removeClass("is-half"):f.removeClass("is-filled").removeClass("is-half"),f.next(g).find("svg").changeIcon("star-filled"),c+1===d&&f.prop("checked",!0),d!==e.currentValue&&c+1===d&&f.addClass("is-half").next(g).find("svg").changeIcon("star-half")}return 0>=d&&a(this.allInputs[0]).prop("checked",!0),this.currentValue},readonly:function(){var b=a(this.element);b.hasClass("is-readonly")&&b.find("input").attr("disabled","")},enable:function(){var b=a(this.element);b.removeClass("is-readonly").find("input").removeAttr("disabled")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.resize=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="resize",e={axis:"x"},f=a.extend({},e,b);return c.prototype={init:function(){this.handleEvents()},handleEvents:function(){var a=this;a.handle=null,this.element.find(".resize-handle").drag({axis:f.axis}).on("drag.resziable",function(b,c){a.element.width(c.left)})},destroy:function(){a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?(g.settings=a.extend({},e,b),g.show()):g=a.data(this,d,new c(this,f))})},a.fn.searchfield=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="searchfield",e={allResultsCallback:void 0,showAllResults:!0,categories:void 0,categoryMultiselect:!1,showCategoryText:!1,source:void 0,template:void 0,clearable:!1},f=a.extend({},e,b);return c.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.build().setupEvents()},build:function(){var b=this;if(this.optionsParseBoolean(),this.label=this.element.prev("label, .label"),(this.settings.source||this.element.attr("data-autocomplete"))&&this.element.autocomplete(this.settings),this.autocomplete=this.element.data("autocomplete"),this.element.attr("autocomplete","off"),this.wrapper=this.element.parent(".searchfield-wrapper"),!this.wrapper||!this.wrapper.length){this.wrapper=this.isInlineLabel?this.inlineLabel.addClass("searchfield-wrapper"):this.element.wrap('<span class="searchfield-wrapper"></span>').parent(),this.element.closest(".toolbar").length&&this.label.prependTo(this.wrapper);for(var c,d=["context","alternate"],e=0;e<d.length;e++)this.element.hasClass(d[e])&&(c=d[e],this.wrapper.addClass(c),this.element.removeClass(c))}var f=this.wrapper.find(".icon:not(.icon-dropdown)");if(f&&f.length||(f=a.createIconElement("search").insertAfter(this.element).icon()),this.hasCategories()){this.wrapper.addClass("has-categories"),this.button=f.parent(".searchfield-category-button"),this.button.length||(this.button=f.wrap('<button type="button" class="btn searchfield-category-button"></button>').parent()),f=this.button,this.settings.showCategoryText&&this.wrapper.addClass("show-category");var g=f.find(".icon-dropdown");g.length||(g=a.createIconElement({classes:"icon-dropdown",icon:"dropdown"}).icon()),g.appendTo(f),this.list=this.wrapper.find("ul.popupmenu"),this.list&&this.list.length||(this.list=a('<ul class="popupmenu"></ul>'));var h=this.settings.categoryMultiselect?"is-multiselectable":"is-selectable";this.list.addClass(h);var i="is-selectable";this.settings.categoryMultiselect||(i="is-multiselectable"),this.list.removeClass(i),this.list.empty(),this.settings.categories.forEach(function(a){b.list.append('<li><a href="#">'+a+"</a></li>")}),this.list.insertAfter(f),f.popupmenu({menu:this.list})}return(this.wrapper.hasClass("context")||this.wrapper.hasClass("has-categories"))&&f.insertBefore(this.element),
this.settings.clearable&&this.element.clearable(),this},optionsParseBoolean:function(){var a,b,c=["showAllResults","categoryMultiselect","showCategoryText","clearable"];for(a=0,b=c.length;b>a;a++)this.settings[c[a]]=this.parseBoolean(this.settings[c[a]])},hasCategories:function(){return this.settings.categories&&a.isArray(this.settings.categories)&&this.settings.categories.length>0},setupEvents:function(){var b=this;return this.element.on("updated.searchfield",function(){b.updated()}).on("focus.searchfield",function(a){b.handleFocus(a)}).on("blur.searchfield",function(a){b.handleBlur(a)}).onTouchClick("searchfield",".searchfield").on("click.searchfield",function(a){b.handleClick(a)}).on("keydown.searchfield",function(a){b.handleKeydown(a)}).on("beforeopen.searchfield",function(a,c){b.handlePopupBeforeOpen(a,c)}),this.wrapper.on("mouseenter.searchfield",function(){a(this).addClass("is-hovered")}).on("mouseleave.searchfield",function(){a(this).removeClass("is-hovered")}),this.hasCategories()&&this.button.on("selected.searchfield deselected.searchfield",function(a,c,d){b.handleCategorySelection(a,c,d)}).on("focus.searchfield",function(a){b.handleCategoryFocus(a)}).on("blur.searchfield",function(a){b.handleCategoryBlur(a)}).on("close.searchfield",function(a){b.handlePopupClose(a)}),this.element.on("populated.searchfield",function(a,c){c.length>0?b.settings.showAllResults&&b.addMoreLink():b.addNoneLink()}),this.element.on("listopen.searchfield",function(c,d){var e=a("#autocomplete-list");e.off("click").on("click.autocomplete","a",function(c){var e=a(c.currentTarget),f=e.text().trim(),g=e.hasClass("more-results"),h=e.hasClass("no-results");if(g||h||b.element.attr("aria-activedescendant",e.parent().attr("id")),g){var i=b.settings.allResultsCallback;i&&"function"==typeof i&&i(f)}if(e.parent().attr("data-value"))for(var j=0;j<d.length;j++)d[j].value.toString()===e.parent().attr("data-value")&&(f=d[j]);return b.element.trigger("selected",[e,f]),b.element.data("popupmenu").close(),c.preventDefault(),!1}),e.find(".more-results, .no-results").off("focus").on("focus.searchfield",function(){var c=a(this);e.find("li").removeClass("is-selected"),c.parent("li").addClass("is-selected"),b.element.val("")})}),this},recalculateParent:function(){var a=this.element.closest(".toolbar");a.length&&setTimeout(function(){a.triggerHandler("recalculateButtons")},300)},setAsActive:function(){if(!this.element.hasClass("active")){var b=this;this.element.addClass("active");var c=this.element.closest('.toolbar, [class$="-toolbar"]');c.length&&c.addClass("searchfield-active"),this.wrapper.is(".toolbar-searchfield-wrapper")||this.wrapper.addClass("has-focus"),setTimeout(function(){function d(){b.element.removeClass("active").blur(),c.removeClass("searchfield-active"),a(document).offTouchClick("searchfield").off("click.searchfield")}a(document).onTouchClick("searchfield",".searchfield").on("click.searchfield",function(c){var e=a(c.target);e[0]!==b.element[0]&&e[0]!==b.element.parent(".searchfield-wrapper")[0]&&d()}),b.element.one("blur.searchfield",function(){d()})},100),this.recalculateParent()}},handleFocus:function(){this.setAsActive()},handleBlur:function(){var a=this;this.recalculateParent(),this.wrapper.is(".toolbar-searchfield-wrapper")||setTimeout(function(){a.wrapper.removeClass("has-focus")},10)},handleClick:function(){this.setAsActive()},handleKeydown:function(a){var b=a.which;27===b&&this.clear()},handlePopupBeforeOpen:function(a,b){if(b){var c=this.wrapper.hasClass("context")?"addClass":"removeClass",d=this.wrapper.hasClass("alternate")?"addClass":"removeClass";return b[c]("context"),b[d]("alternate"),!0}},handleCategorySelection:function(b,c){if(this.settings.showCategoryText){var d=""+c.text().trim(),e=this.wrapper.find(".btn"),f=e.find("span");if(e&&e.length){f&&f.length||(f=a('<span class="category"></span>').insertAfter(e.find(".icon").first())),f.empty();var g=this.list.find(".is-checked");g.length&&(d=g.length>1?g.length+" "+Locale.translate("Selected"):g.text().trim(),f.text(d))}}},handleCategoryFocus:function(){this.wrapper.is(".toolbar-searchfield-wrapper")||this.wrapper.addClass("has-focus")},handleCategoryBlur:function(){this.wrapper.is(".toolbar-searchfield-wrapper")||this.wrapper.removeClass("has-focus")},handlePopupClose:function(){return this.setAsActive()},clear:function(){this.element.val("").trigger("change").focus()},addMoreLink:function(){var b=a("#autocomplete-list"),c=this.element.val();a('<li class="separator" role="presentation"></li>').appendTo(b);var d=a('<li role="presentation"></li>').appendTo(b);this.moreLink=a('<a href="#" class="more-results" tabindex="-1" role="menuitem"></a>').html("<span>"+Locale.translate("AllResults")+' "'+c+'"</span>').appendTo(d)},addNoneLink:function(){var b=a("#autocomplete-list"),c=a('<li role="presentation"></li>').appendTo(b);this.noneLink=a('<a href="#" class="no-results" tabindex="-1" role="menuitem"></a>').html("<span>"+Locale.translate("NoResults")+"</span>").appendTo(c)},updated:function(){this.teardown().init()},enable:function(){this.element.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0)},parseBoolean:function(a){return!/^(false|0)$/i.test(a)&&!!a},teardown:function(){return this.element.off("updated.searchfield populated.searchfield"),this.autocomplete&&this.autocomplete.destroy(),this.wrapper.hasClass("context")&&this.element.addClass("context"),this.element.next(".icon").remove(),this.element.parent().hasClass("searchfield-wrapper")&&this.element.unwrap(),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.sidebar=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="sidebar",e={isSticky:!0},f=a.extend({},e,b);return c.prototype={init:function(){return this.build(),this.handleEvents(),this.isSafari=a("html").is(".is-safari"),this},build:function(){var b=this;return this.closestHeader=a(".header").first(),this.sectionList=a(".section-tracker"),this.sections=a(".editorial > .main > .content > h2"),this.sections.each(function(c){var d=a(this).clone().children().remove().end(),e="heading"+c,f=a('<div><a href="#'+e+'" class="hyperlink'+(0===c?" is-active":"")+'">'+d.text()+"</a></div>");a(this).attr("id",e),b.sectionList.append(f)}),this.anchors=this.sectionList.find("a"),this.editorialContainer=this.element.closest(".editorial"),this.pageContainer=this.element.closest(".page-container"),this.pageContainer.length||(this.pageContainer=a(window)),this},handleEvents:function(){var a=this;return this.anchors.onTouchClick("sidebar").on("click.sidebar",function(b){a.handleAnchorClick(b)}),this.settings.isSticky?(this.pageContainer.on("scroll.sidebar",function(b){a.handleScroll(b),a.adjustCurrentNavItem()}),this):this},handleScroll:function(){this.element.removeAttr("style");var a,b=this.editorialContainer.position(),c=this.element.outerHeight(),d=b.top,e=b.top+this.editorialContainer.outerHeight(!0),f=this.pageContainer[0].scrollHeight-e,g=this.pageContainer.scrollTop(),h=d>g,i=g>=d&&e>=g+c,j=g+c>e,k="",l="";h&&(k="affix-top",l="affix-bottom affix"),i&&(k="affix",l="affix-bottom affix-top"),j&&(k="affix-bottom",l="affix affix-top",a=this.pageContainer[0].scrollHeight-b.top-f-c+"px"),this.element.removeClass(l),this.element.hasClass(k)||this.element.addClass(k),a&&this.element.css({top:a})},adjustCurrentNavItem:function(){if(!this.dontAdjustWhileScrolling){var b=this,c=this.sectionList.find(".is-active").removeClass("is-active");c.length&&c.is(a(document.activeElement))&&c[0].blur(),this.sections.each(function(){var c=this;if(b.isOnScreen(c)){var d=a('a[href="#'+c.id+'"]');return d.addClass("is-active"),d.parent().prev().find("a").removeClass("is-active"),!1}}),0===this.sectionList.find(".is-active").length&&c.addClass("is-active")}},handleAnchorClick:function(b){var c=this,d=a(b.target);d.parent().parent().find(".is-active").removeClass("is-active"),this.dontAdjustWhileScrolling=!0,this.pageContainer.animate({scrollTop:a(d.attr("href")).position().top-30},{duration:150,done:function(){c.dontAdjustWhileScrolling=!1,d.addClass("is-active")}}),b.preventDefault()},isOnScreen:function(b){var c=a(b),d=c.offset(),e=c.outerHeight(!0),f=d.top+e;return d.top<window.innerHeight&&f>0},updated:function(){return this.teardown().init()},teardown:function(){return this.container.off("scroll.sidebar").off("scroll.sidebarMenu"),this.anchors.offTouchClick("sidebar").off("click.sidebar"),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this))})},a.fn.signin=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="signin",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.settings=f,this.handleKeys()},handleKeys:function(){var b=this,c=a.createIconElement({classes:"icon-capslock",icon:"capslock"});document.msCapsLockWarningOff=!0,this.element.on("keypress.signin",'[type="password"]',function(d){var e=a(this),f=e.parent(".field"),g=a(".icon-capslock",f);b.isCapslock(d)&&!e.hasClass("error")?g.length||(f.append(c),a("body").toast({audibleOnly:!0,message:Locale.translate("CapsLockOn")})):g.remove()}).on("blur.signin change.signin",'[type="password"]',function(){var b=a(this),d=b.closest(".field"),e=a(".icon-capslock",d);setTimeout(function(){e&&e.length&&(b.hasClass("error")?e.remove():d.append(c))},150)}).on("blur.signin change.signin keypress.signin","input",function(){a(this).is("#confirm-password")||(a("#username").val(a("#username-display").val()),a("#password").val(a("#password-display").val()),a("#new-password").val(a("#new-password-display").val()))})},isCapslock:function(a){a=a?a:window.event;var b=a.which?a.which:a.keyCode?a.keyCode:!1,c=a.shiftKey?a.shiftKey:a.modifiers?!!(4&a.modifiers):!1;return b>=97&&122>=b&&c?!0:b>=65&&90>=b&&!c?!0:!1},destroy:function(){a.removeData(this.element[0],d),a("body").off("keypress.signin blur.signin change.signin")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.slider=function(b){"use strict";function c(b){this.settings=a.extend({},i),this.element=a(b),this.init()}function d(a){return a%1===0}function e(a,b){return(!b||isNaN(b)||0===b)&&(b=1),Math.round(a/b)*b}function f(a,b){var c=a[0],d=a[1],e=b[0],f=b[1];return Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2))}var g="slider",h={value:[50],min:0,max:100,range:!1,step:void 0,ticks:[],tooltipContent:void 0,persistTooltip:!1},i=a.extend(!0,{},h,b);return c.prototype={init:function(){return this.buildSettings().addMarkup().bindEvents()},buildSettings:function(){var b=this;if(this.element.is(":disabled")&&this.element.closest(".field").addClass("is-disabled"),this.settings||(this.settings={}),this.settings.value=void 0!==this.element.attr("value")?this.element.attr("value"):i.value,this.settings.min=void 0!==this.element.attr("min")?parseInt(this.element.attr("min")):i.min,this.settings.max=void 0!==this.element.attr("max")?parseInt(this.element.attr("max")):i.max,this.settings.range=void 0!==this.element.attr("data-range")?"true"===this.element.attr("data-range"):i.range,this.settings.step=isNaN(this.element.attr("step"))?i.step:Number(this.element.attr("step")),this.settings.ticks=i.ticks,void 0!==this.element.attr("data-ticks"))try{b.settings.ticks=JSON.parse(b.element.attr("data-ticks"))}catch(c){}var d="true"===this.element.attr("data-tooltip-persist")||this.element.attr("data-tooltip-persist")===!0;if(this.settings.persistTooltip=void 0!==this.element.attr("data-tooltip-persist")?d:i.persistTooltip,this.settings.tooltip=i.tooltipContent,void 0!==this.element.attr("data-tooltip-content"))try{b.settings.tooltip=JSON.parse(b.element.attr("data-tooltip-content"))}catch(c){}if("string"==typeof this.settings.tooltip)if(-1===this.settings.tooltip.indexOf(","))this.settings.tooltip=[this.settings.tooltip,""];else{var e=this.settings.tooltip.split(",");this.settings.tooltip=[e[0]],this.settings.tooltip.push(e[1]?e[1]:"")}this.settings.tooltip&&1===this.settings.tooltip.length&&this.settings.tooltip.push(""),this.ticks=[];var f={value:this.settings.min,description:b.getModifiedTextValue(this.settings.min)},g={value:this.settings.max,description:b.getModifiedTextValue(this.settings.max)};if(this.settings.ticks){var h=b.settings.ticks||[];if(a.isArray(h)&&h.length>0){var j=h.filter(function(a){return a.value===b.settings.min}),k=h.filter(function(a){return a.value===b.settings.max});j.length>0&&(f.description=j[0].description,f.color=j[0].color,h=a.grep(h,function(a){return a!==j[0]})),k.length>0&&(g.description=k[0].description,g.color=k[0].color,h=a.grep(h,function(a){return a!==k[0]}))}b.ticks.push(f);for(var l=0;l<h.length;l++){var m={};void 0!==h[l].value&&(m.value=h[l].value,m.description=void 0!==h[l].description?h[l].description:"",m.color=h[l].color,b.ticks.push(m))}b.ticks.push(g)}else this.ticks.push(f,g);if(a.isArray(this.settings.value))this.settings.value[0]=isNaN(this.settings.value[0])?(this.settings.min+this.settings.max)/2:parseInt(this.settings.value[0]);else if("number"==typeof this.settings.value)this.settings.value=[this.settings.value];else if(-1===this.settings.value.indexOf(","))this.settings.value=[isNaN(this.settings.value)?(this.settings.min+this.settings.max)/2:parseInt(this.settings.value)];else{var n=this.settings.value.split(",");n[0]=isNaN(n[0])?this.settings.min:parseInt(n[0]),n[1]=isNaN(n[1])?this.settings.max:parseInt(n[1]),this.settings.value=n}return this.settings.range&&!this.settings.value[1]&&this.settings.value.push(this.settings.max),this},addMarkup:function(){function b(b){var e=c.isRtlHorizontal?100-c.convertValueToPercentage(b.value):c.convertValueToPercentage(b.value),f="calc("+e+"% - 4px)";b.element=a('<div class="tick" data-value="'+b.value+'"></div>'),b.label=a('<span class="label">'+b.description+"</span>"),b.element.css(d?"bottom":"left",f).append(b.label),c.wrapper.append(b.element),d||b.label.css("left",-(b.label.outerWidth()/2-b.element.width()/2)+"px")}var c=this,d=!1;if("INPUT"!==c.element[0].tagName)throw new Error('Element with ID "'+c.element.id+"\" cannot invoke a slider;  it's not an Input element.");c.originalElement={type:c.element.attr("type")},c.element.attr("type","hidden"),c.wrapper=a('<div class="slider-wrapper"></div>').attr("id",c.element.attr("id")+"-slider").insertAfter(c.element),c.hitarea=a('<div class="slider-hit-area"></div>').appendTo(c.wrapper),c.range=a('<div class="slider-range"></div>').appendTo(c.wrapper),this.element.hasClass("vertical")&&(this.wrapper.addClass("vertical"),d=!0),this.isRtlHorizontal=Locale.isRTL()&&!d,this.isRtlVertical=Locale.isRTL()&&d;var e=this.element.attr("style");e&&(e.match(/min-height/)&&(this.wrapper.css("min-height",this.element.css("min-height")),e=e.replace("min-height","")),e.match(/height/)&&this.wrapper.css("height",this.element.css("height")),e.match(/min-width/)&&(this.wrapper.css("min-width",this.element.css("min-width")),e=e.replace("min-width","")),e.match(/width/)&&this.wrapper.css("width",this.element.css("width"))),c.handles=[];var f=c.element.prev("label").text(),g=a('<div class="slider-handle'+(c.settings.range?" lower":"")+'" tabindex="0"></div>').attr("aria-label",Locale.translate(c.settings.range?"SliderMinimumHandle":"SliderHandle")+" "+f);if(c.handles.push(g),c.settings.range){var h=a('<div class="slider-handle higher" tabindex="0"></div>').attr("aria-label",Locale.translate("SliderMaximumHandle")+" "+f);c.handles.push(h)}return a.each(c.handles,function(a,b){b.attr({role:"slider","aria-orientation":d?"vertical":"horizontal","aria-valuemin":c.settings.min,"aria-valuemax":c.settings.max}).hideFocus(),b.appendTo(c.wrapper)}),c.ticks.forEach(function(a){b(a)}),c.value(c.settings.value),c.updateRange(),a.each(c.handles,function(a,b){c.settings.tooltip&&(b.tooltip({content:function(){return""+c.getModifiedTextValue(Math.floor(c.value()[a]))},placement:d?"right":"bottom",trigger:"focus",keepOpen:c.settings.persistTooltip}),b.removeAttr("aria-describedby"))}),this.element.prop("disabled")===!0&&this.disable(),c},bindEvents:function(){function b(a,b,e){function f(){if(d){var a=c.wrapper.height(),f=a-b.outerHeight();return(f-e.top)/f*100}return e.left/(c.wrapper.width()-b.outerWidth())*100}if(!c.isDisabled()){var g=f(),h=c.convertPercentageToValue(g);if(c.settings.range){var i=c.value();b.hasClass("higher")&&h<=i[0]&&(h=i[0]),b.hasClass("lower")&&h>=i[1]&&(h=i[1])}c.settings.step&&(h=Math.round(h/c.settings.step)*c.settings.step),a.defaultPrevented||(c.value(b.hasClass("higher")?[void 0,h]:[h]),c.updateRange(),c.updateTooltip(b),c.element.trigger("sliding",b,h))}}var c=this,d=this.wrapper.hasClass("vertical");return a.each(c.handles,function(e,f){var g={containment:"parent",axis:d?"y":"x",clone:!1};f.drag(g).on("mousedown.slider",function(){c.isDisabled()||a(this).focus()}).on("click.slider",function(a){a.preventDefault()}).on("drag.slider",function(c,d){b(c,a(c.currentTarget),d)}).on("keydown.slider",function(a){c.activateHandle(f),c.handleKeys(a,c)}).on("keyup.slider blur.slider",function(){c.deactivateHandle(f)}).on("dragstart",function(){a(this).addClass("is-dragging"),c.range.addClass("is-dragging"),c.element.trigger("slidestart",f)}).on("dragend",function(){a(this).removeClass("is-dragging"),c.range.removeClass("is-dragging"),c.element.trigger("slidestop",f)})}),c.wrapper.on("click.slider touchend.slider touchcancel.slider",function(a){c.handleRangeClick(a)}),c.element.on("updated.slider",function(){c.updated()}),c},handleRangeClick:function(b){function c(){if(j){var a=i.wrapper.height();return(a-n)/a*100}return m/i.wrapper.width()*100}if(b.preventDefault(),!this.isDisabled()){var d,e,g,h,i=this,j=this.wrapper.hasClass("vertical"),k="click"!==b.originalEvent.type?b.originalEvent.changedTouches[0].pageX:b.pageX,l="click"!==b.originalEvent.type?b.originalEvent.changedTouches[0].pageY:b.pageY,m=k-i.wrapper.offset().left-a(document).scrollLeft(),n=l-i.wrapper.offset().top-a(document).scrollTop(),o=[m,n],p=i.handles[0].offset().left+i.handles[0].width()/2-i.wrapper.offset().left-a(document).scrollLeft(),q=i.handles[0].offset().top+i.handles[0].height()/2-i.wrapper.offset().top-a(document).scrollTop(),r=[p,q],s=i.value(),t=f(o,r),u=s[0],v=i.handles[0];v.addClass("hide-focus");var w=c(),x=i.convertPercentageToValue(w);i.handles[1]?(d=i.handles[1].offset().left+i.handles[1].width()/2-i.wrapper.offset().left-a(document).scrollLeft(),e=i.handles[1].offset().top+i.handles[1].height()/2-i.wrapper.offset().top-a(document).scrollTop(),g=[d,e],h=f(o,g),t>h?(i.value([void 0,x]),v=i.handles[1],u=s[1]):i.value([x])):i.value([x]),i.checkHandleDifference(v,u,x),u>x?i.decreaseValue(b,v,x,0):i.increaseValue(b,v,x,0),i.settings.tooltip||v.focus()}},activateHandle:function(a){a.addClass("is-active")},deactivateHandle:function(a){a.removeClass("is-active")},convertValueToPercentage:function(a){return(a-this.settings.min)/(this.settings.max-this.settings.min)*100},convertPercentageToValue:function(a){var b=a/100*(this.settings.max-this.settings.min)+this.settings.min;return this.isRtlHorizontal?this.settings.max-b+this.settings.min:b},getIncrement:function(){var a=.1*(this.settings.max-this.settings.min);return void 0!==this.settings.step&&a<=this.settings.step&&(a=this.settings.step),a},handleKeys:function(b,c){if(!c.isDisabled()){var d=b.which,e=a(b.currentTarget);switch(e.removeClass("hide-focus"),d){case 33:c.increaseValue(b,e,void 0,this.getIncrement());break;case 34:c.decreaseValue(b,e,void 0,this.getIncrement());break;case 35:c.increaseValue(b,e,this.settings.max);break;case 36:c.decreaseValue(b,e,this.settings.min);break;case 38:case 39:c.isRtlHorizontal&&39===d?c.decreaseValue(b,e):c.increaseValue(b,e);break;case 37:case 40:c.isRtlHorizontal&&37===d?c.increaseValue(b,e):c.decreaseValue(b,e)}}},increaseValue:function(a,b,c,f){a.preventDefault(),clearTimeout(b.data("animationTimeout"));var g,h,i,j=this.value().slice(0),k=void 0!==f?f:void 0!==this.settings.step?this.settings.step:1;if(b.hasClass("higher"))g=void 0!==c?c:j[1],k=d(g)?k:isNaN(g%k)?0:g%k,h=g+k<this.settings.max?g+k:this.settings.max,i=h%k?h:e(h,k),this.value([void 0,i]);else{g=void 0!==c?c:j[0];var l=void 0===j[1]?this.settings.max:j[1];k=d(g)?k:isNaN(g%k)?0:k-g%k,h=l>g+k?g+k:l,i=h%k?h:e(h,k),this.value([i])}this.checkHandleDifference(b,g,i),this.updateRange(),this.updateTooltip(b)},decreaseValue:function(a,b,c,f){a.preventDefault(),clearTimeout(b.data("animationTimeout"));var g,h,i,j=this.value(),k=void 0!==f?f:void 0!==this.settings.step?this.settings.step:1;if(b.hasClass("higher")){g=void 0!==c?c:j[1];var l=void 0===j[0]?this.settings.min:j[0];k=d(g)?k:isNaN(g%k)?0:k-g%k,h=g-k>l?g-k:l,i=h%k?h:e(h,k),this.value([void 0,i])}else g=void 0!==c?c:j[0],k=d(g)?k:isNaN(g%k)?0:g%k,h=g-k>this.settings.min?g-k:this.settings.min,i=h%k?h:e(h,k),this.value([i]);this.checkHandleDifference(b,g,i),this.updateRange(),this.updateTooltip(b)},updateRange:function(){function b(a,b){var c=g?j[1]:j[0],d=g?100-b:b;a.css(c,"calc("+d+"% - "+a.outerWidth()/2+"px)")}for(var c=this,d=this.value(),e=[],f=this.getColorClosestToValue(),g=c.wrapper.hasClass("vertical"),h=0;h<this.ticks.length;h++){var i=this.settings.range?d[0]<this.ticks[h].value&&this.ticks[h].value<=d[1]:this.ticks[h].value<=d[0];i?(this.ticks[h].element.addClass("complete"),f&&(this.ticks[h].element.css("background-color",f),this.ticks[h].element.addClass("inherit"))):(this.ticks[h].element.removeClass("complete"),f&&(this.ticks[h].element.css("background-color",""),this.ticks[h].element.removeClass("inherit")))}f&&(this.range.css("background-color",f),a.each(this.handles,function(a,b){b.css({"background-color":f,"border-color":f})})),a.each(c.ticks,function(a){c.ticks[a].label.css("color","")}),e[0]=this.convertValueToPercentage(d[0]),void 0!==d[1]&&(e[1]=this.convertValueToPercentage(d[1]));var j=g?["bottom","top"]:c.isRtlHorizontal?["right","left"]:["left","right"],k={};this.handles[1]?(k[j[0]]=e[0]+"%",k[j[1]]=100-e[1]+"%"):(k[j[0]]="0%",k[j[1]]=100-e[0]+"%"),this.range.css(k),this.handles[0].hasClass("is-animated")&&this.handles[0].data("animationTimeout",setTimeout(function(){c.handles[0].removeClass("is-animated").trigger("slide-animation-end"),c.range.removeClass("is-animated")},201)),b(this.handles[0],e[0]),this.handles[1]&&(this.handles[1].hasClass("is-animated")&&this.handles[1].data("animationTimeout",setTimeout(function(){c.handles[1].removeClass("is-animated").trigger("slide-animation-end"),c.range.removeClass("is-animated")},201)),b(this.handles[1],e[1]),this.handles[0].attr("aria-valuemax",d[1]),this.handles[1].attr("aria-valuemin",d[0]))},checkHandleDifference:function(b,c,d){if(!a("html").hasClass("ie9")){var e=this.convertValueToPercentage(c),f=this.convertValueToPercentage(d);Math.abs(e-f)>3&&(b.addClass("is-animated"),this.range.addClass("is-animated"))}},updateTooltip:function(a){function b(){e.position(),a.focus()}if(this.settings.tooltip){if(!a){var c,d=this.handles[0].data("tooltip");return this.handles[1]&&(c=this.handles[1].data("tooltip")),d.hide(),void(c&&c.hide())}var e=a.data("tooltip");a.hasClass("is-animated")?(e.hide(),a.one("slide-animation-end",function(){b()})):b()}},getColorClosestToValue:function(){var b=a("#sohoxi-stylesheet").get(0).href.replace(/^.*[\\\/]/,"").replace(/\.[^\.]+$/,""),c={"grey-theme":{"default":"#000000","very-poor":"#a13030",poor:"#d66221",adequate:"#f2bc41",good:"#9cce7c","very-good":"#76b051",superior:"#488421"},"dark-theme":{"default":"#ffffff","very-poor":"#a13030",poor:"#d66221",adequate:"#f2bc41",good:"#9cce7c","very-good":"#76b051",superior:"#488421"},"high-contrast-theme":{"default":"#000000","very-poor":"#a13030",poor:"#d66221",adequate:"#e4882b",good:"#76b051","very-good":"#56932e",superior:"#397514"}},d=b.indexOf("?");""!==b&&d>-1&&(b=b.substr(0,d).replace(".css",""));for(var e,f,g=c[b],h=this.value()[0],i=0;i<this.ticks.length;i++)f=this.ticks[i].color,f&&h>=this.ticks[i].value&&(e=f,e=f.indexOf("#")>-1?f:g[f]||g["default"]);return e},value:function(b,c){var d=this;return void 0===b&&void 0===c?d._value:(b&&a.isArray(b)&&(void 0!==b[1]&&(c=b[1]),b=b[0]),void 0===b&&a.isArray(d._value)&&void 0!==d._value[0]&&(b=d._value[0]),void 0===c&&a.isArray(d._value)&&void 0!==d._value[1]&&(c=d._value[1]),d._value=[b,c],d.element.val(void 0!==c?d._value:d._value[0]),a.each(d.handles,function(b,c){var e=d._value[b],f=d.getModifiedTextValue(e);a.each(d.ticks,function(a,b){b.value===e&&(f=b.description)}),c.attr({"aria-valuenow":d._value[b],"aria-valuetext":f})}),d.element.trigger("change"),d._value)},getModifiedTextValue:function(a){return this.settings.tooltip?this.settings.tooltip[0]+a+this.settings.tooltip[1]:a},enable:function(){return this.element.prop("disabled",!1),this.wrapper.removeClass("is-disabled"),this},disable:function(){return this.element.prop("disabled",!0),this.wrapper.addClass("is-disabled"),this},isDisabled:function(){return this.element.prop("disabled")},setValue:function(a,b){var c=a||void 0,d=b||void 0,e=this.value();this.checkHandleDifference(this.handles[0],e[0],c),this.handles[1]&&this.checkHandleDifference(this.handles[1],e[1],d);var f=this.value(c,d);return this.updateRange(),this.updateTooltip(),f},refresh:function(a,b){return this.setValue(a,b)},updated:function(){return this.element.removeAttr("value"),this.teardown().init()},teardown:function(){var b=this;return a.each(b.handles,function(a,b){b.off("mousedown.slider click.slider blur.slider drag.slider keydown.slider keyup.slider dragstart dragend")}),this.wrapper.off("click.slider touchend.slider touchcancel.slider").remove(),this.element.attr("type",this.originalElement.type),this},destroy:function(){this.teardown(),a.removeData(this.element[0],g)}},this.each(function(){var d=a.data(this,g);d?("function"==typeof d[b]?d[b]():d.settings=a.extend({},d.settings,b),d.updated()):d=a.data(this,g,new c(this,i))})},a.fn.arrange=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="arrange",e={itemsSelector:null,connectWith:!1,placeholderCssClass:"arrange-placeholder"},f=a.extend({},e,b);return c.prototype={init:function(){this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isIE11=/Trident.*rv[ :]*11\./i.test(navigator.userAgent),this.handleEvents()},handleEvents:function(){var b,c,d=this,e={},g=d.element.children().not('[data-arrange-exclude="true"]'),h=a("<"+(/^(ul|ol)$/i.test(d.element[0].tagName)?"li":"div")+">");f.itemsSelector&&(g=a(f.itemsSelector,d.element).not('[data-arrange-exclude="true"]'),h=a("<"+g.first()[0].tagName+" />")),d.dragStart="dragstart.arrange touchstart.arrange gesturestart.arrange",d.dragEnd="dragend.arrange touchend.arrange touchcancel.arrange gestureend.arrange",d.dragWhileDragging="dragover.arrange dragenter.arrange drop.arrange touchmove.arrange gesturechange.arrange",d.handle=d.element.attr("data-arrange-handle"),d.connectWith=d.element.attr("data-arrange-connectWith"),d.placeholders=h.addClass(f.placeholderCssClass+" draggable"),a(d.handle,g).addClass("draggable").on("mousedown.arrange touchstart.arrange",function(){c=!0}).on("mouseup.arrange touchend.arrange",function(){c=!1}),d.connectWith&&(g=g.add(a(d.connectWith).children().not('[data-arrange-exclude="true"]')).data("connectWith",d.connectWith)),g.attr("draggable",!0).addClass(d.handle?"":"draggable").add([this,h]).not("a[href], img").on("selectstart.arrange",function(){return this.dragDrop&&this.dragDrop(),!1}).end().each(function(){a(this).on(d.dragStart,function(f){if(d.handle&&!c)return!1;c=!1,d.dragging=a(this),b=d.dragging.addClass("arrange-dragging").index(),a.extend(e,{start:d.dragging,startIndex:b}),d.element.triggerHandler("beforearrange",e);var g=f.originalEvent.dataTransfer;g.effectAllowed="move",g.setData("Text","dummy")}).on(d.dragEnd,function(){d.dragging&&(d.placeholders.filter(":visible").after(d.dragging),d.dragging.removeClass("arrange-dragging").show(),d.placeholders.detach(),b!==d.dragging.index()&&(a.extend(e,{end:d.dragging,endIndex:d.dragging.index()}),d.element.triggerHandler("arrangeupdate",e)),d.dragging=null)}).on(d.dragWhileDragging,function(b){var c,f=this;if(b.preventDefault(),"drop"===b.type)return b.stopPropagation(),d.dragging.trigger("dragend.arrange"),!1;if(d.isTouch){var i=b.originalEvent.touches[0];f=d.getElementByTouchInList(g,i.pageX,i.pageY)||f}if(f=a(f),d.isTouch||(b.originalEvent.dataTransfer.dropEffect="move"),g.is(f)&&h.index()!==f.index()){d.dragging.hide(),h.index()<f.index()?(h.insertAfter(f),c=f.index()):(h.insertBefore(f),c=h.index()),a.extend(e,{over:f,overIndex:c}),d.element.triggerHandler("draggingarrange",e);var j=a("svg",f);d.isIE11&&j.length&&f.html(f.html()),d.placeholders.not(h).detach()}else d.placeholders.is(this)||(d.placeholders.detach(),this.element.append(h));return!1})})},getElementByTouchInList:function(b,c,d){var e=!1;return a(b).each(function(){var b=a(this),f=b.offset();c<=f.left||c>=f.left+b.outerWidth()||d<=f.top||d>=f.top+b.outerHeight()||(e=b)}),e},destroy:function(){var b=this.connectWith?this.element.children().add(a(this.connectWith).children()):this.element.children();b.off("selectstart.arrange "+this.dragStart+" "+this.dragEnd+" "+this.dragWhileDragging),a(this.handle,b).off("mousedown.arrange mouseup.arrange touchstart.arrange touchend.arrange"),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?(g.settings=a.extend({},e,b),g.show()):g=a.data(this,d,new c(this,f))})},a.fn.spinbox=function(b,c){"use strict";function d(b){this.element=a(b),this.init()}var e="spinbox",f={},g=a.extend({},f,b);return d.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.setInitialValue().addMarkup().bindEvents()},setInitialValue:function(){var a=this,b=a.checkForNumeric(a.element.val());this.element.val(b),this.element.attr("data-trackdirty")&&this.element.data("original",b);var c=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);return c&&this.element.attr("pattern","\\d*"),this},addMarkup:function(){var b=this;this.isInlineLabel?this.inlineLabel.addClass("spinbox-wrapper"):this.element.parent(".spinbox-wrapper").length||this.element.wrap('<span class="spinbox-wrapper"></span>'),this.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.buttons||(this.buttons={down:a("<span "+(this.isTouch?"":'aria-hidden="true"')+' class="spinbox-control down">-</span>').insertBefore(this.element).button(),up:a("<span "+(this.isTouch?"":'aria-hidden="true"')+' class="spinbox-control up">+</span>').insertAfter(this.element).button()});var c,d=this.element.attr("min"),e=this.element.attr("max"),f=this.element.attr("data-mask"),g="",h={role:"spinbutton"},i=0;if(d||e||f||(e="9999999"),(d||e)&&!f){var j="",k=d?d:"",l=e?e:"",m=k.length>l.length?k:l;for(i=0;i<=m.length;)j+="#",i++;(-1!==k.indexOf("-")||-1!==l.indexOf("-"))&&(j="-"+j.substring(0,j.length-1)),h["data-mask"]=j,f=j}for(c=f.length,i=0;c>=i;)g+="9",i++;return-1===f.indexOf("-")?(h.min=d?d:0,h.max=e?e:g):(h.min=d?d:g,h.max=e?e:g.substring(0,g.length-1)),this.element.attr("data-mask-mode")&&"number"===this.element.attr("data-mask-mode")||(h["data-mask-mode"]="number"),this.element.data("mask")&&"object"==typeof this.element.data("mask")&&this.element.data("mask").destroy(),d&&(h["aria-valuemin"]=d),e&&(h["aria-valuemax"]=e),this.element.attr(h),this.updateAria(b.element.val()),this.element.mask(),this.isDisabled()&&this.disable(),this},bindEvents:function(){var b=this,c=!1;this.element.on("focus.spinbox",function(){b.element.parent(".spinbox-wrapper").addClass("is-focused")}).on("blur.spinbox",function(){b.element.parent(".spinbox-wrapper").removeClass("is-focused"),
b.element.trigger("change")}).on("keydown.spinbox",function(a){b.handleKeyDown(a,b)}).on("keypress.spinbox",function(a){b.handleKeyPress(a,b)}).on("keyup.spinbox",function(a){b.handleKeyup(a,b)}).on("afterPaste.mask",function(){b.handleAfterPaste(b)});var d=this.buttons.up.add(this.buttons.down[0]);return d.on("touchstart.spinbox mousedown.spinbox",function(d){if(1===d.which){if(c||b.handleClick(d),b.isTouch)return;c=!0,b.enableLongPress(d,b),a(document).one("mouseup",function(){b.disableLongPress(d,b),c=!1,b.element.focus()}),this.isTouch&&(d.preventDefault(),d.stopPropagation())}}),this},enableLongPress:function(b,c){c.addButtonStyle(b),c.longPressInterval=setInterval(function(){a(b.currentTarget).is(":hover")&&c.handleClick(b)},140)},disableLongPress:function(a,b){b.removeButtonStyle(a),clearInterval(b.longPressInterval),b.longPressInterval=null},handleClick:function(b){if(!this.isDisabled()&&1===b.which){var c=a(b.currentTarget);c.hasClass("up")?this.increaseValue():this.decreaseValue(),this.isTouch?c.focus():this.element.focus()}},handleKeyDown:function(b,c){var d=b.which,e=[35,36,37,38,39,40];if(-1!==a.inArray(d,e))switch(d){case 35:c.element.attr("min")&&c.element.val(c.element.attr("min"));break;case 36:c.element.attr("max")&&c.element.val(c.element.attr("max"));break;case 38:case 39:Locale.isRTL()&&39===d?(c.addButtonStyle(c.buttons.down),c.decreaseValue()):(c.addButtonStyle(c.buttons.up),c.increaseValue());break;case 37:case 40:Locale.isRTL()&&37===d?(c.addButtonStyle(c.buttons.up),c.increaseValue()):(c.addButtonStyle(c.buttons.down),c.decreaseValue())}},handleKeyPress:function(a,b){if(!b.isDisabled()){var c=a.which;if(!(48>c||c>57&&96>c||c>105)){var d=Number(this.checkForNumeric(this.element.val())),e=b.element.attr("min"),f=b.element.attr("max");return e>d?(a.preventDefault(),b.updateVal(e)):d>f?(a.preventDefault(),b.updateVal(f)):void 0}}},handleKeyup:function(a,b){if(!b.isDisabled()){var c=a.which;switch(c){case 38:case 39:b.removeButtonStyle(Locale.isRTL()&&39===c?b.buttons.down:b.buttons.up);break;case 37:case 40:b.removeButtonStyle(Locale.isRTL()&&39===c?b.buttons.up:b.buttons.down)}b.updateAria(b.element.val())}},handleAfterPaste:function(a){var b=Number(a.element.attr("min")),c=Number(a.element.attr("max")),d=Number(a.element.val());d=b>d?b:d>c?c:d,a.updateVal(d)},increaseValue:function(){var a=this.checkForNumeric(this.element.val())+Number(this.element.attr("step")||1);this.element.attr("max")&&a>this.element.attr("max")||this.updateVal(a)},decreaseValue:function(){var a=this.checkForNumeric(this.element.val())-Number(this.element.attr("step")||1);this.element.attr("min")&&a<this.element.attr("min")||this.updateVal(a)},updateVal:function(a){this.element.val(a),this.updateAria(a),this.element.focus()},checkForNumeric:function(b){return""===b?b:a.isNumeric(b)?Number(b):(b=parseInt(b),a.isNumeric(b)?Number(b):0)},updateAria:function(a){var b=this.element.attr("min"),c=this.element.attr("max");a=this.checkForNumeric(a),this.element.attr("aria-valuenow",""!==a?a:""),this.setIsDisabled(this.buttons.up,""!==a&&c&&a>=c?"disable":"enable"),this.setIsDisabled(this.buttons.down,""!==a&&b&&b>=a?"disable":"enable")},addButtonStyle:function(b){if(!this.isDisabled()){var c=b;b.currentTarget&&(c=a(b.currentTarget)),c.addClass("is-active")}},removeButtonStyle:function(b){if(!this.isDisabled()){var c=b;b.currentTarget&&(c=a(b.currentTarget)),c.removeClass("is-active")}},enable:function(){this.element.prop("disabled",!1),this.element.parent(".spinbox-wrapper").removeClass("is-disabled")},disable:function(){this.element.prop("disabled",!0),this.element.parent(".spinbox-wrapper").addClass("is-disabled")},isDisabled:function(){return this.element.prop("disabled")},setIsDisabled:function(a,b){b=void 0===b?!0:b&&"enable"!==b?!0:!1,a[b?"addClass":"removeClass"]("is-disabled")},destroy:function(){var b=this.element.data("mask");b&&"function"==typeof b.destroy&&b.destroy();for(var c in this.buttons){var d=a(c).data("button");d&&d.destroy()}this.buttons.up.off("click.spinbox mousedown.spinbox"),this.buttons.up.remove(),this.buttons.down.off("click.spinbox mousedown.spinbox"),this.buttons.down.remove(),this.element.off("focus.spinbox blur.spinbox keydown.spinbox keyup.spinbox"),this.element.unwrap(),a.removeData(this.element[0],e)}},this.each(function(){var h=a.data(this,e);h?("function"==typeof h[b]&&h[b](c),h.settings=a.extend({},f,b)):h=a.data(this,e,new d(this,g))})},a.fn.splitter=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="splitter",e={axis:"x",resize:"immediate",containment:null},f=a.extend({},e,b);return c.prototype={init:function(){return this.build().handleEvents()},build:function(){var b=this,c=this.element,d=c.closest(".scrollable"),e=c.parent().height();if(localStorage){var f=localStorage[this.uniqueId()];this.splitTo(parseInt(f),e)}return c.is(".splitter-right")&&(c.css({"border-right":b.getBorderString(d,"right")}),d.css({"border-right":0,"margin-right":"20px",width:parseInt(d.css("width"),10)-20+"px"})),this.element.drag({axis:this.settings.axis,containment:this.settings.containment?this.settings.containment:"x"===this.settings.axis?"document":"parent"}).on("dragstart.splitter",function(){var b=a('<div class="overlay"></div>'),c=a("iframe");c.length>0&&c.each(function(){var c=a(this);c.before(b),b.css({height:"100%",width:c.parent().css("width")-40+"px",opacity:0,visibility:"visible"})})}).on("dragend.splitter",function(c,d){a(".overlay").remove(),"end"===b.settings.resize&&b.splitTo("x"===b.settings.axis?d.left:d.top,e)}).on("drag.splitter",function(a,c){"immediate"===b.settings.resize&&b.splitTo("x"===b.settings.axis?c.left:c.top,e)}),"y"===this.settings.axis&&this.element.addClass("splitter-horizontal"),this.element.attr({"aria-dropeffect":"move",tabindex:"0","aria-grabbed":"false"}),this.element.is(".splitter-right")&&(this.orgLeft=this.element.parent().outerWidth()+20,this.element.parent().is(".content")&&(this.orgLeft=this.element.parent().parent().outerWidth()),this.orgLeft-=21,this.element.css("left",this.orgLeft+"px")),this},getBorderString:function(a,b){return a.css("border-"+b+"-width")+" "+a.css("border-"+b+"-style")+" "+a.css("border-"+b+"-color")},handleEvents:function(){var a=this;return this.element.on("updated."+d,function(){a.updated()}).on("keydown."+d,function(b){32===b.which&&(a.toggleSelection(),b.preventDefault()),37===b.which&&a.splitTo(a.split-15,a.parentHeight),39===b.which&&a.splitTo(a.split+15,a.parentHeight)}),this},toggleSelection:function(){this.element.toggleClass("is-dragging")},resizeTop:function(a,b,c){var d=a.prev(),e=a.next();d.css("height",b+"px"),e.css("height",c-b+"px")},resizeLeft:function(a,b){var c=a.parent();c.is(".content")&&(c=c.parent());var d=c.prev(),e=d.parent().outerWidth()-b;c.css("width",e+"px"),d.css("width","calc(100% - "+e+"px)"),a.css("left","")},resizeRight:function(a,b){var c=a.parent();c.is(".content")&&(c=c.parent());var d=c.next(),e=b;c.css("width",e+"px"),d.css("width","calc(100% - "+(e+20)+"px)")},uniqueId:function(){return this.element.attr("id")?this.element.attr("id"):window.location.pathname.split("/").pop()+"-splitter-"+a(".splitter").length},splitTo:function(b,c){var d=this.element;d.is(".splitter-right")?this.resizeRight(d,b):d.is(".splitter-horizontal")?this.resizeTop(d,b,c):this.resizeLeft(d,b),this.element.trigger("split",[b]),a("body").triggerHandler("resize",[this]),localStorage&&(localStorage[this.uniqueId()]=b),this.split=b,this.parentHeight=c},updated:function(){return this.teardown().init()},teardown:function(){return this.element.off("updated."+d),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.swaplist=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="swaplist",e={available:null,selected:null,additional:null,availableClass:".available",selectedClass:".selected",additionalClass:".full-access",availableBtn:".btn-moveto-selected",selectedBtnLeft:".btn-moveto-left",selectedBtnRight:".btn-moveto-right",additionalBtn:".btn-moveto-selected",template:'<ul data-swap-handle=".handle">{{#dataset}}{{#text}}<li{{#value}} data-value="{{value}}"{{/value}}{{#selected}} selected="selected"{{/selected}}{{#disabled}} class="is-disabled"{{/disabled}}><span class="handle" focusable="false" aria-hidden="true" role="presentation">&#8286;</span><div class="swaplist-item-content"><p>{{text}}</p></div></li>{{/text}}{{/dataset}}</ul>'},f=a.extend({},e,b);return c.prototype={init:function(){var a=this;a.isTouch=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),a.loadListview(),a.setElements(),a.isMultiSelectClass(),setTimeout(function(){a.makeDraggable(),a.handleEvents(),a.initSelected(a.settings.availableClass),a.initSelected(a.settings.additionalClass)},0)},handleEvents:function(){var b=this,c=b.settings,d=b.selections;b.actionButtons.onTouchClick("swaplist").on("click.swaplist",function(){var d=a(this),e=d.closest(".card");e.is(c.availableClass)?b.moveElements(c.availableClass,c.selectedClass):e.is(c.additionalClass)?b.moveElements(c.additionalClass,c.selectedClass):e.is(c.selectedClass)&&(d.is(c.selectedBtnLeft)?b.moveElements(c.selectedClass,c.availableClass):d.is(c.selectedBtnRight)&&b.moveElements(c.selectedClass,c.additionalClass))}),b.containers.on("keydown.swaplist",function(d){var e=a(this);d=d||window.event,77===d.keyCode&&b.hasModifier(d)&&(!e.is(c.selectedClass)||e.is(c.selectedClass)&&1===b.selectedButtons.length?e.find(b.actionButtons).trigger("click.swaplist"):b.selectedButtons.first().focus(),d.preventDefault())}),b.selectedButtons.on("keydown.swaplist",function(c){var d,e,f=a(this);c=c||window.event,(13===c.keyCode||32===c.keyCode)&&(f.trigger("click.swaplist"),c.preventDefault()),(37===c.keyCode||39===c.keyCode)&&b.selectedButtons.length>1&&(d=b.selectedButtons.index(this),e=37===c.keyCode?d>0?d-1:b.selectedButtons.length-1:d<b.selectedButtons.length-1?d+1:0,b.selectedButtons[e].focus())}),b.element.on("keydown.swaplist",b.tabButtonsStr,function(b){var c=a(this),d=b.keyCode||b.which;9!==d||b.shiftKey||(a("li:first-child",c.closest(".card")).focus(),b.preventDefault())}),b.element.on("mousedown.swaplist",b.dragElements,function(c){if(b.handle){var d=a(c.target).closest("li");d.attr({draggable:a(c.target).is(".draggable")})}c.stopPropagation()}).onTouchClick("swaplist",b.dragElements).on(b.dragStart,b.dragElements,function(e){var f,g,h,i,j=a(".scrollable"),k=a(e.target).closest("li"),l=a(".listview",k.closest(".card")).data("listview");(!b.handle||d.isHandle)&&(b.isTouch||b.draggedMakeSelected(l,k),b.clearSelections(),b.element.triggerHandler("beforeswap",[d.items]),d.owner=k.closest(".card"),d.dragged=k,d.draggedIndex=k.index(),d.placeholder=k.clone(!0),d.placeholder.attr("id","sl-placeholder"),d.items=l.selectedItems,a("."+c.numOfSelectionsClass,c.itemContentTempl).html(d.items.length),b.addDropeffects(),b.isTouch?(f=e.originalEvent.changedTouches[0],g=k.position(),h=d.owner.position(),j={left:j.scrollLeft()||0,top:j.scrollTop()||0},b.offset={x:f.pageX-(h.left+j.left+g.left),y:f.pageY-(h.top+j.top+g.top+1.2*k.outerHeight(!0))},b.containers.css({"z-index":1}),d.placeholderTouch=d.dragged.clone(!0),d.items.length>1&&!a("#sl-placeholder-touch2").length&&d.dragged.clone().addClass("is-dragging-touch").attr("id","sl-placeholder-touch2").insertBefore(d.dragged).hide(),d.placeholderTouch.attr("id","sl-placeholder-touch").removeClass("is-selected").hide(),i=b.element.is(".one-third")&&b.isMaxWidth(766)?b.element.parent():b.element,i.prepend('<ul id="sl-placeholder-container"></ul>'),a("#sl-placeholder-container").append(d.placeholderTouch),a("#sl-placeholder-container, #sl-placeholder-touch").css({width:d.owner.width()+"px"}),b.draggTouchElement(e,d.placeholderTouch)):(d.dragged.addClass("is-dragging"),e.originalEvent.dataTransfer.setData("text",""),d.items.length>1&&a("."+c.itemContentClass,d.dragged).html(c.itemContentTempl.html())),e.stopPropagation())}).on(b.dragEnterWhileDragging,b.dragElements,function(c){d.dragged&&(b.element.triggerHandler("draggingswap",[d.items]),d.related=c.target,a("ul, li",b.element).removeClass("over"),a(c.target).closest("ul, li").addClass("over"),d.droptarget=a(d.related).closest(".card"),a('[aria-grabbed="true"]',b.element).not(d.dragged).slideUp(),c.stopPropagation())}).on(b.dragOverWhileDragging,b.dragElements,function(e){if(d.dragged){var f,g=a(this),h=a(".listview",d.dragged.closest(".card")).data("listview");if(b.isTouch){if(b.handle&&!d.isHandle)return;d.isInSelection||(b.draggedMakeSelected(h,d.dragged),d.items=h.selectedItems,a("."+c.numOfSelectionsClass,c.itemContentTempl).html(d.items.length)),f=e.originalEvent.touches[0],g=b.getElementByTouchInList(a("ul, li",b.element),f.pageX,f.pageY)||g,d.dragged.addClass("is-dragging"),d.placeholderTouch.addClass("is-dragging is-dragging-touch"),d.placeholderTouch.show(),a('[aria-grabbed="true"]',b.element).not(d.dragged).not(d.placeholderTouch).not("#sl-placeholder-touch2").slideUp(),d.items.length>1&&(a("."+c.itemContentClass,d.placeholderTouch.add("#sl-placeholder-touch2")).html(c.itemContentTempl.html()),a("#sl-placeholder-touch2").show(),d.dragged.hide()),b.draggTouchElement(e,d.placeholderTouch),b.element.triggerHandler("draggingswap",[d.items]),d.related=g,a("ul, li",this.element).removeClass("over"),g.closest("ul, li").addClass("over"),d.droptarget=d.related.closest(".card")}e.preventDefault(),e.stopPropagation()}}).on(b.dragEnd,b.dragElements,function(e){var f=a(d.related).closest("li"),g=a("ul",d.droptarget),h=a("li",g).length,i=d.items.length+h;b.unselectElements(a(".listview",d.owner).data("listview")),a.each(d.items,function(b,c){if(c=a(c),h&&!a(d.related).is("ul")){var e=f.index()<d.draggedIndex,j=e?c:a(d.items[d.items.length-1-b]),k=f.index()+(e?b+1:b+2);c.attr({"aria-posinset":k,"aria-setsize":i}),f[e?"before":"after"](j)}else c.attr({"aria-posinset":h+b+1,"aria-setsize":i}),g.append(c);c.focus()}),d.items.length>1&&(a("."+c.itemContentClass,d.dragged).html(a("."+c.itemContentClass,d.placeholder).html()),b.isTouch&&d.dragged.show()),b.isTouch&&b.containers.css({"z-index":""}),d.isHandle=null,a('[aria-grabbed="true"]',b.element).show(),b.afterUpdate(a(".listview",d.droptarget).data("listview")),e.preventDefault(),e.stopPropagation()})},loadListview:function(){var b,c,d,e,f=this,g=f.settings,h=[{dataset:g.available,"class":g.availableClass},{dataset:g.selected,"class":g.selectedClass},{dataset:g.additional,"class":g.additionalClass}];for(b=0,c=h.length;c>b;b++)e=h[b],d=a(e["class"]+" .listview",f.element),!e.dataset&&d.length&&a("li",d).length?d.listview({selectable:"multiple"}):d.length&&d.listview({dataset:e.dataset||[],template:g.template,selectable:"multiple"})},setElements:function(){this.offset=null,this.containers=a(this.settings.availableClass+","+this.settings.selectedClass+","+this.settings.additionalClass,this.element),this.actionButtons=a(this.settings.availableBtn+","+this.settings.additionalBtn+","+this.settings.selectedBtnLeft+","+this.settings.selectedBtnRight,this.element),this.selectedButtons=a(this.settings.selectedBtnLeft+","+this.settings.selectedBtnRight,this.element),this.tabButtonsStr=""+this.settings.availableBtn+" "+this.settings.additionalBtn+" "+(this.selectedButtons.length>1?this.settings.selectedBtnRight:this.settings.selectedBtnLeft),this.dragElements="ul, li:not(.is-disabled)",this.dragStart="dragstart.swaplist touchstart.swaplist gesturestart.swaplist",this.dragEnterWhileDragging="dragenter.swaplist",this.dragOverWhileDragging="dragover.swaplist touchmove.swaplist gesturechange.swaplist",this.dragEnd="dragend.swaplist touchend.swaplist touchcancel.swaplist gestureend.swaplist",this.selections={items:[],owner:null,related:null,droptarget:null,isInSelection:null,isHandle:null,placeholder:null,placeholderTouch:null,dragged:null,draggedIndex:null},this.settings.numOfSelectionsClass="num-of-selections",this.settings.itemContentClass="swaplist-item-content",this.settings.itemContentTempl=a('<div><p><span class="'+this.settings.numOfSelectionsClass+'">###</span> '+Locale.translate("ItemsSelected")+"</p><div/>")},isMultiSelectClass:function(){var b,c,d,e=this.settings,f=[e.availableClass,e.selectedClass,e.additionalClass];for(b=0,c=f.length;c>b;b++)d=a(f[b]+" .listview",this.element),a("li",d).length||d.addClass("is-muliselect")},initSelected:function(b){var c;b="string"!=typeof b?b:a(b,this.element),b.length&&(c=a(".listview",b).data("listview"),a("li[selected]",b).each(function(){a(this).removeAttr("selected"),c.select(a(this))}),this.moveElements(b,this.settings.selectedClass),a(this.settings.selectedClass+" li:last-child",this.element).blur())},moveElements:function(b,c){var d,e,f,g,h=this;b="string"!=typeof b?b:a(b,h.element),c="string"!=typeof c?c:a(c,h.element),g=a(".listview",b).data("listview"),h.clearSelections(),h.selections.owner=b,h.selections.droptarget=c,h.isTouch?a.each(g.selectedItems,function(a,b){h.selections.items[a]=b.closest("li")}):h.selections.items=g.selectedItems,h.unselectElements(g),h.selections.items.length&&(h.element.triggerHandler("beforeswap",[h.selections.items]),d=a("ul",c),f=a("li",d).length,e=h.selections.items.length+f,a.each(h.selections.items,function(b,c){c=a(c),c.attr({"aria-posinset":f+b+1,"aria-setsize":e}),d.append(c),c.focus()}),h.afterUpdate(a(".listview",c).data("listview")))},unselectElements:function(b){a.each(b.selectedItems,function(a,c){b.select(c)})},isDragAndDropSupports:function(){var a=document.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},isMatchMediaSupports:function(){return"undefined"!=typeof window.matchMedia||"undefined"!=typeof window.msMatchMedia},viewport:function(){var a=window,b="inner";return"innerWidth"in window||(b="client",a=document.documentElement||document.body),{width:a[b+"Width"],height:a[b+"Height"]}},isMaxWidth:function(a){return this.isMatchMediaSupports()&&window.matchMedia("(max-width: "+a+"px)").matches||this.viewport().width<=a},makeDraggable:function(){var b=this,c=a("ul",b.element);b.isDragAndDropSupports&&(b.handle=c.first().attr("data-swap-handle"),b.handle=!b.isTouch&&a(b.handle,c).length?b.handle:null,a(b.handle,c).addClass("draggable").on("mousedown.swaplist touchstart.swaplist",function(){b.selections.isHandle=!0}).on("mouseup.swaplist touchend.swaplist",function(){b.selections.isHandle=!1}),b.targets=c.attr({"aria-dropeffect":"none"}),b.items=a("li:not(.is-disabled)",b.element).not("a[href], img").on("selectstart.swaplist",function(){return this.dragDrop&&this.dragDrop(),!1}).end().attr({draggable:!0}).addClass(b.handle?"":"draggable"))},getElementByTouchInList:function(b,c,d){var e=!1;return a(b).each(function(){var b=a(this),f=b.offset();c<=f.left||c>=f.left+b.outerWidth()||d<=f.top||d>=f.top+b.outerHeight()||(e=b)}),e},draggTouchElement:function(a,b){var c=a.originalEvent;b.css({top:c.changedTouches[0].pageY-this.offset.y,left:c.changedTouches[0].pageX-this.offset.x})},hasModifier:function(a){return a.ctrlKey||a.metaKey||a.shiftKey},addDropeffects:function(){this.targets.each(function(){a(this).attr({"aria-dropeffect":"move",tabindex:0})}),a.each(this.selections.items,function(b,c){a(c).attr({"aria-grabbed":!0,tabindex:0})})},clearDropeffects:function(){this.targets.attr({"aria-dropeffect":"none"}).removeAttr("tabindex"),a.each(this.selections.items,function(b,c){c=a(c),c.removeAttr("aria-grabbed"+(c.is(":focus")?"":" tabindex"))})},clearSelections:function(){this.selections.items=[],this.selections.owner=null,this.selections.related=null,this.selections.droptarget=null,this.selections.isInSelection=null,this.selections.dragged=null,this.selections.placeholder=null,this.selections.placeholderTouch=null,a("ul, li",this.element).removeClass("over"),a("#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder").remove()},updateAttributes:function(b){var c=a("li",b),d=c.length;c.each(function(b){a(this).attr({"aria-posinset":b+1,"aria-setsize":d})})},afterUpdate:function(b){var c=this;setTimeout(function(){b&&(c.selections.placeholder&&(b.select(c.selections.placeholder),c.selections.placeholder.focus()),c.unselectElements(b),c.updateAttributes(a(".listview",c.selections.owner)),c.updateAttributes(a(".listview",c.selections.droptarget)),c.selections.items.length&&c.element.triggerHandler("swapupdate",[c.selections.items])),c.clearDropeffects(),c.clearSelections(),c.items.removeClass("is-dragging is-dragging-touch")},100)},getItems:function(b){return b="string"!=typeof b?b:a(b,this.element),a(".listview li",b)},draggedMakeSelected:function(b,c){var d=this,e=!1;d.selections.isInSelection||(a.each(b.selectedItems,function(a,b){return c[0]===b[0]?(e=!0,!1):void 0}),e||(b.select(c),d.selections.isInSelection=!0))},unbind:function(){return this.actionButtons.off("click.swaplist"),this.containers.off("keydown.swaplist"),this.selectedButtons.off("keydown.swaplist"),this.element.off(this.dragStart+" "+this.dragEnterWhileDragging+" "+this.dragOverWhileDragging+" "+this.dragEnd,this.dragElements),a("#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder").remove(),this},updated:function(){return this.unbind().init()},destroy:function(){this.unbind(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.toast=function(b){"use strict";function c(b){this.element=a(b),this.init()}var d="toast",e={title:"(Title)",message:"(Content)",position:"top right",audibleOnly:!1,progressBar:!0,timeout:6e3},f=a.extend({},e,b);return c.prototype={init:function(){this.settings=f,this.show()},show:function(){var b,c=this,d=c.settings,e=parseFloat(d.timeout),f=!1,g=100,h=a("#toast-container"),i=a('<div class="toast"><span class="toast-title">'+d.title+'</span><span class="toast-message">'+d.message+"</span></div>"),j=a('<button type="button" class="btn-icon btn-close" title="'+Locale.translate("Close")+'" aria-hidden="true">'+a.createIcon("close")+'<span class="audible"> '+Locale.translate("Close")+"</span></button>"),k=a('<div class="toast-progress"></div>');h.length||(h=a('<div id="toast-container" class="toast-container" aria-relevant="additions" aria-live="polite"></div>').appendTo("body")),h.removeClass("toast-top-left toast-top-right toast-bottom-right toast-bottom-left").addClass("toast-"+d.position.replace(" ","-")),d.timeout=d.audibleOnly?100:d.timeout,b=new a.fn.timer(function(){c.remove(i)},d.timeout),d.progressBar&&i.append(k),a(b.event).on("update",function(a,b){g=(e-b.counter)/e*100,Locale.isRTL()&&(g=100-g),d.progressBar&&k.width(g+"%")}),h.append(i),i.addClass(d.audibleOnly?"audible":"effect-scale"),i.append(j),a(document).on("keydown keyup",function(a){a=a||window.event,a.ctrlKey&&a.altKey&&80===a.keyCode&&(f="keydown"===a.type?!0:!1,b[f?"pause":"resume"]())}),i.on("mousedown.toast touchstart.toast mouseup.toast touchend.toast",function(a){f=/mousedown|touchstart/i.test(a.type)?!0:!1,b[f?"pause":"resume"]()}),j.on("click",function(){b.cancel(),c.remove(i)})},remove:function(a){return this.settings.audibleOnly?void a.remove():(a.addClass("effect-scale-hide"),void setTimeout(function(){a.remove()},500))},destroy:function(){a("#toast-container").remove(),a.removeData(this.element[0],d)}},this.each(function(){var g=a.data(this,d);g?(g.settings=a.extend({},e,b),g.show()):g=a.data(this,d,new c(this,f))})},a.fn.tabs=function(b){function c(b){this.settings=a.extend({},g),this.element=a(b),this.init()}var d="tabs",e={addTabButton:!1,addTabButtonCallback:null,containerElement:null,changeTabOnHashChange:!1,hashChangeCallback:null,tabCounts:!1},f=["horizontal","vertical","module-tabs","header-tabs"],g=a.extend({},e,b);return c.prototype={init:function(){return this.setup().build().setupEvents()},setup:function(){return this.tabsIndex=a(".tab-container").index(this.element),this},build:function(){function b(){var b=a(this),d=b.parent(),e=d.data("popupmenu"),f=b.attr("href");if("#"===f.substr(0,1)){if(void 0!==f&&"#"!==f){var g=a(f);if(d.is(":not(.has-popupmenu)")&&!g.length)return;b.data("panel-link",g),g.data("tab-link",b),c.panels=c.panels.add(g)}e&&e.menu.children("li").each(function(){var b=a(this),d=b.children("a"),e=d.attr("href"),f=a(e);if(d.data("panel-link",f),f.data("tab-link",d),c.panels=c.panels.add(f),c.anchors=c.anchors.add(d),b.hasClass("dismissible")){var g=b.children(".icon");g.length||(g=a.createIcon({icon:"close","class":"close"})),g.detach().appendTo(d)}}).on("click.popupmenu",".icon",function(b){var d=a(this),e=d.closest("li");e.is(".dismissible")&&d.is(".icon")&&(b.preventDefault(),b.stopPropagation(),c.closeDismissibleTab(e.children("a").attr("href")))})}}var c=this;this.container=this.element,this.element.closest(".header").length>0&&(this.container=a("body > .page-container"),this.container.length||(this.container=this.element));var d=a(this.settings.containerElement);d.length&&(this.container=d,this.container.addClass("tab-panel-container"));var e=!0;if(f.forEach(function(a,b){c.element.hasClass(f[b])&&(e=!1)}),e&&c.element.addClass(this.element.closest(".header").length?"header-tabs":"horizontal"),c.settings.tabCounts&&c.container.addClass("has-counts"),c.tablist=c.element.children(".tab-list"),c.tablist.length||(c.tablist=c.element.children(".tab-list-container").children(".tab-list")),c.tablist.attr({"class":"tab-list",role:"tablist","aria-multiselectable":"false"}),this.hasSquareFocusState()&&(c.focusState=c.container.children(".tab-focus-indicator"),c.focusState.length||(c.focusState=a('<div class="tab-focus-indicator" role="presentation"></div>').insertBefore(c.tablist))),this.hasAnimatedBar()&&(c.animatedBar=c.container.children(".animated-bar"),c.animatedBar.length||(c.animatedBar=a('<div class="animated-bar" role="presentation"></div>').insertBefore(c.tablist))),c.moreButton=c.tablist.next(".tab-more"),0===c.moreButton.length){var g=a("<div>").attr({"class":"tab-more"});g.append(a('<span class="more-text">').text(Locale.translate("More"))),g.append(a.createIconElement({classes:"icon-more",icon:"dropdown"})),c.tablist.after(g),c.moreButton=g}if(c.isModuleTabs()&&!this.tablist.find(".application-menu-trigger").length){var h=a('<li class="tab application-menu-trigger"><a href="#"><span class="icon app-header"><span class="one"></span><span class="two"></span><span class="three"></span></span><span>Menu</span></a></tab>');this.tablist.prepend(h)}!c.settings.addTabButton||this.addTabButton&&this.addTabButton.length||(this.addTabButton=a('<li class="tab add-tab-button"><a href="#">+ <span class="audible">'+Locale.translate("AddNewTab")+"</span></a></tab>"),this.tablist.append(this.addTabButton)),!c.settings.addTabButton&&this.addTabButton&&this.addTabButton.length&&this.addTabButton.remove(),c.anchors=c.tablist.children("li:not(.separator)").children("a"),c.anchors.each(function(){var b=a(this);b.attr({role:"tab","aria-expanded":"false","aria-selected":"false",tabindex:"-1"}).parent().attr("role","presentation").addClass("tab"),b.parent().hasClass("dismissible")&&!b.parent().children(".icon").length&&a.createIconElement({icon:"close",classes:"close"}).insertAfter(b);var d=b.nextAll("ul").first();if(d.length>0){d.addClass("dropdown-tab");var e=b.parent();e.addClass("has-popupmenu").popupmenu({menu:d,trigger:"click",attachToBody:!0}),b.removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected"),b.parent().children(".icon.icon-more").length||a.createIconElement({classes:"icon-more",icon:"dropdown"}).insertAfter(b)}c.settings.tabCounts&&0===a(this).find(".count").length&&a(this).prepend('<span class="count">0 </span>')}),c.panels=a(),c.anchors.each(b),c.panels.addClass("tab-panel").attr({role:"tabpanel"}).hide().find("h3:first").attr("tabindex","0");var i=":not(.separator):not(.is-disabled):not(.is-hidden)",j=this.tablist.children("li"+i),k=this.tablist.children("li.is-selected"+i),l=k.children("a");if(c.nestedTabControls=c.panels.find(".tab-container"),j.length){if(this.settings.changeTabOnHashChange){var m=window.location.hash;if(m&&m.length){var n=j.find('a[href="'+m+'"]');n.length&&(k=n.first().parent(),l=k.children("a"))}}k.length||(k=j.not(".add-tab-button, .application-menu-trigger").first(),l=k.children("a")),k.length&&this.activate(l.attr("href"))}return this.isModuleTabs()&&this.element.children(".toolbar").length&&this.element.addClass("has-toolbar"),this.setOverflow(),this.hasSquareFocusState()&&this.positionFocusState(l),this.hasAnimatedBar()&&(this.animatedBar.addClass("no-transition"),this.focusBar(void 0,function(){setTimeout(function(){c.animatedBar.removeClass("no-transition")},0)})),this},setupEvents:function(){function b(b){var c=a(b.currentTarget);"#"===c.attr("href").substr(0,1)&&b.preventDefault()}function c(b){var c=a(this);if(!c.is("[disabled]")&&!c.parent().hasClass("is-disabled")){var d=a(c).parent();d.hasClass("dismissible")&&(b.preventDefault(),b.stopPropagation(),h.closeDismissibleTab(d.children("a")))}}function d(){a(this).parent().removeClass("is-focused")}function e(b){var c=a(this);return c.is(".is-disabled")?(b.preventDefault(),!1):(h.hideFocusState(),void c.children("a").data("focused-by-click",!0))}function f(b,c){function d(a){a.altKey&&e.is(".dismissible")&&h.closeDismissibleTab(f.attr("href"))}var e=a(c),f=e.children("a"),g=e.data("popupmenu").menu;g.on("keydown.popupmenu","a",function(a){switch(a.which){case 27:e.addClass("is-selected"),f.focus();break;case 8:d(a);break;case 46:d(a)}}),e.on("selected.tabs",function(b,c){var d=a(c).attr("href");return h.activate(d),h.hasSquareFocusState()&&h.positionFocusState(f),h.hasAnimatedBar()&&h.focusBar(e),f.focus(),!1})}function g(b,c){var d=a(c),e=d.children("a");e.on("keydown.tabs",function(a){h.handleDismissibleTabKeydown(a)})}var h=this,i=h.element.closest(".modal");i.length&&i.on("afteropen",function(){h.hasAnimatedBar()&&h.focusBar()}),this.tablist.onTouchClick("tabs","> li").on("click.tabs","> li",function(b){return h.handleTabClick(b,a(this))}).on("click.tabs touchend.tabs touchcancel.tabs","a",b).on("click.tabs touchend.tabs touchcancel.tabs",".icon",c).on("focus.tabs","a",function(b){return h.handleTabFocus(b,a(this))}).on("blur.tabs","a",d).on("keydown.tabs","a",function(a){return h.handleTabKeyDown(a)}),this.tablist.on("mousedown.tabs","> li",e),this.moreButton.on("mousedown.tabs",e);var j=h.tablist.find("li").filter(".has-popupmenu");j.each(f);var k=h.tablist.find("li").filter("is-dismissible");return k.each(g),this.moreButton.onTouchClick("tabs").on("click.tabs",function(a){h.handleMoreButtonClick(a)}).on("keydown.tabs",function(a){h.handleMoreButtonKeydown(a)}).on("focus.tabs",function(a){h.handleMoreButtonFocus(a)}),this.panels.on("keydown.tabs",function(a){h.handlePanelKeydown(a)}),this.element.on("focusout.tabs",function(){var b=!a.contains(h.element[0],document.activeElement),c=0===h.tablist.children('[aria-expanded="true"]').length;b&&c&&!h.moreButton.is(".is-selected, .popup-is-open")&&h.positionFocusState(),h.checkFocusedElements()}).on("updated.tabs",function(){h.updated()}).on("activated.tabs",function(a){a.stopPropagation()}).on("add.tabs",function(a,b,c,d){h.add(b,c,d)}).on("remove.tabs",function(a,b){h.remove(b)}),a("body").on("resize.tabs"+this.tabsIndex,function(){h.handleResize()}),h.handleResize(),this},handleTabClick:function(a,b){if(this.element.is(".is-disabled")||b&&b.is(".is-disabled"))return a.stopPropagation(),a.preventDefault(),!1;var c=this.handleAppMenuTabKeydown(a);if(c){var d=":not(.separator):not(:hidden)",e=b.children("a");if(e.data("focused-by-click",!0),this.tablist.children("li"+d).removeClass("is-selected"),b.addClass("is-selected"),this.popupmenu&&this.popupmenu.close(),b.is(".has-popupmenu"))return this.positionFocusState(e),void this.focusBar(b);

var f=e.attr("href");b.is(".add-tab-button")&&(e=this.handleAddButton(),b=e.parent(),f=e.attr("href"),this.element.trigger("tab-added",[e])),this.activate(f),this.changeHash(f),this.hasSquareFocusState()&&this.focusState.removeClass("is-visible"),e.focus(),this.focusBar(b),this.positionFocusState(e)}},handleMoreButtonClick:function(a){return this.element.is(".is-disabled")||this.moreButton.is(".is-disabled")?(a.preventDefault(),a.stopPropagation(),!1):(this.moreButton.data("focused-by-click",!0),this.container.hasClass("has-more-button")||a.stopPropagation(),this.moreButton.hasClass("popup-is-open")?(this.popupmenu.close(),this.moreButton.removeClass("popup-is-open")):this.buildPopupMenu(),void this.hideFocusState())},handleTabFocus:function(b,c){if(this.element.is(".is-disabled"))return b.preventDefault(),!1;var d=c.parent(),e=c.data("focused-by-click"),f=void 0===e||e&&e===!1;a.removeData(c[0],"focused-by-click"),this.isTabOverflowed(d)?(this.buildPopupMenu(c.attr("href")),this.moreButton.addClass("is-focused"),this.positionFocusState(this.moreButton)):(d.addClass("is-focused"),this.positionFocusState(c,f))},handleMoreButtonFocus:function(b){if(this.element.is(".is-disabled"))return void b.preventDefault();var c=this.moreButton.data("focused-by-click"),d=c&&c===!1;a.removeData(this.moreButton[0],"focused-by-click"),this.hasSquareFocusState()&&(this.focusState.removeClass("is-visible"),this.positionFocusState(this.moreButton,d))},handleTabKeyDown:function(b){function c(){return a.inArray(b.which,h)>-1}function d(){for(var a=o.index(m)-1;a>-1&&!j;){if(o.eq(a).is(l))return o.eq(a);a-=1}return k.tablist.children("li"+l).last()}function e(){for(var a=o.index(m)+1;a<o.length&&!j;){if(o.eq(a).is(l))return o.eq(a);a++}return k.tablist.children("li"+l).first()}function f(){(n.attr("ng-click")||n.attr("data-ng-click"))&&n.click()}function g(){if(m.hasClass("has-popupmenu"))return void m.data("popupmenu").open();var a=n.attr("href");m.is(".add-tab-button")&&(n=k.handleAddButton(),m=n.parent(),a=n.attr("href"),k.element.trigger("tab-added",[n])),k.activate(a),k.changeHash(a),k.focusBar(m),f(),n[0].focus(),k.hideFocusState(),k.handleOutboundLink(a)}if(this.element.is(".is-disabled"))return b.preventDefault(),!1;if(!(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey&&8!==b.which)){var h=[8,13,32];if(!(b.which<32&&!c()||b.which>46)){if(c()){var i=this.handleAppMenuTabKeydown(b);if(!i)return}var j,k=this,l=":not(.separator):not(.is-disabled):not(:hidden)",m=a(b.currentTarget).parent(),n=m.children("a"),o=k.tablist.children("li"+l),p=Locale.isRTL();switch(b.which){case 8:return void(b.altKey&&m.is(".dismissible")&&(b.preventDefault(),k.closeDismissibleTab(n.attr("href"))));case 13:return g(),!1;case 32:return g(),!1;case 38:b.preventDefault();case 37:j=p?e():d(),b.preventDefault();break;case 40:b.preventDefault();case 39:j=p?d():e(),b.preventDefault()}if(this.isTabOverflowed(j)){b.preventDefault();var q=j.children("a").attr("href");return void setTimeout(function(){k.buildPopupMenu(q)},0)}var r=j.children("a").focus();k.hasSquareFocusState()&&k.positionFocusState(r,!0)}}},handleDismissibleTabKeydown:function(b){var c=b.which,d=a(b.target);if(d.is("a")&&(d=d.parent()),b.altKey&&46===c){if(d.children("a").is("[disabled]")||d.hasClass("is-disabled"))return;b.preventDefault(),this.closeDismissibleTab(d.children("a").attr("href"))}},handleAppMenuTabKeydown:function(b){var c=a(b.target),d=c.parent();if(!d.is(".application-menu-trigger")&&!c.is(".application-menu-trigger"))return!0;var e=a("#application-menu");return e.length?(b.preventDefault(),this.hideFocusState(),e.hasClass("is-open")?(e.trigger("close-applicationmenu"),!1):(e.trigger("open-applicationmenu"),!1)):!1},handleMoreButtonKeydown:function(a){if(this.element.is(".is-disabled"))return a.preventDefault(),!1;switch(a.which){case 37:case 38:a.preventDefault(),this.findLastVisibleTab();break;case 13:case 32:a.preventDefault();case 39:case 40:a.preventDefault(),this.buildPopupMenu(this.tablist.find(".is-selected").children("a").attr("href")),this.positionFocusState(this.moreButton,!0)}},handlePanelKeydown:function(b){var c=b.which,d=a(b.target),e=this.anchors.filter("#"+d.attr("id")),f=this.anchors.filter("#"+d.attr("id")).parent();return f.is(".dismissible")&&b.altKey&&46===c?(b.preventDefault(),this.closeDismissibleTab(e.attr("href"))):b.ctrlKey&&38===c&&a.contains(document.activeElement,d[0])?(b.preventDefault(),this.activate(e.attr("href"))):void 0},handleAddButton:function(){function b(){var b="new-tab",c=a('[id^="'+b+'"]');return c.length?b+"-"+c.length:b+"-0"}function c(a){var b=a.toString().split("-");return b.forEach(function(a,c){b[c]=a.charAt(0).toUpperCase()+a.slice(1)}),b.join(" ")}var d=this.settings.addTabButtonCallback;if(d&&"function"==typeof d){var e=d();return this.anchors.filter('[href="#'+e+'"]')}var f=this.tablist.children().index(this.addTabButton),g=b(),h=c(g),i={name:h,content:"&nbsp;",isDismissible:!0};0>f&&(f=this.tablist.find("li:not(.separator)").length);var j=this.element.triggerHandler("before-tab-added",[g,i,f]);return j?(j.newId&&j.newId.length&&"string"==typeof j.newId&&(g=j.newId),j.settings&&"object"==typeof j.settings&&(i=j.settings),isNaN(j.newIndex)||(f=j.newIndex),this.add(g,i,f),this.anchors.filter('[href="#'+g+'"]')):(this.add(g,i,f),this.anchors.filter('[href="#'+g+'"]'))},handleResize:function(){this.setOverflow(),this.positionFocusState(),this.focusBar(),this.handleVerticalTabResize()},handleVerticalTabResize:function(){this.isVerticalTabs()&&(!this.isNested()||this.isNestedInLayoutTabs()||this.isHidden()||this.tablist.css("height",this.element.outerHeight(!0)))},handleOutboundLink:function(a,b){return"#"===a.charAt(0)?!1:("/"!==a.charAt(0)||b&&b!==!1||(a=window.location.origin+a),void(window.location=a))},hasAnimatedBar:function(){return!this.isModuleTabs()&&!this.isVerticalTabs()},hasSquareFocusState:function(){return!0},isModuleTabs:function(){return this.element.hasClass("module-tabs")},isVerticalTabs:function(){return this.element.hasClass("vertical")},isHeaderTabs:function(){return this.element.hasClass("header-tabs")},isHidden:function(){return this.element.is(":hidden")},isNested:function(){return this.element.closest(".tab-panel").length},isActive:function(a){var b=this.getPanel(a);return"none"===b.css("display")},isNestedInLayoutTabs:function(){var a=this.element.closest(".module-tabs").length,b=this.element.closest(".header-tabs").length,c=this.element.closest(".tab-panel-container").length;return a>0||b>0||c>0},isTab:function(a){return a instanceof jQuery&&a.length&&a.is("li.tab")},isAnchor:function(a){return a instanceof jQuery&&a.length&&a.is("a")},getAnchor:function(a){return this.isAnchor(a)?a:(-1===a.indexOf("#")&&"/"!==a.charAt(0)&&(a="#"+a),this.anchors.filter('[href="'+a+'"]'))},getPanel:function(b){return this.isTab(b)&&(b=b.children("a")),this.isAnchor(b)&&(b=b.attr("href")),b&&""!==b&&"#"!==b?this.panels.filter('[id="'+b.replace(/#/g,"")+'"]'):a()},getMenuItem:function(a){return this.isAnchor(a)&&(a=a.attr("href")),-1===a.indexOf("#")&&(a="#"+a),this.moreMenu.children().children().filter('[data-href="'+a+'"]').parent()},getPreviousTab:function(a){for(var b=this.getTab(null,a),c="li:not(.separator):not(:hidden):not(.is-disabled)",d=this.tablist.find(c),e=d.eq(d.index(b)-1);e.length&&!e.is(c);)e=d.eq(d.index(e)-1);if(e.is(".has-popupmenu")){var f=e.data("popupmenu");f&&(e=f.menu.children("li").first())}return e},activatePreviousTab:function(a,b){var c=this.getTab(null,a);if(b&&b instanceof jQuery||(b=this.getPreviousTab(a)),!b.length)return this.positionFocusState(),this.defocusBar(),b;var d=b.children("a");return c.is(".is-selected")&&(this.activate(d.attr("href")),d.focus()),this.positionFocusState(d),this.focusBar(b),b},activate:function(b){function c(){i.resizeNestedTabs()}function d(){a("#tooltip").addClass("is-hidden"),a("#dropdown-list, #multiselect-list").remove(),i.element.trigger("afteractivated",[j])}var e,f,g,h,i=this,j=i.getAnchor(b);e=j.parent(),f=i.getPanel(b),g=i.anchors.parents().filter(".is-selected"),h=i.panels.filter(":visible");var k=i.element.trigger("beforeactivate",[j]);if(k){i.panels.hide(),i.element.trigger("activated",[j]),f.stop().fadeIn({duration:250,start:c,complete:d}),i.updateAria(j),g.removeClass("is-selected"),e.is(".tab")&&e.addClass("is-selected");var l=e.parents(".popupmenu");if(l.length){var m=l.data("trigger");m.length&&m.addClass("is-selected")}setTimeout(function(){a("#validation-tooltip").hide(),a("#tooltip").hide()},100)}},changeHash:function(a){if(this.settings.changeTabOnHashChange){a||(a=""),a.replace(/#/g,"");var b=this.settings.hashChangeCallback;b&&"function"==typeof b?b(a):window.location.hash=a,this.element.triggerHandler("hash-change",[a])}},updateAria:function(a){a&&(this.anchors.attr({"aria-selected":"false","aria-expanded":"false",tabindex:"-1"}),this.moreButton.attr({tabindex:"-1"}),a.length&&this.element.is(":not(.is-disabled)")&&(a.parent().removeClass("is-selected"),this.isTabOverflowed(a.parent())?this.moreButton.attr({tabindex:"0"}):a.attr({"aria-selected":"true","aria-expanded":"true",tabindex:"0"}).parent().addClass("is-selected")))},resizeNestedTabs:function(){this.nestedTabControls.each(function(b,c){var d=a(c),e=d.data("tabs");e&&e.handleResize&&"function"==typeof e.handleResize&&e.handleResize()})},add:function(b,c,d){function e(b){var c=typeof b;switch(c){case"string":var d=b.match(/#/g);if(null!==d){var e=a(b);b=e.length?a(b).clone():b}break;case"object":b=a(b).clone()}return b}function f(a,b){function c(a){return a>f.length-1}function d(a){return 0>=a}var e,f=a.tablist.children("li"),g=f.not(".application-menu-trigger, .add-tab-button"),i=f.length-1;if(!f.length)return h.appendTo(a.tablist),void j.appendTo(a.container);var k=f.filter(".add-tab-button"),l=f.filter(".application-menu-trigger");(void 0===b||null===b||isNaN(b))&&(b=f.length),f.length>g.length&&(c(b)&&k&&k.length&&(b-=1),d(b)&&l&&l.length&&(b+=1));var m=f.eq(b).length>0;i=m?b:i,e="insertAfter",m&&(e="insertBefore"),h[e](f.eq(i)),j.appendTo(a.container)}if(!b)return this;c||(c={});var g=0===this.tablist.find("li").not(".application-menu-trigger, .add-tab-button").length;b=""+b.replace(/#/g,""),c.name=c.name?c.name.toString():"&nbsp;",c.isDismissible=c.isDismissible?c.isDismissible===!0:!1,c.isDropdown=c.isDropdown?c.isDropdown===!0:!1,c.content&&(c.content=e(c.content)),c.dropdown&&(c.dropdown=e(c.dropdown));var h=a('<li role="presentation" class="tab"></li>'),i=a('<a href="#'+b+'" role="tab" aria-expanded="false" aria-selected="false" tabindex="-1">'+c.name+"</a>"),j=a('<div id="'+b+'" class="tab-panel" role="tabpanel" style="display: none;"></div>');return h.html(i),j.html(c.content),c.isDismissible&&(h.addClass("dismissible"),h.append(a.createIconElement({icon:"close",classes:"close"}))),this.settings.tabCounts&&i.prepend('<span class="count">0 </span>'),c.dropdown,f(this,d),this.panels=this.panels.add(j),this.anchors=this.anchors.add(i),i.data("panel-link",j),j.data("tab-link",i),this.setOverflow(),g&&(this.positionFocusState(i),this.focusBar(h),this.activate(i.attr("href")),i.focus()),this},remove:function(b){function c(a){return 0===a.children("li:not(.separator)").length}var d=this,e=this.doGetTab(null,b);if(e&&e.length){var f=e.children("a"),g=this.getPanel(b),h=g&&g.length,i=this.tablist.children("li").index(e),j=".separator, .is-disabled, :hidden",k=e.prev(),l=this.element.triggerHandler("beforeclose",[e]);if(l===!1)return!1;var m=!1;e.hasClass("is-selected")?m=!0:k=this.tablist.children("li").not(j).filter(".is-selected"),h&&(this.panels=this.panels.not(g)),this.anchors=this.anchors.not(f);var n=e.data("popupmenu");e.hasClass("has-popupmenu")&&n&&(n.menu.children("li").each(function(){d.remove(a(this).children("a").attr("href"))}),n.destroy());var o=e.closest(".dropdown-tab"),p=o.data("trigger");e.off("click.tabs"),f.off("click.tabs focus.tabs keydown.tabs"),e.remove(),h&&g.remove();var q=f.data("moremenu-link");q&&(q.parent().off().remove(),a.removeData(f[0],"moremenu-link")),c(o)&&(k=this.getPreviousTab(p),this.remove(p)),this.setOverflow(),this.element.trigger("close",[e]);for(var r=i-1;r>-1;)r=-1,k.is(j)&&(k=k.prev(),r-=1);if(k.length||(k=this.tablist.children("li").not(j).first()),!k.length)return this.positionFocusState(),this.defocusBar(),this.element.trigger("afterclose",[e]),this;var s=k.children("a");return this.positionFocusState(s),m&&this.activate(s.attr("href")),this.focusBar(k),s.focus(),this.element.trigger("afterclose",[e]),this}},checkPopupMenuItems:function(b){function c(b){if(!b||!b.menu)return a();var c=b.menu,d=c.children("li");return d.length?d:(b.destroy(),a())}if(b.is(".has-popupmenu"))return c(b.data("popupmenu"));var d=b.closest(".dropdown-tab");return d.length?c(d.data("popupmenu")):a()},getTab:function(b,c){function d(b){var c=a(b.currentTarget);return c.is(".tab")?c:c.closest(".tab").length?c.closest(".tab").first():null}function e(a){if(!a||""===a||"#"===a)return null;-1===a.indexOf("#")&&(a="#"+a);var b=f.anchors.filter('[href="'+a+'"]');return b.length?b.parent():null}var f=this,g=a();return c instanceof a&&c.length>0?c.is("a")?c.parent():c:b?d(b):c?e(c):g},doGetTab:function(b,c){return(b||c)&&(!b||b instanceof a.Event||"string"==typeof b)?b?"string"!=typeof b?this.getTab(b):this.getTab(null,b):this.getTab(null,c):a()},hide:function(a,b){var c=this.doGetTab(a,b);return c.is(".is-selected")&&this.activatePreviousTab(b),c.addClass("hidden"),this.focusBar(),this.positionFocusState(),this},show:function(a,b){var c=this.doGetTab(a,b);return c.removeClass("hidden"),this.focusBar(),this.positionFocusState(),this},disableTab:function(a,b){var c=this.doGetTab(a,b);return c.is(".is-selected")&&this.activatePreviousTab(b),c.addClass("is-disabled"),this.focusBar(),this.positionFocusState(),this},enableTab:function(a,b){var c=this.doGetTab(a,b);return c.removeClass("is-disabled"),this.focusBar(),this.positionFocusState(),this},rename:function(a,b,c){if(a&&"string"==typeof a&&(c=b,b=a),c){var d,e=this.doGetTab(a,b),f=this.settings.tabCounts,g=e.children("a");f&&(d=g.find(".count").clone()),g.text(c.toString()),f&&g.prepend(d);var h=this.tablist.children("li").length<2?e:void 0;this.positionFocusState(h),this.focusBar(h)}},updateCount:function(a,b,c){if(a&&"string"==typeof a&&(c=b,b=a),this.settings.tabCounts&&c){var d=this.doGetTab(a,b);d.children("a").find(".count").text(c.toString()+" ");var e=this.tablist.children("li").length<2?d:void 0;this.positionFocusState(e),this.focusBar(e)}},getActiveTab:function(){var a=this.panels.filter(":visible");return this.anchors.filter('[href="#'+a.first().attr("id")+'"]')},getVisibleTabs:function(){var b=this,c=a();return this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)").each(function(){var d=a(this);b.isTabOverflowed(d)||(c=c.add(d))}),c},getOverflowTabs:function(){var b=this,c=a();return this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)").each(function(){var d=a(this);b.isTabOverflowed(d)&&(c=c.add(d))}),c},setOverflow:function(){var a=this;this.isModuleTabs()&&this.adjustModuleTabs(),this.isHeaderTabs()&&this.adjustHeaderTabs(),a.tablist[0].scrollHeight>a.tablist.outerHeight()+3.5?a.element.addClass("has-more-button"):a.element.removeClass("has-more-button"),this.adjustSpilloverNumber(),a.setMoreActive()},adjustHeaderTabs:function(){var b=this,c=this.tablist.find("li:not(.separator):not(.application-menu-trigger):not(.add-tab-button)"),d=this.tablist.width(),e=0;return c.add(this.moreButton).removeAttr("style"),c.each(function(){var f=a(this),g=f.outerWidth(!0);b.isTabOverflowed(f)&&(c=c.not(f)),g>d&&(g=d),f.width(g),e+=g}),this},adjustModuleTabs:function(){var b=this,c=this.tablist.find("li:not(.separator):not(.application-menu-trigger):not(.add-tab-button)"),d=this.tablist.find(".application-menu-trigger"),e=d.length>0,f=this.tablist.find(".add-tab-button"),g=f.length>0,h=this.tablist.outerWidth(),i=120,j=120,k=e?d.outerWidth():0,l=g?f.outerWidth(!0):0;return c.add(this.moreButton).removeAttr("style"),c.each(function(){var d=a(this);b.isTabOverflowed(d)&&(c=c.not(d))}),c.length?(b.isTabOverflowed(f)&&(l=0),j=(h-(k+l))/c.length-1,i>j&&(j=i),c.width(j),void this.adjustSpilloverNumber()):(j=h-k+101,void this.moreButton.width(j))},adjustSpilloverNumber:function(){var b=this.moreButton.find(".more-text"),c=this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)"),d=this.getOverflowTabs();b.text(c.length<=d.length?""+Locale.translate("Tabs"):""+Locale.translate("More"));var e=this.moreButton.find(".count");e.length||(e=a('<span class="count"></span>'),this.moreButton.children("span").first().prepend(e)),e.text(""+d.length+" ")},select:function(a){var b=a.replace(/#/g,""),c=this.getAnchor(b);this.positionFocusState(void 0,!1),this.focusBar(c.parent()),this.activate(c.attr("href")),this.changeHash(b),c.focus()},setMoreActive:function(){var a=this,b=a.tablist.find(".is-selected");a.isTabOverflowed(b)?a.moreButton.addClass("is-selected"):(a.moreButton.removeClass("is-selected"),a.checkFocusedElements())},buildPopupMenu:function(b){function c(){a(this).off("close.tabs selected.tabs"),g.moreButton.removeClass("popup-is-open"),g.setMoreActive(),g.positionFocusState(void 0),g.focusBar()}function d(b,c){var d=c.attr("href"),e=d.substr(1,d.length),f=g.doGetTab(e)||a(),h=f?f.children("a"):a(),i=c.data("original-tab").parent();i.is(".add-tab-button")&&(h=g.handleAddButton(),i=h.parent(),d=h.attr("href"),g.element.trigger("tab-added",[h])),g.activate(d),f.length&&h.length&&"function"==typeof h[0].onclick&&h[0].onclick.apply(h[0]),g.moreButton.focus()}function e(){j.off(),g.hideFocusState(),a("#tab-container-popupmenu").remove()}function f(b){var c=a(this),d=c.closest("li");d.is(".dismissible")&&c.is(".close")&&(b.preventDefault(),b.stopPropagation(),g.closeDismissibleTab(d.children("a").attr("href")),g.popupmenu.close())}var g=this;g.popupmenu&&(a("#tab-container-popupmenu").off("focus.popupmenu"),g.popupmenu.close(),a("#tab-container-popupmenu").remove(),a(document).off("keydown.popupmenu"));var h=a("#tab-container-popupmenu");0===h.length?h=a('<ul class="tab-list-spillover">').attr("id","tab-container-popupmenu").appendTo("body"):h.html("");var i=g.tablist.children("li:not(.separator)");a.each(i,function(b,c){var d;if(g.isTabOverflowed(c)&&a(c).is(":not(:hidden)")&&(h.find("li").length>0&&a(c).prev().is(".separator")&&a(c).prev().clone().appendTo(h),a(c).is(":not(.separator)")&&(d=a(c).clone().removeClass("tab is-selected").removeAttr("style"),d.find(".icon").detach().appendTo(d.children("a")).off(),d.appendTo(h),d.children("a").data("original-tab",a(c).children("a")).removeAttr("onclick"),a(c).data("moremenu-link",d.children("a"))),a(c).is(".has-popupmenu"))){var e=a("#"+a(c).attr("aria-controls")),f=e.clone().removeClass("has-popupmenu").insertAfter(d.children("a"));f.children("li").each(function(b){var c=a(this),d=c.children("a"),f=e.children("li").eq(b),g=f.children("a");d.data("original-tab",g),g.data("moremenu-link",d)})}}),g.tablist.children("li:not(.separator)").removeClass("is-focused"),g.moreButton.popupmenu({autoFocus:!1,attachToBody:!0,menu:"tab-container-popupmenu",trigger:"immediate"}),g.moreButton.addClass("popup-is-open"),g.popupmenu=g.moreButton.data("popupmenu"),g.hasSquareFocusState()&&g.positionFocusState(g.moreButton),g.moreButton.on("close.tabs",c).on("selected.tabs",d);var j=g.popupmenu.menu;j.on("destroy.popupmenu",e).on("touchend.popupmenu touchcancel.popupmenu",".icon",f).on("click.popupmenu",".icon",f),g.popupmenu.highlight(b?j.find('a[href="'+b+'"]'):g.tablist.children(".is-selected").length>0?j.find('a[href="'+g.tablist.children(".is-selected").children("a").attr("href")+'"]'):j.find("li:first-child > a")),a(document).bindFirst("keydown.popupmenu",function(b){function c(){return this===document.activeElement}function d(){var d=j.find("li:first-child > a");d.filter(c).length>0&&(b.preventDefault(),a(document).off(b),g.popupmenu.close(),g.findLastVisibleTab())}function e(){var d=j.find("li:last-child > a");d.filter(c).length>0&&d.parent().is(":not(.submenu)")&&(b.preventDefault(),a(document).off(b),g.popupmenu.close(),g.findFirstVisibleTab())}function f(a){a.altKey&&i.parent().is(".dismissible")&&g.closeDismissibleTab(i.attr("href"))}var h=b.which,i=a(b.target);switch(h){case 8:case 46:f(b);break;case 37:i.is("a")&&(i.parent().is(":not(:first-child)")&&b.preventDefault(),a(document).trigger({type:"keydown.popupmenu",which:38}));break;case 38:d();break;case 39:i.is("a")&&!i.parent(".submenu").length&&a(document).trigger({type:"keydown.popupmenu",which:40});break;case 40:e()}})},isTabOverflowed:function(b){if(!b||0===b.length)return!0;this.tablist.scrollTop()>0&&this.tablist.scrollTop(0);var c=a(b).offset().top-this.tablist.offset().top;return c>=this.tablist.height()},findLastVisibleTab:function(){for(var a=this.tablist.children("li:not(.separator):not(.hidden):not(.is-disabled)"),b=a.first();!this.isTabOverflowed(b);)b=a.eq(a.index(b)+1);a.eq(a.index(b)-1).find("a").focus()},findFirstVisibleTab:function(){var a=this.tablist.children("li:not(.separator):not(.hidden):not(.is-disabled)");a.eq(0).find("a").focus()},focusBar:function(b,c){function d(a){h.animatedBar.css({left:j+"px",width:g+"px"}),a&&"function"==typeof a&&a()}if(this.hasAnimatedBar()){var e,f,g,h=this,i=void 0!==b?b:h.moreButton.hasClass("is-selected")?h.moreButton:h.tablist.children(".is-selected").length>0?h.tablist.children(".is-selected"):void 0;if(!i||void 0===i||!i.length||!h.anchors.length)return void h.animatedBar.removeClass("visible").removeClass("no-transition");e=parseInt(i.css("padding-left"),10)||0,f=parseInt(i.css("padding-right"),10)||0,g=i.innerWidth(),i.is(".tab")&&(e+=parseInt(i.children("a").css("padding-left"),10)||0,f+=parseInt(i.children("a").css("padding-right"),10)||0,g=i.width(),i.is(":first-child, :last-child")&&(g-=1),a("html").hasClass("is-firefox")&&(g-=1)),(i.is(".dismissible.tab")||i.is(".has-popupmenu.tab"))&&(f-=i.is(".has-popupmenu.tab")?0:10,g+=10);var j=Locale.isRTL()?f+i.position().left:i.position().left;clearTimeout(h.animationTimeout),this.animatedBar.addClass("visible"),this.animationTimeout=setTimeout(d.apply(this,[c]),0)}},defocusBar:function(){if(this.hasAnimatedBar()){var a=this,b=Locale.isRTL()?0:a.animatedBar.position().left+a.animatedBar.outerWidth()/2;clearTimeout(a.animationTimeout),this.animatedBar.css({left:b+"px",width:"0"}),this.animationTimeout=setTimeout(function(){a.animatedBar.removeClass("visible").removeAttr("style")},350)}},hideFocusState:function(){this.hasSquareFocusState()&&this.focusState.removeClass("is-visible")},positionFocusState:function(b,c){function d(b){if(!(b&&b instanceof jQuery))return 0;var c=0;return b.each(function(b,d){c+=a(d).outerHeight(!0)}),c}if(this.hasSquareFocusState()){var e=this;if(b=void 0!==b?a(b):e.moreButton.hasClass("is-selected")?e.moreButton:e.tablist.children(".is-selected").length>0?e.tablist.children(".is-selected").children("a"):void 0,!b||void 0===b||!b.length)return void this.focusState.removeClass("is-visible");var f,g,h=b.offset(),i=this.tablist.offset(),j=parseInt(b.outerWidth()),k=parseInt(b.outerHeight()),l=Locale.isRTL();this.isModuleTabs()||!b.is(".dismissible.tab > a")&&!b.is(".has-popupmenu.tab > a")||(j+=22),f=h.left-i.left,g=h.top-i.top;var m=this.element.parent();if(m.is(".header, header")&&(f+=parseInt(this.element.css("padding-left")),k-=4,g+=5),this.isModuleTabs()&&(j=parseInt(b.parent().outerWidth(!0)),f-=parseInt(b.css("margin-left")),b.parent().is(".add-tab-button")&&(f-=1)),this.isVerticalTabs()){var n=this.tablist.prevAll(".tab-list-info");j=this.tablist.outerWidth(!0),m.is(".page-container")&&(g+=n.length?d(n):0)}this.focusState.css({left:f,top:g,right:l?"":f+j,bottom:g+k,width:j,height:k});var o="addClass";c&&(o=c===!0?"addClass":"removeClass",this.focusState[o]("is-visible"))}},checkFocusedElements:function(){var a=this,b=a.tablist;!this.hasSquareFocusState()||0!==b.find(".is-focused").length||a.moreButton.hasClass("is-focused")||a.moreButton.hasClass("popup-is-open")||a.focusState.removeClass("is-visible"),this.hasAnimatedBar()&&0===b.find(".is-selected").length&&!a.moreButton.hasClass("is-selected")&&a.defocusBar()},updated:function(){return this.teardown().init()},disable:function(){this.element.prop("disabled",!0).addClass("is-disabled"),this.disabledElems||(this.disabledElems=[]);var b=this,c=this.tablist.children("li:not(.separator)");c.each(function(){var c=a(this),d=c.children("a");if((c.is(".is-disabled")||d.prop("disabled")===!0)&&b.disabledElems.push({elem:c,originalTabindex:c.attr("tabindex"),originalDisabled:d.prop("disabled")}),c.addClass("is-disabled"),d.prop("disabled",!0),!c.is(".application-menu-trigger")&&!c.is(".add-tab-button")){var e=a(d.attr("href"));e.addClass("is-disabled"),e.find("*").each(function(){var c=a(this);c.is("input.dropdown, input.multiselect")||(("-1"===c.attr("tabindex")||c.attr("disabled"))&&b.disabledElems.push({elem:c,originalTabindex:c.attr("tabindex"),originalDisabled:c.prop("disabled")}),c.disable())})}}),this.isModuleTabs()&&this.element.children(".toolbar").disable(),this.updateAria(a())},enable:function(){this.element.prop("disabled",!1).removeClass("is-disabled");var b=this,c=this.tablist.children("li:not(.separator)");c.each(function(){var c=a(this),d=c.children("a");if(c.removeClass("is-disabled"),d.prop("disabled",!1),!c.is(".application-menu-trigger")&&!c.is(".add-tab-button")){var e=a(d.attr("href"));e.removeClass("is-disabled"),e.find("*").each(function(){var b=a(this);b.enable&&"function"==typeof b.enable&&b.enable()}),a.each(b.disabledElems,function(a,b){var c=b.elem.is(".tab")?b.elem.children("a"):b.elem;return b.elem.disable&&"function"==typeof b.elem.disable&&b.elem.disable(),b.elem.is("li")?void b.elem.addClass("is-disabled"):void(b.elem.is("input.dropdown, input.multiselect")||(b.elem.attr("tabindex",b.originalTabindex),c.prop("disabled",b.originalDisabled)))})}}),this.isModuleTabs()&&this.element.children(".toolbar").enable(),this.disabledElems=[],this.updateAria(this.tablist.find(".is-selected > a"))},closeDismissibleTab:function(a){return this.remove(a)},teardown:function(){this.panels.removeAttr("style"),this.tablist.off().removeAttr("role").removeAttr("aria-multiselectable");var b=this.tablist.children("li");b.off().removeAttr("role").removeClass("is-selected");var c=b.filter(".has-popupmenu");if(c.each(function(){var b=a(this).data("popupmenu");b&&(b.menu.children("li:not(.separator)").each(function(){var b=a(this),c=b.children("a"),d=c.data("panel-link");a.removeData(c[0],"panel-link"),d&&d.length&&a.removeData(d[0],"tab-link")}),b.destroy())}),this.panels.off(),this.anchors.off().removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabindex"),this.element.off("focusout.tabs updated.tabs activated.tabs"),a("body").off("resize.tabs"+this.tabsIndex),this.tabsIndex=void 0,this.moreButton.data("popupmenu")){var d=this.moreButton.data("popupmenu");d.menu.find("li:not(.separator)").each(function(){var b=a(this),c=b.children("a");c.data("original-tab")&&a.removeData(c[0],"original-tab")}),d.destroy()}return this.addTabButton&&this.addTabButton.length&&(this.addTabButton.off().remove(),this.addTabButton=void 0),this.moreButton.off().remove(),this.moreButton=void 0,this.hasSquareFocusState()&&(this.focusState.remove(),this.focusState=void 0),this.hasAnimatedBar()&&(this.animatedBar.remove(),this.animatedBar=void 0),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,g))})},a.fn.verticaltabs=a.fn.tabs,a.fn.tag=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="tag",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.handleEvents()},handleEvents:function(){var b=this,c=a('<span class="dismissable-btn">'+a.createIcon("close")+'<span class="audible"> '+Locale.translate("Close")+"</span></span>");b.element.is(".is-dismissable")&&(b.element.append(c),c.on("click.tag",function(a){b.remove(a,b.element)}),b.element.on("keydown.tag",function(a){var c=a||window.event;8===c.keyCode&&b.remove(a,this)}))},remove:function(b,c){c=c instanceof jQuery?c:a(c);var d=c.parent();this.element.triggerHandler("beforetagremove",{event:b,element:c}),c.remove(),d.triggerHandler("aftertagremove",{event:b})},destroy:function(){this.element.off("keydown.tag"),a(".dismissable-btn",this.element).off("click.tag").remove(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.textarea=function(b){function c(b){this.element=a(b),this.init()}var d="textarea",e={characterCounter:!0,printable:!0,charRemainingText:null,charMaxText:null},f=a.extend({},e,b);return c.prototype={init:function(){this.isChrome=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),this.isSafari=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Android"),this.element.addClass(this.element.is(".textarea-xs")?"input-xs":this.element.is(".textarea-sm")?"input-sm":this.element.is(".textarea-lg")?"input-lg":""),f.characterCounter&&this.element.attr("maxlength")&&(this.counter=a('<span class="textarea-wordcount">Chars Left..</span>').insertAfter(this.element)),f.printable&&(this.printarea=a('<span class="textarea-print"></span>').insertBefore(this.element)),this.handleEvents(),this.update(this)},handleEvents:function(){var a=this;this.element.on("keyup.textarea",function(){a.update(a)}).on("focus.textarea",function(){a.counter&&a.counter.addClass("focus")}).on("keypress.textarea",function(b){var c=a.element.val().length,d=a.element.attr("maxlength");return[97,99,118,120].indexOf(b.which)>-1&&(b.metaKey||b.ctrlKey)?void a.update(a):void(a.isPrintable(b.which)&&c>=d&&!a.isSelected(this)&&b.preventDefault())}).on("blur.textarea",function(){a.update(a),a.counter&&a.counter.removeClass("focus")})},isSelected:function(a){return"number"==typeof a.selectionStart?0===a.selectionStart&&a.selectionEnd===a.value.length:"undefined"!=typeof document.selection?(a.focus(),document.selection.createRange().text===a.value):void 0},isPrintable:function(a){var b=a>47&&58>a||a>64&&91>a||a>95&&112>a||a>185&&193>a||a>218&&223>a;return b},countLinebreaks:function(a){return(a.match(/\n/g)||[]).length},update:function(a){var b=a.element.val(),c=this.isChrome||this.isSafari,d=b.length+(c?this.countLinebreaks(b):0),e=a.element.attr("maxlength"),g=parseInt(e)-d,h=(f.charRemainingText?f.charRemainingText:"CharactersLeft"===Locale.translate("CharactersLeft")?"Characters Left":Locale.translate("CharactersLeft")).replace("{0}",g.toString());a.counter&&(0===d?(h=(f.charMaxText?f.charMaxText:Locale.translate("CharactersMax"))+e,a.counter.text(h),a.counter.removeClass("almost-empty")):(a.counter.text(h),10>g?a.counter.addClass("almost-empty"):a.counter.removeClass("almost-empty"))),a.printarea&&a.printarea.text(a.element.val())},enable:function(){this.element.prop("disable",!1).prop("readonly",!1)},disable:function(){this.element.prop("disable",!0)},readonly:function(){this.element.prop("readonly",!0)},destroy:function(){a.removeData(this.element[0],d),this.printarea&&this.printarea.length&&this.printarea.remove(),this.counter&&this.counter.length&&this.counter.remove(),this.element.off("keyup.textarea")}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},a.fn.timepicker=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="timepicker",e={timeFormat:Locale.calendar().timeFormat||"h:mm a",minuteInterval:5,mode:"standard",roundToInterval:!1},f=a.extend({},e,b);

return c.prototype={init:function(){this.setup().build().handleEvents().roundMinutes()},setup:function(){function b(a){if(void 0===a||isNaN(a))return e.minuteInterval;var b=parseInt(a,10);return b>0&&60>b?b:e.minuteInterval}function c(a){return a&&(a.match("h")||a.match("HH"))&&a.match("mm")?a:e.timeFormat}function d(a){return a===!0}function f(b){var c=["standard","range"];return a.inArray(b,c)>-1?b:e.mode}return this.element.is("[data-round-to-interval]")&&(this.settings.roundToInterval=this.getBoolean(this.element.attr("data-round-to-interval"))),this.element.is("[data-minute-interval]")&&(this.settings.minuteInterval=parseInt(this.element.attr("data-minute-interval"),10)),this.settings.timeFormat=c(24===parseInt(this.element.attr("data-force-hour-mode"))?"HH:mm":this.settings.timeFormat),this.settings.minuteInterval=b(this.settings.minuteInterval),this.settings.mode=f(this.settings.mode),this.settings.roundToInterval=d(this.settings.roundToInterval),this},build:function(){return this.trigger=this.element.next("svg.icon"),0===this.trigger.length&&(this.trigger=a.createIconElement("clock").insertAfter(this.element)),this.addAria(),this.mask(),this},addAria:function(){this.element.attr({"aria-expanded":"false",role:"combobox"}),this.label=a('label[for="'+this.element.attr("id")+'"]'),this.label.append('<span class="audible">'+Locale.translate("UseArrow")+"</span>")},handleEvents:function(){var a=this;return this.trigger.onTouchClick("timepicker").on("click.timepicker",function(){a.toggleTimePopup()}),this.handleKeys(),this.handleBlur(),this},handleKeys:function(){var a=this;this.element.on("keydown.timepicker",function(b){var c=!1;return 27===b.which&&a.isOpen()&&(c=!0,a.closeTimePopup()),40!==b.which||a.isOpen()||(c=!0,a.openTimePopup()),c?(b.stopPropagation(),b.preventDefault(),!1):void 0})},handleBlur:function(){var a=this;this.element.on("blur.timepicker",function(){a.roundMinutes(),setTimeout(function(){a.isOpen()&&0===a.popup.find(":focus").length&&a.closeTimePopup()},20)})},is24HourFormat:function(a){return a||(a=this.settings.timeFormat),(a.match("HH")||[]).length>0},getTimeSeparator:function(){return Locale.calendar().dateFormat.timeSeparator},roundMinutes:function(){if(this.getBoolean(this.settings.roundToInterval)){var a=this.element.val(),b=this.getTimeSeparator(),c=a?a.split(b):[],d=this.settings.minuteInterval;if(c[1]){if(!this.is24HourFormat(this.settings.timeFormat)){var e=c[1].split(" ");c[1]=e[0],e[1]&&c.push(e[1])}if(c[1]=parseInt(c[1],10),c[1]%d!==0){c[1]=Math.round(c[1]/d)*d,c[1]=c[1].toString(),c[1]=(c[1].length<2?"0":"")+c[1],"60"===c[1]&&(c[1]="00",c[0]=(parseInt(c[0])+1).toString());var f=c[0]+b+c[1]+" "+(c[2]?c[2]:"");this.element.val(f)}}}},mask:function(){this.element.data("mask")&&"object"==typeof this.element.data("mask")&&this.element.data("mask").destroy(),this.element.data("mask",void 0);var b=this.getTimeSeparator(),c="##"+b+"##"+(this.is24HourFormat()?"":" am"),d="time",e="time",f={time:"blur"},g=this.element.attr("data-validate"),h=this.element.attr("data-validation-events");"required"!==g||h||(e=g+" "+e,a.extend(f,{required:"change blur"})),h&&(f=h),this.element.attr("data-mask",c).attr("data-mask-mode",d).attr("data-validate",e).attr("data-validation-events",JSON.stringify(f)).mask().validate().triggerHandler("updated")},buildStandardPopup:function(){var b,c,d,e,f=this,g=a('<div class="timepicker-popup-content"></div>'),h=f.getTimeFromField(),i=this.getTimeSeparator(),j=a('<div class="time-parts"></div>').appendTo(g),k=this.is24HourFormat(),l=k?0:1,m=k?24:13;for(b=a('<select id="timepicker-hours" class="hours dropdown"></select>');m>l;)e="",h.hours===l&&(e=" selected"),b.append(a("<option"+e+">"+l+"</option>")),l++;j.append(a('<label for="timepicker-hours" class="audible">'+Locale.translate("TimeHours")+"</label>")),j.append(b),j.append(a('<span class="label colons">'+i+"</span>"));var n=0;for(c=a('<select id="timepicker-minutes" class="minutes dropdown"></select>');59>=n;){var o=10>n?"0"+n:n;e="",h.minutes===n&&(e=" selected"),c.append(a("<option"+e+">"+o+"</option>")),n+=f.settings.minuteInterval}if(j.append(a('<label for="timepicker-minutes" class="audible">'+Locale.translate("TimeMinutes")+"</label>")),j.append(c),d=a('<select id="timepicker-period" class="period dropdown"></select>'),!k){j.append(a('<span class="label colons">&nbsp;</span>'));for(var p=Locale.calendar().dayPeriods,q=0,r=new RegExp(h.period,"i"),s="AM";2>q;)s=0===q?"AM":"PM",e="",p[q].match(r)&&(e=" selected"),d.append(a('<option value="'+s+'">'+p[q]+"</option>")),q++;j.append(a('<label for="timepicker-period" class="audible">'+Locale.translate("TimePeriod")+"</label>")),j.append(d)}g.append('<div class="modal-buttonset"><button type="button" class="btn-modal-primary set-time">'+Locale.translate("SetTime")+"</button></div>"),this.trigger.popover({content:g,trigger:"immediate",placement:"bottom",offset:{top:27,left:-8},width:"200",tooltipElement:"#timepicker-popup"}).on("show.timepicker",function(e,g){g.find("select").dropdown({}),g.find("button").button(),f.trigger.data("tooltip").position(),b.val(h.hours),b.data("dropdown").pseudoElem.find("span").text(h.hours),c.val(h.minutes),c.data("dropdown").pseudoElem.find("span").text(h.minutes),f.is24HourFormat()||(d.val(h.period),d.data("dropdown").pseudoElem.find("span").text(h.period)),a(this).find("#timepicker-hours-shdo").focus()}),g.find(".set-time").off("click.timepicker").onTouchClick("timepicker").on("click.timepicker",function(a){a.preventDefault(),f.setTimeOnField(),f.closeTimePopup()});var t=f.popup=this.trigger.data("tooltip").tooltip;t.addClass("timepicker-popup")},setupStandardEvents:function(){var a=this;a.popup.on("touchend.timepicker touchcancel.timepicker",".set-time",function(a){a.preventDefault(),a.target.click()}).on("keydown.timepicker","input.dropdown",function(b){var c=!1;if(27===b.which&&(c=!0,a.closeTimePopup(),a.element.focus()),32===b.which&&(c=!0,a.popup.find(".set-time").click()),37===b.which||39===b.which){c=!0;var d=a.popup.find('input[id$="-shdo"]');if(37===b.which){var e=d.eq(d.index(this)-1);e&&0!==e.length||(e=d.eq(d.length)),e.focus()}if(39===b.which){var f=d.eq(d.index(this)+1);f&&0!==f.length||(f=d.eq(0)),f.focus()}}return c?(b.preventDefault(),b.stopPropagation(),!1):void 0}),a.trigger.on("hide.timepicker",function(){a.onPopupHide()})},buildRangePopup:function(){},setupRangeEvents:function(){},getTimeFromField:function(){var a=this.element.val(),b=this.getTimeSeparator(),c=a.split(b),d=1,e=0,f=Locale.translateDayPeriod("AM");return c[0]=parseInt(c[0].replace(/ /g,""),10),c[0]=isNaN(c[0])?"1":""+parseInt(c[0],10),d=c[0],c[1]?(c[1]=c[1].replace(/^\s+|\s+$/g,""),this.is24HourFormat()?(e=parseInt(c[1],10),e=10>e?"0"+e:""+e):(c[1]=c[1].split(" "),e=parseInt(c[1][0],10),e=10>e?"0"+e:""+e,c[1][1]&&(f=""+c[1][1]))):e="00",{hours:d,minutes:e,period:f}},setTimeOnField:function(){var b=a("#timepicker-hours").val()||"",c=a("#timepicker-minutes").val()||"",d=(a("#timepicker-period").val()||"").toUpperCase(),e=""+b+this.getTimeSeparator()+c;d=this.is24HourFormat()||""!==d?d:a("#timepicker-period-shdo").val(),e+=d?" "+Locale.translateDayPeriod(d):"",this.element.val(e).trigger("change"),this.element.focus()},isOpen:function(){return this.popup&&!this.popup.hasClass("is-hidden")},openTimePopup:function(){var a=this;a.setup(),this.element.is(":disabled")||(this.popup&&!this.popup.hasClass("is-hidden")&&a.closeTimePopup(),this.element.addClass("is-active"),"range"===a.settings.mode?(a.buildRangePopup(),a.setupRangeEvents()):(a.buildStandardPopup(),a.setupStandardEvents()),this.element.attr({"aria-expanded":"true"}))},closeTimePopup:function(){this.trigger.data("tooltip").hide()},onPopupHide:function(){"standard"===this.settings.mode&&(a("#timepicker-hours").data("dropdown").destroy(),a("#timepicker-minutes").data("dropdown").destroy(),this.is24HourFormat()||a("#timepicker-period").data("dropdown").destroy(),this.popup.off("click.timepicker touchend.timepicker touchcancel.timepicker keydown.timepicker")),this.element.attr({"aria-expanded":"false"}),this.trigger.off("hide.timepicker show.timepicker"),this.trigger.data("tooltip").destroy(),this.trigger.data("tooltip",void 0),a("#timepicker-popup").remove(),this.element.removeClass("is-active")},toggleTimePopup:function(){this.isOpen()?this.closeTimePopup():this.openTimePopup()},value:function(a){var b=this.element.val();if(!a||a===!1)return b;var c=Locale.calendar().dateFormat.timeSeparator,d=new RegExp(c,"g");b=b.replace(d,"");var e=b.split(" ");return e[0].length<4&&(b="0"+e[0]+(e[1]?e[1]:"")),b},enable:function(){this.element.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0)},isDisabled:function(){return this.element.prop("disabled")},getBoolean:function(a){var b=+a;return isNaN(b)?!!String(a).toLowerCase().replace(!1,""):!!b},updated:function(){return this.teardown().init()},teardown:function(){this.trigger.off("keydown.timepicker"),this.element.off("focus.timepicker blur.timepicker keydown.timepicker"),this.popup&&this.closeTimePopup(),this.trigger.remove();var a=this.element.data("mask");return a&&"function"==typeof a.destroy&&a.destroy(),this.label.find(".audible").remove(),this},destroy:function(){this.teardown(),a.removeData(this.element[0],"validate"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})};var G=window.Tmpl={};G.Template=function(a,b,c,d){a=a||{},this.r=a.code||this.r,this.c=c,this.options=d||{},this.text=b||"",this.partials=a.partials||{},this.subs=a.subs||{},this.buf=""};var H=/\S/,I=/\n/g,J=/\r/g,K=/\\/g,L=/\u2028/,M=/\u2029/,N=/&/g,O=/</g,P=/>/g,Q=/\'/g,R=/\"/g,S=/[&<>\"\']/;G.Template.prototype={r:function(){return""},v:u,t:q,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var c=this.partials[a],d=b[c.name];if(c.instance&&c.base===d)return c.instance;if("string"==typeof d){if(!this.c)throw new Error("No compiler available.");d=this.c.compile(d,this.options)}if(!d)return null;if(this.partials[a].base=d,c.subs){b.stackText||(b.stackText={});for(var e in c.subs)b.stackText[e]||(b.stackText[e]=void 0!==this.activeSub&&b.stackText[this.activeSub]?b.stackText[this.activeSub]:this.text);d=p(d,c.subs,c.partials,this.stackSubs,this.stackPartials,b.stackText)}return this.partials[a].instance=d,d},rp:function(a,b,c,d){var e=this.ep(a,c);return e?e.ri(b,c,d):""},rs:function(b,c,d){var e=b[b.length-1];if(!a.isArray(e))return void d(b,c,this);for(var f=0;f<e.length;f++)b.push(e[f]),d(b,c,this),b.pop()},s:function(b,c,d,e,f,g,h){var i;return a.isArray(b)&&0===b.length?!1:("function"==typeof b&&(b=this.ms(b,c,d,e,f,g,h)),i=!!b,!e&&i&&c&&c.push("object"==typeof b?b:c[c.length-1]),i)},d:function(b,c,d,e){var f,g=b.split("."),h=this.f(g[0],c,d,e),i=this.options.modelGet,j=null;if("."===b&&a.isArray(c[c.length-2]))h=c[c.length-1];else for(var l=1;l<g.length;l++)f=k(g[l],h,i),void 0!==f?(j=h,h=f):h="";return e&&!h?!1:(e||"function"!=typeof h||(c.push(j),h=this.mv(h,c,d),c.pop()),h)},f:function(a,b,c,d){for(var e=!1,f=null,g=!1,h=this.options.modelGet,i=b.length-1;i>=0;i--)if(f=b[i],e=k(a,f,h),void 0!==e){g=!0;break}return g?(d||"function"!=typeof e||(e=this.mv(e,b,c)),e):d?!1:""},ls:function(a,b,c,d,e){var f=this.options.delimiters;return this.options.delimiters=e,this.b(this.ct(q(a.call(b,d)),b,c)),this.options.delimiters=f,!1},ct:function(a,b,c){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,c)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;return this.buf="",a},ms:function(a,b,c,d,e,f,g){var h,i=b[b.length-1],j=a.call(i);return"function"==typeof j?d?!0:(h=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(j,i,c,h.substring(e,f),g)):j},mv:function(a,b,c){var d=b[b.length-1],e=a.call(d);return"function"==typeof e?this.ct(q(e.call(d)),d,c):e},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=a,e(b,c,this,d),this.activeSub=!1)}},G.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},G.scan=function(a,b){function c(){n.length>0&&(o.push({tag:"_t",text:new String(n)}),n="")}function d(){for(var a=!0,b=u;b<o.length;b++)if(a=G.tags[o[b].tag]<G.tags._v||"_t"==o[b].tag&&null===o[b].text.match(H),!a)return!1;return a}function e(a,b){if(c(),a&&d())for(var e,f=u;f<o.length;f++)o[f].text&&((e=o[f+1])&&">"===e.tag&&(e.indent=o[f].text.toString()),o.splice(f,1));else b||o.push({tag:"\n"});p=!1,u=o.length}function f(a,b){var c="="+w,d=a.indexOf(c,b),e=s(a.substring(a.indexOf("=",b)+1,d)).split(" ");return v=e[0],w=e[e.length-1],d+c.length-1}var g=a.length,h=0,i=1,j=2,k=h,l=null,m=null,n="",o=[],p=!1,q=0,u=0,v="{{",w="}}";for(b&&(b=b.split(" "),v=b[0],w=b[1]),q=0;g>q;q++)k===h?t(v,a,q)?(--q,c(),k=i):"\n"===a.charAt(q)?e(p):n+=a.charAt(q):k===i?(q+=v.length-1,m=G.tags[a.charAt(q+1)],l=m?a.charAt(q+1):"_v","="===l?(q=f(a,q),k=h):(m&&q++,k=j),p=q):t(w,a,q)?(o.push({tag:l,n:s(n),otag:v,ctag:w,i:"/"===l?p-v.length:q+w.length}),n="",q+=w.length-1,k=h,"{"===l&&("}}"===w?q++:r(o[o.length-1]))):n+=a.charAt(q);return e(p,!0),o};var T={_t:!0,"\n":!0,$:!0,"/":!0};G.stringify=function(a){return"{code: function (c,p,i) { "+G.wrapMain(a.code)+" },"+x(a)+"}"};var U=0;G.generate=function(a,b,c){U=0;var d={code:"",subs:{},partials:{}};return G.walk(a,d),c.asString?this.stringify(d,b,c):this.makeTemplate(d,b,c)},G.wrapMain=function(a){return'var t=this;t.b(i=i||"");'+a+"return t.fl();"},G.template=G.Template,G.makeTemplate=function(a,b,c){var d=this.makePartials(a);return d.code=new Function("c","p","i",this.wrapMain(a.code)),new this.template(d,b,this,c)},G.makePartials=function(a){var b,c={subs:{},partials:a.partials,name:a.name};for(b in c.partials)c.partials[b]=this.makePartials(c.partials[b]);for(b in a.subs)c.subs[b]=new Function("c","p","t","i",a.subs[b]);return c},G.codegen={"#":function(a,b){b.code+="if(t.s(t."+y(a.n)+'("'+o(a.n)+'",c,p,1),c,p,0,'+a.i+","+a.end+',"'+a.otag+" "+a.ctag+'")){t.rs(c,p,function(c,p,t){',G.walk(a.nodes,b),b.code+="});c.pop();}"},"^":function(a,b){b.code+="if(!t.s(t."+y(a.n)+'("'+o(a.n)+'",c,p,1),c,p,1,0,0,"")){',G.walk(a.nodes,b),b.code+="};"},">":z,"<":function(a,b){var c={partials:{},code:"",subs:{},inPartial:!0};G.walk(a.nodes,c);var d=b.partials[z(a,b)];d.subs=c.subs,d.partials=c.partials},$:function(a,b){var c={subs:{},code:"",partials:b.partials,prefix:a.n};G.walk(a.nodes,c),b.subs[a.n]=c.code,b.inPartial||(b.code+='t.sub("'+o(a.n)+'",c,p,i);')},"\n":function(a,b){b.code+=l('"\\n"'+(a.last?"":" + i"))},_v:function(a,b){b.code+="t.b(t.v(t."+y(a.n)+'("'+o(a.n)+'",c,p,0)));'},_t:function(a,b){b.code+=l('"'+o(a.text)+'"')},"{":A,"&":A},G.walk=function(a,b){for(var c,d=0,e=a.length;e>d;d++)c=G.codegen[a[d].tag],c&&c(a[d],b);return b},G.parse=function(a,b,c){return c=c||{},v(a,"",[],c.sectionTags||[])},G.cache={},G.cacheKey=function(a,b){return[a,!!b.asString,!!b.disableLambda,b.delimiters,!!b.modelGet].join("||")},G.compile=function(a,b){b=b||{};var c=G.cacheKey(a,b),d=this.cache[c];if(d){var e=d.partials;for(var f in e)delete e[f].instance;return d}return d=this.generate(this.parse(this.scan(a,b.delimiters),a,b),a,b),this.cache[c]=d,d},a.fn.toolbar=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="toolbar",e={rightAligned:!1,maxVisibleButtons:3},f=a.extend({},e,b);return c.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){return this.settings.maxVisibleButtons<=0&&(this.settings.maxVisibleButtons=3),this},build:function(){function b(){return a(this).parent(".buttonset, .inline").length}function c(){function b(c,e,f){var g=c.children("li"),h=e.attr("id");e.children("li").each(function(c,d){var e=a(d),f=g.eq(c),h=e.children("a"),i=f.children("a");h.removeAttr("id"),i.data("action-button-link",h),h.data("original-button",i);var j=f.children(".wrapper").children(".popupmenu"),k=e.children(".wrapper").children(".popupmenu");k.length&&k.length&&(e.addClass("submenu"),b(k,j,e))}),e.removeAttr("id").attr("data-original-menu",h),f.addClass("submenu"),f.is(d)&&(e.wrap(a('<div class="wrapper"></div>')),f.append(e))}var c=a(this),d=a("<li></li>"),e=a('<a href="#"></a>').appendTo(d);c.is(":hidden")&&d.addClass("hidden"),c.is(":disabled")?d.addClass("is-disabled"):d.removeClass("is-disabled"),e.text(f.getItemText(c));var g=a.getBaseURL("#icon-dropdown"),h=c.children(".icon").filter(function(){var b=a(this).getIconName();return b&&b!==g&&-1===b.indexOf("dropdown")});h&&h.length&&(e.html("<span>"+e.text()+"</span>"),h.clone().detach().prependTo(e));var i=d.find("b");if(i.length&&(f.moreMenu.addClass("has-icons"),i.detach().prependTo(d)),c.is(".searchfield")&&!c.data("searchfield")){var j=a.extend({},a.fn.parseOptions(c[0]));c.toolbarsearchfield(j)}if(c.is(".btn-menu")){c.data("popupmenu")||c.popupmenu();var l=c.data("popupmenu").menu,m=l.clone();b(l,m,d)}c.is("[data-popdown]")&&c.popdown(),c.data("action-button-link",e),d.children("a").data("original-button",c),k.push(d)}function d(){f.moreMenu.find("a").each(function(){var b=a(this),c=a(this).data("originalButton"),d=f.getItemText(c);c&&(b.find("span").length?b.find("span").text(d.trim()):b.text(d.trim()),c.is(":disabled")?(b.closest("li").addClass("is-disabled"),b.attr("disabled","disabled")):(b.closest("li").removeClass("is-disabled"),b.removeAttr("disabled")))})}function e(){f.items.attr("tabindex","-1");var a=f.items.filter(".is-selected");return a.length?(f.activeButton=a.first().attr("tabindex","0"),void f.items.not(f.activeButton).removeClass("is-selected")):(a=f.items.filter(":visible:not(:disabled)").first().attr("tabindex","0"),f.activeButton=a,f.element.is(":hidden, .is-hidden")?void(f.activeButton=f.items.filter(":not(:disabled)").first().attr("tabindex","0")):void(f.isItemOverflowed(a)&&(a.attr("tabindex","-1"),f.activeButton=f.more.addClass("is-selected").attr("tabindex","0"))))}var f=this;if(this.element.attr("role","toolbar"),this.buildAriaLabel(),this.id||(this.id=parseInt(a(".toolbar, .formatter-toolbar").index(this.element),10)),this.title=this.element.children(".title"),this.buttonset=this.element.children(".buttonset"),this.buttonset.length||(this.buttonset=a('<div class="buttonset"></div>'),this.title.length?this.buttonset.insertAfter(this.title):this.buttonset.prependTo(this.element)),this.buttonset[this.settings.rightAligned?"addClass":"removeClass"]("right-aligned"),this.more=this.element.find(".btn-actions"),0===this.more.length&&!this.element.hasClass("no-actions-button")){var g=this.element.find(".more");g.length||(g=a('<div class="more"></div>').appendTo(this.element)),this.more=a('<button class="btn-actions" type="button"></button>').html(a.createIcon({icon:"more"})+'<span class="audible">'+Locale.translate("MoreActions")+"</span>").appendTo(g)}this.items=this.buttonset.children("button").add(this.buttonset.find("input")).add(this.title.children("button")).add(this.more),this.buttonsetItems=this.buttonset.children("button, input").add(this.buttonset.find(".searchfield-wrapper").children("input"));var h=this.items.filter('button, input[type="button"], [class^="btn"]');h.each(function(){var b=a(this).data("button");b||a(this).button()});var i=this.more.data("popupmenu"),j=this.more.attr("aria-controls");i?this.moreMenu=i.menu:(this.moreMenu=a("#"+j),this.moreMenu.length||(this.moreMenu=this.more.next(".popupmenu")),this.moreMenu.length||(this.moreMenu=a('<ul id="popupmenu-toolbar-'+this.id+'" class="popupmenu"></ul>').insertAfter(this.more))),this.defaultMenuItems=this.moreMenu.children("li:not(.separator)").length>0;var k=[];if(this.items.not(this.more).filter(b).each(c),k.reverse(),a.each(k,function(a,b){""!==b.text()&&b.prependTo(f.moreMenu)}),i)this.more.triggerHandler("updated"),i.element.off("beforeopen").on("beforeopen",d);else{var l=a.fn.parseOptions(this.more[0]);this.more.popupmenu(a.extend({},l,{trigger:"click",menu:this.moreMenu})).off("beforeopen").on("beforeopen",d)}return e(),this.adjustButtonVisibility(),this.toggleMoreMenu(),this.element.triggerHandler("rendered"),this},getItemText:function(a){if(a){var b=a.find(".audible"),c=a.attr("title"),d=a.data("tooltip"),e=d?d.content:void 0,f=b.length?b.text():""!==c&&void 0!==c?a.attr("title"):e?e:a.text();return f}},handleEvents:function(){var b=this;return this.items.off("keydown.toolbar").on("keydown.toolbar",function(a){b.handleKeys(a)}).off("click.toolbar").on("click.toolbar",function(a){b.handleClick(a)}),this.items.filter(".btn-menu, .btn-actions").off("close.toolbar").on("close.toolbar",function(){a(this).focus()}),this.items.not(this.more).off("selected.toolbar").on("selected.toolbar",function(a,c){a.stopPropagation(),b.handleSelected(a,c)}),this.more.off("keydown.toolbar").on("keydown.toolbar",function(a){b.handleKeys(a)}).off("beforeopen.toolbar").on("beforeopen.toolbar",function(){b.checkOverflowItems()}).off("selected.toolbar").on("selected.toolbar",function(a,c){a.stopPropagation(),b.handleSelected(a,c)}),this.element.off("updated.toolbar").on("updated.toolbar",function(a){a.stopPropagation(),b.updated()}).off("recalculateButtons.toolbar").on("recalculateButtons.toolbar",function(){b.adjustButtonVisibility(),b.toggleMoreMenu()}),a(window).off("resize.toolbar-"+this.id).on("resize.toolbar-"+this.id,function(){b.adjustButtonVisibility(),b.toggleMoreMenu()}),this},handleSelected:function(b,c){var d,e,f=c.data("original-button");if(f&&f.length>0){if(d=f.listEvents(),e=this.element.listEvents(),this.setActiveButton(f),f.attr("ng-click")||f.attr("data-ng-click"))return void f.trigger("click");for(var g=["click","touchend","touchcancel"],h=0;h<g.length;h++){var i=g[h];if(e&&e[i]&&e[i].delegateCount>0){var j=this.element,k=a.Event(i);return k.target=j.find(f)[0],void j.trigger(k)}if(d&&d[i]||f[0]["on"+i])return void f.trigger(i)}return void this.triggerSelect(f)}this.triggerSelect(c)},handleClick:function(b){return this.setActiveButton(a(b.currentTarget)),this.triggerSelect(a(b.currentTarget)),!1},handleKeys:function(b){var c=this,d=b.which,e=a(b.target);return e.is(".btn-actions")?((37===d||38===d)&&(b.preventDefault(),c.setActiveButton(c.getLastVisibleButton())),void((39===d||40===d&&"true"!==e.attr("aria-expanded"))&&(b.preventDefault(),c.setActiveButton(c.getFirstVisibleButton())))):((37===d&&e.is(":not(input)")||37===d&&e.is("input")&&b.shiftKey||38===d)&&(b.preventDefault(),c.navigate(-1)),void((39===d&&e.is(":not(input)")||39===d&&e.is("input")&&b.shiftKey||40===d)&&(b.preventDefault(),c.navigate(1))))},navigate:function(a){var b,c=this.items.filter(":visible:not(:disabled)"),d=c.index(this.activeButton),e=d+a;return e>=0&&e<c.length&&(b=c.eq(e)),e>=c.length&&(b=c.first()),-1===e&&(b=c.last()),this.isItemOverflowed(b)&&(b=this.more),this.setActiveButton(b),!1},getLastVisibleButton:function(){var b,c=this;for(this.items.each(function(d){return c.isItemOverflowed(a(this))?(b=c.items.eq(d-1),!1):void 0}),b&&0!==b.length||(b=this.items.not(this.more).last());b.is(".separator, *:disabled, *:hidden");)b=b.prev();return b},getFirstVisibleButton:function(){for(var a=this.items.eq(0);a.is(".separator, *:disabled, *:hidden");)a=a.next();return a},setActiveButton:function(a,b){function c(){if(a.is("a"))return d.more;var b=d.more.data("tooltip");return a[0]===d.more[0]?(b&&b.tooltip.is(":not(.hidden)")&&b.hide(),d.more):d.isItemOverflowed(a)&&!a.is(".searchfield")?d.more:a}if(a[0]!==this.activeButton[0]){var d=this;this.items.add(this.more).attr("tabindex","-1").removeClass("is-selected"),this.activeButton=c(),this.activeButton.addClass("is-selected").attr("tabindex","0"),b||this.activeButton[0].focus()}},triggerSelect:function(b){var c=a(b);c.is(this.more)||c.is(".btn-menu, li.submenu")||this.element.trigger("selected",[c])},adjustButtonVisibility:function(){function b(){var b=a(this);return b.data("action-button-link")&&b.is(":not(.searchfield)")}var c=this,d=[],e="removeClass";return this.buttonsetItems.filter(b).removeClass("is-overflowed").each(function(){var b=a(this),f=b.data("action-button-link").parent();!c.isItemOverflowed(b)||b.hasClass("hidden")?f.addClass("hidden"):(f.removeClass("hidden"),b.addClass("is-overflowed"),b.find(".icon").length&&(e="addClass"),d.push(f))}),this.moreMenu[e]("has-icons"),{visible:d}},isItemOverflowed:function(b){if(!b||0===b.length)return!0;if(this.title.length&&this.buttonsetItems.index(b)>=this.settings.maxVisibleButtons-1&&(!this.buttonsetItems.last().is(b)||b.prev().is(".is-overflowed")))return!0;this.buttonset.scrollTop()>0&&this.buttonset.scrollTop(0);var c=a(b).offset().top+a(b).outerHeight()-this.buttonset.offset().top;return c>=this.buttonset.outerHeight()+1},checkOverflowItems:function(){var b=this.adjustButtonVisibility();a.contains(this.buttonset[0],document.activeElement)||(b.visible.length?b.visible[b.visible.length-1].focus():this.moreMenu.find(".hidden").last().next().focus())},toggleMoreMenu:function(){if(!this.element.hasClass("no-actions-button")){var a=this.moreMenu.children("li:not(.separator)"),b=a.not(".hidden"),c="removeClass";(this.defaultMenuItems||b.length>0)&&(c="addClass"),this.element[c]("has-more-button");var d=this.more.data("popupmenu");if("removeClass"===c){if(!d)return;d.close();var e=d.menu.find("li:not(.separator)").children("a"),f=!1;e.add(this.more).each(function(){document.activeElement===this&&(f=!0)}),f&&this.getLastVisibleButton()[0].focus()}}},buildAriaLabel:function(){if(!this.element.attr("aria-label")){var b=1===this.element.closest(".header").length,c=this.element.attr("id")||"",d=this.element.children(".title"),e=this.element.prev("label"),f=this.element.prev(".label"),g=b?a("header.header").find("h1").text():d.length?d.filter("div").text():e.length?e.text():f.length?f.text():c+" "+Locale.translate("Toolbar");this.element.attr("aria-label",g.replace(/\s+/g," ").trim())}},updated:function(){this.unbind().teardown().init(),setTimeout(function(){a(window).trigger("resize")},0)},enable:function(){this.element.prop("disabled",!1),this.items.prop("disabled",!1),this.more.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0),this.items.prop("disabled",!0),this.more.prop("disabled",!0).data("popupmenu").close()},unbind:function(){return this.items.offTouchClick("toolbar").off("keydown.toolbar click.toolbar focus.toolbar blur.toolbar"),this.more.off("beforeOpen.toolbar selected.toolbar"),a(window).off("resize.toolbar-"+this.id),this},teardown:function(){function b(c,d){var e=a(d),f=e.children("a"),g=f.data("original-button");f.off("mousedown.toolbar click.toolbar touchend.toolbar touchcancel.toolbar"),g&&g.length&&(a.removeData(f[0],"original-button"),a.removeData(g[0],"action-button-link")),e.is("submenu")&&e.children(".wrapper").children(".popupmenu").children("li").each(b),e.remove()}return this.moreMenu.children("li").each(b),this.more.length&&void 0!==this.more.data("popupmenu")&&this.more.data("popupmenu").destroy(),this.defaultMenuItems||this.moreMenu.remove(),this},destroy:function(){if(this.unbind().teardown(),this.buttonset.children(".searchfield-wrapper").length){var b=this.buttonset.children(".searchfield-wrapper").children(".searchfield");b.data("toolbarsearchfield")&&b.data("toolbarsearchfield").destroy()}this.element.removeAttr("role").removeAttr("aria-label"),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.toolbarsearchfield=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="toolbarsearchfield",e={clearable:!0,collapsible:!0},f=a.extend({},e,b);return c.prototype={init:function(){return this.build().handleEvents()},build:function(){this.id||(this.id=this.element.uniqueId("toolbar-searchfield")),this.input=this.element,this.toolbarParent=this.element.parents(".toolbar"),this.containmentParent=this.toolbarParent;var b=this.containmentParent.closest(".module-tabs");b.length&&(this.containmentParent=b);var c=this.element.attr("placeholder")||this.element.prev("label, .label").text().trim();c&&""!==c||(c=Locale.translate("Keyword")),this.input.attr({"aria-label":c});var d=a.extend({},this.settings,a.fn.parseOptions(this.input[0]));this.input.searchfield(d),this.inputWrapper=this.input.parent(".searchfield-wrapper"),this.inputWrapper.addClass("toolbar-searchfield-wrapper"),d.categories&&(this.button=this.inputWrapper.find(".searchfield-category-button"));var e=this.settings.collapsible?"removeClass":"addClass";return this.inputWrapper[e]("non-collapsible"),this.xButton=this.inputWrapper.children(".icon.close"),this.settings.collapsible||(this.inputWrapper.addClass("no-transition").one("activated."+this.id,function(){a(this).removeClass("no-transition")}),this.activate()),this},handleEvents:function(){var b=this;return this.inputWrapper.on("mousedown.toolbarsearchfield",function(){b.fastActivate=!0}).on("focusin.toolbarsearchfield",function(a){b.handleFocus(a)}).on("deactivate.toolbarsearchfield",function(){b.deactivate()}),this.button&&this.button.length&&this.button.on("beforeopen.toolbarsearchfield",function(a,c){return b.handlePopupBeforeOpen(a,c)}),a(document).on("keydown."+this.id,function(a){b.handleOutsideKeydown(a)}),a("body").on("resize."+this.id,function(){b.adjustOnBreakpoint()}),this},handleDeactivationEvents:function(){var b=this;a(document).onTouchClick(this.id).on("click."+this.id,function(a){b.handleOutsideClick(a)})},handleFocus:function(){function a(){b.activate()}var b=this;return clearTimeout(this.focusTimer),this.inputWrapper.addClass("has-focus"),this.fastActivate?void a():void(this.focusTimer=setTimeout(a,0))},handleFakeBlur:function(){function b(){!a.contains(c.inputWrapper[0],document.activeElement)&&c.inputWrapper.hasClass("active")&&(c.inputWrapper.removeClass("has-focus"),c.deactivate())}var c=this;clearTimeout(this.focusTimer),this.focusTimer=setTimeout(b,0)},handleOutsideClick:function(b){var c=a(b.target);if(!(a.contains(this.inputWrapper[0],b.target)||c.is(this.element)||c.is(this.inputWrapper))){if(this.button&&this.button.length){var d=this.button.data("popupmenu").menu;if(d.has(c).length)return}a(document).offTouchClick(this.id).off("click."+this.id),this.deactivate()}},handleOutsideKeydown:function(b){var c=b.which;if(this.fastActivate=!1,9===c)return this.fastActivate=!0,this.handleFakeBlur();var d=a(b.target).is(this.input)||a(b.target).is(this.inputWrapper);return!d||37!==c&&38!==c&&39!==c&&40!==c?void 0:this.handleFakeBlur()},handlePopupBeforeOpen:function(a,b){return b?this.inputWrapper.is(".is-open")?!0:(this.input.focus(),!1):!1},getFillSize:function(b,c){function d(a){if(!a)return 0;if(!isNaN(parseInt(a)))return parseInt(a);if(a instanceof jQuery){if(!a.length)return;a.is(".title")&&(a=a.next(".buttonset")),a=a[0]}return a}function e(b,c){if(!isNaN(b))return null===b||void 0===b?0:b;c&&"string"==typeof c||(c="left");var d=["left","right"];-1===a.inArray(c,d)&&(c=d[0]);var e;return(b instanceof HTMLElement||b instanceof SVGElement)&&(e=b.getBoundingClientRect()),e[c]}function f(){var d="left";return(b===c||a(c).length&&a(c).is(".buttonset"))&&(d="right"),d}var g=225,h=0,i=0,j=450;if(b=d(b),c=d(c),h=e(b),i=e(c,f()),!h&&!i)return g;var k=i-h;return g>=k?g:k>=j?j:k},setOpenWidth:function(){this.inputWrapper.css("width",this.openWidth)},calculateOpenWidth:function(){var a,b=this.element.parents(".toolbar").children(".buttonset"),c=this.inputWrapper.next();if(c.is(".title")&&(c=b),this.shouldBeFullWidth())return a="100%",this.toolbarParent.closest(".header").length&&(a="calc(100% - 40px)"),void(this.openWidth=a);var d=b.offset().left+10,e=this.inputWrapper.next();e.length||(e=b.offset().left+b.outerWidth(!0)),a=this.getFillSize(d,e),this.openWidth=a+"px"},isActive:function(){return this.inputWrapper.hasClass("is-active")},adjustOnBreakpoint:function(){
var a=this.shouldBeFullWidth(),b=this.inputWrapper.attr("style");this.isActive()&&this.deactivate(),a||b||this.calculateOpenWidth()},activate:function(){function a(){b.inputWrapper.addClass("is-open"),b.calculateOpenWidth(),b.setOpenWidth(),b.input.focus(),b.toolbarParent.trigger("recalculateButtons"),b.inputWrapper.triggerHandler("activated")}if(!this.inputWrapper.hasClass("active")){var b=this,c=!this.shouldBeFullWidth();return this.animationTimer&&clearTimeout(this.animationTimer),c||this.inputWrapper.detach().prependTo(this.containmentParent),this.inputWrapper.addClass("active"),this.handleDeactivationEvents(),this.settings.collapsible!==!1||this.shouldBeFullWidth()?void(this.animationTimer=setTimeout(a,0)):void a()}},deactivate:function(){function a(){(c.settings.collapsible||c.shouldBeFullWidth())&&c.inputWrapper.removeAttr("style")}function b(){c.inputWrapper.removeClass("is-open"),c.fastActivate=!1,a(),c.button&&c.button.length&&c.button.is(".is-open")&&c.button.data("popupmenu").close(!1,!0),c.toolbarParent.trigger("recalculateButtons"),c.inputWrapper.trigger("deactivated")}var c=this,d="removeClass";return""!==this.input.val().trim()&&(d="addClass"),this.inputWrapper[d]("has-text"),this.animationTimer&&clearTimeout(this.animationTimer),this.inputWrapper.parent().is(this.containmentParent)&&this.inputWrapper.detach().prependTo(this.containmentParent.find(".buttonset")),c.inputWrapper.removeClass("active").removeClass("has-focus"),this.fastActivate||this.settings.collapsible===!1?void b():void(this.animationTimer=setTimeout(b,0))},shouldBeFullWidth:function(){var b=this.inputWrapper.closest(".header"),c=b.width(),d=a(window).width();return 767>d||b.length>0&&320>c},updated:function(){return this.teardown().init()},enable:function(){this.inputWrapper.addClass("is-disabled"),this.input.prop("disabled",!0)},disable:function(){this.inputWrapper.removeClass("is-disabled"),this.input.prop("disabled",!1)},teardown:function(){return this.inputWrapper.off("mousedown.toolbarsearchfield focusin.toolbarsearchfield"),a(document).off("keydown."+this.id),a("body").off("resize."+this.id),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.tooltip=function(b,c){"use strict";function d(b){this.element=a(b),this.init()}var e="tooltip",f={content:null,offset:{top:10,left:0},placement:"top",trigger:"hover",title:null,beforeShow:null,popover:null,closebutton:null,isError:!1,isErrorColor:!1,tooltipElement:null,keepOpen:!1,extraClass:null,maxWidth:null},g=a.extend({},f,b);return d.prototype={init:function(){this.setup(),this.appendTooltip(),this.handleEvents(),this.addAria(),this.isPopover=null!==g.content&&"object"==typeof g.content||g.popover},setup:function(){this.activeElement=this.element,this.descriptionId=a(".tooltip-description").length+1,this.description=this.element.next(".tooltip-description"),!this.description.length&&g.isError&&(this.description=a('<span id="tooltip-description-'+this.descriptionId+'" class="tooltip-description audible"></span>').insertAfter(this.element)),this.element.is(".dropdown, .multiselect")&&(this.activeElement=this.element.nextAll(".dropdown-wrapper:first").find(">.dropdown")),g.closebutton=g.closebutton||this.element.data("closebutton")?!0:!1,this.element.data("extraClass")&&this.element.data("extraClass").length&&(g.extraClass=this.element.data("extraClass"))},addAria:function(){this.content=this.element.attr("title")||g.content,this.description.text(this.content),this.content=this.addClassToLinks(this.content,"links-clickable"),this.isPopover||this.element.removeAttr("title").attr("aria-describedby",this.description.attr("id")),this.isPopover&&"click"===g.trigger&&this.element.attr("aria-haspopup",!0)},addClassToLinks:function(b,c){var d=a("<div/>").html(b);return a("a",d).addClass(c),d.html()},appendTooltip:function(){if(this.tooltip=a(g.tooltipElement?g.tooltipElement:"#tooltip"),!this.tooltip.length){var b=g.tooltipElement?g.tooltipElement.substring(1,g.tooltipElement.length):"tooltip";this.tooltip=a('<div class="'+(this.isPopover?"popover":"tooltip")+' bottom is-hidden" role="tooltip" id="'+b+'"><div class="arrow"></div><div class="tooltip-content"></div></div>')}this.place()},handleEvents:function(){var a,b=this,c=400;"hover"!==g.trigger||g.isError||this.element.on("mouseenter.tooltip",function(){a=setTimeout(function(){b.show()},c)}).on("mouseleave.tooltip mousedown.tooltip click.tooltip mouseup.tooltip",function(){clearTimeout(a),setTimeout(function(){b.hide()},c)}).on("updated.tooltip",function(){b.updated()}),"click"===g.trigger&&this.element.on("click.tooltip",function(){b.tooltip.hasClass("is-hidden")?b.show():b.hide()}),"immediate"===g.trigger&&(a=setTimeout(function(){b.tooltip.hasClass("is-hidden")?b.show():b.hide()},1)),"focus"===g.trigger&&this.element.on("focus.tooltip",function(){b.show()}).on("blur.tooltip",function(){b.hide()}),this.element.filter("button, a").on("focus.tooltip",function(){b.setContent(b.content)})},setContent:function(b){if(!(b&&b.length||"function"==typeof g.content))return!1;var c,d=this,e=!1,f=a('<button type="button" class="btn-icon l-pull-right"><span>Close</span></button>').prepend(a.createIconElement({classes:["icon-close"],icon:"close"})).css({"margin-top":"-9px"}).on("click",function(){d.hide()});if(b=Locale.translate(b)||b,0===b.indexOf("#")&&(b=a(b).html(),e=!0),g.extraClass&&"string"==typeof g.extraClass?this.tooltip.addClass(g.extraClass):this.tooltip.removeAttr("class").addClass("tooltip bottom is-hidden"),this.isPopover){if(c=this.tooltip.find(".tooltip-content").html(g.content).removeClass("hidden"),g.content.removeClass("hidden"),this.tooltip.removeClass("tooltip").addClass("popover"),null!==g.title){var h=this.tooltip.find(".tooltip-title");0===h.length&&(h=a('<div class="tooltip-title"></div>').prependTo(this.tooltip)),h.html(g.title).show()}else this.tooltip.find(".tooltip-title").hide();return g.closebutton&&a(".tooltip-title",this.tooltip).append(f),c.initialize(),!0}return this.tooltip.find(".tooltip-title").hide(),this.tooltip.removeClass("popover").addClass("tooltip"),"function"!=typeof g.content||(b=this.content=g.content.call(this.element))?(c=this.tooltip.find(".tooltip-content"),0===c.prev(".arrow").length&&c.before('<div class="arrow"></div>'),c.html(e?b:"<p>"+(void 0===b?"(Content)":b)+"</p>"),!0):!1},open:function(){return this.show()},show:function(b,c){var d=this;if(this.isInPopup=!1,b&&(g=b),g.beforeShow&&!c){var e=function(a){d.content=a,d.show(g,!0)};return"string"==typeof g.beforeShow?void window[g.beforeShow](e):void g.beforeShow(e)}var f=!0;f=this.setContent(this.content),f!==!1&&(f=this.element.triggerHandler("beforeshow",[this.tooltip]),f!==!1&&(this.tooltip.removeAttr("style"),this.tooltip.removeClass("bottom right left top offset is-error").addClass(g.placement),(g.isError||g.isErrorColor)&&this.tooltip.addClass("is-error"),this.place(),this.tooltip.removeClass("is-hidden"),this.position(),this.element.trigger("show",[this.tooltip]),setTimeout(function(){a(document).on("mouseup.tooltip",function(b){g.isError||"focus"===g.trigger||a(b.target).is(d.element)&&a(b.target).is("svg.icon")||0===a(b.target).closest(".popover").length&&0===a(b.target).closest(".dropdown-list").length&&d.hide(b)}).on("keydown.tooltip",function(a){(27===a.which||g.isError)&&d.hide()}),!g.isError||d.element.is(":visible")||d.element.is(".dropdown")||d.hide(),void 0===window.orientation&&a(window).on("resize.tooltip",function(){d.hide()}),g.isError&&d.tooltip.on("click.tooltip",function(){d.hide()}),d.element.trigger("aftershow",[d.tooltip])},400)))},place:function(){var b=a("body");this.scrollparent=this.element.closest(".page-container.scrollable"),this.scrollparent.length&&(b=this.scrollparent),this.tooltip.detach().appendTo(b)},position:function(){function b(){m=f.tooltip.offset(),n=f.tooltip.find(".arrow"),o=0,p=0,q=0}function c(){return b(),m.left-j.deltaWidth<=0}function d(){return b(),m.left-j.deltaWidth+f.tooltip.outerWidth()-10>=i}function e(){return b(),m.top-j.deltaHeight<=0}var f=this,h=window.innerHeight+a(document).scrollTop(),i=window.innerWidth-2+a(document).scrollLeft(),j={deltaHeight:0,deltaWidth:0,offsetLeft:0,offsetTop:0};this.tooltip.removeAttr("style"),this.tooltip.find(".arrow").removeAttr("style"),this.settings.maxWidth&&this.tooltip.css("max-width",this.settings.maxWidth+"px"),this.scrollparent.length&&(j.offsetTop=this.scrollparent.scrollTop(),j.offsetLeft=this.scrollparent.scrollLeft(),j.deltaHeight=this.scrollparent.offset().top,j.deltaWidth=this.scrollparent.offset().left,h-=this.scrollparent.offset().top+j.offsetTop,i-=this.scrollparent.offset().left+j.offsetLeft);var k;switch(g.placement){case"offset":f.tooltip.addClass("bottom"),f.placeBelowOffset(j);break;case"bottom":f.placeBelow(j);var l=f.tooltip.offset().top-j.deltaHeight+f.tooltip.outerHeight();l>=h&&(f.tooltip.removeClass("bottom").addClass("top"),f.placeAbove(j));break;case"top":f.placeAbove(j),this.tooltip.offset().top-j.deltaHeight<=0&&(f.tooltip.removeClass("top").addClass("bottom"),f.placeBelow(j));break;case"right":Locale.isRTL()?(f.placeToLeft(j),this.tooltip.offset().left-j.deltaWidth<=0&&(f.tooltip.removeClass("right").addClass("left"),f.placeToRight(j))):(f.placeToRight(j),k=f.tooltip.offset().left-j.deltaWidth+f.tooltip.outerWidth(),k>=i&&(f.tooltip.removeClass("right").addClass("left"),f.placeToLeft(j)));break;default:Locale.isRTL()?(f.placeToRight(j),k=f.tooltip.offset().left-j.deltaWidth+f.tooltip.outerWidth(),k>=i&&(f.tooltip.removeClass("left").addClass("right"),f.placeToLeft(j))):(f.placeToLeft(j),this.tooltip.offset().left-j.deltaWidth<=0&&(f.tooltip.removeClass("left").addClass("right"),f.placeToRight(j)))}var m,n,o,p,q,r,s,t=f.activeElement;if(t.prev().is(".datepicker")){var u=t.prev();c()&&(n.removeAttr("style"),f.tooltip.removeClass("top bottom").addClass("right"),f.placeToRight(j),n.css("left","-12px"),b(),q=u.offset().left+u.outerWidth()+15,f.tooltip.css("left",q)),d()&&(n.removeAttr("style"),f.tooltip.removeClass("top bottom").addClass("left"),f.placeToLeft(j),n.css("left","auto"),b(),q=u.offset().left-f.tooltip.outerWidth()-15,f.tooltip.css("left",q)),e()&&(r=a("html"),s={offsetTop:0,paddingTop:0},(r.is(".is-firefox")||r.is(".is-safari")||r.is(".ie"))&&(s.offsetTop=8,s.paddingTop=8),(r.is(".ie11")||r.is(".ie9"))&&(s.offsetTop=13,s.paddingTop=15),q=j.deltaHeight-m.top-j.offsetTop-40,p=f.tooltip.outerHeight()/2-q-(t.outerHeight()/2+40),m.top+j.offsetTop-s.offsetTop<0&&(q-=j.deltaHeight-s.paddingTop,p+=t.outerHeight()/2),f.tooltip.css({top:q}),n.css("top",p))}else{if(/offset|bottom|top/i.test(g.placement)&&(c()&&(q=-1*(0-(m.left-j.deltaWidth)+1),f.tooltip.css("left",m.left+q),c()&&(f.tooltip.removeClass("top bottom").addClass("right"),f.placeToRight(j))),d())){var v,w=f.tooltip.outerWidth()-10;t=f.activeElement,f.tooltip.removeClass("top bottom").addClass(Locale.isRTL()?"right":"left"),f.tooltip.css("width",w),q=-1*(i-(m.left-j.deltaWidth+w+7)-1),v=t.offset().top-t.outerHeight()-f.tooltip.outerHeight()/2-3+j.offsetTop,f.tooltip.css({left:Locale.isRTL()?t.offset().left-f.tooltip.outerWidth()-7:m.left-q,top:v}),o=parseInt(n.css("left"),10),n.css("left",Locale.isRTL()?"auto":o+q),d()&&(n.removeAttr("style"),f.tooltip.removeClass("top bottom").addClass("left"),f.placeToLeft(j))}e()&&(r=a("html"),s={offsetTop:0,paddingTop:0},(r.is(".is-firefox")||r.is(".is-safari")||r.is(".ie"))&&(s.offsetTop=8,s.paddingTop=8),(r.is(".ie11")||r.is(".ie9"))&&(s.offsetTop=13,s.paddingTop=15),q=j.deltaHeight-m.top-j.offsetTop,p=f.tooltip.outerHeight()/2-q-t.outerHeight()/2,m.top+j.offsetTop-s.offsetTop<0&&(q-=j.deltaHeight-s.paddingTop,p+=t.outerHeight()/2),f.tooltip.css({top:q}),n.css("top",p))}},placeBelowOffset:function(a){var b=this.activeElement.offset(),c=!!this.activeElement.closest(".field-short").length,d=this.element.parent().find(".icon").length>1?-12:4,e=10,f=0;this.activeElement.is("input.dropdown")&&(e=-20,d=16),this.activeElement.is(".lookup")&&(d=-17),this.tooltip.find(".arrow").css("right",""),this.activeElement.is(".timepicker")&&this.activeElement.parent().is(":not(.field-short)")&&(d=Locale.isRTL()?25:-20),this.activeElement.is(".datepicker")&&this.activeElement.parent().is(":not(.field-short)")&&(d=-15),g.isError&&(d=this.tooltip.outerWidth()===parseInt(this.tooltip.css("max-width"),10)?7:c?Locale.isRTL()?-10:4:1,f=2,this.activeElement.is(".editor")&&(d=-5,f=this.activeElement.outerHeight()-22),this.activeElement.is("textarea")&&(f=this.activeElement.outerHeight()-22),this.activeElement.is(".dropdown")&&(this.tooltip.outerWidth()===parseInt(this.tooltip.css("max-width"),10)?(e=-20,d=10):(e=10,d=c?Locale.isRTL()?10:-10:Locale.isRTL()?10:-20)),this.activeElement.is(".spinbox")&&(d=Locale.isRTL()?-5:4),(this.activeElement.is(".datepicker")||this.activeElement.is(".timepicker"))&&(d=Locale.isRTL()?c?5:18:c?-9:-23),this.activeElement.is(".colorpicker")&&(d=11));var h=b.left+a.offsetLeft+g.offset.left+(this.activeElement.outerWidth()-this.tooltip.outerWidth())+d-a.deltaWidth;h=Locale.isRTL()?h-(this.activeElement.outerWidth()-this.tooltip.outerWidth()):h,this.tooltip.css({width:this.tooltip.width()+e,top:b.top+a.offsetTop+this.activeElement.outerHeight()+g.offset.top-a.deltaHeight-f,left:h})},placeBelow:function(a){var b=this.activeElement.offset();this.tooltip.css({top:b.top+a.offsetTop+this.activeElement.outerHeight()+g.offset.top-a.deltaHeight,left:b.left+a.offsetLeft+g.offset.left+this.activeElement.outerWidth()/2-this.tooltip.outerWidth()/2-a.deltaWidth})},placeAbove:function(a){var b=this.activeElement.offset();this.tooltip.css({top:b.top+a.offsetTop-g.offset.top-this.tooltip.outerHeight()-a.deltaHeight,left:b.left+a.offsetLeft+g.offset.left+this.activeElement.outerWidth()/2-this.tooltip.outerWidth()/2-a.deltaWidth})},placeToRight:function(a){var b=this.activeElement.offset(),c=this.isPopover?10:0;this.tooltip.removeAttr("style"),this.tooltip.css({top:b.top+a.offsetTop-this.tooltip.outerHeight()/2+this.activeElement.outerHeight()/2-a.deltaHeight,left:b.left+a.offsetLeft+c+g.offset.left+this.activeElement.outerWidth()+g.offset.top-a.deltaWidth})},placeToLeft:function(a){var b=this.activeElement.offset();this.tooltip.removeAttr("style"),this.tooltip.css({top:b.top+a.offsetTop-this.tooltip.outerHeight()/2+this.activeElement.outerHeight()/2-a.deltaHeight,left:b.left+a.offsetLeft+g.offset.left-(g.offset.top+this.tooltip.outerWidth())-a.deltaWidth})},close:function(){return this.hide()},hide:function(){if(!g.keepOpen){if(this.isInPopup)return void g.content.addClass("hidden");this.tooltip.addClass("is-hidden").css({left:"",top:""}),this.tooltip.off("click.tooltip"),0===a(".popover").not(".is-hidden").length&&(a(document).off("mouseup.tooltip keydown.tooltip"),a(window).off("resize.tooltip")),this.element.trigger("hide",[this.tooltip])}},updated:function(){return this.teardown().init()},teardown:function(){return this.description.remove(),this.descriptionId=void 0,this.element.removeAttr("aria-describedby").removeAttr("aria-haspopup"),this.tooltip.hasClass("is-hidden")||this.hide(),this.element.removeData(e),this.element.off("mouseenter.tooltip mouseleave.tooltip mousedown.tooltip click.tooltip focus.tooltip blur.tooltip"),this},destroy:function(){this.teardown(),a.removeData(this.element[0],e)}},this.each(function(){var f=a.data(this,e);!f||null!=f.settings.popover&&f.settings.popover===g.popover?(f=a.data(this,e,new d(this,g)),f.settings=g):("function"==typeof f[b]&&f[b](c),f.settings=a.extend(f.settings,b),"immediate"===g.trigger&&setTimeout(function(){f.show(g)},100))})},a.fn.popover=a.fn.tooltip,a.fn.tree=function(b){function c(b){this.element=a(b),this.init()}var d="tree",e={},f=a.extend({},e,b);return c.prototype={init:function(){this.settings=a.extend({},f),this.initTree(),this.handleKeys(),this.setupEvents(),this.loadData(this.settings.dataset),this.syncDataset(this.element),this.focusFirst()},initTree:function(){var b=this.element.find("a"),c=this;this.element.wrap('<div class="tree-container"></div>'),this.element.parent(".tree-container").prepend('<div class="selected-item-indicator"></div><div class="focused-item-indicator"></div>'),this.container=this.element.closest(".tree-container"),this.focusedIndicator=a(".focused-item-indicator",this.container),this.selectedIndicator=a(".selected-item-indicator",this.container),b.each(function(){var b=a(this);c.decorateNode(b)})},focusFirst:function(){this.element.find("a:first").attr("tabindex","0")},setFocus:function(a){a.focus()},decorateNode:function(b){var c,d=0;if(b.attr({role:"treeitem",tabindex:"-1","aria-selected":"false"}),b.hasClass("is-disabled")){b.attr("aria-disabled","true");var e=b.next();e.is("ul.is-open")&&(a("a",e).addClass("is-disabled").attr("aria-disabled","true"),a("ul",b.parent()).addClass("is-disabled"))}d=b.parentsUntil(this.element,"ul").length-1,b.attr("aria-level",d+1);var f=b.parent().index();b.attr("aria-posinset",f+1);var g=b.closest("li").siblings().addBack().length;b.attr("aria-setsize",g),b.next("ul").children().length>0&&b.attr("aria-expanded",b.next().hasClass("is-open")?"true":"false"),c=b.next();var h=b.text();b.text(""),0===b.children("svg").length&&b.prepend(a.createIcon({icon:"tree-node",classes:["icon-tree"]})),b.append('<span class="tree-text">'+h+"</span>"),b.is('[class^="icon"]')&&this.setTreeIcon(b.find("svg"),b.attr("class")),c.is("ul")&&(c.attr("role","group").parent().addClass("folder"),this.setTreeIcon(b.find("svg"),c.hasClass("is-open")?"open-folder":"closed-folder"),b.is('[class^="icon"]')&&this.setTreeIcon(b.find("svg"),c.hasClass("is-open")?b.attr("class"):b.attr("class").replace("open","closed"))),b.addClass("hide-focus"),b.hideFocus()},setTreeIcon:function(a,b){var c=b.replace("icon-",""),d="icons.svg";c.match("jpg|mp3|gif|msg|pdf|png|ppt|prj|psd|pub|rar|tif|vis|xls")&&(d="icons-extended.svg");var e=this,f=setInterval(function(){e.loading||clearInterval(f),a.changeIcon(c,d)},10)},expandAll:function(b){var c=this;b=b||this.element.find("ul[role=group]"),b.each(function(){var b=a(this);b.addClass("is-open"),c.setTreeIcon(b.prev("a").find("svg"),"open-folder"),b.prev("a").is('[class^="icon"]')&&c.setTreeIcon(b.prev("svg"),b.prev("a").attr("class"))})},collapseAll:function(){var b=this.element.find("ul[role=group]"),c=this;b.each(function(){var b=a(this);b.removeClass("is-open"),c.setTreeIcon(b.prev("a").find("svg"),"closed-folder"),b.prev("a").is('[class^="icon"]')&&c.setTreeIcon(b.prev("a").find("svg"),b.prev("a").attr("class").replace("open","closed").replace(" hide-focus","")),b.prev("a").is('[class^="icon"]')&&c.setTreeIcon(b.prev("svg"),b.prev("a").attr("class").replace("open","closed"))})},isjQuery:function(a){return a&&(a instanceof jQuery||a.constructor.prototype.jquery)},selectNodeById:function(a){this.selectNodeByJquerySelectior("#"+a)},selectNodeByJquerySelectior:function(b){var c=this.isjQuery(b)?b:a(b);if(c.length&&!c.is(".is-disabled")){var d=c.parentsUntil(this.element,"ul[role=group]");this.expandAll(d),this.setSelectedNode(c,!0)}},markNodeSelectedById:function(a,b){b=b||this.settings.dataset;for(var c in b){var d=b[c];if(delete d.selected,d.id===a)return void(d.selected=!0);d.children&&this.markNodeSelectedById(a,d.children)}},setSelectedNode:function(a,b){if(0!==a.length){a.attr({tabindex:"0","aria-selected":"true"}).parent().addClass("is-selected"),this.element.find("a").not(a).attr({tabindex:"-1","aria-selected":"false"}).parent().removeClass("is-selected"),this.markNodeSelectedById(a.attr("id")),b&&a.focus();var c=a.data("jsonData")?a.data("jsonData"):[],d=this.getAbsoluteOffset(a[0],this.container[0]).top;this.selectedIndicator.length&&this.selectedIndicator.css({top:d}),this.element.trigger("selected",{node:a,data:c})}},getAbsoluteOffset:function(a,b){for(var c=0,d=0;a&&a!==b&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,d+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{top:d,left:c}},toggleNode:function(a){var b=a.next(),c=this;if(b.is('ul[role="group"]'))if(b.hasClass("is-open"))c.setTreeIcon(a.closest(".folder").removeClass("is-open").end().find("svg"),"closed-folder"),a.closest(".folder a").is('[class^="icon"]')&&c.setTreeIcon(a.closest(".folder a").find("svg"),a.closest(".folder a").attr("class").replace("open","closed").replace(" hide-focus","")),c.isAnimating=!0,a.find(".is-selected").removeClass("is-selected"),this.element.parent().find(".selected-item-indicator").css("top",""),b.one("animateclosedcomplete",function(){b.removeClass("is-open"),c.isAnimating=!1}).animateClosed(),a.attr("aria-expanded","true"!==a.attr("aria-expanded"));else{var d=a.data("jsonData");if(c.settings.source&&d.children&&0===d.children.length){var e=function(e){var f=d.id,g=c.findById(f);g.children=e,c.addChildNodes(g,a.parent()),a.removeClass("is-loading"),c.openNode(b,a),d.children=e,a.data("jsonData",d)},f={node:a,data:a.data("jsonData")};return c.settings.source(f,e),void a.addClass("is-loading")}c.openNode(b,a)}},openNode:function(a,b){var c=this;c.setTreeIcon(b.closest(".folder").addClass("is-open").end().find("svg"),"open-folder"),b.is('[class^="icon"]')&&c.setTreeIcon(b.find("svg"),b.attr("class").replace(" hide-focus","")),c.isAnimating=!0,a.one("animateopencomplete",function(){c.isAnimating=!1}).addClass("is-open").css("height",0).animateOpen(),b.attr("aria-expanded","true"!==b.attr("aria-expanded"))},setupEvents:function(){var a=this;a.element.on("updated.tree",function(){a.initTree()})},handleKeys:function(){var b=this;this.element.on("click.tree","a",function(c){var d=a(this);return d.is(".is-disabled, .is-loading")||(b.setSelectedNode(d,!0),b.toggleNode(d),c.stopPropagation()),!1}),this.element.on("focus.tree","a",function(){var b=a(this);if(0===parseInt(b.attr("aria-level"))&&1===parseInt(b.attr("aria-posinset"))&&b.hasClass("is-disabled")){var c=a.Event("keydown.tree");return c.keyCode=40,void b.trigger(c)}}).on("blur.tree","a",function(){b.focusedIndicator.length&&b.focusedIndicator.css({top:""})}),this.element.on("keydown.tree","a",function(c){var d,e,f=c.charCode||c.keyCode,g=a(this);if(!b.isAnimating){if(40===f&&(d=g.parent().next().find("a:first"),g.next().is("ul")&&g.next().hasClass("is-open")&&(d=g.next().find("a:first")),d.hasClass("is-disabled")&&(d=d.parent().next().find("a:first")),0===d.length&&(d=g.closest(".folder").next().find("a:first")),b.setFocus(d)),38===f&&(e=g.parent().prev().find("a:first"),e.parent().is(".folder.is-open")&&e.parent().find("ul.is-open").length&&!e.parent().find("ul.is-disabled").length&&(e=e.parent().find("ul.is-open a:last")),e.hasClass("is-disabled")&&(e=e.parent().prev().find("a:first")),0===e.length&&(e=g.closest("ul").prev("a")),b.setFocus(e)),32===c.keyCode&&g.trigger("click.tree"),37===f)return Locale.isRTL()?g.next().hasClass("is-open")?(d=g.next().find("a:first"),b.setFocus(d)):b.toggleNode(g):g.next().hasClass("is-open")?b.toggleNode(g):(d=g.closest(".folder").find("a:first"),b.setFocus(d)),c.stopPropagation(),!1;if(39===f)return Locale.isRTL()?g.next().hasClass("is-open")?b.toggleNode(g):(d=g.closest(".folder").find("a:first"),b.setFocus(d)):g.next().hasClass("is-open")?(d=g.next().find("a:first"),b.setFocus(d)):(b.toggleNode(g),b.setFocus(g)),c.stopPropagation(),!1;36===f&&(d=b.element.find("a:first:visible"),b.setFocus(d)),35===f&&(d=b.element.find("a:last:visible"),b.setFocus(d))}}),this.element.on("keypress.tree","a",function(c){var d=c.charCode||c.keyCode,e=a(this);return d>=37&&40>=d||32===d?(c.stopPropagation(),!1):void(0!==c.which&&e.closest("li").nextAll().find("a:visible").each(function(){var d=a(this),e=d.text().substr(0,1).toLowerCase(),f=String.fromCharCode(c.which).toLowerCase();return e===f?(b.setFocus(d),!1):void 0}))})},loadData:function(a){var b=this;if(a){b.element.empty(),b.loading=!0;for(var c=0;c<a.length;c++)b.addNode(a[c],"bottom");b.loading=!1,b.syncDataset(b.element)}},addToDataset:function(a,b){var c;return a.parent&&(c=this.findById(a.parent)),"bottom"!==b||a.parent||c||this.settings.dataset.push(a),"top"!==b||a.parent||c||this.settings.dataset.unshift(a),a.parent&&c&&(c.children||(c.children=[]),"bottom"===b?c.children.push(a):c.children.unshift(a)),a.parent&&!c?!1:!0},findById:function(a,b){var c,d=this;b||(b=this.settings.dataset);for(c in b){var e=b[c];if(e.id===a)return e;if(e.children){var f=d.findById(a,e.children);if(f)return f}}return null},getNodeByIdIfSelected:function(a,b){var c=this.findById(a,b);return c&&c.selected?c:null},getSelectedNodes:function(b){var c,d=this,e=[];return a("a",d.element).each(function(){this.id&&(c=d.getNodeByIdIfSelected(this.id,b),c&&e.push(c))}),e},syncDataset:function(b){var c=[],d=this;b.children("li").each(function(){var b=a(this),e=b.find("a:first"),f=d.syncNode(e);c.push(f)}),this.settings.dataset=c},syncNode:function(b){var c={},d=this;c={node:b,id:b.attr("id"),text:b.find(".tree-text").text()},b.hasClass("is-open")&&(c.open=!0),b.attr("href")&&(c.href=b.attr("href")),b.parent().is(".is-selected")&&(c.selected=!0);var e=b.attr("class");if(e&&e.indexOf("icon")>-1&&(c.icon=b.attr("class")),b.next().is("ul")){var f=b.next();c.children=[],f.children("li").each(function(){var b=a(this),e=b.find("a:first");c.children.push(d.syncNode(e))})}return c},addNode:function(b,c){var d=a("<li></li>"),e=a('<a href="#"></a>').appendTo(d);c=c?c:"bottom",e.attr({id:b.id,href:b.href}).text(b.text),b.open&&e.parent().addClass("is-open"),b.disabled&&e.addClass("is-disabled"),b.icon&&e.addClass(b.icon);var f=this.loading?!0:this.addToDataset(b,c);return b.parent instanceof jQuery&&(f=!0),!(c instanceof jQuery)||b.parent&&f||b.parent instanceof jQuery||(c.append(d),f=!0),"bottom"!==c||b.parent&&f||this.element.append(d),"top"!==c||b.parent&&f||this.element.prepend(d),b.parent?(f&&"string"==typeof b.parent&&(d=this.element.find("#"+b.parent).parent(),this.addAsChild(b,d)),b.parent&&b.parent instanceof jQuery&&(d=b.parent,b.parent.is("a")&&(d=b.parent.parent()),this.addAsChild(b,d)),b.node=d.find("ul li a#"+b.id)):(this.addChildNodes(b,d),b.node=d.children("a").first()),this.decorateNode(e),b.selected&&this.setSelectedNode(e,b.focus),e.data("jsonData",b),d},addAsChild:function(b,c){var d=c.find("ul").first();0===d.length&&(d=a("<ul></ul>").appendTo(c),d.addClass("folder")),d.addClass(b.open?"is-open":""),this.decorateNode(c.find("a").first()),b.parent="",this.addNode(b,d)},addChildNodes:function(b,c){var d=this,e=c.find("ul");if(!b.children)return void e.remove();if(0===e.length&&(e=a("<ul></ul>").appendTo(c),e.addClass(b.open?"is-open":""),e.addClass("folder")),e.empty(),b.children)for(var f=0;f<b.children.length;f++){var g=b.children[f];d.addNode(g,e)}},updateNode:function(a){var b=this.findById(a.id);a.node&&(b={},b.node=a.node),b&&(a.text&&(b.node.find(".tree-text").first().text(a.text),b.text=a.text),a.icon&&(this.setTreeIcon(b.node.find("svg").first(),a.icon),b.icon=a.icon),a.disabled&&(b.node.addClass("is-disabled"),b.node.attr("aria-disabled","true")),a.node&&this.syncDataset(this.element),a.children&&(a.children.length?this.addChildNodes(a,b.node.parent()):this.removeChildren(a,b.node.parent())))},removeChildren:function(a,b){var c=b.find("ul");this.setTreeIcon(b.find("svg").first(),a.icon||"icon-tree-node"),b.removeClass("folder is-open"),c.remove()},removeNode:function(a){var b=this.findById(a.id);a instanceof jQuery?(b=a,b.parent().remove()):b&&b.node.parent().remove(),b&&this.syncDataset(this.element)},destroy:function(){this.element.removeData(d),this.element.off("updated.tree click.tree focus.tree keydown.tree keypress.tree").empty()}},this.each(function(){var g=a.data(this,d);g?g.settings=a.extend({},e,b):g=a.data(this,d,new c(this,f))})},B.prototype={init:function(){this.fields="input, textarea, select, div[data-validate], div[data-validation]",this.isPlaceholderSupport=!!("placeholder"in document.createElement("input")),this.inputs=this.element.find(this.fields),this.element.is(this.fields)&&(this.inputs=a().add(this.element)),this.timeout=null},extractEvents:function(a){if(a.indexOf("{")>-1&&(a=JSON.parse(a.replace(/'/g,'"'))),"object"==typeof a){var b="";for(var c in a)-1===b.indexOf(a[c])&&(b+=a[c]+" ");b=b.split(" ").join(".validate "),a=b}return a},filterValidations:function(a,b){var c=[];if(!a)return[];if(a.indexOf("{")>-1&&(a=JSON.parse(a.replace(/'/g,'"'))),"object"==typeof a)for(var d in a)b&&a[d].indexOf(b)>-1&&c.push(d);return c},attachEvents:function(){var b=this,c="[data-validate],[data-validation]",d=null;a(document).on("mousedown.validate",function(b){d=a(b.target)}),a(document).on("mouseup.validate",function(){d=null}),this.inputs.each(function(){var b=a(this),c=b.attr("data-validate")||b.attr("data-validation");c&&c.indexOf("required")>-1&&b.addClass("required")}),this.inputs.filter("input, textarea, div").filter(c).not("input[type=checkbox]").each(function(){var c=a(this),d=c.attr("data-validation-events"),e=d?d:"blur.validate change.validate keyup.validate";e=b.extractEvents(e),c.on(e,function(c){if("keyup"!==c.type||9!==c.keyCode){var d=a(this);setTimeout(function(){"true"!==d.attr("data-disable-validation")&&!d.hasClass("disable-validation")&&"is-hidden"!==d.css("visibility")&&d.is(":visible")&&(!d.closest(".modal-engaged").length||d.closest(".modal-body").length)&&b.validate(d,!0,c)},300)}})}),this.inputs.filter("input[type=checkbox]").filter(c).on("click.validate",function(c){b.validate(a(this),!0,c)});var e=this.inputs.filter("select").filter(c);if(e.length&&(e.on("change.validate",function(c){b.validate(a(this),!0,c)}).on("listopened.validate",function(){var b=a(this),c=b.data("tooltip");c&&document.activeElement===b.data("dropdown").searchInput[0]&&c.hide()}).on("listclosed.validate",function(){var b=a(this),c=b.data("tooltip");c&&document.activeElement!==b.data("dropdown").searchInput[0]&&c.show()}),e.filter(function(){return void 0!==a(this).data("dropdown")}).data("dropdown").pseudoElem.on("blur.validate",function(c){var d=a(this).closest(".field").find("select");b.validate(d,!0,c)})),this.element.is("form")){var f=function(a){a.stopPropagation(),a.preventDefault(),b.validateForm(function(a){b.element.off("submit.validate"),b.element.trigger("validated",a),b.element.data("isValid",a),b.element.on("submit.validate",f)})};this.element.on("submit.validate",f)}},validateForm:function(b){var c=this,d=[];c.inputs=this.element.find(c.fields),c.inputs.each(function(b){var e=a(this);if(e.attr("data-validate")){if("true"===e.attr("data-disable-validation")||e.hasClass("disable-validation"))return!0;for(var f=c.validate(e,!1,b),g=0;g<f.length;g++)d.push(f[g])}}),a.when.apply(a,d).then(function(){b(!0)},function(){b(!1)})},value:function(a){return a.is("input[type=checkbox]")?a.prop("checked"):a.is("div")?a[0].innerHTML:a.val()},getTypes:function(a,b){var c,d=this.filterValidations(a.attr("data-validation-events"),b.type);return a.is("input.dropdown")&&a.prev().prev("select").attr("data-validate")&&(c=a.prev().prev("select").attr("data-validate").split(" ")),a.is("input.dropdown")&&a.prev().prev("select").attr("data-validation")&&(c=a.prev().prev("select").attr("data-validation").split(" ")),a.attr("data-validation")&&(c=a.attr("data-validation").split(" ")),a.attr("data-validate")&&(c=a.attr("data-validate").split(" ")),d.length>0&&(c=c.filter(function(a){return-1!==d.indexOf(a)})),"keyup"===b.type&&(c=c.filter(function(a){return"date"!==a&&"time"!==a})),c},setErrorOnParent:function(b){var c,d,e,f,g=a.createIcon({classes:["icon-error"],icon:"error"}),h=b.closest(".tab-panel, .expandable-pane"),i=b.closest(".tab-container, .expandable-area"),j=h.attr("id");if(i.is(".tab-container"))c=a('.tab-list a[href="#'+j+'"]',i).closest(".tab"),c.length?a(".count",c).length&&(c=a(".count",c)):(j=a('a[href="#'+j+'"]',".popupmenu").closest(".popupmenu").attr("id"),c=a('.tab-list .tab[aria-controls="'+j+'"]',i),d=j);else{if(!i.is(".expandable-area"))return;

c=a('.expandable-header[aria-controls="'+j+'"] .title',i)}d&&d.length&&(e=h.add(a(a(d).attr("href"))),a('a[role="menuitem"]',"#"+d).each(function(){e=e.add(a(a(this).attr("href")))})),f=a('a[href="#'+h.attr("id")+'"]',"#"+j),h&&a(".error",h).length||e&&a(".error",e).length?(a(".error",h).length||(f.removeClass("is-error"),a(".icon-error",f).remove()),a(".error",h).length&&a(".error",e).length&&!a(".icon-error",f).length&&f.addClass("is-error").append(g),a(".icon-error",c).length||c.addClass("is-error").append(g)):(c=c.add(f),c.removeClass("is-error"),a(".icon-error",c).remove())},validate:function(b,c,d){var e,f,g,h=this,i=h.getTypes(b,d),j=[],k=[],l=h.value(b),m=b.attr("placeholder"),n=function(a,c){if(e.positive===!1&&h.removePositive(b),a)0===k.length&&(h.removeError(b),f.resolve(),e.positive&&(h.addError(b,e.message,e.inline,c),h.removeError(b),f.resolve(),h.addPositive(b)));else{if(!h.isPlaceholderSupport&&l===m&&e.message!==Locale.translate("Required"))return;h.addError(b,e.message,"tooltip"===b.attr("data-error-type")?!1:!0,c),k.push(e.msg),f.reject()}h.setErrorOnParent(b)};for(h.removeError(b),b.removeData("data-errormessage"),g=0;g<i.length;g++)e=a.fn.validation.rules[i[g]],f=a.Deferred(),e&&(e.async?e.check(l,b,n):n(e.check(l,b),c),j.push(f));return j},getField:function(a){return a.is("select")&&void 0!==a.data("dropdown")&&(a=a.data("dropdown").pseudoElem),a},hasError:function(a){return this.getField(a).hasClass("error")},addError:function(b,c,d,e){var f=this.getField(b).addClass("error"),g=(f.data("data-errormessage")?f.data("data-errormessage")+"<br>":"")+c;return f.data("data-errormessage",g),void 0!==a.fn.toast&&a("body").toast({title:Locale.translate("Error"),audibleOnly:!0,message:g}),d?void this.showInlineError(f,c):void this.showTooltipError(b,c,e)},showErrorIcon:function(b){var c=this.getField(b).addClass("error"),d=a.createIconElement({classes:["icon-error"],icon:"error"});0===c.parent(".field, .field-short").find("svg.icon-error").length&&(b.parent().is(".editor-container")&&b.parent().addClass("is-error"),1===b.parent(":not(.editor-container)").find(".btn-actions").length?b.parent().find(".btn-actions").before(d):1===b.parent().find(".data-description").length?b.parent().find(".data-description").before(d):1===b.parent().find(".field-info").length?b.parent().find(".field-info").before(d):b.is("textarea")?b.after(d):b.is(".dropdown, .multiselect")?b.parent().find(".dropdown-wrapper").append(d):b.parent().append(b.is(".spinbox")?d:b.is(".lookup")?d:d),a(".icon-confirm",c.parent(".field, .field-short")).remove())},showTooltipError:function(a,b,c){if(this.showErrorIcon(a),a.is(".dropdown, .multiselect")&&void 0!==a.data("dropdown")){var d=a.data("dropdown").pseudoElem;d.addClass("error")}a.data("tooltip")?a.data("tooltip").content=b:a.tooltip({content:b,placement:"offset",trigger:"focus",isError:!0,tooltipElement:"#validation-tooltip"}),a.on("focus.validate",function(){a.data("tooltip").show()}).on("blur.validate",function(){a.data("tooltip")&&a.data("tooltip").hide()}),c&&a.data("tooltip").show()},showInlineError:function(b,c){var d=this.getField(b).addClass("error"),e='<div class="error-message">'+a.createIcon({classes:["icon-error"],icon:"error"})+'<pre class="audible">'+Locale.translate("Error")+'</pre><p class="message-text">'+c+"</p></div>";d.closest(".field, .field-short").find(".formatter-toolbar").addClass("error"),d.closest(".field, .field-short").append(e)},addPositive:function(b){var c=a.createIcon({icon:"confirm",classes:"icon-confirm"});a(".icon-confirm",b.parent(".field, .field-short")).length||b.parent(".field, .field-short").append(c)},removeError:function(b){var c=this.getField(b);this.inputs.filter("input, textarea").off("focus.validate"),b.removeClass("error"),b.removeData("data-errormessage"),b.next(".icon-error").off("click.validate").remove(),(b.hasClass("dropdown")||b.hasClass("multiselect"))&&(b.next().next().removeClass("error"),b.parent().find(".dropdown-wrapper > .icon-error").off("click.validate").remove()),b.next().next(".icon-error").remove(),b.next(".inforCheckboxLabel").next(".icon-error").remove(),b.parent(".field, .field-short").find("span.error").remove(),b.parent().find(".icon-error").remove(),b.off("focus.validate focus.tooltip"),b.data("tooltip")&&b.data("tooltip").destroy(),"validation-tooltip"===b.attr("aria-describedby")&&(b.removeAttr("aria-describedby"),a("#validation-tooltip").remove()),c.attr("data-placeholder")&&(c.attr("placeholder",c.attr("data-placeholder")),c.removeAttr("data-placeholder")),b.is(".dropdown, .multiselect")&&b.data("dropdown").pseudoElem.removeClass("error").removeAttr("placeholder"),b.parent().is(".editor-container")&&b.parent().removeClass("is-error"),b.closest(".field, .field-short").find(".error-message").remove(),b.parent(".field, .field-short").find(".formatter-toolbar").removeClass("error")},removePositive:function(b){a(".icon-confirm",b.parent(".field, .field-short")).remove()}},a.fn.addError=function(b){var c={message:"",showTooltip:!1,inline:!0},d=a.extend({},c,b);return this.each(function(){var b=new B(this,d);b.addError(a(this),d.message,d.inline,d.showTooltip)})},a.fn.removeError=function(b){var c={message:""},d=a.extend({},c,b);return this.each(function(){var b=new B(this,d);b.removeError(a(this))})},a.fn.validate=function(b,c){var d="validate",e={inline:!0},f=a.extend({},e,b);return this.each(function(){var g=a.data(this,d);g?("function"==typeof g[b]&&g[b](c),g.settings=a.extend({},e,b)):(g=a.data(this,d,new B(this,f)),g.attachEvents())})};var V=function(){var b=this;this.rules={required:{isNotEmpty:function(b,c){var d=!!("placeholder"in document.createElement("input"));return d||!c||b!==c.attr("placeholder")&&b!==Locale.translate("Required")?"string"==typeof b?(b=a.trim(b.replace(/<\/?[^>]*>/g,"")),0===a.trim(b).length?!1:!0):b?!0:!1:!1},check:function(b,c){var d=this,e=!0;return c.closest(".modal").find("input.required, textarea.required, select.required").each(function(){d.isNotEmpty(a(this).val())||(e=!1)}),e?c.closest(".modal").find(".btn-modal-primary").not(".no-validation").removeAttr("disabled"):c.closest(".modal").find(".btn-modal-primary").not(".no-validation").attr("disabled","disabled"),this.message=Locale.translate("Required"),this.isNotEmpty(b,c)},message:"Required"},date:{check:function(a,b){this.message=Locale.translate("InvalidDate");var c=a.indexOf(":")>-1?Locale.calendar().dateFormat.datetime:Locale.calendar().dateFormat["short"];b&&b.data("datepicker")&&(c=b.data("datepicker").pattern);var d=Locale.parseDate(a,c,!0);return void 0===d&&""!==a?!1:!0},message:"Invalid Date"},availableDate:{check:function(a,c){this.message=Locale.translate("UnavailableDate");var d=!0;if(""!==a&&b.rules.date.check(a)){var e,f,g,h,i,j=new Date(a),k=c.data("datepicker").settings;if(k)for(h=new Date(k.disable.minDate).setHours(0,0,0,0),i=new Date(k.disable.maxDate).setHours(0,0,0,0),-1!==k.disable.dayOfWeek.indexOf(j.getDay())&&(d=!1),j=j.setHours(0,0,0,0),(h>=j||j>=i)&&(d=!1),k.disable.dates.length&&"string"==typeof k.disable.dates&&(k.disable.dates=[k.disable.dates]),f=0,g=k.disable.dates.length;g>f;f++)if(e=new Date(k.disable.dates[f]),j===e.setHours(0,0,0,0)){d=!1;break}d=d&&!k.disable.isEnable||!d&&k.disable.isEnable?!0:!1}return d},message:"Unavailable Date"},email:{check:function(a){this.message=Locale.translate("EmailValidation");var b=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return a.length?b.test(a):!0},message:"EmailValidation"},enableSubmit:{check:function(a,c){var d=c.closest(".signin").find('button[type="submit"]'),e=a.length&&(b.rules.email.check(a)||b.rules.passwordConfirm.check(a,c));return e?d.enable():d.disable(),!0},message:""},emailPositive:{check:function(c,d){return a.trim(c).length&&!d.is("[readonly]")?(b.rules.emailPositive.positive=!0,this.message=Locale.translate("EmailValidation"),b.rules.email.check(c,d)):(b.rules.emailPositive.positive=!1,!0)},message:"EmailValidation"},passwordReq:{check:function(a){this.message=Locale.translate("PasswordValidation");var b=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{10,}$/;return a.length?a.match(b):!0},message:"PasswordValidation"},passwordConfirm:{check:function(c,d){this.message=Locale.translate("PasswordConfirmValidation");var e=a('input[type="password"]:not('+d.attr("id")+")",d.closest(".signin")).eq(0).val(),f=c===e&&b.rules.passwordReq.check(e);return c.length?f:!0},message:"PasswordConfirmValidation"},time:{check:function(a,b){a=a.replace(/ /g,""),this.message=Locale.translate("InvalidTime");var c,d,e=b&&b.data("timepicker")?b.data("timepicker").settings:{},f=e&&e.timeFormat?e.timeFormat:Locale.calendar().timeFormat,g=(f.match("HH")||[]).length>0,h=g?24:12,i=a.indexOf(Locale.calendar().dateFormat.timeSeparator),j=0;if(""===a)return!0;if(j=parseInt(a.substring(0,i)),c=parseInt(a.substring(i+1,i+3)),j.toString().length<1||isNaN(j)||parseInt(j)<0||parseInt(j)>h)return!1;if(c.toString().length<1||isNaN(c)||parseInt(c)<0||parseInt(c)>59)return!1;if(!g){if(parseInt(j)<1)return!1;var k=new RegExp(Locale.calendar().dayPeriods[0],"i"),l=new RegExp(Locale.calendar().dayPeriods[1],"i");if(d=a.match(k)||a.match(l)||[],0===d.length)return!1}return!0},message:"Invalid Time"},test:{check:function(a){return"1"===a?!0:!1},message:"Value is not valid (test)."}}};a.fn.validation=new V,a.fn.isValid=function(){return a(this).data("isValid")?!0:!1},a.fn.resetForm=function(){var b=a(this).find("input, select, textarea");b.removeClass("error"),a(this).find(".error").removeClass("error"),a(this).find(".icon-error").remove(),a(this).find(".icon-confirm").remove(),a(this).find(".error-message").remove(),setTimeout(function(){a("#validation-errors").addClass("is-hidden")},300),b.data("isDirty",!1).removeClass("isDirty"),a(this).find(".isDirty").removeClass("isDirty"),a(this).is("form")&&a(this)[0].reset()},a.fn.wizard=function(b){"use strict";function c(b){this.settings=a.extend({},f),this.element=a(b),this.init()}var d="wizard",e={ticks:null},f=a.extend({},e,b);return c.prototype={init:function(){this.build().handleEvents()},build:function(){return this.header=this.element.find(".wizard-header"),this.header.length||(this.header=a('<div class="wizard-header"></div>').appendTo(this.element)),this.bar=this.element.find(".bar"),this.bar.length||(this.bar=a('<div class="bar"></div>').appendTo(this.header)),this.completedRange=this.element.find(".completed-range"),this.completedRange.length||(this.completedRange=a('<div class="completed-range"></div>').appendTo(this.bar)),this.buildTicks().updateRange(),this},handleEvents:function(){var b=this;return this.element.on("updated",function(){b.updated()}),this.ticks.onTouchClick("wizard").on("click.wizard",function(c){b.activate(c,a(this))}),this},buildTicks:function(){var b=this.settings.ticks,c=this;if(this.ticks=this.bar.children(".tick"),!this.ticks.length&&b){for(var d=0;d<b.length;d++){var e=a('<a ng-click="handleClick()" class="tick '+(b[d].state?b[d].state:"")+'" href="'+(b[d].href?b[d].href:"#")+'"><span class="label">'+b[d].label+"</span></a>");b[d].ngClick&&e.attr("ng-click",b[d].ngClick),c.bar.append(e)}this.ticks=this.bar.children(".tick")}return this.positionTicks(),a(".tick",c.element).each(function(){var b=a(this);b.hasClass("is-disabled")&&b.removeAttr("onclick ng-click")}),this.element.find(".wizard-header").css("opacity","1"),this},positionTicks:function(){function b(a){return 0===a?0:a===c-1?100:d*a}for(var c=this.ticks.length,d=100/(c-1),e=[],f=0;c>f;f++)e.push(b(f));this.ticks.each(function(b){var c=a(this),d=c.children(".label"),f=Locale.isRTL()?100-e[b]:e[b];c.css("left",f+"%"),d.length&&d.css("left","-"+(d.outerWidth()/2-c.outerWidth()/2)+"px"),c.is(".is-disabled")&&c.attr("tabindex","-1")})},updateRange:function(){var a=this.ticks.filter(".current").last(),b=100*parseFloat(a.css("left"))/parseFloat(a.parent().css("width"));return b=Locale.isRTL()?100-b:b,this.completedRange.css("width",b+"%"),this},updated:function(){return this.buildTicks().updateRange(),this},teardown:function(){return this.ticks.offTouchClick("wizard").off("click.wizard"),this.element.off("updated.wizard"),this.ticks.remove(),this},select:function(a,b){return this.activate(a,b)},activate:function(b,c){function d(){var d;return void 0===b||void 0!==b&&null!==b&&b.type&&b.target||c||(c=b),void 0===c?(d=a(b.target),d.is(".label")?d.parent():d):"number"==typeof c?e.ticks.eq(c):c}if(void 0===b&&!c)return this;var e=this;if(c=d(),b&&(c.is("[disabled], .is-disabled")||!c.is("a")))return b.preventDefault(),b.stopPropagation(),this;var f=this.element.triggerHandler("beforeactivate",[c]);if(f===!1)return this;var g=this.ticks.index(c);return this.ticks.removeClass("complete current").eq(g).addClass("current").prevAll(".tick").addClass("complete"),this.updateRange(),this.element.trigger("activated",[c]),setTimeout(function(){e.element.trigger("afteractivated",[c])},300),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var e=a.data(this,d);e?(e.settings=a.extend({},e.settings,b),e.updated()):e=a.data(this,d,new c(this,f))})},a.fn.zoom=function(b){"use strict";function c(b,c){this.settings=a.extend({},c),this.element=a(b),this.init()}var d="zoom",e=a.extend({},b);return c.prototype={init:function(){return this.build().handleEvents()},build:function(){return this.env={iOS:a("html").hasClass("ios"),iPhone:a("html").hasClass("iPhone"),iPad:a("html").hasClass("iPad"),iPod:a("html").hasClass("iPod")},this.viewport=this.element.find("meta[name=viewport]"),this.body=a("body"),this},handleEvents:function(){var a=this;return this.element.on("updated."+d,function(){a.updated()}).on("enable-zoom",function(){a.enableZoom()}).on("disable-zoom",function(){a.disableZoom()}),this.env.iOS?(this.body.on("touchstart.zoomdisabler","input, label",function(){a.noZoomTimeout||a.disableZoom()}).on("touchend.zoomdisabler","input, label",function(){a.noZoomTimeout&&(clearTimeout(a.noZoomTimeout),a.noZoomTimeout=null),a.noZoomTimeout=setTimeout(function(){a.noZoomTimeout=null,a.enableZoom()},600)}),this):this},enableZoom:function(){this.viewport.remove(),this.viewport=a('<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=1" />'),this.element.prepend(this.viewport)},disableZoom:function(){this.viewport.remove(),this.viewport=a('<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />'),this.element.prepend(this.viewport)},updated:function(){return this.teardown().init()},teardown:function(){return this.element.off("updated."+d+" enable-zoom disable-zoom"),this.body.off("touchstart.zoomdisabler touchend.zoomdisabler"),this},destroy:function(){this.teardown(),a.removeData(this.element[0],d)}},this.each(function(){var f=a.data(this,d);f?(f.settings=a.extend({},f.settings,b),f.updated()):f=a.data(this,d,new c(this,e))})}});
//# sourceMappingURL=sohoxi.map