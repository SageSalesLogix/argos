<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Views/RelatedContextWidget', ['exports', 'module', 'dojo/_base/declare', 'dojo/aspect', 'dojo/dom-construct', 'argos/RelatedViewManager', 'argos/_RelatedViewWidgetBase'], function (exports, module, _dojo_baseDeclare, _dojoAspect, _dojoDomConstruct, _argosRelatedViewManager, _argos_RelatedViewWidgetBase) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _declare = _interopRequireDefault(_dojo_baseDeclare);

  var _aspect = _interopRequireDefault(_dojoAspect);

  var _domConstruct = _interopRequireDefault(_dojoDomConstruct);

  var _RelatedViewManager = _interopRequireDefault(_argosRelatedViewManager);

  var _RelatedViewWidgetBase2 = _interopRequireDefault(_argos_RelatedViewWidgetBase);

  var __class = (0, _declare['default'])('crm.Views.RelatedContextWidget', [_RelatedViewWidgetBase2['default']], {

    cls: 'related-context-widget',
    contextCls: null,
    contextWrapperTemplate: new Simplate(['&lt;div class=&quot;context-snapshot {%: $$.contextCls %}&quot;&gt;&lt;/div&gt;']),
    onInit: function onInit() {
      var self = this;
      this.onLoad();
      if (this.owner) {
        _aspect['default'].after(this.owner, 'show', function after() {
          self.onRefreshView();
        });
      }
    },
    onLoad: function onLoad() {
      var snapShot = this.getContextSnapShot();
      if (snapShot) {
        this.processSnapShot(snapShot);
      }
    },
    getContextSnapShot: function getContextSnapShot() {
      var snapShot = undefined;
      if (this.owner &amp;&amp; this.owner.options &amp;&amp; this.owner.options.fromContext) {
        var ctx = this.owner.options.fromContext;
        snapShot = ctx.getContextSnapShot(this.owner.options);
      }
      return snapShot;
    },
    processSnapShot: function processSnapShot(snapShot) {
      if (this.containerNode &amp;&amp; snapShot) {
        var wrapper = _domConstruct['default'].toDom(this.contextWrapperTemplate.apply(this));
        _domConstruct['default'].place(snapShot, wrapper, 'last');
        _domConstruct['default'].place(wrapper, this.containerNode, 'last');
      }
    },
    onRefreshView: function onRefreshView() {
      if (this.containerNode) {
        var node = _domConstruct['default'].toDom('&lt;div&gt;&lt;/div&gt;');
        _domConstruct['default'].place(node, this.containerNode, 'only');
        this.onLoad();
      }
    }
  });
  var rvm = new _RelatedViewManager['default']();
  rvm.registerType('relatedContext', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9WaWV3cy9SZWxhdGVkQ29udGV4dFdpZGdldC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBTUEsTUFBTSxPQUFPLEdBQUcseUJBQVEsZ0NBQWdDLEVBQUUsb0NBQXdCLEVBQUU7O0FBRWxGLE9BQUcsRUFBRSx3QkFBd0I7QUFDN0IsY0FBVSxFQUFFLElBQUk7QUFDaEIsMEJBQXNCLEVBQUUsSUFBSSxRQUFRLENBQUMsQ0FDbkMsMkRBQTJELENBQzVELENBQUM7QUFDRixVQUFNLEVBQUUsU0FBUyxNQUFNLEdBQUc7QUFDeEIsVUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO0FBQ2xCLFVBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNkLFVBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtBQUNkLDJCQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxTQUFTLEtBQUssR0FBRztBQUNoRCxjQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7U0FDdEIsQ0FBQyxDQUFDO09BQ0o7S0FDRjtBQUNELFVBQU0sRUFBRSxTQUFTLE1BQU0sR0FBRztBQUN4QixVQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztBQUMzQyxVQUFJLFFBQVEsRUFBRTtBQUNaLFlBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7T0FDaEM7S0FDRjtBQUNELHNCQUFrQixFQUFFLFNBQVMsa0JBQWtCLEdBQUc7QUFDaEQsVUFBSSxRQUFRLFlBQUEsQ0FBQztBQUNiLFVBQUksQUFBQyxJQUFJLENBQUMsS0FBSyxJQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxBQUFDLElBQUssSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxBQUFDLEVBQUU7QUFDNUUsWUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQzNDLGdCQUFRLEdBQUcsR0FBRyxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7T0FDdkQ7QUFDRCxhQUFPLFFBQVEsQ0FBQztLQUNqQjtBQUNELG1CQUFlLEVBQUUsU0FBUyxlQUFlLENBQUMsUUFBUSxFQUFFO0FBQ2xELFVBQUksSUFBSSxDQUFDLGFBQWEsSUFBSSxRQUFRLEVBQUU7QUFDbEMsWUFBTSxPQUFPLEdBQUcseUJBQWEsS0FBSyxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUM1RSxpQ0FBYSxLQUFLLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztBQUM5QyxpQ0FBYSxLQUFLLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUM7T0FDekQ7S0FDRjtBQUNELGlCQUFhLEVBQUUsU0FBUyxhQUFhLEdBQUc7QUFDdEMsVUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO0FBQ3RCLFlBQU0sSUFBSSxHQUFHLHlCQUFhLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUMvQyxpQ0FBYSxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDckQsWUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO09BQ2Y7S0FDRjtHQUNGLENBQUMsQ0FBQztBQUNILE1BQU0sR0FBRyxHQUFHLG9DQUF3QixDQUFDO0FBQ3JDLEtBQUcsQ0FBQyxZQUFZLENBQUMsZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLENBQUM7bUJBQzdCLE9BQU8iLCJmaWxlIjoic3JjL1ZpZXdzL1JlbGF0ZWRDb250ZXh0V2lkZ2V0LmpzIiwic291cmNlUm9vdCI6InNyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWNsYXJlIGZyb20gJ2Rvam8vX2Jhc2UvZGVjbGFyZSc7XHJcbmltcG9ydCBhc3BlY3QgZnJvbSAnZG9qby9hc3BlY3QnO1xyXG5pbXBvcnQgZG9tQ29uc3RydWN0IGZyb20gJ2Rvam8vZG9tLWNvbnN0cnVjdCc7XHJcbmltcG9ydCBSZWxhdGVkVmlld01hbmFnZXIgZnJvbSAnYXJnb3MvUmVsYXRlZFZpZXdNYW5hZ2VyJztcclxuaW1wb3J0IF9SZWxhdGVkVmlld1dpZGdldEJhc2UgZnJvbSAnYXJnb3MvX1JlbGF0ZWRWaWV3V2lkZ2V0QmFzZSc7XHJcblxyXG5jb25zdCBfX2NsYXNzID0gZGVjbGFyZSgnY3JtLlZpZXdzLlJlbGF0ZWRDb250ZXh0V2lkZ2V0JywgW19SZWxhdGVkVmlld1dpZGdldEJhc2VdLCB7XHJcblxyXG4gIGNsczogJ3JlbGF0ZWQtY29udGV4dC13aWRnZXQnLFxyXG4gIGNvbnRleHRDbHM6IG51bGwsXHJcbiAgY29udGV4dFdyYXBwZXJUZW1wbGF0ZTogbmV3IFNpbXBsYXRlKFtcclxuICAgICc8ZGl2IGNsYXNzPVwiY29udGV4dC1zbmFwc2hvdCB7JTogJCQuY29udGV4dENscyAlfVwiPjwvZGl2PicsXHJcbiAgXSksXHJcbiAgb25Jbml0OiBmdW5jdGlvbiBvbkluaXQoKSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIHRoaXMub25Mb2FkKCk7XHJcbiAgICBpZiAodGhpcy5vd25lcikge1xyXG4gICAgICBhc3BlY3QuYWZ0ZXIodGhpcy5vd25lciwgJ3Nob3cnLCBmdW5jdGlvbiBhZnRlcigpIHtcclxuICAgICAgICBzZWxmLm9uUmVmcmVzaFZpZXcoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcclxuICAgIGNvbnN0IHNuYXBTaG90ID0gdGhpcy5nZXRDb250ZXh0U25hcFNob3QoKTtcclxuICAgIGlmIChzbmFwU2hvdCkge1xyXG4gICAgICB0aGlzLnByb2Nlc3NTbmFwU2hvdChzbmFwU2hvdCk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBnZXRDb250ZXh0U25hcFNob3Q6IGZ1bmN0aW9uIGdldENvbnRleHRTbmFwU2hvdCgpIHtcclxuICAgIGxldCBzbmFwU2hvdDtcclxuICAgIGlmICgodGhpcy5vd25lcikgJiYgKHRoaXMub3duZXIub3B0aW9ucykgJiYgKHRoaXMub3duZXIub3B0aW9ucy5mcm9tQ29udGV4dCkpIHtcclxuICAgICAgY29uc3QgY3R4ID0gdGhpcy5vd25lci5vcHRpb25zLmZyb21Db250ZXh0O1xyXG4gICAgICBzbmFwU2hvdCA9IGN0eC5nZXRDb250ZXh0U25hcFNob3QodGhpcy5vd25lci5vcHRpb25zKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzbmFwU2hvdDtcclxuICB9LFxyXG4gIHByb2Nlc3NTbmFwU2hvdDogZnVuY3Rpb24gcHJvY2Vzc1NuYXBTaG90KHNuYXBTaG90KSB7XHJcbiAgICBpZiAodGhpcy5jb250YWluZXJOb2RlICYmIHNuYXBTaG90KSB7XHJcbiAgICAgIGNvbnN0IHdyYXBwZXIgPSBkb21Db25zdHJ1Y3QudG9Eb20odGhpcy5jb250ZXh0V3JhcHBlclRlbXBsYXRlLmFwcGx5KHRoaXMpKTtcclxuICAgICAgZG9tQ29uc3RydWN0LnBsYWNlKHNuYXBTaG90LCB3cmFwcGVyLCAnbGFzdCcpO1xyXG4gICAgICBkb21Db25zdHJ1Y3QucGxhY2Uod3JhcHBlciwgdGhpcy5jb250YWluZXJOb2RlLCAnbGFzdCcpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgb25SZWZyZXNoVmlldzogZnVuY3Rpb24gb25SZWZyZXNoVmlldygpIHtcclxuICAgIGlmICh0aGlzLmNvbnRhaW5lck5vZGUpIHtcclxuICAgICAgY29uc3Qgbm9kZSA9IGRvbUNvbnN0cnVjdC50b0RvbSgnPGRpdj48L2Rpdj4nKTtcclxuICAgICAgZG9tQ29uc3RydWN0LnBsYWNlKG5vZGUsIHRoaXMuY29udGFpbmVyTm9kZSwgJ29ubHknKTtcclxuICAgICAgdGhpcy5vbkxvYWQoKTtcclxuICAgIH1cclxuICB9LFxyXG59KTtcclxuY29uc3QgcnZtID0gbmV3IFJlbGF0ZWRWaWV3TWFuYWdlcigpO1xyXG5ydm0ucmVnaXN0ZXJUeXBlKCdyZWxhdGVkQ29udGV4dCcsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
