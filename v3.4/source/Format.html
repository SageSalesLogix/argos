<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">define('crm/Format', ['exports', 'module', 'dojo/_base/lang', 'dojo/_base/array', 'dojo/string', 'dojo/number', './Template', 'argos/Format'], function (exports, module, _dojo_baseLang, _dojo_baseArray, _dojoString, _dojoNumber, _Template, _argosFormat) {
  function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { 'default': obj }; }

  var _lang = _interopRequireDefault(_dojo_baseLang);

  var _array = _interopRequireDefault(_dojo_baseArray);

  var _string = _interopRequireDefault(_dojoString);

  var _dojoNumber2 = _interopRequireDefault(_dojoNumber);

  var _template = _interopRequireDefault(_Template);

  var _format = _interopRequireDefault(_argosFormat);

<span id='crm-Format'>  /**
</span>   * @class crm.Format
   *
   * @extends argos.Format
   * @requires crm.Template
   *
   */
  var __class = _lang['default'].setObject('crm.Format', _lang['default'].mixin({}, _format['default'], {
<span id='crm-Format-property-addressCultureFormats'>    /**
</span>     * Address Culture Formats as defined by crm.Format.address
     * http://msdn.microsoft.com/en-us/library/cc195167.aspx
     */
    addressCultureFormats: {
      'en': 'a1|a2|a3|m, R p|C',
      'en-GB': 'a1|a2|a3|M|P|C',
      'fr': 'a1|a2|a3|p M|C',
      'de': 'a1|a2|a3|p m|C',
      'it': 'a1|a2|a3|p m Z|C',
      'ru': 'a1|a2|a3|p m|C'
    },
<span id='crm-Format-property-countryCultures'>    /**
</span>     * Country name to culture identification
     * http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx
     */
    countryCultures: {
      'USA': 'en',
      'United States': 'en',
      'United States of America': 'en',
      'US': 'en',
      'United Kingdom': 'en-GB',
      'UK': 'en-GB',
      'Britain': 'en-GB',
      'England': 'en-GB',
      'Russia': 'ru',
      'Россия': 'ru',
      'Italy': 'it',
      'Italia': 'it',
      'France': 'fr',
      'Germany': 'de',
      'Deutschland': 'de'
    },
<span id='crm-Format-method-address'>    /**
</span>    Converts the given value using the provided format, joining with the separator character
    If no format given, will use predefined format for the addresses Country (or en-US as final fallback)
    &lt;pre&gt;
    Format    Description                                    Example
    ------    -----------------------------------------    -----------------------
     s         Salutation (Attention, Name)                ATTN: Mr. Bob
     S         Salutation Uppercase                        ATTN: MR. BOB
     a1        Address Line 1                              555 Oak Ave
     a2        Address Line 2                                #2038
     a3        Address Line 3
     m        Municipality (City, town, hamlet)            Phoenix
     M        Municipality Uppercase                        PHOENIX
     z        County (parish, providence)                    Maricopa
     Z         County Uppercase                            MARICOPA
     r        Region (State, area)                        AZ
     R        Region Uppercase                            AZ
     p         Postal Code (ZIP code)                        85021
     P         Postal Code Uppercase                        85021
     c         Country                                     France
     C         Country Uppercase                            FRANCE
       |        separator                                    as defined by separator variable
     &lt;/pre&gt;
     @param {object} o Address Entity containing all the SData properties
     @param {boolean} asText If set to true returns text only, if false returns anchor link to google maps
     @param {string|boolean} separator If false - separates with html &lt;br&gt;,
                          if true - separates with line return,
                          if defined as string - uses string to separate
     @param {string} fmt Address format to use, may also pass a culture string to use predefined format
     @return {string} Formatted address
    */
    address: function addressFormatter(o, asText, s, f) {
      function isEmpty(line) {
        var filterSymbols = _lang['default'].trim(line.replace(/,|\(|\)|\.|&gt;|-|&lt;|;|:|'|&quot;|\/|\?|\[|\]|{|}|_|=|\+|\\|\||!|@|#|\$|%|\^|&amp;|\*|`|~/g, ''));
        return filterSymbols === '';
      }

      var self = crm.Format;
      var fmt = f;
      var separator = s;

      if (!fmt) {
        var culture = self.resolveAddressCulture(o);
        fmt = self.addressCultureFormats[culture] || self.addressCultureFormats.en;
      }

      var lines = fmt.indexOf('|') === -1 ? [fmt] : fmt.split('|');
      lines = _array['default'].map(lines, function (line) {
        return self.replaceAddressPart(line, o);
      });

      var addressItems = [];

      var filtered = _array['default'].filter(lines, function (line) {
        return !isEmpty(line);
      });

      addressItems = _array['default'].map(filtered, function (line) {
        return self.encode(self.collapseSpace(line));
      });

      if (asText) {
        if (separator === true) {
          separator = '\n';
        }
        return addressItems.join(separator || '&lt;br /&gt;');
      }

      return _string['default'].substitute('&lt;a target=&quot;_blank&quot; href=&quot;http://maps.google.com/maps?q=${1}&quot;&gt;${0}&lt;/a&gt;', [addressItems.join('&lt;br /&gt;'), encodeURIComponent(self.decode(addressItems.join(' ')))]);
    },
    collapseSpace: function collapseSpace(text) {
      return _lang['default'].trim(text.replace(/\s+/g, ' '));
    },
    resolveAddressCulture: function resolveAddressCulture(o) {
      return crm.Format.countryCultures[o.Country] || Mobile.CultureInfo.name;
    },
    replaceAddressPart: function replaceAddressPart(fmt, o) {
      return fmt.replace(/s|S|a1|a2|a3|a4|m|M|z|Z|r|R|p|P|c|C/g, function replacePart(part) {
        switch (part) {// eslint-disable-line
          case 's':
            return o.Salutation || '';
          case 'S':
            return o.Salutation &amp;&amp; o.Salutation.toUpperCase() || '';
          case 'a1':
            return o.Address1 || '';
          case 'a2':
            return o.Address2 || '';
          case 'a3':
            return o.Address3 || '';
          case 'a4':
            return o.Address4 || '';
          case 'm':
            return o.City || '';
          case 'M':
            return o.City &amp;&amp; o.City.toUpperCase() || '';
          case 'z':
            return o.County || '';
          case 'Z':
            return o.County &amp;&amp; o.County.toUpperCase() || '';
          case 'r':
            return o.State || '';
          case 'R':
            return o.State &amp;&amp; o.State.toUpperCase() || '';
          case 'p':
            return o.PostalCode || '';
          case 'P':
            return o.PostalCode &amp;&amp; o.PostalCode.toUpperCase() || '';
          case 'c':
            return o.Country || '';
          case 'C':
            return o.Country &amp;&amp; o.Country.toUpperCase() || '';
        }
      });
    },
    // These were added to the SDK, and should not be here. Keeping the alias to not break anyone with a minor update.
    phoneFormat: _format['default'].phoneFormat,
    phone: _format['default'].phone,
    currency: function currency(_val) {
      var val = _val;
      if (isNaN(val) || val === null) {
        return val;
      }

      if (typeof val === 'string') {
        val = parseFloat(val);
      }

      var v = val.toFixed(2); // only 2 decimal places
      var f = Math.floor(parseFloat((100 * (v - Math.floor(v))).toPrecision(2))); // for fractional part, only need 2 significant digits

      return _string['default'].substitute('${0}' + Mobile.CultureInfo.numberFormat.currencyDecimalSeparator + '${1}', [Math.floor(v).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + Mobile.CultureInfo.numberFormat.currencyGroupSeparator.replace('\\.', '.')), f.toString().length &lt; 2 ? '0' + f.toString() : f.toString()]).replace(/ /g, ' '); // keep numbers from breaking
    },
    bigNumberAbbrText: {
      'billion': 'B',
      'million': 'M',
      'thousand': 'K'
    },
    bigNumber: function bigNumber(val) {
      var numParse = typeof val !== 'number' ? parseFloat(val) : val;
      var absVal = Math.abs(numParse);
      var text = crm.Format.bigNumberAbbrText;

      if (isNaN(numParse)) {
        return val;
      }

      var results = numParse.toString();
      if (absVal &gt;= 1000000000) {
        numParse = numParse / 1000000000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.billion;
      } else if (absVal &gt;= 1000000) {
        numParse = numParse / 1000000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.million;
      } else if (absVal &gt;= 1000) {
        numParse = numParse / 1000;
        results = _dojoNumber2['default'].format(numParse, {
          places: 1
        }) + text.thousand;
      } else {
        results = _dojoNumber2['default'].round(numParse, 2).toString();
      }

      return results;
    },
    relativeDate: function relativeDate(_date, timeless) {
      var date = moment(_date);
      if (!date || !date.isValid()) {
        throw new Error('Invalid date passed into crm.Format.relativeDate');
      }

      if (timeless) {
        // utc
        date = date.subtract({
          minutes: date.utcOffset()
        });
      }

      return date.fromNow();
    },
    multiCurrency: function multiCurrency(val, code) {
      return _string['default'].substitute('${0} ${1}', [crm.Format.currency(val), code]);
    },
    nameLF: function nameLF(val) {
      if (!val) {
        return '';
      }

      var name = _template['default'].nameLF.apply(val);
      return name;
    },
    mail: function mail(val) {
      if (typeof val !== 'string') {
        return val;
      }

      return _string['default'].substitute('&lt;a href=&quot;mailto:${0}&quot;&gt;${0}&lt;/a&gt;', [val]);
    },
    userActivityFormatText: {
      'asUnconfirmed': 'Unconfirmed',
      'asAccepted': 'Accepted',
      'asDeclned': 'Declined'
    },
    userActivityStatus: function userActivityStatus(val) {
      return crm.Format.userActivityFormatText[val];
    },
<span id='crm-Format-method-formatUserInitial'>    /**
</span>     * Takes a string input and converts name to First amd Last initials
     * `Lee Hogan` -&gt; `LH`
     * @param val
     * @returns {String}
     */
    formatUserInitial: function formatUserInitial(user) {
      var firstLast = this.resolveFirstLast(user);
      var initials = [firstLast[0].substr(0, 1)];

      if (firstLast[1]) {
        initials.push(firstLast[1].substr(0, 1));
      }

      return initials.join('').toUpperCase();
    },
<span id='crm-Format-method-formatByUser'>    /**
</span>     * Takes a string input and the user name to First amd Last name
     * `Hogan, Lee` -&gt; `Lee Hogan`
     * @param val
     * @returns {String}
     */
    formatByUser: function formatByUser(user) {
      var name = this.resolveFirstLast(user);
      return name.join(' ');
    },
<span id='crm-Format-method-resolveFirstLast'>    /**
</span>     * Takes a string input and the user name to First amd Last name
     * `Hogan, Lee` -&gt; `Lee Hogan`
     * @param val
     * @returns {String}
     */
    resolveFirstLast: function resolveFirstLast(name) {
      var firstLast = [];
      if (name.indexOf(' ') !== -1) {
        var names = name.split(' ');
        if (names[0].indexOf(',') !== -1) {
          firstLast = [names[1], names[0].slice(0, -1)];
        } else {
          firstLast = [names[0], names[1]];
        }
      } else {
        firstLast = [name];
      }
      return firstLast;
    },
    fixedLocale: function fixedLocale(_val, _d) {
      var val = _val;
      var d = _d;
      var p = undefined;
      var v = undefined;
      var f = undefined;
      var fVal = undefined;
      var num = undefined;

      if (isNaN(val) || val === null) {
        return val;
      }
      if (typeof val === 'string') {
        val = parseFloat(val);
      }
      if (typeof d !== 'number') {
        d = 2;
      }
      if (d &gt; 0) {
        p = Math.pow(10, d);
        v = val.toFixed(d); // only d decimal places
        f = Math.floor(parseFloat((p * (v - Math.floor(v))).toPrecision(d))); // for fractional part, only need d significant digits
        if (f === 0) {
          f = String(p).slice(1);
        }
      } else {
        // zero decimal palces
        p = Math.pow(10, 0);
        v = Math.round(val * p) / p;
        f = 0;
      }
      num = Math.floor(v).toString();
      num = num.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + Mobile.CultureInfo.numberFormat.numberGroupSeparator.replace('\\.', '.'));
      if (d &gt; 0) {
        var frac = f.toString().length &lt; d ? '' : f.toString();
        fVal = _string['default'].substitute('${0}' + Mobile.CultureInfo.numberFormat.numberDecimalSeparator + '${1}', [num, frac]);
      } else {
        fVal = num;
      }
      return fVal.replace(/ /g, ' '); // keep numbers from breaking
    }
  }));

  _lang['default'].setObject('Mobile.SalesLogix.Format', __class);
  module.exports = __class;
});
//# sourceMappingURL=data:application/json;base64,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QyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQy9CLFNBQUcsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLHlCQUF5QixFQUFFLElBQUksR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDOUgsVUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO0FBQ1QsWUFBTSxJQUFJLEdBQUcsQUFBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsTUFBTSxHQUFHLENBQUMsR0FBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQzNELFlBQUksR0FBRyxtQkFBTyxVQUFVLENBQ3RCLE1BQU0sR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxzQkFBc0IsR0FBRyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztPQUMxRixNQUFNO0FBQ0wsWUFBSSxHQUFHLEdBQUcsQ0FBQztPQUNaO0FBQ0QsYUFBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFRLENBQUMsQ0FBQztLQUNyQztHQUNGLENBQUMsQ0FBQyxDQUFDOztBQUVKLG1CQUFLLFNBQVMsQ0FBQywwQkFBMEIsRUFBRSxPQUFPLENBQUMsQ0FBQzttQkFDckMsT0FBTyIsImZpbGUiOiJzcmMvRm9ybWF0LmpzIiwic291cmNlUm9vdCI6InNyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBsYW5nIGZyb20gJ2Rvam8vX2Jhc2UvbGFuZyc7XHJcbmltcG9ydCBhcnJheSBmcm9tICdkb2pvL19iYXNlL2FycmF5JztcclxuaW1wb3J0IHN0cmluZyBmcm9tICdkb2pvL3N0cmluZyc7XHJcbmltcG9ydCBkb2pvTnVtYmVyIGZyb20gJ2Rvam8vbnVtYmVyJztcclxuaW1wb3J0IHRlbXBsYXRlIGZyb20gJy4vVGVtcGxhdGUnO1xyXG5pbXBvcnQgZm9ybWF0IGZyb20gJ2FyZ29zL0Zvcm1hdCc7XHJcblxyXG4vKipcclxuICogQGNsYXNzIGNybS5Gb3JtYXRcclxuICpcclxuICogQGV4dGVuZHMgYXJnb3MuRm9ybWF0XHJcbiAqIEByZXF1aXJlcyBjcm0uVGVtcGxhdGVcclxuICpcclxuICovXHJcbmNvbnN0IF9fY2xhc3MgPSBsYW5nLnNldE9iamVjdCgnY3JtLkZvcm1hdCcsIGxhbmcubWl4aW4oe30sIGZvcm1hdCwge1xyXG4gIC8qKlxyXG4gICAqIEFkZHJlc3MgQ3VsdHVyZSBGb3JtYXRzIGFzIGRlZmluZWQgYnkgY3JtLkZvcm1hdC5hZGRyZXNzXHJcbiAgICogaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2NjMTk1MTY3LmFzcHhcclxuICAgKi9cclxuICBhZGRyZXNzQ3VsdHVyZUZvcm1hdHM6IHtcclxuICAgICdlbic6ICdhMXxhMnxhM3xtLCBSIHB8QycsXHJcbiAgICAnZW4tR0InOiAnYTF8YTJ8YTN8TXxQfEMnLFxyXG4gICAgJ2ZyJzogJ2ExfGEyfGEzfHAgTXxDJyxcclxuICAgICdkZSc6ICdhMXxhMnxhM3xwIG18QycsXHJcbiAgICAnaXQnOiAnYTF8YTJ8YTN8cCBtIFp8QycsXHJcbiAgICAncnUnOiAnYTF8YTJ8YTN8cCBtfEMnLFxyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICogQ291bnRyeSBuYW1lIHRvIGN1bHR1cmUgaWRlbnRpZmljYXRpb25cclxuICAgKiBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2dvZ2xvYmFsL2JiODk2MDAxLmFzcHhcclxuICAgKi9cclxuICBjb3VudHJ5Q3VsdHVyZXM6IHtcclxuICAgICdVU0EnOiAnZW4nLFxyXG4gICAgJ1VuaXRlZCBTdGF0ZXMnOiAnZW4nLFxyXG4gICAgJ1VuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSc6ICdlbicsXHJcbiAgICAnVVMnOiAnZW4nLFxyXG4gICAgJ1VuaXRlZCBLaW5nZG9tJzogJ2VuLUdCJyxcclxuICAgICdVSyc6ICdlbi1HQicsXHJcbiAgICAnQnJpdGFpbic6ICdlbi1HQicsXHJcbiAgICAnRW5nbGFuZCc6ICdlbi1HQicsXHJcbiAgICAnUnVzc2lhJzogJ3J1JyxcclxuICAgICfQoNC+0YHRgdC40Y8nOiAncnUnLFxyXG4gICAgJ0l0YWx5JzogJ2l0JyxcclxuICAgICdJdGFsaWEnOiAnaXQnLFxyXG4gICAgJ0ZyYW5jZSc6ICdmcicsXHJcbiAgICAnR2VybWFueSc6ICdkZScsXHJcbiAgICAnRGV1dHNjaGxhbmQnOiAnZGUnLFxyXG4gIH0sXHJcbiAgLyoqXHJcbiAgQ29udmVydHMgdGhlIGdpdmVuIHZhbHVlIHVzaW5nIHRoZSBwcm92aWRlZCBmb3JtYXQsIGpvaW5pbmcgd2l0aCB0aGUgc2VwYXJhdG9yIGNoYXJhY3RlclxyXG4gIElmIG5vIGZvcm1hdCBnaXZlbiwgd2lsbCB1c2UgcHJlZGVmaW5lZCBmb3JtYXQgZm9yIHRoZSBhZGRyZXNzZXMgQ291bnRyeSAob3IgZW4tVVMgYXMgZmluYWwgZmFsbGJhY2spXHJcbiAgPHByZT5cclxuICBGb3JtYXQgICAgRGVzY3JpcHRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFeGFtcGxlXHJcbiAgLS0tLS0tICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgIHMgICAgICAgICBTYWx1dGF0aW9uIChBdHRlbnRpb24sIE5hbWUpICAgICAgICAgICAgICAgIEFUVE46IE1yLiBCb2JcclxuICAgUyAgICAgICAgIFNhbHV0YXRpb24gVXBwZXJjYXNlICAgICAgICAgICAgICAgICAgICAgICAgQVRUTjogTVIuIEJPQlxyXG4gICBhMSAgICAgICAgQWRkcmVzcyBMaW5lIDEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NTUgT2FrIEF2ZVxyXG4gICBhMiAgICAgICAgQWRkcmVzcyBMaW5lIDIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMyMDM4XHJcbiAgIGEzICAgICAgICBBZGRyZXNzIExpbmUgM1xyXG4gICBtICAgICAgICBNdW5pY2lwYWxpdHkgKENpdHksIHRvd24sIGhhbWxldCkgICAgICAgICAgICBQaG9lbml4XHJcbiAgIE0gICAgICAgIE11bmljaXBhbGl0eSBVcHBlcmNhc2UgICAgICAgICAgICAgICAgICAgICAgICBQSE9FTklYXHJcbiAgIHogICAgICAgIENvdW50eSAocGFyaXNoLCBwcm92aWRlbmNlKSAgICAgICAgICAgICAgICAgICAgTWFyaWNvcGFcclxuICAgWiAgICAgICAgIENvdW50eSBVcHBlcmNhc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUFSSUNPUEFcclxuICAgciAgICAgICAgUmVnaW9uIChTdGF0ZSwgYXJlYSkgICAgICAgICAgICAgICAgICAgICAgICBBWlxyXG4gICBSICAgICAgICBSZWdpb24gVXBwZXJjYXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFaXHJcbiAgIHAgICAgICAgICBQb3N0YWwgQ29kZSAoWklQIGNvZGUpICAgICAgICAgICAgICAgICAgICAgICAgODUwMjFcclxuICAgUCAgICAgICAgIFBvc3RhbCBDb2RlIFVwcGVyY2FzZSAgICAgICAgICAgICAgICAgICAgICAgIDg1MDIxXHJcbiAgIGMgICAgICAgICBDb3VudHJ5ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZyYW5jZVxyXG4gICBDICAgICAgICAgQ291bnRyeSBVcHBlcmNhc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJBTkNFXHJcblxyXG4gICB8ICAgICAgICBzZXBhcmF0b3IgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcyBkZWZpbmVkIGJ5IHNlcGFyYXRvciB2YXJpYWJsZVxyXG4gICA8L3ByZT5cclxuICAgQHBhcmFtIHtvYmplY3R9IG8gQWRkcmVzcyBFbnRpdHkgY29udGFpbmluZyBhbGwgdGhlIFNEYXRhIHByb3BlcnRpZXNcclxuICAgQHBhcmFtIHtib29sZWFufSBhc1RleHQgSWYgc2V0IHRvIHRydWUgcmV0dXJucyB0ZXh0IG9ubHksIGlmIGZhbHNlIHJldHVybnMgYW5jaG9yIGxpbmsgdG8gZ29vZ2xlIG1hcHNcclxuICAgQHBhcmFtIHtzdHJpbmd8Ym9vbGVhbn0gc2VwYXJhdG9yIElmIGZhbHNlIC0gc2VwYXJhdGVzIHdpdGggaHRtbCA8YnI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiB0cnVlIC0gc2VwYXJhdGVzIHdpdGggbGluZSByZXR1cm4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRlZmluZWQgYXMgc3RyaW5nIC0gdXNlcyBzdHJpbmcgdG8gc2VwYXJhdGVcclxuICAgQHBhcmFtIHtzdHJpbmd9IGZtdCBBZGRyZXNzIGZvcm1hdCB0byB1c2UsIG1heSBhbHNvIHBhc3MgYSBjdWx0dXJlIHN0cmluZyB0byB1c2UgcHJlZGVmaW5lZCBmb3JtYXRcclxuICAgQHJldHVybiB7c3RyaW5nfSBGb3JtYXR0ZWQgYWRkcmVzc1xyXG4gICovXHJcbiAgYWRkcmVzczogZnVuY3Rpb24gYWRkcmVzc0Zvcm1hdHRlcihvLCBhc1RleHQsIHMsIGYpIHtcclxuICAgIGZ1bmN0aW9uIGlzRW1wdHkobGluZSkge1xyXG4gICAgICBjb25zdCBmaWx0ZXJTeW1ib2xzID0gbGFuZy50cmltKGxpbmUucmVwbGFjZSgvLHxcXCh8XFwpfFxcLnw+fC18PHw7fDp8J3xcInxcXC98XFw/fFxcW3xcXF18e3x9fF98PXxcXCt8XFxcXHxcXHx8IXxAfCN8XFwkfCV8XFxefCZ8XFwqfGB8fi9nLCAnJykpO1xyXG4gICAgICByZXR1cm4gZmlsdGVyU3ltYm9scyA9PT0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2VsZiA9IGNybS5Gb3JtYXQ7XHJcbiAgICBsZXQgZm10ID0gZjtcclxuICAgIGxldCBzZXBhcmF0b3IgPSBzO1xyXG5cclxuICAgIGlmICghZm10KSB7XHJcbiAgICAgIGNvbnN0IGN1bHR1cmUgPSBzZWxmLnJlc29sdmVBZGRyZXNzQ3VsdHVyZShvKTtcclxuICAgICAgZm10ID0gc2VsZi5hZGRyZXNzQ3VsdHVyZUZvcm1hdHNbY3VsdHVyZV0gfHwgc2VsZi5hZGRyZXNzQ3VsdHVyZUZvcm1hdHMuZW47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGxpbmVzID0gKGZtdC5pbmRleE9mKCd8JykgPT09IC0xKSA/IFtmbXRdIDogZm10LnNwbGl0KCd8Jyk7XHJcbiAgICBsaW5lcyA9IGFycmF5Lm1hcChsaW5lcywgKGxpbmUpID0+IHtcclxuICAgICAgcmV0dXJuIHNlbGYucmVwbGFjZUFkZHJlc3NQYXJ0KGxpbmUsIG8pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGFkZHJlc3NJdGVtcyA9IFtdO1xyXG5cclxuICAgIGNvbnN0IGZpbHRlcmVkID0gYXJyYXkuZmlsdGVyKGxpbmVzLCAobGluZSkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlzRW1wdHkobGluZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhZGRyZXNzSXRlbXMgPSBhcnJheS5tYXAoZmlsdGVyZWQsIChsaW5lKSA9PiB7XHJcbiAgICAgIHJldHVybiBzZWxmLmVuY29kZShzZWxmLmNvbGxhcHNlU3BhY2UobGluZSkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGFzVGV4dCkge1xyXG4gICAgICBpZiAoc2VwYXJhdG9yID09PSB0cnVlKSB7XHJcbiAgICAgICAgc2VwYXJhdG9yID0gJ1xcbic7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGFkZHJlc3NJdGVtcy5qb2luKHNlcGFyYXRvciB8fCAnPGJyIC8+Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN0cmluZy5zdWJzdGl0dXRlKFxyXG4gICAgICAnPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwcz9xPSR7MX1cIj4kezB9PC9hPicsIFthZGRyZXNzSXRlbXMuam9pbignPGJyIC8+JyksIGVuY29kZVVSSUNvbXBvbmVudChzZWxmLmRlY29kZShhZGRyZXNzSXRlbXMuam9pbignICcpKSldXHJcbiAgICApO1xyXG4gIH0sXHJcbiAgY29sbGFwc2VTcGFjZTogZnVuY3Rpb24gY29sbGFwc2VTcGFjZSh0ZXh0KSB7XHJcbiAgICByZXR1cm4gbGFuZy50cmltKHRleHQucmVwbGFjZSgvXFxzKy9nLCAnICcpKTtcclxuICB9LFxyXG4gIHJlc29sdmVBZGRyZXNzQ3VsdHVyZTogZnVuY3Rpb24gcmVzb2x2ZUFkZHJlc3NDdWx0dXJlKG8pIHtcclxuICAgIHJldHVybiBjcm0uRm9ybWF0LmNvdW50cnlDdWx0dXJlc1tvLkNvdW50cnldIHx8IE1vYmlsZS5DdWx0dXJlSW5mby5uYW1lO1xyXG4gIH0sXHJcbiAgcmVwbGFjZUFkZHJlc3NQYXJ0OiBmdW5jdGlvbiByZXBsYWNlQWRkcmVzc1BhcnQoZm10LCBvKSB7XHJcbiAgICByZXR1cm4gZm10LnJlcGxhY2UoL3N8U3xhMXxhMnxhM3xhNHxtfE18enxafHJ8UnxwfFB8Y3xDL2csXHJcbiAgICAgIGZ1bmN0aW9uIHJlcGxhY2VQYXJ0KHBhcnQpIHtcclxuICAgICAgICBzd2l0Y2ggKHBhcnQpIHsvLyBlc2xpbnQtZGlzYWJsZS1saW5lXHJcbiAgICAgICAgICBjYXNlICdzJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uU2FsdXRhdGlvbiB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ1MnOlxyXG4gICAgICAgICAgICByZXR1cm4gKG8uU2FsdXRhdGlvbiAmJiBvLlNhbHV0YXRpb24udG9VcHBlckNhc2UoKSkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdhMSc6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkFkZHJlc3MxIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnYTInOlxyXG4gICAgICAgICAgICByZXR1cm4gby5BZGRyZXNzMiB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ2EzJzpcclxuICAgICAgICAgICAgcmV0dXJuIG8uQWRkcmVzczMgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdhNCc6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkFkZHJlc3M0IHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnbSc6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkNpdHkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdNJzpcclxuICAgICAgICAgICAgcmV0dXJuIChvLkNpdHkgJiYgby5DaXR5LnRvVXBwZXJDYXNlKCkpIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAneic6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkNvdW50eSB8fCAnJztcclxuICAgICAgICAgIGNhc2UgJ1onOlxyXG4gICAgICAgICAgICByZXR1cm4gKG8uQ291bnR5ICYmIG8uQ291bnR5LnRvVXBwZXJDYXNlKCkpIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAncic6XHJcbiAgICAgICAgICAgIHJldHVybiBvLlN0YXRlIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnUic6XHJcbiAgICAgICAgICAgIHJldHVybiAoby5TdGF0ZSAmJiBvLlN0YXRlLnRvVXBwZXJDYXNlKCkpIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAncCc6XHJcbiAgICAgICAgICAgIHJldHVybiBvLlBvc3RhbENvZGUgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdQJzpcclxuICAgICAgICAgICAgcmV0dXJuIChvLlBvc3RhbENvZGUgJiYgby5Qb3N0YWxDb2RlLnRvVXBwZXJDYXNlKCkpIHx8ICcnO1xyXG4gICAgICAgICAgY2FzZSAnYyc6XHJcbiAgICAgICAgICAgIHJldHVybiBvLkNvdW50cnkgfHwgJyc7XHJcbiAgICAgICAgICBjYXNlICdDJzpcclxuICAgICAgICAgICAgcmV0dXJuIChvLkNvdW50cnkgJiYgby5Db3VudHJ5LnRvVXBwZXJDYXNlKCkpIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9LFxyXG4gIC8vIFRoZXNlIHdlcmUgYWRkZWQgdG8gdGhlIFNESywgYW5kIHNob3VsZCBub3QgYmUgaGVyZS4gS2VlcGluZyB0aGUgYWxpYXMgdG8gbm90IGJyZWFrIGFueW9uZSB3aXRoIGEgbWlub3IgdXBkYXRlLlxyXG4gIHBob25lRm9ybWF0OiBmb3JtYXQucGhvbmVGb3JtYXQsXHJcbiAgcGhvbmU6IGZvcm1hdC5waG9uZSxcclxuICBjdXJyZW5jeTogZnVuY3Rpb24gY3VycmVuY3koX3ZhbCkge1xyXG4gICAgbGV0IHZhbCA9IF92YWw7XHJcbiAgICBpZiAoaXNOYU4odmFsKSB8fCB2YWwgPT09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIHZhbDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgdmFsID0gcGFyc2VGbG9hdCh2YWwpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHYgPSB2YWwudG9GaXhlZCgyKTsgLy8gb25seSAyIGRlY2ltYWwgcGxhY2VzXHJcbiAgICBjb25zdCBmID0gTWF0aC5mbG9vcihwYXJzZUZsb2F0KCgxMDAgKiAodiAtIE1hdGguZmxvb3IodikpKS50b1ByZWNpc2lvbigyKSkpOyAvLyBmb3IgZnJhY3Rpb25hbCBwYXJ0LCBvbmx5IG5lZWQgMiBzaWduaWZpY2FudCBkaWdpdHNcclxuXHJcbiAgICByZXR1cm4gc3RyaW5nLnN1YnN0aXR1dGUoXHJcbiAgICAgICckezB9JyArIE1vYmlsZS5DdWx0dXJlSW5mby5udW1iZXJGb3JtYXQuY3VycmVuY3lEZWNpbWFsU2VwYXJhdG9yICsgJyR7MX0nLCBbXHJcbiAgICAgICAgKE1hdGguZmxvb3IodikpLnRvU3RyaW5nKCkucmVwbGFjZSgvKFxcZCkoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCAnJDEnICsgTW9iaWxlLkN1bHR1cmVJbmZvLm51bWJlckZvcm1hdC5jdXJyZW5jeUdyb3VwU2VwYXJhdG9yLnJlcGxhY2UoJ1xcXFwuJywgJy4nKSksIChmLnRvU3RyaW5nKCkubGVuZ3RoIDwgMikgPyAnMCcgKyBmLnRvU3RyaW5nKCkgOiBmLnRvU3RyaW5nKCksXHJcbiAgICAgIF1cclxuICAgICkucmVwbGFjZSgvIC9nLCAnXFx1MDBBMCcpOyAvLyBrZWVwIG51bWJlcnMgZnJvbSBicmVha2luZ1xyXG4gIH0sXHJcbiAgYmlnTnVtYmVyQWJiclRleHQ6IHtcclxuICAgICdiaWxsaW9uJzogJ0InLFxyXG4gICAgJ21pbGxpb24nOiAnTScsXHJcbiAgICAndGhvdXNhbmQnOiAnSycsXHJcbiAgfSxcclxuICBiaWdOdW1iZXI6IGZ1bmN0aW9uIGJpZ051bWJlcih2YWwpIHtcclxuICAgIGxldCBudW1QYXJzZSA9IHR5cGVvZiB2YWwgIT09ICdudW1iZXInID8gcGFyc2VGbG9hdCh2YWwpIDogdmFsO1xyXG4gICAgY29uc3QgYWJzVmFsID0gTWF0aC5hYnMobnVtUGFyc2UpO1xyXG4gICAgY29uc3QgdGV4dCA9IGNybS5Gb3JtYXQuYmlnTnVtYmVyQWJiclRleHQ7XHJcblxyXG4gICAgaWYgKGlzTmFOKG51bVBhcnNlKSkge1xyXG4gICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCByZXN1bHRzID0gbnVtUGFyc2UudG9TdHJpbmcoKTtcclxuICAgIGlmIChhYnNWYWwgPj0gMTAwMDAwMDAwMCkge1xyXG4gICAgICBudW1QYXJzZSA9IG51bVBhcnNlIC8gMTAwMDAwMDAwMDtcclxuICAgICAgcmVzdWx0cyA9IGRvam9OdW1iZXIuZm9ybWF0KG51bVBhcnNlLCB7XHJcbiAgICAgICAgcGxhY2VzOiAxLFxyXG4gICAgICB9KSArIHRleHQuYmlsbGlvbjtcclxuICAgIH0gZWxzZSBpZiAoYWJzVmFsID49IDEwMDAwMDApIHtcclxuICAgICAgbnVtUGFyc2UgPSBudW1QYXJzZSAvIDEwMDAwMDA7XHJcbiAgICAgIHJlc3VsdHMgPSBkb2pvTnVtYmVyLmZvcm1hdChudW1QYXJzZSwge1xyXG4gICAgICAgIHBsYWNlczogMSxcclxuICAgICAgfSkgKyB0ZXh0Lm1pbGxpb247XHJcbiAgICB9IGVsc2UgaWYgKGFic1ZhbCA+PSAxMDAwKSB7XHJcbiAgICAgIG51bVBhcnNlID0gbnVtUGFyc2UgLyAxMDAwO1xyXG4gICAgICByZXN1bHRzID0gZG9qb051bWJlci5mb3JtYXQobnVtUGFyc2UsIHtcclxuICAgICAgICBwbGFjZXM6IDEsXHJcbiAgICAgIH0pICsgdGV4dC50aG91c2FuZDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc3VsdHMgPSBkb2pvTnVtYmVyLnJvdW5kKG51bVBhcnNlLCAyKS50b1N0cmluZygpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG4gIH0sXHJcbiAgcmVsYXRpdmVEYXRlOiBmdW5jdGlvbiByZWxhdGl2ZURhdGUoX2RhdGUsIHRpbWVsZXNzKSB7XHJcbiAgICBsZXQgZGF0ZSA9IG1vbWVudChfZGF0ZSk7XHJcbiAgICBpZiAoIWRhdGUgfHwgIWRhdGUuaXNWYWxpZCgpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBkYXRlIHBhc3NlZCBpbnRvIGNybS5Gb3JtYXQucmVsYXRpdmVEYXRlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRpbWVsZXNzKSB7XHJcbiAgICAgIC8vIHV0Y1xyXG4gICAgICBkYXRlID0gZGF0ZS5zdWJ0cmFjdCh7XHJcbiAgICAgICAgbWludXRlczogZGF0ZS51dGNPZmZzZXQoKSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRhdGUuZnJvbU5vdygpO1xyXG4gIH0sXHJcbiAgbXVsdGlDdXJyZW5jeTogZnVuY3Rpb24gbXVsdGlDdXJyZW5jeSh2YWwsIGNvZGUpIHtcclxuICAgIHJldHVybiBzdHJpbmcuc3Vic3RpdHV0ZSgnJHswfSAkezF9JywgW2NybS5Gb3JtYXQuY3VycmVuY3kodmFsKSwgY29kZV0pO1xyXG4gIH0sXHJcbiAgbmFtZUxGOiBmdW5jdGlvbiBuYW1lTEYodmFsKSB7XHJcbiAgICBpZiAoIXZhbCkge1xyXG4gICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbmFtZSA9IHRlbXBsYXRlLm5hbWVMRi5hcHBseSh2YWwpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbiAgfSxcclxuICBtYWlsOiBmdW5jdGlvbiBtYWlsKHZhbCkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN0cmluZy5zdWJzdGl0dXRlKCc8YSBocmVmPVwibWFpbHRvOiR7MH1cIj4kezB9PC9hPicsIFt2YWxdKTtcclxuICB9LFxyXG4gIHVzZXJBY3Rpdml0eUZvcm1hdFRleHQ6IHtcclxuICAgICdhc1VuY29uZmlybWVkJzogJ1VuY29uZmlybWVkJyxcclxuICAgICdhc0FjY2VwdGVkJzogJ0FjY2VwdGVkJyxcclxuICAgICdhc0RlY2xuZWQnOiAnRGVjbGluZWQnLFxyXG4gIH0sXHJcbiAgdXNlckFjdGl2aXR5U3RhdHVzOiBmdW5jdGlvbiB1c2VyQWN0aXZpdHlTdGF0dXModmFsKSB7XHJcbiAgICByZXR1cm4gY3JtLkZvcm1hdC51c2VyQWN0aXZpdHlGb3JtYXRUZXh0W3ZhbF07XHJcbiAgfSxcclxuICAvKipcclxuICAgKiBUYWtlcyBhIHN0cmluZyBpbnB1dCBhbmQgY29udmVydHMgbmFtZSB0byBGaXJzdCBhbWQgTGFzdCBpbml0aWFsc1xyXG4gICAqIGBMZWUgSG9nYW5gIC0+IGBMSGBcclxuICAgKiBAcGFyYW0gdmFsXHJcbiAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgKi9cclxuICBmb3JtYXRVc2VySW5pdGlhbDogZnVuY3Rpb24gZm9ybWF0VXNlckluaXRpYWwodXNlcikge1xyXG4gICAgY29uc3QgZmlyc3RMYXN0ID0gdGhpcy5yZXNvbHZlRmlyc3RMYXN0KHVzZXIpO1xyXG4gICAgY29uc3QgaW5pdGlhbHMgPSBbZmlyc3RMYXN0WzBdLnN1YnN0cigwLCAxKV07XHJcblxyXG4gICAgaWYgKGZpcnN0TGFzdFsxXSkge1xyXG4gICAgICBpbml0aWFscy5wdXNoKGZpcnN0TGFzdFsxXS5zdWJzdHIoMCwgMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBpbml0aWFscy5qb2luKCcnKS50b1VwcGVyQ2FzZSgpO1xyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICogVGFrZXMgYSBzdHJpbmcgaW5wdXQgYW5kIHRoZSB1c2VyIG5hbWUgdG8gRmlyc3QgYW1kIExhc3QgbmFtZVxyXG4gICAqIGBIb2dhbiwgTGVlYCAtPiBgTGVlIEhvZ2FuYFxyXG4gICAqIEBwYXJhbSB2YWxcclxuICAgKiBAcmV0dXJucyB7U3RyaW5nfVxyXG4gICAqL1xyXG4gIGZvcm1hdEJ5VXNlcjogZnVuY3Rpb24gZm9ybWF0QnlVc2VyKHVzZXIpIHtcclxuICAgIGNvbnN0IG5hbWUgPSB0aGlzLnJlc29sdmVGaXJzdExhc3QodXNlcik7XHJcbiAgICByZXR1cm4gbmFtZS5qb2luKCcgJyk7XHJcbiAgfSxcclxuICAvKipcclxuICAgKiBUYWtlcyBhIHN0cmluZyBpbnB1dCBhbmQgdGhlIHVzZXIgbmFtZSB0byBGaXJzdCBhbWQgTGFzdCBuYW1lXHJcbiAgICogYEhvZ2FuLCBMZWVgIC0+IGBMZWUgSG9nYW5gXHJcbiAgICogQHBhcmFtIHZhbFxyXG4gICAqIEByZXR1cm5zIHtTdHJpbmd9XHJcbiAgICovXHJcbiAgcmVzb2x2ZUZpcnN0TGFzdDogZnVuY3Rpb24gcmVzb2x2ZUZpcnN0TGFzdChuYW1lKSB7XHJcbiAgICBsZXQgZmlyc3RMYXN0ID0gW107XHJcbiAgICBpZiAobmFtZS5pbmRleE9mKCcgJykgIT09IC0xKSB7XHJcbiAgICAgIGNvbnN0IG5hbWVzID0gbmFtZS5zcGxpdCgnICcpO1xyXG4gICAgICBpZiAobmFtZXNbMF0uaW5kZXhPZignLCcpICE9PSAtMSkge1xyXG4gICAgICAgIGZpcnN0TGFzdCA9IFtuYW1lc1sxXSwgbmFtZXNbMF0uc2xpY2UoMCwgLTEpXTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmaXJzdExhc3QgPSBbbmFtZXNbMF0sIG5hbWVzWzFdXTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmlyc3RMYXN0ID0gW25hbWVdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpcnN0TGFzdDtcclxuICB9LFxyXG4gIGZpeGVkTG9jYWxlOiBmdW5jdGlvbiBmaXhlZExvY2FsZShfdmFsLCBfZCkge1xyXG4gICAgbGV0IHZhbCA9IF92YWw7XHJcbiAgICBsZXQgZCA9IF9kO1xyXG4gICAgbGV0IHA7XHJcbiAgICBsZXQgdjtcclxuICAgIGxldCBmO1xyXG4gICAgbGV0IGZWYWw7XHJcbiAgICBsZXQgbnVtO1xyXG5cclxuICAgIGlmIChpc05hTih2YWwpIHx8IHZhbCA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsKTtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZCAhPT0gJ251bWJlcicpIHtcclxuICAgICAgZCA9IDI7XHJcbiAgICB9XHJcbiAgICBpZiAoZCA+IDApIHtcclxuICAgICAgcCA9IE1hdGgucG93KDEwLCBkKTtcclxuICAgICAgdiA9IHZhbC50b0ZpeGVkKGQpOyAvLyBvbmx5IGQgZGVjaW1hbCBwbGFjZXNcclxuICAgICAgZiA9IE1hdGguZmxvb3IocGFyc2VGbG9hdCgocCAqICh2IC0gTWF0aC5mbG9vcih2KSkpLnRvUHJlY2lzaW9uKGQpKSk7IC8vIGZvciBmcmFjdGlvbmFsIHBhcnQsIG9ubHkgbmVlZCBkIHNpZ25pZmljYW50IGRpZ2l0c1xyXG4gICAgICBpZiAoZiA9PT0gMCkge1xyXG4gICAgICAgIGYgPSAoU3RyaW5nKHApKS5zbGljZSgxKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHsgLy8gemVybyBkZWNpbWFsIHBhbGNlc1xyXG4gICAgICBwID0gTWF0aC5wb3coMTAsIDApO1xyXG4gICAgICB2ID0gKE1hdGgucm91bmQodmFsICogcCkgLyBwKTtcclxuICAgICAgZiA9IDA7XHJcbiAgICB9XHJcbiAgICBudW0gPSBNYXRoLmZsb29yKHYpLnRvU3RyaW5nKCk7XHJcbiAgICBudW0gPSBudW0ucmVwbGFjZSgvKFxcZCkoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCAnJDEnICsgTW9iaWxlLkN1bHR1cmVJbmZvLm51bWJlckZvcm1hdC5udW1iZXJHcm91cFNlcGFyYXRvci5yZXBsYWNlKCdcXFxcLicsICcuJykpO1xyXG4gICAgaWYgKGQgPiAwKSB7XHJcbiAgICAgIGNvbnN0IGZyYWMgPSAoZi50b1N0cmluZygpLmxlbmd0aCA8IGQpID8gJycgOiBmLnRvU3RyaW5nKCk7XHJcbiAgICAgIGZWYWwgPSBzdHJpbmcuc3Vic3RpdHV0ZShcclxuICAgICAgICAnJHswfScgKyBNb2JpbGUuQ3VsdHVyZUluZm8ubnVtYmVyRm9ybWF0Lm51bWJlckRlY2ltYWxTZXBhcmF0b3IgKyAnJHsxfScsIFtudW0sIGZyYWNdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZWYWwgPSBudW07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZlZhbC5yZXBsYWNlKC8gL2csICdcXHUwMEEwJyk7IC8vIGtlZXAgbnVtYmVycyBmcm9tIGJyZWFraW5nXHJcbiAgfSxcclxufSkpO1xyXG5cclxubGFuZy5zZXRPYmplY3QoJ01vYmlsZS5TYWxlc0xvZ2l4LkZvcm1hdCcsIF9fY2xhc3MpO1xyXG5leHBvcnQgZGVmYXVsdCBfX2NsYXNzO1xyXG4iXX0=
</pre>
</body>
</html>
